module.exports=[830304,e=>{"use strict";var t=e.i(747909),r=e.i(174017),a=e.i(996250),n=e.i(759756),s=e.i(561916),o=e.i(114444),i=e.i(837092),l=e.i(869741),u=e.i(316795),d=e.i(487718),p=e.i(995169),c=e.i(47587),f=e.i(666012),m=e.i(570101),h=e.i(626937),g=e.i(10372),R=e.i(193695);e.i(52474);var v=e.i(600220),w=e.i(89171),x=e.i(522734),j=e.i(814747);let N=j.default.join(process.cwd(),"public","images","video"),y=j.default.join(process.cwd(),"public","images","video"),E=[{id:"ad-content",name:"Ad Content"},{id:"before-and-after",name:"Before and After"},{id:"branding",name:"Branding"},{id:"presentations",name:"Presentations"},{id:"all-footages",name:"All Footages"},{id:"other-files",name:"Other Files"}],C=new Set([".png",".jpg",".jpeg",".webp",".gif",".bmp",".tif",".tiff"]),b=new Set([".mp4",".mov",".avi",".mkv",".webm",".flv",".mpeg"]),A=e=>e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,""),P=e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024)),r=e/Math.pow(1024,t);return`${r.toFixed(2)} ${["B","KB","MB","GB","TB"][t]}`},T=e=>{let t=j.default.extname(e).toLowerCase();return C.has(t)?"image":b.has(t)?"video":"clip"},k=async e=>{try{return(await x.promises.stat(e)).isDirectory()}catch{return!1}},I=e=>e.replace(/[\\/]/g,"").trim(),S=e=>e.split("/").map(e=>e.trim()).filter(Boolean),O=e=>{let t=j.default.relative(y,e);return""===t||!t.startsWith("..")&&!j.default.isAbsolute(t)},_=async e=>{try{return(await x.promises.stat(e)).isFile()}catch{return!1}},M=(e,t)=>{let r=j.default.basename(t,j.default.extname(t)),a=`${r}_thumb.jpg`;return j.default.join(N,a)},U=(e,t)=>{let r=j.default.basename(t,j.default.extname(t)),a=`${r}_thumb.jpg`;return`/images/video/${a}`},$=async(e,t,r,a,n)=>{let s=await x.promises.readdir(e,{withFileTypes:!0});s.sort((e,t)=>e.name.localeCompare(t.name,void 0,{sensitivity:"base"}));let o=[],i=[];for(let l of s){if(l.name.startsWith("."))continue;let s=j.default.join(e,l.name);if(l.isDirectory()){let e=await $(s,[...t,l.name],r,a,n);i.push(e);continue}if(l.isFile()){let e=await x.promises.stat(s),i=n.value++,u=[...t,l.name],d=u.map(e=>encodeURIComponent(e)),p=`/api/serve-video/${d.join("/")}`,c=T(l.name),f=p,m=!1;if("video"===c||"clip"===c){let e=M(u,l.name);await _(e)?f=U(u,l.name):(f="/images/video-placeholder.svg",m=!0)}let h={id:i,name:l.name,type:c,url:p,thumbnail:f,size:P(e.size),date:e.mtime.toISOString(),tags:t,favorite:!1,views:0,category:r,needsThumbnailGeneration:m};a.push(h),o.push(i)}}return{id:t.map(A).join("-"),name:t[t.length-1]??"",path:t.join("/"),fileIds:o,children:i}};async function F(){try{let e=[],t={value:1},r=[];for(let a of E){let n=j.default.join(y,a.name);if(await k(n)){let s=await $(n,[a.name],a.name,e,t);r.push(s)}else r.push({id:a.id,name:a.name,path:a.name,fileIds:[],children:[]})}return w.NextResponse.json({folders:r,files:e},{status:200})}catch(e){return console.error("Error reading marketing folders",e),w.NextResponse.json({folders:[],files:[],error:"Unable to read marketing assets."},{status:500})}}let H=async e=>{try{let t=await x.promises.readdir(e);return 0===t.length}catch{return!1}};async function q(e){try{let t=await e.json(),r="string"==typeof t.currentPath?t.currentPath:"",a="string"==typeof t.newName?t.newName:"",n=I(a);if(!r||!n)return w.NextResponse.json({error:"Current path and new folder name are required."},{status:400});if(n.includes(".."))return w.NextResponse.json({error:"Invalid folder name."},{status:400});let s=S(r);if(0===s.length||s.some(e=>e.includes("..")))return w.NextResponse.json({error:"Invalid current path."},{status:400});let o=j.default.join(y,...s);if(!O(o))return w.NextResponse.json({error:"Current path is outside of marketing assets."},{status:400});if(!await k(o))return w.NextResponse.json({error:"Folder does not exist."},{status:404});let i=s.slice(0,-1),l=j.default.join(y,...i);if(!O(l))return w.NextResponse.json({error:"Invalid parent folder."},{status:400});let u=j.default.join(l,n);if(!O(u))return w.NextResponse.json({error:"Invalid target path."},{status:400});if(await k(u))return w.NextResponse.json({error:"Target folder already exists."},{status:409});await x.promises.rename(o,u);let d=i.join("/"),p=d?`${d}/${n}`:n;return w.NextResponse.json({success:!0,path:p},{status:200})}catch(e){return console.error("Error renaming marketing folder",e),w.NextResponse.json({error:"Unable to rename folder."},{status:500})}}async function D(e){try{let t=await e.json(),r="string"==typeof t.parentPath?t.parentPath:"",a="string"==typeof t.folderName?t.folderName:"",n=I(a);if(!r||!n)return w.NextResponse.json({error:"Parent path and folder name are required."},{status:400});if(n.includes(".."))return w.NextResponse.json({error:"Invalid folder name."},{status:400});let s=S(r);if(0===s.length||s.some(e=>e.includes("..")))return w.NextResponse.json({error:"Invalid parent path."},{status:400});let o=j.default.join(y,...s);if(!O(o))return w.NextResponse.json({error:"Parent path is outside of the marketing tree."},{status:400});if(!await k(o))return w.NextResponse.json({error:"Parent folder does not exist."},{status:404});let i=j.default.join(o,n);if(!O(i))return w.NextResponse.json({error:"Invalid folder path."},{status:400});if(await k(i))return w.NextResponse.json({error:"Folder already exists."},{status:409});return await x.promises.mkdir(i),w.NextResponse.json({success:!0,path:`${r}/${n}`},{status:201})}catch(e){return console.error("Error creating marketing folder",e),w.NextResponse.json({error:"Unable to create folder."},{status:500})}}async function B(e){try{let t=await e.json(),r="string"==typeof t.path?t.path:"",a=S(r);if(0===a.length)return w.NextResponse.json({error:"Folder path is required."},{status:400});if(a.some(e=>e.includes("..")))return w.NextResponse.json({error:"Invalid folder path."},{status:400});let n=j.default.join(y,...a);if(!O(n))return w.NextResponse.json({error:"Path is outside marketing assets."},{status:400});if(!await k(n))return w.NextResponse.json({error:"Folder not found."},{status:404});if(!await H(n))return w.NextResponse.json({error:"Folder must be empty before deleting."},{status:409});return await x.promises.rmdir(n),w.NextResponse.json({success:!0,path:a.join("/")},{status:200})}catch(e){return console.error("Error deleting marketing folder",e),w.NextResponse.json({error:"Unable to delete folder."},{status:500})}}e.s(["DELETE",()=>B,"GET",()=>F,"PATCH",()=>q,"POST",()=>D],381634);var K=e.i(381634);let L=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/marketing-folders/route",pathname:"/api/marketing-folders",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/marketing-folders/route.ts",nextConfigOutput:"",userland:K}),{workAsyncStorage:G,workUnitAsyncStorage:z,serverHooks:W}=L;function V(){return(0,a.patchFetch)({workAsyncStorage:G,workUnitAsyncStorage:z})}async function X(e,t,a){L.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let w="/api/marketing-folders/route";w=w.replace(/\/index$/,"")||"/";let x=await L.prepare(e,t,{srcPage:w,multiZoneDraftMode:!1});if(!x)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:j,params:N,nextConfig:y,parsedUrl:E,isDraftMode:C,prerenderManifest:b,routerServerContext:A,isOnDemandRevalidate:P,revalidateOnlyGenerated:T,resolvedPathname:k,clientReferenceManifest:I,serverActionsManifest:S}=x,O=(0,l.normalizeAppPath)(w),_=!!(b.dynamicRoutes[O]||b.routes[k]),M=async()=>((null==A?void 0:A.render404)?await A.render404(e,t,E,!1):t.end("This page could not be found"),null);if(_&&!C){let e=!!b.routes[k],t=b.dynamicRoutes[O];if(t&&!1===t.fallback&&!e){if(y.experimental.adapterPath)return await M();throw new R.NoFallbackError}}let U=null;!_||L.isDev||C||(U="/index"===(U=k)?"/":U);let $=!0===L.isDev||!_,F=_&&!$;S&&I&&(0,o.setReferenceManifestsSingleton)({page:w,clientReferenceManifest:I,serverActionsManifest:S,serverModuleMap:(0,i.createServerModuleMap)({serverActionsManifest:S})});let H=e.method||"GET",q=(0,s.getTracer)(),D=q.getActiveScopeSpan(),B={params:N,prerenderManifest:b,renderOpts:{experimental:{authInterrupts:!!y.experimental.authInterrupts},cacheComponents:!!y.cacheComponents,supportsDynamicResponse:$,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:y.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>L.onRequestError(e,t,a,A)},sharedContext:{buildId:j}},K=new u.NodeNextRequest(e),G=new u.NodeNextResponse(t),z=d.NextRequestAdapter.fromNodeNextRequest(K,(0,d.signalFromNodeResponse)(t));try{let o=async e=>L.handle(z,B).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=q.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${H} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${H} ${w}`)}),i=!!(0,n.getRequestMeta)(e,"minimalMode"),l=async n=>{var s,l;let u=async({previousCacheEntry:r})=>{try{if(!i&&P&&T&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await o(n);e.fetchMetrics=B.renderOpts.fetchMetrics;let l=B.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let u=B.renderOpts.collectedTags;if(!_)return await (0,f.sendResponse)(K,G,s,B.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(s.headers);u&&(t[g.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==B.renderOpts.collectedRevalidate&&!(B.renderOpts.collectedRevalidate>=g.INFINITE_CACHE)&&B.renderOpts.collectedRevalidate,a=void 0===B.renderOpts.collectedExpire||B.renderOpts.collectedExpire>=g.INFINITE_CACHE?void 0:B.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await L.onRequestError(e,t,{routerKind:"App Router",routePath:w,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:F,isOnDemandRevalidate:P})},A),t}},d=await L.handleResponse({req:e,nextConfig:y,cacheKey:U,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:b,isRoutePPREnabled:!1,isOnDemandRevalidate:P,revalidateOnlyGenerated:T,responseGenerator:u,waitUntil:a.waitUntil,isMinimalMode:i});if(!_)return null;if((null==d||null==(s=d.value)?void 0:s.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(l=d.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",P?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),C&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,m.fromNodeOutgoingHttpHeaders)(d.value.headers);return i&&_||p.delete(g.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,h.getCacheControlHeader)(d.cacheControl)),await (0,f.sendResponse)(K,G,new Response(d.value.body,{headers:p,status:d.value.status||200})),null};D?await l(D):await q.withPropagatedContext(e.headers,()=>q.trace(p.BaseServerSpan.handleRequest,{spanName:`${H} ${w}`,kind:s.SpanKind.SERVER,attributes:{"http.method":H,"http.target":e.url}},l))}catch(t){if(t instanceof R.NoFallbackError||await L.onRequestError(e,t,{routerKind:"App Router",routePath:O,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:F,isOnDemandRevalidate:P})}),_)throw t;return await (0,f.sendResponse)(K,G,new Response(null,{status:500})),null}}e.s(["handler",()=>X,"patchFetch",()=>V,"routeModule",()=>L,"serverHooks",()=>W,"workAsyncStorage",()=>G,"workUnitAsyncStorage",()=>z],830304)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_a70c2ec0.js.map