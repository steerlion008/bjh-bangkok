{"version":3,"sources":["../../../../src/components/NotificationPopup.tsx","../../../../src/components/EditCustomerModal.tsx","../../../../src/components/AddCustomerModal.tsx","../../../../src/app/%28fullscreen%29/customer-all-data/page.tsx","../../../../src/app/api/customer-data/utils.ts","../../../../node_modules/lucide-react/src/icons/funnel.ts","../../../../node_modules/lucide-react/src/icons/chevron-up.ts","../../../../node_modules/lucide-react/src/icons/clipboard-check.ts"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { CheckCircle, XCircle, X } from \"lucide-react\";\r\n\r\ninterface NotificationPopupProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  type: \"success\" | \"error\";\r\n  title: string;\r\n  message: string;\r\n}\r\n\r\nexport const NotificationPopup = ({\r\n  isOpen,\r\n  onClose,\r\n  type,\r\n  title,\r\n  message,\r\n}: NotificationPopupProps) => {\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const [isAnimating, setIsAnimating] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setIsVisible(true);\r\n      setTimeout(() => setIsAnimating(true), 10);\r\n\r\n      // Auto close after 3 seconds\r\n      const timer = setTimeout(() => {\r\n        handleClose();\r\n      }, 3000);\r\n\r\n      return () => clearTimeout(timer);\r\n    } else {\r\n      setIsAnimating(false);\r\n      setTimeout(() => setIsVisible(false), 300);\r\n    }\r\n  }, [isOpen]);\r\n\r\n  const handleClose = () => {\r\n    setIsAnimating(false);\r\n    setTimeout(() => {\r\n      setIsVisible(false);\r\n      onClose();\r\n    }, 300);\r\n  };\r\n\r\n  if (!isVisible) return null;\r\n\r\n  const isSuccess = type === \"success\";\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 flex items-center justify-center z-[9999] pointer-events-none\">\r\n      {/* Backdrop with blur effect */}\r\n      <div\r\n        className={`absolute inset-0 backdrop-blur-sm transition-opacity duration-300 pointer-events-auto ${\r\n          isAnimating ? \"opacity-100\" : \"opacity-0\"\r\n        }`}\r\n        style={{ backgroundColor: \"rgba(0, 0, 0, 0.3)\" }}\r\n        onClick={handleClose}\r\n      />\r\n\r\n      {/* Notification Card */}\r\n      <div\r\n        className={`relative pointer-events-auto transform transition-all duration-300 ${\r\n          isAnimating\r\n            ? \"scale-100 opacity-100 translate-y-0\"\r\n            : \"scale-95 opacity-0 -translate-y-4\"\r\n        }`}\r\n      >\r\n        <div\r\n          className={`relative bg-white rounded-2xl shadow-2xl overflow-hidden w-96 ${\r\n            isSuccess ? \"border-4 border-green-400\" : \"border-4 border-red-400\"\r\n          }`}\r\n        >\r\n          {/* Animated Background Gradient */}\r\n          <div\r\n            className={`absolute inset-0 opacity-10 ${\r\n              isSuccess\r\n                ? \"bg-gradient-to-br from-green-400 via-emerald-400 to-teal-400\"\r\n                : \"bg-gradient-to-br from-red-400 via-rose-400 to-pink-400\"\r\n            } animate-gradient`}\r\n          />\r\n\r\n          {/* Close Button */}\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"absolute top-4 right-4 p-1 rounded-full hover:bg-gray-100 transition-colors z-10\"\r\n          >\r\n            <X className=\"w-5 h-5 text-gray-500\" />\r\n          </button>\r\n\r\n          {/* Content */}\r\n          <div className=\"relative p-8\">\r\n            {/* Icon with animation */}\r\n            <div className=\"flex justify-center mb-6\">\r\n              <div\r\n                className={`relative ${\r\n                  isSuccess ? \"animate-success-icon\" : \"animate-error-icon\"\r\n                }`}\r\n              >\r\n                {isSuccess ? (\r\n                  <div className=\"relative\">\r\n                    {/* Pulsing circles */}\r\n                    <div className=\"absolute inset-0 animate-ping-slow\">\r\n                      <div className=\"w-24 h-24 rounded-full bg-green-400 opacity-30\" />\r\n                    </div>\r\n                    <div className=\"absolute inset-0 animate-pulse-slow\">\r\n                      <div className=\"w-24 h-24 rounded-full bg-green-300 opacity-20\" />\r\n                    </div>\r\n                    {/* Main icon */}\r\n                    <CheckCircle className=\"w-24 h-24 text-green-500 relative z-10 drop-shadow-lg\" />\r\n                    {/* Sparkles */}\r\n                    <div className=\"absolute top-0 left-0 w-full h-full\">\r\n                      <div className=\"absolute top-2 right-2 w-3 h-3 bg-yellow-400 rounded-full animate-sparkle-1\" />\r\n                      <div className=\"absolute top-6 right-0 w-2 h-2 bg-yellow-300 rounded-full animate-sparkle-2\" />\r\n                      <div className=\"absolute top-0 right-6 w-2 h-2 bg-yellow-500 rounded-full animate-sparkle-3\" />\r\n                      <div className=\"absolute bottom-2 left-2 w-3 h-3 bg-green-300 rounded-full animate-sparkle-1\" />\r\n                      <div className=\"absolute bottom-6 left-0 w-2 h-2 bg-green-400 rounded-full animate-sparkle-2\" />\r\n                    </div>\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"relative\">\r\n                    {/* Pulsing circles */}\r\n                    <div className=\"absolute inset-0 animate-ping-slow\">\r\n                      <div className=\"w-24 h-24 rounded-full bg-red-400 opacity-30\" />\r\n                    </div>\r\n                    <div className=\"absolute inset-0 animate-pulse-slow\">\r\n                      <div className=\"w-24 h-24 rounded-full bg-red-300 opacity-20\" />\r\n                    </div>\r\n                    {/* Main icon */}\r\n                    <XCircle className=\"w-24 h-24 text-red-500 relative z-10 drop-shadow-lg animate-shake\" />\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Title */}\r\n            <h2\r\n              className={`text-2xl font-bold text-center mb-3 ${\r\n                isSuccess ? \"text-green-600\" : \"text-red-600\"\r\n              }`}\r\n            >\r\n              {title}\r\n            </h2>\r\n\r\n            {/* Message */}\r\n            <p className=\"text-gray-600 text-center text-base leading-relaxed\">\r\n              {message}\r\n            </p>\r\n\r\n            {/* Progress bar */}\r\n            <div className=\"mt-6\">\r\n              <div className=\"w-full h-1 bg-gray-200 rounded-full overflow-hidden\">\r\n                <div\r\n                  className={`h-full ${\r\n                    isSuccess ? \"bg-green-500\" : \"bg-red-500\"\r\n                  } animate-progress`}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Bottom decoration */}\r\n          <div\r\n            className={`h-2 ${\r\n              isSuccess\r\n                ? \"bg-gradient-to-r from-green-400 via-emerald-400 to-teal-400\"\r\n                : \"bg-gradient-to-r from-red-400 via-rose-400 to-pink-400\"\r\n            }`}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <style jsx>{`\r\n        @keyframes gradient {\r\n          0%,\r\n          100% {\r\n            transform: scale(1) rotate(0deg);\r\n          }\r\n          50% {\r\n            transform: scale(1.1) rotate(5deg);\r\n          }\r\n        }\r\n\r\n        @keyframes ping-slow {\r\n          0% {\r\n            transform: scale(1);\r\n            opacity: 0.3;\r\n          }\r\n          50% {\r\n            transform: scale(1.2);\r\n            opacity: 0.15;\r\n          }\r\n          100% {\r\n            transform: scale(1.4);\r\n            opacity: 0;\r\n          }\r\n        }\r\n\r\n        @keyframes pulse-slow {\r\n          0%,\r\n          100% {\r\n            transform: scale(1);\r\n            opacity: 0.2;\r\n          }\r\n          50% {\r\n            transform: scale(1.15);\r\n            opacity: 0.3;\r\n          }\r\n        }\r\n\r\n        @keyframes success-icon {\r\n          0% {\r\n            transform: scale(0) rotate(-180deg);\r\n          }\r\n          50% {\r\n            transform: scale(1.2) rotate(10deg);\r\n          }\r\n          100% {\r\n            transform: scale(1) rotate(0deg);\r\n          }\r\n        }\r\n\r\n        @keyframes error-icon {\r\n          0% {\r\n            transform: scale(0) rotate(0deg);\r\n          }\r\n          50% {\r\n            transform: scale(1.2);\r\n          }\r\n          100% {\r\n            transform: scale(1);\r\n          }\r\n        }\r\n\r\n        @keyframes shake {\r\n          0%,\r\n          100% {\r\n            transform: translateX(0);\r\n          }\r\n          10%,\r\n          30%,\r\n          50%,\r\n          70%,\r\n          90% {\r\n            transform: translateX(-3px);\r\n          }\r\n          20%,\r\n          40%,\r\n          60%,\r\n          80% {\r\n            transform: translateX(3px);\r\n          }\r\n        }\r\n\r\n        @keyframes sparkle-1 {\r\n          0%,\r\n          100% {\r\n            transform: scale(0) rotate(0deg);\r\n            opacity: 0;\r\n          }\r\n          50% {\r\n            transform: scale(1) rotate(180deg);\r\n            opacity: 1;\r\n          }\r\n        }\r\n\r\n        @keyframes sparkle-2 {\r\n          0%,\r\n          100% {\r\n            transform: scale(0) rotate(0deg);\r\n            opacity: 0;\r\n          }\r\n          60% {\r\n            transform: scale(1) rotate(180deg);\r\n            opacity: 1;\r\n          }\r\n        }\r\n\r\n        @keyframes sparkle-3 {\r\n          0%,\r\n          100% {\r\n            transform: scale(0) rotate(0deg);\r\n            opacity: 0;\r\n          }\r\n          40% {\r\n            transform: scale(1) rotate(180deg);\r\n            opacity: 1;\r\n          }\r\n        }\r\n\r\n        @keyframes progress {\r\n          0% {\r\n            width: 0%;\r\n          }\r\n          100% {\r\n            width: 100%;\r\n          }\r\n        }\r\n\r\n        .animate-gradient {\r\n          animation: gradient 3s ease-in-out infinite;\r\n        }\r\n\r\n        .animate-ping-slow {\r\n          animation: ping-slow 2s cubic-bezier(0, 0, 0.2, 1) infinite;\r\n        }\r\n\r\n        .animate-pulse-slow {\r\n          animation: pulse-slow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\r\n        }\r\n\r\n        .animate-success-icon {\r\n          animation: success-icon 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);\r\n        }\r\n\r\n        .animate-error-icon {\r\n          animation: error-icon 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);\r\n        }\r\n\r\n        .animate-shake {\r\n          animation: shake 0.5s cubic-bezier(0.36, 0.07, 0.19, 0.97) 0.6s;\r\n        }\r\n\r\n        .animate-sparkle-1 {\r\n          animation: sparkle-1 1s ease-in-out 0.3s;\r\n        }\r\n\r\n        .animate-sparkle-2 {\r\n          animation: sparkle-2 1s ease-in-out 0.4s;\r\n        }\r\n\r\n        .animate-sparkle-3 {\r\n          animation: sparkle-3 1s ease-in-out 0.5s;\r\n        }\r\n\r\n        .animate-progress {\r\n          animation: progress 3s linear;\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n};\r\n","\"use client\";\r\nimport { useState, useEffect, useMemo, useRef, useCallback, type PointerEvent } from \"react\";\r\nimport { X, Save, Loader2, Star, FileText, ClipboardCheck, Briefcase, Calendar, User } from \"lucide-react\";\r\nimport { NotificationPopup } from \"./NotificationPopup\";\r\n\r\ninterface CustomerData {\r\n  [key: string]: any;\r\n}\r\n\r\ninterface ThaiProvince {\r\n  id: number;\r\n  name_th: string;\r\n  name_en: string;\r\n}\r\n\r\ninterface ThaiDistrict {\r\n  id: number;\r\n  province_id: number;\r\n  name_th: string;\r\n  name_en: string;\r\n}\r\n\r\ninterface ThaiSubDistrict {\r\n  id: number;\r\n  district_id: number;\r\n  name_th: string;\r\n  name_en: string;\r\n  zip_code: number | string | null;\r\n}\r\n\r\ninterface ThaiAdministrativeData {\r\n  provinces: ThaiProvince[];\r\n  districts: ThaiDistrict[];\r\n  subdistricts: ThaiSubDistrict[];\r\n}\r\n\r\nconst THAI_DATA_BASE_URL =\r\n  \"https://raw.githubusercontent.com/kongvut/thai-province-data/refs/heads/master/api/latest\";\r\n\r\nlet thaiAdministrativeCache: ThaiAdministrativeData | null = null;\r\nlet thaiAdministrativePromise: Promise<ThaiAdministrativeData> | null = null;\r\n\r\nconst fetchThaiAdministrativeData = async () => {\r\n  if (thaiAdministrativeCache) {\r\n    return thaiAdministrativeCache;\r\n  }\r\n\r\n  if (!thaiAdministrativePromise) {\r\n    thaiAdministrativePromise = Promise.all([\r\n      fetch(`${THAI_DATA_BASE_URL}/province.json`).then((response) => {\r\n        if (!response.ok) {\r\n          throw new Error(\"ไม่สามารถโหลดข้อมูลจังหวัดได้\");\r\n        }\r\n        return response.json() as Promise<ThaiProvince[]>;\r\n      }),\r\n      fetch(`${THAI_DATA_BASE_URL}/district.json`).then((response) => {\r\n        if (!response.ok) {\r\n          throw new Error(\"ไม่สามารถโหลดข้อมูลอำเภอได้\");\r\n        }\r\n        return response.json() as Promise<ThaiDistrict[]>;\r\n      }),\r\n      fetch(`${THAI_DATA_BASE_URL}/sub_district.json`).then((response) => {\r\n        if (!response.ok) {\r\n          throw new Error(\"ไม่สามารถโหลดข้อมูลตำบลได้\");\r\n        }\r\n        return response.json() as Promise<ThaiSubDistrict[]>;\r\n      }),\r\n    ]).then(([provinces, districts, subdistricts]) => {\r\n      const payload: ThaiAdministrativeData = {\r\n        provinces,\r\n        districts,\r\n        subdistricts,\r\n      };\r\n      thaiAdministrativeCache = payload;\r\n      return payload;\r\n    });\r\n  }\r\n\r\n  return thaiAdministrativePromise;\r\n};\r\n\r\nconst normalizeAdministrativeName = (value: string | null | undefined) =>\r\n  value ? value.trim().toLowerCase() : \"\";\r\n\r\nconst matchesAdministrativeName = (\r\n  candidate: { name_th: string; name_en: string },\r\n  target: string\r\n) => {\r\n  const normalizedTarget = normalizeAdministrativeName(target);\r\n  if (!normalizedTarget) {\r\n    return false;\r\n  }\r\n  return (\r\n    normalizeAdministrativeName(candidate.name_th) === normalizedTarget ||\r\n    normalizeAdministrativeName(candidate.name_en) === normalizedTarget\r\n  );\r\n};\r\n\r\n// OPD Service interfaces\r\ninterface OPDServiceGroup {\r\n  groupcode: string;\r\n  groupname: string;\r\n}\r\n\r\ninterface OPDServiceItem {\r\n  itemcode: string;\r\n  itemname: string;\r\n  saleprice: number;\r\n}\r\n\r\ninterface SelectedServiceEntry {\r\n  id: string;\r\n  itemcode: string;\r\n  itemname: string;\r\n  salesprice: number;\r\n  chargePrice: string;\r\n  chargePercent: string;\r\n  discountPrice: string;\r\n  discountPercent: string;\r\n  saleType?: string;\r\n}\r\n\r\ninterface ConsentSection {\r\n  weight: string;\r\n  height: string;\r\n  hasChronic: boolean;\r\n  chronicDiseaseDetail: string;\r\n  hasDrugAllergy: boolean;\r\n  drugAllergyDetail: string;\r\n  signatureUrl: string;\r\n  medicalConsent: string;\r\n  acceptPdpa: string;\r\n  acceptMedia: string;\r\n}\r\n\r\nconst consentPartMeta = [\r\n  { key: \"patient\", label: \"ผู้รับบริการ\" },\r\n  { key: \"provider\", label: \"ผู้ให้ข้อมูล\" },\r\n] as const;\r\n\r\ntype ConsentPartKey = (typeof consentPartMeta)[number][\"key\"];\r\n\r\nconst buildEmptyConsentSections = () =>\r\n  consentPartMeta.reduce((acc, part) => {\r\n    acc[part.key] = {\r\n      weight: \"\",\r\n      height: \"\",\r\n      hasChronic: false,\r\n      chronicDiseaseDetail: \"\",\r\n      hasDrugAllergy: false,\r\n      drugAllergyDetail: \"\",\r\n      signatureUrl: \"\",\r\n      medicalConsent: \"\",\r\n      acceptPdpa: \"\",\r\n      acceptMedia: \"\",\r\n    };\r\n    return acc;\r\n  }, {} as Record<ConsentPartKey, ConsentSection>);\r\n\r\nconst medicalConsentOptions = [\"ยินยอม\", \"ไม่ยินยอม\"] as const;\r\nconst medicalConsentAcknowledgementText = [\r\n  \"ข้าพเจ้าขอแสดงความยินยอมและรับทราบเงื่อนไขการตรวจรักษาดังต่อไปนี้\",\r\n  \"ข้าพเจ้ายินยอมเข้ารับบริการหัตถการ, การศัลยกรรม หรือการรักษาทางการแพทย์อื่น ๆ ตามที่แพทย์เห็นสมควร\",\r\n  \"ข้าพเจ้าตกลงยินยอมให้ทีมแพทย์และบุคลากรทางการแพทย์ ดำเนินการตรวจวินิจฉัย รักษา ให้คำปรึกษา หรือทำหัตถการต่าง ๆ ที่จำเป็น อันรวมถึงแต่ไม่จำกัดเพียง การฉีดยา, การเจาะเลือด, การทำหัตถการเล็ก, การทำเลเซอร์, การผ่าตัดเฉพาะจุด และการรักษาโดยเทคโนโลยีต่าง ๆ ตามดุลยพินิจของแพทย์\",\r\n  \"ข้าพเจ้ารับทราบถึงผลลัพธ์ที่อาจเกิดขึ้น รวมถึงภาวะแทรกซ้อนหรือความเสี่ยงต่าง ๆ ที่อาจเกิดขึ้นได้จากการตรวจรักษาหรือหัตถการดังกล่าว และขอยืนยันว่าได้รับคำอธิบายจากบุคลากรทางการแพทย์อย่างเพียงพอแล้ว\",\r\n  \"ในกรณีเกิดเหตุการณ์ฉุกเฉิน ข้าพเจ้ายินยอมให้บุคลากรทางการแพทย์ดำเนินการรักษาอย่างเร่งด่วนตามความเหมาะสมโดยไม่จำเป็นต้องขอความยินยอมเพิ่มเติม\",\r\n  \"ข้าพเจ้ารับทราบถึงสิทธิ์ของข้าพเจ้าในการขอเข้าถึง แก้ไข หรือเพิกถอนความยินยอมในการใช้ข้อมูลส่วนบุคคล ตามที่กฎหมาย PDPA กำหนด\",\r\n  \"ข้าพเจ้าเข้าใจและยินยอมว่า เมื่อได้มีการชำระเงินมัดจำเพื่อยืนยันการจองบริการแล้ว จะไม่สามารถขอคืนเงินมัดจำดังกล่าวได้ไม่ว่ากรณีใด ๆ\",\r\n  \"ข้าพเจ้าได้อ่านและเข้าใจข้อความข้างต้นโดยชัดเจนแล้ว และยินยอมโดยสมัครใจ โดยไม่มีการบังคับหรือหลอกลวงใด ๆ ทั้งสิ้น\",\r\n  \"ผู้รับบริการขอรับรองว่าได้แสดงเจตนาไว้ก่อนเข้ารับบริการรักษาและ/หรือรับบริการใด ๆ ก็ตาม ผู้รับบริการหรือผู้แทนขอสละสิทธิ์ทุกประเภทที่จะเรียกร้องค่าเสียหายหรือค่าใช้จ่ายใด ๆ จากบริษัทหรือแพทย์ผู้เชี่ยวชาญหรือผู้ให้บริการ\",\r\n  \"ผู้รับบริการทราบดีว่าการรับบริการนี้เป็นความยินยอมและสมัครใจโดยไม่ได้ถูกบังคับ หลอกลวง หรือเข้าใจผิดในสาระสำคัญของข้อเท็จจริง\",\r\n  \"ไม่ว่ากรณีใด ๆ ผู้รับบริการจะไม่บอกเลิกการใช้บริการหรือขอคืนเงินที่ชำระไว้แล้ว\",\r\n  \"กรณีชำระเงินมัดจำไว้บางส่วนและขาดการติดต่อหรือไม่เข้ารับบริการเกิน 6 เดือน ผู้รับบริการจะหมดอายุการเป็นสมาชิก ยกเว้นกรณีชำระเงินครบถ้วนตามโปรแกรม ผู้รับบริการจะต้องเข้ารับบริการให้ครบภายในระยะเวลา 2 ปี หากเกินกำหนด บริษัทมีสิทธิ์ยกเลิกการให้บริการโดยไม่ต้องแจ้งล่วงหน้า\",\r\n  \"ผู้รับบริการต้องชำระค่าบริการให้ครบถ้วนตามที่ตกลงไว้ มิฉะนั้นโปรแกรมจะสิ้นสุดลงโดยอัตโนมัติ\",\r\n  \"หากผู้รับบริการชำระเงินไม่ครบถ้วน หากมีการรับบริการ บริษัทจะคำนวณหักค่าใช้บริการจากราคาเต็ม จนกว่าจะชำระครบแล้วจึงคิดราคาตามส่วนลดหรือโปรโมชั่น\",\r\n  \"โปรแกรมนี้เป็นโปรแกรมเฉพาะบุคคล ไม่สามารถโอนสิทธิ์ให้ผู้อื่นได้\",\r\n  \"กรณีมีปัญหาสุขภาพที่ไม่สามารถใช้โปรแกรมต่อได้ ต้องได้รับการตรวจและยืนยันจากแพทย์เท่านั้น บริษัทจะคืนเงินไม่เกิน 70% ของราคาเต็ม\",\r\n  \"ผู้รับบริการทราบและตกลงว่าจะไม่ถือเอาค่าโฆษณา คำชวน คำแนะนำ หรือคำบรรยายสรรพคุณใด ๆ จากพนักงานเป็นส่วนหนึ่งของข้อตกลง ทั้งนี้ผลลัพธ์ขึ้นกับสุขภาพร่างกาย สภาพผิว การใช้ยา สิ่งแวดล้อม และพฤติกรรมของผู้รับบริการ\",\r\n  \"หากบริษัทพิจารณาว่าสภาพผิวหรือร่างกายผู้รับบริการไม่พร้อม บริษัทขอสงวนสิทธิ์หยุดหรือยกเลิกบริการบางส่วนหรือทั้งหมดได้ทันที\",\r\n  \"ผู้รับบริการยินยอมให้ตรวจสุขภาพและทำแบบทดสอบต่าง ๆ ตามที่บริษัทกำหนด\",\r\n  \"ผู้รับบริการตกลงรับผิดชอบต่อความเสียหายที่เกิดขึ้นกับทรัพย์สินของตนเอง\",\r\n  \"ผู้รับบริการตกลงรับผิดชอบต่อการกระทำใด ๆ ที่ก่อให้เกิดความเสียหายต่อทรัพย์สินหรือชื่อเสียงของบริษัท\",\r\n  \"บริษัทมีสิทธิ์หยุด ระงับ หรือยกเลิกการให้บริการหากผู้รับบริการมีพฤติกรรมไม่เหมาะสม\",\r\n  \"สัญญานี้ไม่สามารถดัดแปลง แก้ไข หรือขูดลบใด ๆ เว้นแต่มีข้อตกลงเป็นลายลักษณ์อักษร\",\r\n  \"กรณีชำระยอดคงเหลือ ผู้รับบริการต้องชำระภายใน 14 วันนับจากวันที่ตกลงใช้บริการ\",\r\n  \"จดคืนเงินทุกกรณี: No Refund\",\r\n];\r\n\r\nconst pdpaTextBlock = [\r\n  \"PDPA - ข้าพเจ้ายินยอมให้โรงพยาบาล/คลินิก เก็บ รวบรวม ใช้ และเปิดเผยข้อมูลส่วนบุคคลเพื่อวัตถุประสงค์ในการให้บริการทางการแพทย์ และ/หรือการใช้เพื่อประโยชน์ทางการแพทย์อื่น ๆ\",\r\n  \"ข้าพเจ้ายินยอมให้มีการบันทึกภาพถ่าย วิดีโอ หรือเอกสารทางการแพทย์ที่เกี่ยวข้อง เพื่อประกอบการรักษา ติดตามผล หรือใช้เพื่อการศึกษา วิจัย หรือประชาสัมพันธ์ (โดยไม่เปิดเผยตัวตน เว้นแต่จะได้รับความยินยอมเป็นลายลักษณ์อักษรเพิ่มเติม)\",\r\n];\r\nconst mediaTextBlock = [\r\n  \"ข้าพเจ้ายินยอมให้คลินิกใช้ภาพถ่าย หรือวิดีโอที่เกิดขึ้นระหว่างการรักษาเพื่อประกอบการศึกษาภายในหรือประชาสัมพันธ์ โดยไม่ระบุชื่อบุคคล และขอสงวนสิทธิ์ในการขอความยินยอมเพิ่มเติมหากมีการเปิดเผยตัวตน\",\r\n  \"ข้าพเจ้ายินยอมรับข้อมูลประชาสัมพันธ์เกี่ยวกับการรักษา ผ่านช่องทางที่คลินิกกำหนด เพื่อเป็นส่วนหนึ่งของการติดตามผลการรักษาหรือการให้ข่าวสารสำคัญ\",\r\n];\r\nconst acceptOptions = [\"ยอมรับ\", \"ไม่ยอมรับ\"] as const;\r\n\r\n// Currency formatting helpers\r\nconst currencyFormatter = new Intl.NumberFormat(\"th-TH\", {\r\n  minimumFractionDigits: 2,\r\n  maximumFractionDigits: 2,\r\n});\r\n\r\nconst formatCurrencyDisplay = (value: number) =>\r\n  Number.isFinite(value) ? currencyFormatter.format(value) : \"0.00\";\r\n\r\nconst formatDecimalInputValue = (value: number) =>\r\n  Number.isFinite(value) ? value.toFixed(2) : \"\";\r\n\r\nconst parseMonetaryInputValue = (value: string) => {\r\n  const trimmed = value.trim();\r\n  if (!trimmed) return 0;\r\n  const numeric = Number(trimmed);\r\n  return Number.isFinite(numeric) ? numeric : 0;\r\n};\r\n\r\nconst toNumericValue = (value: unknown) => {\r\n  if (value === null || value === undefined) return 0;\r\n  if (typeof value === \"number\" && Number.isFinite(value)) {\r\n    return value;\r\n  }\r\n  const numeric = Number(value);\r\n  return Number.isFinite(numeric) ? numeric : 0;\r\n};\r\n\r\nconst normalizeSalepriceValue = (value: number | string | null | undefined) => {\r\n  if (value === null || value === undefined) return 0;\r\n  const numeric = typeof value === \"number\" ? value : Number(value);\r\n  return Number.isFinite(numeric) ? numeric : 0;\r\n};\r\n\r\nconst calculateServiceEntryTotal = (entry: SelectedServiceEntry) => {\r\n  const baseAmount = Number.isFinite(entry.salesprice) ? entry.salesprice : 0;\r\n  const chargeAmount = parseMonetaryInputValue(entry.chargePrice);\r\n  const discountAmount = parseMonetaryInputValue(entry.discountPrice);\r\n  return baseAmount + chargeAmount - discountAmount;\r\n};\r\n\r\nconst generateReceiptNumber = () => {\r\n  const twoDigits = Math.floor(Math.random() * 90 + 10);\r\n  const fourDigits = Math.floor(Math.random() * 9000 + 1000);\r\n  return `Ex${twoDigits}-${fourDigits}`;\r\n};\r\n\r\nconst bjhMasterColumnDefinitions = [\r\n  { key: \"id_all\", label: \"id_all\", readOnly: true },\r\n  { key: \"cn\", label: \"cn\" },\r\n  { key: \"code\", label: \"code\" },\r\n  { key: \"status\", label: \"status\" },\r\n  { key: \"source\", label: \"source\" },\r\n  { key: \"interested_product\", label: \"interested_product\" },\r\n  { key: \"doctor\", label: \"doctor\" },\r\n  { key: \"contact_staff\", label: \"contact_staff\" },\r\n  { key: \"prefix\", label: \"prefix\" },\r\n  { key: \"name\", label: \"name\" },\r\n  { key: \"surname\", label: \"surname\" },\r\n  { key: \"nickname\", label: \"nickname\" },\r\n  { key: \"gender\", label: \"gender\" },\r\n  { key: \"birthdate\", label: \"birthdate\" },\r\n  { key: \"occupation\", label: \"occupation\" },\r\n  { key: \"member\", label: \"member\" },\r\n  { key: \"cusgroup\", label: \"cusgroup\" },\r\n  { key: \"customer_name\", label: \"customer_name\" },\r\n  { key: \"phone\", label: \"phone\" },\r\n  { key: \"mobilephone\", label: \"mobilephone\" },\r\n  { key: \"email\", label: \"email\" },\r\n  { key: \"lineid\", label: \"lineid\" },\r\n  { key: \"facebook\", label: \"facebook\" },\r\n  { key: \"country\", label: \"country\" },\r\n  { key: \"from_province\", label: \"from_province\" },\r\n  { key: \"medianame\", label: \"medianame\" },\r\n  { key: \"disease\", label: \"disease\" },\r\n  { key: \"allergic\", label: \"allergic\" },\r\n  { key: \"note\", label: \"note\", multiline: true },\r\n  { key: \"got_contact_date\", label: \"got_contact_date\" },\r\n  { key: \"last_followup\", label: \"last_followup\" },\r\n  { key: \"next_followup\", label: \"next_followup\" },\r\n  { key: \"consult_date\", label: \"consult_date\" },\r\n  { key: \"surgery_date\", label: \"surgery_date\" },\r\n  { key: \"appointment_time\", label: \"appointment_time\" },\r\n  { key: \"booked_consult_date\", label: \"booked_consult_date\" },\r\n  { key: \"booked_surgery_date\", label: \"booked_surgery_date\" },\r\n  { key: \"proposed_amount\", label: \"proposed_amount\" },\r\n  { key: \"star_flag\", label: \"star_flag\" },\r\n  { key: \"address\", label: \"address\", multiline: true },\r\n  { key: \"province\", label: \"province\" },\r\n  { key: \"zipcode\", label: \"zipcode\" },\r\n  { key: \"registerdate\", label: \"registerdate\" },\r\n  { key: \"ownername\", label: \"ownername\" },\r\n  { key: \"binddate\", label: \"binddate\" },\r\n  { key: \"is_opd\", label: \"is_opd\" },\r\n  { key: \"locno\", label: \"locno\" },\r\n  { key: \"road\", label: \"road\" },\r\n  { key: \"moo\", label: \"moo\" },\r\n  { key: \"tumbon\", label: \"tumbon\" },\r\n  { key: \"amphur\", label: \"amphur\" },\r\n  { key: \"id_card\", label: \"id_card\" },\r\n];\r\n\r\nconst getBjFieldType = (key: string) => {\r\n  const normalized = key.toLowerCase();\r\n  if (normalized.includes(\"date\")) return \"date\";\r\n  if (normalized.includes(\"time\")) return \"time\";\r\n  if (normalized === \"proposed_amount\") return \"number\";\r\n  return \"text\";\r\n};\r\n\r\ntype AppointmentFieldType = \"text\" | \"date\" | \"textarea\" | \"tel\" | \"time\" | \"datetime-local\";\r\n\r\ninterface AppointmentFieldMeta {\r\n  key: string;\r\n  label: string;\r\n  type?: AppointmentFieldType;\r\n  placeholder?: string;\r\n  readOnly?: boolean;\r\n  fullWidth?: boolean;\r\n}\r\n\r\nconst appointmentFieldMeta: AppointmentFieldMeta[] = [\r\n  { key: \"record_no\", label: \"Record No\", readOnly: true },\r\n  { key: \"code\", label: \"Code\", readOnly: true },\r\n  { key: \"appoint_code\", label: \"Appoint Code\", readOnly: true },\r\n  { key: \"register_date\", label: \"วันที่ลงทะเบียน\", type: \"date\" },\r\n  { key: \"start_date\", label: \"วันนัด\", type: \"datetime-local\" },\r\n  { key: \"end_date\", label: \"ครบกำหนด\", type: \"datetime-local\" },\r\n  { key: \"prefix\", label: \"คำนำหน้า\" },\r\n  { key: \"name\", label: \"ชื่อ\" },\r\n  { key: \"surname\", label: \"นามสกุล\" },\r\n  { key: \"nickname\", label: \"ชื่อเล่น\" },\r\n  {\r\n    key: \"display_name\",\r\n    label: \"ชื่อที่แสดง\",\r\n    placeholder: \"เช่น ชื่อที่ลูกค้าต้องการให้แสดง\",\r\n  },\r\n  { key: \"mobilephone\", label: \"เบอร์มือถือ\", type: \"tel\" },\r\n  { key: \"email\", label: \"อีเมล\" },\r\n  { key: \"activity\", label: \"กิจกรรม\" },\r\n  { key: \"note\", label: \"หมายเหตุ\", type: \"textarea\", fullWidth: true },\r\n  { key: \"doctor_code\", label: \"รหัสหมอ\" },\r\n  { key: \"doctor_name\", label: \"ชื่อหมอ\" },\r\n  { key: \"dest_code\", label: \"รหัสจุดหมาย\" },\r\n  { key: \"dest_name\", label: \"ชื่อจุดหมาย\" },\r\n  { key: \"organize\", label: \"หน่วยงาน\" },\r\n  { key: \"bind_code\", label: \"รหัส Bind\" },\r\n  { key: \"bind_date\", label: \"วันที่ Bind\", type: \"date\" },\r\n  { key: \"id_all\", label: \"ID ลูกค้า\", readOnly: true },\r\n];\r\n\r\nconst appointmentFieldMetaMap = appointmentFieldMeta.reduce((acc, field) => {\r\n  acc[field.key] = field;\r\n  return acc;\r\n}, {} as Record<string, AppointmentFieldMeta>);\r\n\r\ntype AppointmentHistoryItem = Record<string, unknown> & {\r\n  record_no?: string | number;\r\n  appoint_code?: string;\r\n  start_date?: string | number;\r\n  end_date?: string | number;\r\n  activity?: string;\r\n  note?: string;\r\n  id_all?: string;\r\n};\r\n\r\nconst formatAppointmentDateTimeLabel = (\r\n  value?: string | number | null\r\n) => {\r\n  if (value === undefined || value === null || value === \"\") return \"-\";\r\n\r\n  const normalized = typeof value === \"number\" ? value : String(value);\r\n  const parsed = new Date(normalized);\r\n  if (Number.isNaN(parsed.getTime())) {\r\n    const fallback = typeof normalized === \"string\" ? normalized : String(normalized);\r\n    return fallback.replace(\"T\", \" \").split(\".\")[0];\r\n  }\r\n\r\n  return new Intl.DateTimeFormat(\"th-TH\", {\r\n    dateStyle: \"medium\",\r\n    timeStyle: \"short\",\r\n  }).format(parsed);\r\n};\r\n\r\nconst resolveAppointmentHistoryKey = (\r\n  entry: AppointmentHistoryItem,\r\n  index: number\r\n) => {\r\n  if (entry.appoint_code) {\r\n    return `code-${entry.appoint_code}`;\r\n  }\r\n  if (entry.record_no !== undefined && entry.record_no !== null) {\r\n    return `record-${entry.record_no}`;\r\n  }\r\n  return `history-${index}`;\r\n};\r\n\r\ninterface AppointmentSection {\r\n  title: string;\r\n  fields: string[];\r\n  columns?: string;\r\n}\r\n\r\nconst appointmentSections: AppointmentSection[] = [\r\n  {\r\n    title: \"ข้อมูลการนัดหมาย\",\r\n    fields: [\r\n      \"register_date\",\r\n      \"start_date\",\r\n      \"end_date\",\r\n      \"bind_date\",\r\n    ],\r\n    columns: \"grid-cols-1 md:grid-cols-3\",\r\n  },\r\n  {\r\n    title: \"ข้อมูลผู้รับบริการ\",\r\n    fields: [\r\n      \"prefix\",\r\n      \"name\",\r\n      \"surname\",\r\n      \"nickname\",\r\n      \"display_name\",\r\n      \"mobilephone\",\r\n      \"email\",\r\n      \"id_all\",\r\n    ],\r\n    columns: \"grid-cols-1 md:grid-cols-2\",\r\n  },\r\n  {\r\n    title: \"รายละเอียดเพิ่มเติม\",\r\n    fields: [\r\n      \"activity\",\r\n      \"note\",\r\n      \"doctor_code\",\r\n      \"doctor_name\",\r\n      \"dest_code\",\r\n      \"dest_name\",\r\n      \"organize\",\r\n      \"bind_code\",\r\n    ],\r\n    columns: \"grid-cols-1 md:grid-cols-2\",\r\n  },\r\n];\r\n\r\nconst buildEmptyAppointmentForm = () =>\r\n  appointmentFieldMeta.reduce((acc, field) => {\r\n    acc[field.key] = \"\";\r\n    return acc;\r\n  }, {} as Record<string, string>);\r\n\r\nconst resolveConsentPartKey = (value: string | null | undefined): ConsentPartKey | null => {\r\n  if (!value) return null;\r\n  const normalized = value.toString().trim().toLowerCase();\r\n  if (!normalized) return null;\r\n  if (normalized === \"patient\" || normalized.includes(\"ผู้รับ\")) return \"patient\";\r\n  if (normalized === \"provider\" || normalized.includes(\"ผู้ให้\")) return \"provider\";\r\n  const directMatch = consentPartMeta.find((part) => part.key === normalized);\r\n  return directMatch ? directMatch.key : null;\r\n};\r\n\r\ninterface SignaturePadProps {\r\n  value: string;\r\n  onChange: (value: string) => void;\r\n}\r\n\r\nconst SignaturePad = ({ value, onChange }: SignaturePadProps) => {\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n  const ctxRef = useRef<CanvasRenderingContext2D | null>(null);\r\n  const drawingRef = useRef(false);\r\n  const [isReady, setIsReady] = useState(false);\r\n\r\n  const updateSignature = useCallback(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n    onChange(canvas.toDataURL(\"image/png\"));\r\n  }, [onChange]);\r\n\r\n  const clearCanvas = useCallback(() => {\r\n    const canvas = canvasRef.current;\r\n    const ctx = ctxRef.current;\r\n    if (!canvas || !ctx) return;\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    onChange(\"\");\r\n  }, [onChange]);\r\n\r\n  const drawFromValue = useCallback(() => {\r\n    const ctx = ctxRef.current;\r\n    const canvas = canvasRef.current;\r\n    if (!ctx || !canvas) return;\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    if (!value) return;\r\n    const image = new Image();\r\n    image.crossOrigin = \"anonymous\";\r\n    image.onload = () => {\r\n      ctx.drawImage(image, 0, 0, canvas.width, canvas.height);\r\n    };\r\n    image.src = value;\r\n  }, [value]);\r\n\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n    const ctx = canvas.getContext(\"2d\");\r\n    if (!ctx) return;\r\n    const ratio = Math.max(1, window.devicePixelRatio || 1);\r\n    const clientWidth = canvas.clientWidth || 400;\r\n    const fixedHeight = 150;\r\n    canvas.width = clientWidth * ratio;\r\n    canvas.height = fixedHeight * ratio;\r\n    canvas.style.width = \"100%\";\r\n    canvas.style.height = `${fixedHeight}px`;\r\n    ctx.scale(ratio, ratio);\r\n    ctx.lineCap = \"round\";\r\n    ctx.lineJoin = \"round\";\r\n    ctx.lineWidth = 1.8;\r\n    ctx.strokeStyle = \"#4c1d95\";\r\n    ctxRef.current = ctx;\r\n    setIsReady(true);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!isReady) return;\r\n    drawFromValue();\r\n  }, [drawFromValue, isReady]);\r\n\r\n  const getPointerCoords = (event: PointerEvent<HTMLCanvasElement>) => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return { x: 0, y: 0 };\r\n    const rect = canvas.getBoundingClientRect();\r\n    return {\r\n      x: event.clientX - rect.left,\r\n      y: event.clientY - rect.top,\r\n    };\r\n  };\r\n\r\n  const handlePointerDown = (event: PointerEvent<HTMLCanvasElement>) => {\r\n    event.preventDefault();\r\n    const ctx = ctxRef.current;\r\n    if (!ctx) return;\r\n    const { x, y } = getPointerCoords(event);\r\n    drawingRef.current = true;\r\n    ctx.beginPath();\r\n    ctx.moveTo(x, y);\r\n  };\r\n\r\n  const handlePointerMove = (event: PointerEvent<HTMLCanvasElement>) => {\r\n    if (!drawingRef.current) return;\r\n    const ctx = ctxRef.current;\r\n    if (!ctx) return;\r\n    const { x, y } = getPointerCoords(event);\r\n    ctx.lineTo(x, y);\r\n    ctx.stroke();\r\n  };\r\n\r\n  const stopDrawing = () => {\r\n    if (!drawingRef.current) return;\r\n    drawingRef.current = false;\r\n    updateSignature();\r\n  };\r\n\r\n  return (\r\n    <div className=\"rounded-2xl border border-slate-200 bg-slate-50 p-3\">\r\n      <canvas\r\n        ref={canvasRef}\r\n        className=\"w-full touch-none\"\r\n        onPointerDown={handlePointerDown}\r\n        onPointerMove={handlePointerMove}\r\n        onPointerUp={stopDrawing}\r\n        onPointerLeave={stopDrawing}\r\n      />\r\n      <div className=\"mt-2 flex items-center justify-between\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={clearCanvas}\r\n          className=\"rounded-lg border border-slate-300 px-3 py-1 text-xs font-semibold text-slate-600 transition hover:border-slate-400\"\r\n        >\r\n          ล้างลายเซ็น\r\n        </button>\r\n        <span className=\"text-[11px] text-slate-500\">ลงชื่อด้วยเมาส์หรือสัมผัส</span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\ninterface EditCustomerModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  customerData: CustomerData;\r\n  onSave: (data: CustomerData) => void;\r\n}\r\nexport const EditCustomerModal = ({\r\n  isOpen,\r\n  onClose,\r\n  customerData: initialData,\r\n  onSave,\r\n}: EditCustomerModalProps) => {\r\n  const [customerData, setCustomerData] = useState<CustomerData>({});\r\n  const [activeTab, setActiveTab] = useState<\"contact\" | \"opd\" | \"consent\" | \"service\" | \"appointment\">(\"contact\");\r\n  const [statusOptions, setStatusOptions] = useState<\r\n    Array<{ value: string; label: string; color: string }>\r\n  >([]);\r\n  const [sourceOptions, setSourceOptions] = useState<\r\n    Array<{ value: string; label: string }>\r\n  >([]);\r\n  const [productOptions, setProductOptions] = useState<\r\n    Array<{ value: string; label: string }>\r\n  >([]);\r\n  const [countryOptions, setCountryOptions] = useState<\r\n    Array<{ value: string; label: string }>\r\n  >([]);\r\n  const [contactPersonOptions, setContactPersonOptions] = useState<\r\n    Array<{ value: string; label: string }>\r\n  >([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [showOPDPopup, setShowOPDPopup] = useState(false);\r\n  const [showConsentPopup, setShowConsentPopup] = useState(false);\r\n  const [showServicePopup, setShowServicePopup] = useState(false);\r\n  const [showAppointmentPopup, setShowAppointmentPopup] = useState(false);\r\n  const [appointmentForm, setAppointmentForm] = useState<Record<string, string>>(\r\n    buildEmptyAppointmentForm\r\n  );\r\n  const [appointmentLoading, setAppointmentLoading] = useState(false);\r\n  const [appointmentError, setAppointmentError] = useState<string | null>(null);\r\n  const [appointmentHistory, setAppointmentHistory] = useState<AppointmentHistoryItem[]>(\r\n    []\r\n  );\r\n  const [appointmentHistoryLoading, setAppointmentHistoryLoading] = useState(false);\r\n  const [appointmentHistoryError, setAppointmentHistoryError] = useState<string | null>(null);\r\n  const [selectedAppointmentHistoryKey, setSelectedAppointmentHistoryKey] = useState<string | null>(\r\n    null\r\n  );\r\n  const [editingAppointmentCode, setEditingAppointmentCode] = useState<string | null>(null);\r\n  const appointmentPrefillRef = useRef<Record<string, string>>({});\r\n  const [thaiProvinces, setThaiProvinces] = useState<ThaiProvince[]>([]);\r\n  const [thaiDistricts, setThaiDistricts] = useState<ThaiDistrict[]>([]);\r\n  const [thaiSubdistricts, setThaiSubdistricts] = useState<ThaiSubDistrict[]>([]);\r\n  const [selectedProvinceId, setSelectedProvinceId] = useState<number | null>(null);\r\n  const [selectedDistrictId, setSelectedDistrictId] = useState<number | null>(null);\r\n  const [selectedSubdistrictId, setSelectedSubdistrictId] = useState<number | null>(null);\r\n  const [thaiAddressLoading, setThaiAddressLoading] = useState(false);\r\n  const [thaiAddressError, setThaiAddressError] = useState<string | null>(null);\r\n  const normalizeCustomerValue = (value: unknown) => {\r\n    if (value === undefined || value === null) return \"\";\r\n    const text = typeof value === \"string\" ? value : String(value);\r\n    return text.trim();\r\n  };\r\n  const customerIdentifier = useMemo(() => {\r\n    const priorityKeys = [\"id_all\", \"id\", \"รหัสลูกค้า\", \"customer_code\"];\r\n    for (const key of priorityKeys) {\r\n      if (key in customerData) {\r\n        const normalized = normalizeCustomerValue(customerData[key]);\r\n        if (normalized) return normalized;\r\n      }\r\n    }\r\n    return \"\";\r\n  }, [customerData]);\r\n  const customerIdAll = useMemo(() => {\r\n    const possible = [\"id_all\", \"idAll\", \"id\"];\r\n    for (const key of possible) {\r\n      if (key in customerData) {\r\n        const normalized = normalizeCustomerValue(customerData[key]);\r\n        if (normalized) return normalized;\r\n      }\r\n    }\r\n    return \"\";\r\n  }, [customerData]);\r\n  const customerDisplayName = useMemo(() => {\r\n    const labelKeys = [\"ชื่อ\", \"customer_name\", \"displayName\"];\r\n    for (const key of labelKeys) {\r\n      if (key in customerData) {\r\n        const normalized = normalizeCustomerValue(customerData[key]);\r\n        if (normalized) return normalized;\r\n      }\r\n    }\r\n    return \"\";\r\n  }, [customerData]);\r\n  const customerSaleCode = useMemo(() => {\r\n    const labelKeys = [\"รหัสลูกค้า\", \"customer_code\"];\r\n    for (const key of labelKeys) {\r\n      if (key in customerData) {\r\n        const normalized = normalizeCustomerValue(customerData[key]);\r\n        if (normalized) return normalized;\r\n      }\r\n    }\r\n    return \"\";\r\n  }, [customerData]);\r\n  // OPD Service states\r\n  const [opdGroups, setOpdGroups] = useState<OPDServiceGroup[]>([]);\r\n  const [groupsLoading, setGroupsLoading] = useState(false);\r\n  const [selectedOpdGroupCode, setSelectedOpdGroupCode] = useState<string>(\"\");\r\n  const [groupServiceItems, setGroupServiceItems] = useState<OPDServiceItem[]>([]);\r\n  const [servicesLoading, setServicesLoading] = useState(false);\r\n  const [serviceError, setServiceError] = useState<string | null>(null);\r\n  const [serviceSearchTerm, setServiceSearchTerm] = useState(\"\");\r\n  const [selectedServices, setSelectedServices] = useState<SelectedServiceEntry[]>([]);\r\n  const latestServiceFetchGroupRef = useRef<string | null>(null);\r\n  const [saleItemsHistory, setSaleItemsHistory] = useState<any[]>([]);\r\n  const [saleItemsHistoryLoading, setSaleItemsHistoryLoading] = useState(false);\r\n  const [saleItemsHistoryError, setSaleItemsHistoryError] = useState<string | null>(null);\r\n  const [savingServices, setSavingServices] = useState(false);\r\n  const [showHistoryModal, setShowHistoryModal] = useState(false);\r\n  const [lastReceiptNo, setLastReceiptNo] = useState<string | null>(null);\r\n  const [consentSections, setConsentSections] = useState<Record<ConsentPartKey, ConsentSection>>(\r\n    buildEmptyConsentSections()\r\n  );\r\n  const [selectedConsentPart, setSelectedConsentPart] = useState<ConsentPartKey>(\r\n    consentPartMeta[0].key\r\n  );\r\n  const [consentLoading, setConsentLoading] = useState(false);\r\n  const [consentLoadError, setConsentLoadError] = useState<string | null>(null);\r\n  const [consentSaving, setConsentSaving] = useState(false);\r\n  const [loggedInUser, setLoggedInUser] = useState(\"\");\r\n\r\n  const [notification, setNotification] = useState<{\r\n    isOpen: boolean;\r\n    type: \"success\" | \"error\";\r\n    title: string;\r\n    message: string;\r\n  }>({\r\n    isOpen: false,\r\n    type: \"success\",\r\n    title: \"\",\r\n    message: \"\",\r\n  });\r\n\r\n  const fetchStatusOptions = async () => {\r\n    try {\r\n      const response = await fetch(\"/api/status-options\");\r\n      const result = await response.json();\r\n      if (result.success && result.data) {\r\n        setStatusOptions(result.data);\r\n      } else {\r\n        // Use fallback data when database is not accessible\r\n        setStatusOptions([\r\n          {\r\n            value: \"ติดตามต่อเนื่อง\",\r\n            label: \"ติดตามต่อเนื่อง\",\r\n            color: \"#FFD700\",\r\n          },\r\n          { value: \"ปิดการขาย\", label: \"ปิดการขาย\", color: \"#90EE90\" },\r\n          { value: \"ยกเลิก\", label: \"ยกเลิก\", color: \"#FFB6C1\" },\r\n          { value: \"รอตอบกลับ\", label: \"รอตอบกลับ\", color: \"#87CEEB\" },\r\n          {\r\n            value: \"ได้นัด Consult\",\r\n            label: \"ได้นัด Consult\",\r\n            color: \"#FFA500\",\r\n          },\r\n          { value: \"ได้นัดผ่าตัด\", label: \"ได้นัดผ่าตัด\", color: \"#FF6347\" },\r\n          { value: \"ผ่าตัดแล้ว\", label: \"ผ่าตัดแล้ว\", color: \"#32CD32\" },\r\n        ]);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching status options:\", error);\r\n      // Use fallback data on network error\r\n      setStatusOptions([\r\n        {\r\n          value: \"ติดตามต่อเนื่อง\",\r\n          label: \"ติดตามต่อเนื่อง\",\r\n          color: \"#FFD700\",\r\n        },\r\n        { value: \"ปิดการขาย\", label: \"ปิดการขาย\", color: \"#90EE90\" },\r\n        { value: \"ยกเลิก\", label: \"ยกเลิก\", color: \"#FFB6C1\" },\r\n        { value: \"รอตอบกลับ\", label: \"รอตอบกลับ\", color: \"#87CEEB\" },\r\n        { value: \"ได้นัด Consult\", label: \"ได้นัด Consult\", color: \"#FFA500\" },\r\n        { value: \"ได้นัดผ่าตัด\", label: \"ได้นัดผ่าตัด\", color: \"#FF6347\" },\r\n        { value: \"ผ่าตัดแล้ว\", label: \"ผ่าตัดแล้ว\", color: \"#32CD32\" },\r\n      ]);\r\n    }\r\n  };\r\n\r\n  const fetchSourceOptions = async () => {\r\n    try {\r\n      const response = await fetch(\"/api/source-options\");\r\n      const result = await response.json();\r\n      if (result.success && result.data) {\r\n        setSourceOptions(result.data);\r\n      } else {\r\n        // Use fallback data\r\n        setSourceOptions([\r\n          { value: \"Facebook\", label: \"Facebook\" },\r\n          { value: \"Instagram\", label: \"Instagram\" },\r\n          { value: \"Google Ads\", label: \"Google Ads\" },\r\n          { value: \"Line\", label: \"Line\" },\r\n          { value: \"Walk-in\", label: \"Walk-in\" },\r\n          { value: \"Referral\", label: \"Referral\" },\r\n        ]);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching source options:\", error);\r\n      // Use fallback data\r\n      setSourceOptions([\r\n        { value: \"Facebook\", label: \"Facebook\" },\r\n        { value: \"Instagram\", label: \"Instagram\" },\r\n        { value: \"Google Ads\", label: \"Google Ads\" },\r\n        { value: \"Line\", label: \"Line\" },\r\n        { value: \"Walk-in\", label: \"Walk-in\" },\r\n        { value: \"Referral\", label: \"Referral\" },\r\n      ]);\r\n    }\r\n  };\r\n\r\n  const fetchProductOptions = async () => {\r\n    try {\r\n      const response = await fetch(\"/api/product-options\");\r\n      const result = await response.json();\r\n      if (result.success && result.data) {\r\n        setProductOptions(result.data);\r\n      } else {\r\n        // Use fallback data\r\n        setProductOptions([\r\n          { value: \"ตีตัวไล่ตัว\", label: \"ตีตัวไล่ตัว\" },\r\n          { value: \"Sub brow lift\", label: \"Sub brow lift\" },\r\n          { value: \"แก้ตาหมื่อตอนและแก้ว\", label: \"แก้ตาหมื่อตอนและแก้ว\" },\r\n          { value: \"ตาสองชั้น\", label: \"ตาสองชั้น\" },\r\n          { value: \"เสริมจมูก\", label: \"เสริมจมูก\" },\r\n          { value: \"แก้จมูก\", label: \"แก้จมูก\" },\r\n          { value: \"เสริมตาขาว\", label: \"เสริมตาขาว\" },\r\n          { value: \"ลิฟหน้า\", label: \"ลิฟหน้า\" },\r\n          { value: \"Skin\", label: \"Skin\" },\r\n        ]);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching product options:\", error);\r\n      // Use fallback data\r\n      setProductOptions([\r\n        { value: \"ตีตัวไล่ตัว\", label: \"ตีตัวไล่ตัว\" },\r\n        { value: \"Sub brow lift\", label: \"Sub brow lift\" },\r\n        { value: \"แก้ตาหมื่อตอนและแก้ว\", label: \"แก้ตาหมื่อตอนและแก้ว\" },\r\n        { value: \"ตาสองชั้น\", label: \"ตาสองชั้น\" },\r\n        { value: \"เสริมจมูก\", label: \"เสริมจมูก\" },\r\n        { value: \"แก้จมูก\", label: \"แก้จมูก\" },\r\n        { value: \"เสริมตาขาว\", label: \"เสริมตาขาว\" },\r\n        { value: \"ลิฟหน้า\", label: \"ลิฟหน้า\" },\r\n        { value: \"Skin\", label: \"Skin\" },\r\n      ]);\r\n    }\r\n  };\r\n\r\n  const fetchCountryOptions = async () => {\r\n    try {\r\n      const response = await fetch(\"/api/country-options\");\r\n      const result = await response.json();\r\n      if (result.success && result.data) {\r\n        setCountryOptions(result.data);\r\n      } else {\r\n        // Use fallback data\r\n        setCountryOptions([\r\n          { value: \"ไทย\", label: \"ไทย\" },\r\n          { value: \"จีน\", label: \"จีน\" },\r\n          { value: \"ญี่ปุ่น\", label: \"ญี่ปุ่น\" },\r\n          { value: \"เกาหลี\", label: \"เกาหลี\" },\r\n          { value: \"สิงคโปร์\", label: \"สิงคโปร์\" },\r\n          { value: \"มาเลเซีย\", label: \"มาเลเซีย\" },\r\n          { value: \"อื่นๆ\", label: \"อื่นๆ\" },\r\n        ]);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching country options:\", error);\r\n      // Use fallback data\r\n      setCountryOptions([\r\n        { value: \"ไทย\", label: \"ไทย\" },\r\n        { value: \"จีน\", label: \"จีน\" },\r\n        { value: \"ญี่ปุ่น\", label: \"ญี่ปุ่น\" },\r\n        { value: \"เกาหลี\", label: \"เกาหลี\" },\r\n        { value: \"สิงคโปร์\", label: \"สิงคโปร์\" },\r\n        { value: \"มาเลเซีย\", label: \"มาเลเซีย\" },\r\n        { value: \"อื่นๆ\", label: \"อื่นๆ\" },\r\n      ]);\r\n    }\r\n  };\r\n\r\n  const fetchContactPersonOptions = async () => {\r\n    try {\r\n      const response = await fetch(\"/api/contact-person-options\");\r\n      const result = await response.json();\r\n      if (result.success && result.data) {\r\n        setContactPersonOptions(result.data);\r\n      } else {\r\n        // Use fallback data\r\n        setContactPersonOptions([\r\n          { value: \"ว่าน\", label: \"ว่าน\" },\r\n          { value: \"จีน\", label: \"จีน\" },\r\n          { value: \"สา\", label: \"สา\" },\r\n          { value: \"เจ\", label: \"เจ\" },\r\n          { value: \"พิดยา\", label: \"พิดยา\" },\r\n          { value: \"มุก\", label: \"มุก\" },\r\n        ]);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching contact person options:\", error);\r\n      // Use fallback data\r\n      setContactPersonOptions([\r\n        { value: \"ว่าน\", label: \"ว่าน\" },\r\n        { value: \"จีน\", label: \"จีน\" },\r\n        { value: \"สา\", label: \"สา\" },\r\n        { value: \"เจ\", label: \"เจ\" },\r\n        { value: \"พิดยา\", label: \"พิดยา\" },\r\n        { value: \"มุก\", label: \"มุก\" },\r\n      ]);\r\n    }\r\n  };\r\n\r\n  // Fetch OPD Groups\r\n  const fetchOpdGroups = async () => {\r\n    setGroupsLoading(true);\r\n    try {\r\n      const response = await fetch(\"/api/b-item-groups\");\r\n      const result = await response.json();\r\n      if (!response.ok || result.success === false) {\r\n        throw new Error(result.error || \"ไม่พบกลุ่มขาย OPD\");\r\n      }\r\n      setOpdGroups(Array.isArray(result.data) ? result.data : []);\r\n    } catch (error: any) {\r\n      console.error(\"Error fetching OPD groups:\", error);\r\n    } finally {\r\n      setGroupsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Load services for selected group\r\n  const loadServicesForGroup = async (groupCode: string) => {\r\n    if (!groupCode) {\r\n      setGroupServiceItems([]);\r\n      return;\r\n    }\r\n    latestServiceFetchGroupRef.current = groupCode;\r\n    setServicesLoading(true);\r\n    setServiceError(null);\r\n    setGroupServiceItems([]);\r\n    try {\r\n      const response = await fetch(\r\n        `/api/b-item-services?groupCode=${encodeURIComponent(groupCode)}`\r\n      );\r\n      const result = await response.json();\r\n      if (!response.ok || result.success === false) {\r\n        throw new Error(result.error || \"ไม่พบรายการบริการ\");\r\n      }\r\n      if (latestServiceFetchGroupRef.current !== groupCode) return;\r\n      const normalizedItems = Array.isArray(result.data)\r\n        ? result.data.map((item: OPDServiceItem) => ({\r\n          ...item,\r\n          saleprice: normalizeSalepriceValue(item.saleprice),\r\n        }))\r\n        : [];\r\n      setGroupServiceItems(normalizedItems as OPDServiceItem[]);\r\n    } catch (error: any) {\r\n      if (latestServiceFetchGroupRef.current !== groupCode) return;\r\n      setServiceError(error?.message || \"ไม่สามารถโหลดรายการบริการได้\");\r\n    } finally {\r\n      if (latestServiceFetchGroupRef.current === groupCode) {\r\n        setServicesLoading(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  const fetchSaleItemsHistory = useCallback(async (code: string) => {\r\n    setSaleItemsHistoryLoading(true);\r\n    setSaleItemsHistoryError(null);\r\n    try {\r\n      const response = await fetch(`/api/b-saleitem?code=${encodeURIComponent(code)}`);\r\n      const result = await response.json();\r\n      if (!response.ok || result.success === false) {\r\n        throw new Error(result.error || \"ไม่สามารถโหลดประวัติบริการได้\");\r\n      }\r\n      setSaleItemsHistory(Array.isArray(result.data) ? result.data : []);\r\n    } catch (error: any) {\r\n      setSaleItemsHistory([]);\r\n      setSaleItemsHistoryError(error?.message || \"ไม่สามารถโหลดประวัติบริการได้\");\r\n    } finally {\r\n      setSaleItemsHistoryLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const handleGroupSelect = (groupCode: string) => {\r\n    setSelectedOpdGroupCode(groupCode);\r\n    setServiceSearchTerm(\"\");\r\n    setServiceError(null);\r\n    if (!groupCode) {\r\n      setGroupServiceItems([]);\r\n      return;\r\n    }\r\n    loadServicesForGroup(groupCode);\r\n  };\r\n\r\n  const handleOpenServicePopup = () => {\r\n    setShowServicePopup(true);\r\n    setServiceError(null);\r\n    if (opdGroups.length === 0) {\r\n      fetchOpdGroups();\r\n    }\r\n    if (selectedOpdGroupCode) {\r\n      loadServicesForGroup(selectedOpdGroupCode);\r\n    }\r\n  };\r\n\r\n  const handleCloseServicePopup = () => {\r\n    setShowServicePopup(false);\r\n    setServiceSearchTerm(\"\");\r\n    setServiceError(null);\r\n  };\r\n\r\n  const handleShowHistory = () => {\r\n    if (!customerIdentifier) return;\r\n    fetchSaleItemsHistory(customerIdentifier);\r\n    setShowHistoryModal(true);\r\n  };\r\n\r\n  const handleCloseHistory = () => {\r\n    setShowHistoryModal(false);\r\n  };\r\n\r\n  const fetchConsentForms = useCallback(async () => {\r\n    if (!customerIdAll) return;\r\n    setConsentLoading(true);\r\n    setConsentLoadError(null);\r\n    setConsentSections(buildEmptyConsentSections());\r\n    try {\r\n      const response = await fetch(\r\n        `/api/consent-forms?id_all=${encodeURIComponent(customerIdAll)}`\r\n      );\r\n      const result = await response.json();\r\n      if (!response.ok || result.success === false) {\r\n        throw new Error(result.error || \"ไม่สามารถโหลด Consent form ได้\");\r\n      }\r\n      const nextSections = buildEmptyConsentSections();\r\n      if (Array.isArray(result.data)) {\r\n        result.data.forEach((item: Record<string, any>) => {\r\n          const partKey = resolveConsentPartKey(item.part);\r\n          if (!partKey) return;\r\n          const formatString = (value: unknown) =>\r\n            value === undefined || value === null ? \"\" : String(value);\r\n          nextSections[partKey] = {\r\n            weight: formatString(item.weight_kg ?? item.weight),\r\n            height: formatString(item.height_cm ?? item.height),\r\n            hasChronic: Boolean(\r\n              item.has_chronic_disease ?? item.has_chronic ?? item.hasChronic\r\n            ),\r\n            chronicDiseaseDetail:\r\n              item.chronic_disease_detail || item.chronicDiseaseDetail || \"\",\r\n            hasDrugAllergy: Boolean(\r\n              item.has_drug_allergy ?? item.hasDrugAllergy\r\n            ),\r\n            drugAllergyDetail:\r\n              item.drug_allergy_detail || item.drugAllergyDetail || \"\",\r\n            signatureUrl: item.signature_url || item.signatureUrl || \"\",\r\n            medicalConsent: item.medical_consent || item.medicalConsent || \"\",\r\n            acceptPdpa: item.accept_pdpa || item.acceptPdpa || \"\",\r\n            acceptMedia: item.accept_media || item.acceptMedia || \"\",\r\n          };\r\n        });\r\n      }\r\n      setConsentSections(nextSections);\r\n    } catch (error: any) {\r\n      console.error(\"Error fetching consent data:\", error);\r\n      setConsentLoadError(error?.message || \"ไม่สามารถโหลด Consent form ได้\");\r\n    } finally {\r\n      setConsentLoading(false);\r\n    }\r\n  }, [customerIdentifier]);\r\n\r\n  useEffect(() => {\r\n    if (showServicePopup && customerIdentifier) {\r\n      fetchSaleItemsHistory(customerIdentifier);\r\n    }\r\n  }, [showServicePopup, customerIdentifier, fetchSaleItemsHistory]);\r\n\r\n  useEffect(() => {\r\n    if (!showConsentPopup) return;\r\n    setSelectedConsentPart(consentPartMeta[0].key);\r\n    fetchConsentForms();\r\n  }, [showConsentPopup, fetchConsentForms]);\r\n\r\n  const handleConsentSectionChange = (\r\n    part: ConsentPartKey,\r\n    changes: Partial<ConsentSection>\r\n  ) => {\r\n    setConsentSections((current) => ({\r\n      ...current,\r\n      [part]: {\r\n        ...current[part],\r\n        ...changes,\r\n      },\r\n    }));\r\n  };\r\n\r\n  const handleConsentToggle = (\r\n    part: ConsentPartKey,\r\n    field: \"hasChronic\" | \"hasDrugAllergy\",\r\n    value: boolean\r\n  ) => {\r\n    const updates: Partial<ConsentSection> = { [field]: value } as Partial<ConsentSection>;\r\n    if (field === \"hasChronic\" && !value) {\r\n      updates.chronicDiseaseDetail = \"\";\r\n    }\r\n    if (field === \"hasDrugAllergy\" && !value) {\r\n      updates.drugAllergyDetail = \"\";\r\n    }\r\n    handleConsentSectionChange(part, updates);\r\n  };\r\n\r\n  const handleConsentSignatureChange = (part: ConsentPartKey, signatureUrl: string) => {\r\n    handleConsentSectionChange(part, { signatureUrl });\r\n  };\r\n\r\n  const handleSaveConsentForms = async () => {\r\n    if (!customerIdAll) {\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"error\",\r\n        title: \"ข้อมูลไม่ครบ\",\r\n        message: \"ไม่สามารถบันทึก Consent ได้ เพราะยังไม่รู้จักลูกค้า\",\r\n      });\r\n      return;\r\n    }\r\n    setConsentSaving(true);\r\n    try {\r\n      const payload = {\r\n        code: customerIdAll,\r\n        idAll: customerIdAll,\r\n        createdBy: loggedInUser || null,\r\n        sections: consentPartMeta.map((part) => {\r\n          const entry = consentSections[part.key];\r\n          return {\r\n            part: part.key,\r\n            weight: entry.weight,\r\n            height: entry.height,\r\n            hasChronic: entry.hasChronic,\r\n            chronicDiseaseDetail: entry.chronicDiseaseDetail,\r\n            hasDrugAllergy: entry.hasDrugAllergy,\r\n            drugAllergyDetail: entry.drugAllergyDetail,\r\n            signatureUrl: entry.signatureUrl,\r\n            medicalConsent: entry.medicalConsent || null,\r\n            acceptPdpa: entry.acceptPdpa || null,\r\n            acceptMedia: entry.acceptMedia || null,\r\n          };\r\n        }),\r\n      };\r\n\r\n      const response = await fetch(\"/api/consent-forms\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(payload),\r\n      });\r\n\r\n      let result: { success?: boolean; message?: string; error?: string };\r\n      try {\r\n        result = await response.json();\r\n      } catch (parseError) {\r\n        const fallbackText = await response.text();\r\n        throw new Error(\r\n          fallbackText ||\r\n          (parseError as Error).message ||\r\n          \"ไม่สามารถอ่านผลลัพธ์จากเซิร์ฟเวอร์\"\r\n        );\r\n      }\r\n      if (!response.ok || result.success === false) {\r\n        throw new Error(result.error || \"ไม่สามารถบันทึก Consent ได้\");\r\n      }\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"success\",\r\n        title: \"บันทึก Consent แล้ว\",\r\n        message: result.message || \"Consent form ถูกบันทึกเรียบร้อยแล้ว\",\r\n      });\r\n      await fetchConsentForms();\r\n    } catch (error: any) {\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"error\",\r\n        title: \"บันทึกไม่สำเร็จ\",\r\n        message: error?.message || \"เกิดข้อผิดพลาดในการบันทึก Consent\",\r\n      });\r\n    } finally {\r\n      setConsentSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleSaveSelectedServices = async () => {\r\n    if (!customerIdentifier) {\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"error\",\r\n        title: \"รหัสลูกค้าไม่ครบ\",\r\n        message: \"ไม่สามารถบันทึกบริการได้ เพราะยังไม่มีรหัสดึงข้อมูลลูกค้า\",\r\n      });\r\n      return false;\r\n    }\r\n    if (selectedServices.length === 0) {\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"error\",\r\n        title: \"ยังไม่มีบริการ\",\r\n        message: \"กรุณาเลือกบริการก่อนบันทึกลง b_saleitem\",\r\n      });\r\n      return false;\r\n    }\r\n    setSavingServices(true);\r\n    try {\r\n      const currentReceipt = lastReceiptNo ?? generateReceiptNumber();\r\n      const payload = {\r\n        code: customerIdentifier,\r\n        saleCode: customerSaleCode || null,\r\n        displayName: customerDisplayName || null,\r\n        receiptNo: currentReceipt,\r\n        services: selectedServices.map((entry) => ({\r\n          itemCode: entry.itemcode,\r\n          itemName: entry.itemname,\r\n          unitSale: entry.salesprice,\r\n          netAmount: calculateServiceEntryTotal(entry),\r\n          saleType: entry.saleType || \"20\",\r\n        })),\r\n      };\r\n\r\n      const response = await fetch(\"/api/b-saleitem\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(payload),\r\n      });\r\n\r\n      const result = await response.json();\r\n      if (!response.ok || result.success === false) {\r\n        throw new Error(result.error || \"เกิดข้อผิดพลาดในการบันทึกบริการ\");\r\n      }\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"success\",\r\n        title: \"บันทึกบริการ OPD แล้ว\",\r\n        message:\r\n          result.message ||\r\n          `บันทึก ${result.insertedCount ?? selectedServices.length} รายการลง b_saleitem แล้ว`,\r\n      });\r\n      setLastReceiptNo(currentReceipt);\r\n      if (customerIdentifier) {\r\n        fetchSaleItemsHistory(customerIdentifier);\r\n      }\r\n      return true;\r\n    } catch (error: any) {\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"error\",\r\n        title: \"ไม่สามารถบันทึกบริการได้\",\r\n        message:\r\n          error?.message || \"เกิดข้อผิดพลาดในการเชื่อมต่อกับเซิร์ฟเวอร์ กรุณาลองใหม่\",\r\n      });\r\n      return false;\r\n    } finally {\r\n      setSavingServices(false);\r\n    }\r\n  };\r\n\r\n  const handleCompleteServiceSelection = async () => {\r\n    const saved = await handleSaveSelectedServices();\r\n    if (saved) {\r\n      handleCloseServicePopup();\r\n    }\r\n  };\r\n\r\n  // Service entry update handlers\r\n  const updateSelectedServiceEntry = (\r\n    id: string,\r\n    updater: (entry: SelectedServiceEntry) => SelectedServiceEntry\r\n  ) => {\r\n    setSelectedServices((current) =>\r\n      current.map((entry) => (entry.id === id ? updater(entry) : entry))\r\n    );\r\n  };\r\n\r\n  const handleChargePriceChange = (id: string, value: string) => {\r\n    updateSelectedServiceEntry(id, (entry) => {\r\n      const trimmed = value.trim();\r\n      const numeric = Number(trimmed);\r\n      const hasValue = trimmed.length > 0 && Number.isFinite(numeric);\r\n      const nextPercent =\r\n        hasValue && entry.salesprice > 0\r\n          ? formatDecimalInputValue((numeric / entry.salesprice) * 100)\r\n          : \"\";\r\n      return { ...entry, chargePrice: value, chargePercent: nextPercent };\r\n    });\r\n  };\r\n\r\n  const handleChargePercentChange = (id: string, value: string) => {\r\n    updateSelectedServiceEntry(id, (entry) => {\r\n      const trimmed = value.trim();\r\n      const numeric = Number(trimmed);\r\n      const hasValue = trimmed.length > 0 && Number.isFinite(numeric);\r\n      const nextPrice =\r\n        hasValue && entry.salesprice > 0\r\n          ? formatDecimalInputValue((entry.salesprice * numeric) / 100)\r\n          : \"\";\r\n      return { ...entry, chargePrice: nextPrice, chargePercent: value };\r\n    });\r\n  };\r\n\r\n  const handleDiscountPriceChange = (id: string, value: string) => {\r\n    updateSelectedServiceEntry(id, (entry) => {\r\n      const trimmed = value.trim();\r\n      const numeric = Number(trimmed);\r\n      const hasValue = trimmed.length > 0 && Number.isFinite(numeric);\r\n      const nextPercent =\r\n        hasValue && entry.salesprice > 0\r\n          ? formatDecimalInputValue((numeric / entry.salesprice) * 100)\r\n          : \"\";\r\n      return { ...entry, discountPrice: value, discountPercent: nextPercent };\r\n    });\r\n  };\r\n\r\n  const handleDiscountPercentChange = (id: string, value: string) => {\r\n    updateSelectedServiceEntry(id, (entry) => {\r\n      const trimmed = value.trim();\r\n      const numeric = Number(trimmed);\r\n      const hasValue = trimmed.length > 0 && Number.isFinite(numeric);\r\n      const nextPrice =\r\n        hasValue && entry.salesprice > 0\r\n          ? formatDecimalInputValue((entry.salesprice * numeric) / 100)\r\n          : \"\";\r\n      return { ...entry, discountPrice: nextPrice, discountPercent: value };\r\n    });\r\n  };\r\n\r\n  const handleAddService = (item: OPDServiceItem) => {\r\n    setSelectedServices((current) => {\r\n      if (current.some((entry) => entry.itemcode === item.itemcode)) {\r\n        return current;\r\n      }\r\n      return [\r\n        ...current,\r\n        {\r\n          id: `${item.itemcode}-${Date.now()}`,\r\n          itemcode: item.itemcode,\r\n          itemname: item.itemname,\r\n          salesprice: normalizeSalepriceValue(item.saleprice),\r\n          chargePrice: \"\",\r\n          chargePercent: \"\",\r\n          discountPrice: \"\",\r\n          discountPercent: \"\",\r\n          saleType: \"20\",\r\n        },\r\n      ];\r\n    });\r\n  };\r\n\r\n  const handleRemoveServiceEntry = (id: string) => {\r\n    setSelectedServices((current) => current.filter((entry) => entry.id !== id));\r\n  };\r\n\r\n  // Memoized values for OPD Service\r\n  const selectedOpdGroup = useMemo(\r\n    () => opdGroups.find((group) => group.groupcode === selectedOpdGroupCode) ?? null,\r\n    [opdGroups, selectedOpdGroupCode]\r\n  );\r\n\r\n  const selectedServicesTotals = useMemo(\r\n    () =>\r\n      selectedServices.reduce(\r\n        (acc, entry) => {\r\n          const baseAmount = Number.isFinite(entry.salesprice) ? entry.salesprice : 0;\r\n          const chargeAmount = parseMonetaryInputValue(entry.chargePrice);\r\n          const discountAmount = parseMonetaryInputValue(entry.discountPrice);\r\n          const netAmount = baseAmount + chargeAmount - discountAmount;\r\n          acc.baseTotal += baseAmount;\r\n          acc.chargeTotal += chargeAmount;\r\n          acc.discountTotal += discountAmount;\r\n          acc.netTotal += netAmount;\r\n          return acc;\r\n        },\r\n        { baseTotal: 0, chargeTotal: 0, discountTotal: 0, netTotal: 0 }\r\n      ),\r\n    [selectedServices]\r\n  );\r\n\r\n  const saleHistorySummary = useMemo(\r\n    () =>\r\n      saleItemsHistory.reduce(\r\n        (acc, entry) => {\r\n          const amount = toNumericValue(entry?.amount);\r\n          acc.total += Number.isFinite(amount) ? amount : 0;\r\n          acc.count += 1;\r\n          return acc;\r\n        },\r\n        { count: 0, total: 0 }\r\n      ),\r\n    [saleItemsHistory]\r\n  );\r\n\r\n  const currentConsentSection = consentSections[selectedConsentPart];\r\n\r\n  const filteredServiceItems = useMemo(() => {\r\n    if (!serviceSearchTerm.trim()) return groupServiceItems;\r\n    const lowerTerm = serviceSearchTerm.trim().toLowerCase();\r\n    return groupServiceItems.filter(\r\n      (item) =>\r\n        item.itemname.toLowerCase().includes(lowerTerm) ||\r\n        item.itemcode.toLowerCase().includes(lowerTerm)\r\n    );\r\n  }, [groupServiceItems, serviceSearchTerm]);\r\n\r\n  useEffect(() => {\r\n    console.log(\r\n      \"📋 EditCustomerModal - isOpen:\",\r\n      isOpen,\r\n      \"initialData:\",\r\n      initialData\r\n    );\r\n    if (initialData) {\r\n      setCustomerData({ ...initialData });\r\n    }\r\n    if (isOpen) {\r\n      fetchStatusOptions();\r\n      fetchSourceOptions();\r\n      fetchProductOptions();\r\n      fetchCountryOptions();\r\n      fetchContactPersonOptions();\r\n    }\r\n  }, [initialData, isOpen]);\r\n\r\n  useEffect(() => {\r\n    try {\r\n      const storedUser = localStorage.getItem(\"user\");\r\n      if (storedUser) {\r\n        const parsed = JSON.parse(storedUser);\r\n        const name = parsed?.name || parsed?.username || parsed?.email || \"\";\r\n        setLoggedInUser(name);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Failed to load logged in user info\", error);\r\n    }\r\n  }, []);\r\n  const handleFieldChange = useCallback((fieldName: string, value: any) => {\r\n    setCustomerData((current) => ({\r\n      ...current,\r\n      [fieldName]: value,\r\n    }));\r\n  }, []);\r\n\r\n  const handleAppointmentFieldChange = useCallback((fieldName: string, value: string) => {\r\n    setAppointmentForm((current) => ({\r\n      ...current,\r\n      [fieldName]: value,\r\n    }));\r\n  }, []);\r\n\r\n  const resetAppointmentForm = useCallback(() => {\r\n    const today = new Date().toISOString().split(\"T\")[0];\r\n    setAppointmentForm({\r\n      ...buildEmptyAppointmentForm(),\r\n      ...appointmentPrefillRef.current,\r\n      register_date:\r\n        appointmentPrefillRef.current.register_date || today,\r\n      bind_date: appointmentPrefillRef.current.bind_date || today,\r\n    });\r\n    setEditingAppointmentCode(null);\r\n    setSelectedAppointmentHistoryKey(null);\r\n    setAppointmentError(null);\r\n  }, []);\r\n\r\n  const handleOpenNewAppointment = useCallback(() => {\r\n    resetAppointmentForm();\r\n  }, [resetAppointmentForm]);\r\n\r\n  const fetchAppointmentHistory = useCallback(async () => {\r\n    if (!customerIdAll) {\r\n      setAppointmentHistory([]);\r\n      setAppointmentHistoryError(\"ไม่พบ ID ลูกค้าสำหรับประวัติ\");\r\n      return;\r\n    }\r\n    setAppointmentHistoryLoading(true);\r\n    setAppointmentHistoryError(null);\r\n    try {\r\n      const response = await fetch(\r\n        `/api/appointments?id_all=${encodeURIComponent(customerIdAll)}`\r\n      );\r\n      const result = await response.json();\r\n      if (!response.ok || result.success === false) {\r\n        throw new Error(result.error || \"ไม่สามารถโหลดประวัตินัดหมายได้\");\r\n      }\r\n      setAppointmentHistory(Array.isArray(result.data) ? result.data : []);\r\n    } catch (error: any) {\r\n      setAppointmentHistory([]);\r\n      setAppointmentHistoryError(\r\n        error?.message || \"ไม่สามารถโหลดประวัตินัดหมายได้\"\r\n      );\r\n    } finally {\r\n      setAppointmentHistoryLoading(false);\r\n    }\r\n  }, [customerIdAll]);\r\n\r\n  const handleSelectAppointmentHistory = useCallback(\r\n    (entry: AppointmentHistoryItem, key: string) => {\r\n      const normalized: Record<string, string> = {};\r\n      appointmentFieldMeta.forEach((meta) => {\r\n        const rawValue = entry[meta.key];\r\n        normalized[meta.key] =\r\n          rawValue === undefined || rawValue === null ? \"\" : String(rawValue);\r\n      });\r\n      if (!normalized.id_all) {\r\n        normalized.id_all = customerIdAll;\r\n      }\r\n      setAppointmentForm({\r\n        ...buildEmptyAppointmentForm(),\r\n        ...normalized,\r\n      });\r\n      setEditingAppointmentCode(entry.appoint_code ? String(entry.appoint_code) : null);\r\n      setSelectedAppointmentHistoryKey(key);\r\n      setAppointmentError(null);\r\n    },\r\n    [customerIdAll]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!showOPDPopup) return;\r\n    setThaiAddressError(null);\r\n    if (\r\n      thaiProvinces.length &&\r\n      thaiDistricts.length &&\r\n      thaiSubdistricts.length\r\n    ) {\r\n      return;\r\n    }\r\n    let cancelled = false;\r\n    setThaiAddressLoading(true);\r\n    fetchThaiAdministrativeData()\r\n      .then((data) => {\r\n        if (cancelled) return;\r\n        setThaiProvinces(data.provinces);\r\n        setThaiDistricts(data.districts);\r\n        setThaiSubdistricts(data.subdistricts);\r\n      })\r\n      .catch((error: any) => {\r\n        if (cancelled) return;\r\n        setThaiAddressError(error?.message || \"ไม่สามารถโหลดข้อมูลที่อยู่ได้\");\r\n      })\r\n      .finally(() => {\r\n        if (cancelled) return;\r\n        setThaiAddressLoading(false);\r\n      });\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, [\r\n    showOPDPopup,\r\n    thaiProvinces.length,\r\n    thaiDistricts.length,\r\n    thaiSubdistricts.length,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    const today = new Date().toISOString().split(\"T\")[0];\r\n    appointmentPrefillRef.current = {\r\n      id_all: customerIdAll,\r\n      display_name: customerDisplayName,\r\n      prefix: customerData[\"prefix\"] || \"\",\r\n      name: customerData[\"name\"] || customerData[\"ชื่อ\"] || \"\",\r\n      surname: customerData[\"surname\"] || \"\",\r\n      nickname: customerData[\"nickname\"] || \"\",\r\n      mobilephone: customerData[\"mobilephone\"] || customerData[\"phone\"] || \"\",\r\n      email: customerData[\"email\"] || \"\",\r\n      activity: customerData[\"activity\"] || \"\",\r\n      note: customerData[\"note\"] || \"\",\r\n      register_date:\r\n        appointmentPrefillRef.current.register_date || today,\r\n      bind_date: appointmentPrefillRef.current.bind_date || today,\r\n    };\r\n  }, [customerIdAll, customerDisplayName, customerData]);\r\n\r\n  useEffect(() => {\r\n    if (!showAppointmentPopup) return;\r\n    fetchAppointmentHistory();\r\n    resetAppointmentForm();\r\n  }, [showAppointmentPopup, fetchAppointmentHistory, resetAppointmentForm]);\r\n\r\n  const provinceValue = customerData[\"province\"] || \"\";\r\n  const amphurValue = customerData[\"amphur\"] || \"\";\r\n  const tumbonValue = customerData[\"tumbon\"] || \"\";\r\n\r\n  useEffect(() => {\r\n    if (!thaiProvinces.length) {\r\n      setSelectedProvinceId(null);\r\n      return;\r\n    }\r\n    if (!provinceValue) {\r\n      setSelectedProvinceId(null);\r\n      return;\r\n    }\r\n    const match = thaiProvinces.find((item) =>\r\n      matchesAdministrativeName(item, provinceValue)\r\n    );\r\n    setSelectedProvinceId(match ? match.id : null);\r\n  }, [thaiProvinces, provinceValue]);\r\n\r\n  useEffect(() => {\r\n    if (!thaiDistricts.length) {\r\n      setSelectedDistrictId(null);\r\n      return;\r\n    }\r\n    if (!selectedProvinceId) {\r\n      setSelectedDistrictId(null);\r\n      return;\r\n    }\r\n    if (!amphurValue) {\r\n      setSelectedDistrictId(null);\r\n      return;\r\n    }\r\n    const match = thaiDistricts.find(\r\n      (item) =>\r\n        item.province_id === selectedProvinceId &&\r\n        matchesAdministrativeName(item, amphurValue)\r\n    );\r\n    setSelectedDistrictId(match ? match.id : null);\r\n  }, [thaiDistricts, selectedProvinceId, amphurValue]);\r\n\r\n  useEffect(() => {\r\n    if (!thaiSubdistricts.length) {\r\n      setSelectedSubdistrictId(null);\r\n      return;\r\n    }\r\n    if (!selectedDistrictId) {\r\n      setSelectedSubdistrictId(null);\r\n      return;\r\n    }\r\n    if (!tumbonValue) {\r\n      setSelectedSubdistrictId(null);\r\n      return;\r\n    }\r\n    const match = thaiSubdistricts.find(\r\n      (item) =>\r\n        item.district_id === selectedDistrictId &&\r\n        matchesAdministrativeName(item, tumbonValue)\r\n    );\r\n    setSelectedSubdistrictId(match ? match.id : null);\r\n  }, [thaiSubdistricts, selectedDistrictId, tumbonValue]);\r\n\r\n  useEffect(() => {\r\n    if (showOPDPopup && !customerData[\"country\"]) {\r\n      handleFieldChange(\"country\", \"Thailand\");\r\n    }\r\n  }, [showOPDPopup, customerData[\"country\"], handleFieldChange]);\r\n  const provinceOptions = useMemo(\r\n    () =>\r\n      thaiProvinces.map((province) => ({\r\n        id: province.id,\r\n        label: `${province.name_th} (${province.name_en})`,\r\n      })),\r\n    [thaiProvinces]\r\n  );\r\n  const districtOptions = useMemo(() => {\r\n    if (!selectedProvinceId) return [] as Array<{ id: number; label: string }>;\r\n    return thaiDistricts\r\n      .filter((district) => district.province_id === selectedProvinceId)\r\n      .map((district) => ({\r\n        id: district.id,\r\n        label: `${district.name_th} (${district.name_en})`,\r\n      }));\r\n  }, [thaiDistricts, selectedProvinceId]);\r\n  const subdistrictOptions = useMemo(() => {\r\n    if (!selectedDistrictId) return [] as Array<{ id: number; label: string }>;\r\n    return thaiSubdistricts\r\n      .filter((subdistrict) => subdistrict.district_id === selectedDistrictId)\r\n      .map((subdistrict) => ({\r\n        id: subdistrict.id,\r\n        label: `${subdistrict.name_th} (${subdistrict.name_en})`,\r\n      }));\r\n  }, [thaiSubdistricts, selectedDistrictId]);\r\n\r\n  const handleProvinceSelect = (provinceIdValue: string) => {\r\n    if (!provinceIdValue) {\r\n      setSelectedProvinceId(null);\r\n      setSelectedDistrictId(null);\r\n      setSelectedSubdistrictId(null);\r\n      handleFieldChange(\"province\", \"\");\r\n      handleFieldChange(\"amphur\", \"\");\r\n      handleFieldChange(\"tumbon\", \"\");\r\n      handleFieldChange(\"zipcode\", \"\");\r\n      return;\r\n    }\r\n    const numericId = Number(provinceIdValue);\r\n    if (!Number.isFinite(numericId)) return;\r\n    const province = thaiProvinces.find((item) => item.id === numericId);\r\n    setSelectedProvinceId(numericId);\r\n    setSelectedDistrictId(null);\r\n    setSelectedSubdistrictId(null);\r\n    handleFieldChange(\"province\", province?.name_th || province?.name_en || \"\");\r\n    handleFieldChange(\"amphur\", \"\");\r\n    handleFieldChange(\"tumbon\", \"\");\r\n    handleFieldChange(\"zipcode\", \"\");\r\n  };\r\n\r\n  const handleDistrictSelect = (districtIdValue: string) => {\r\n    if (!districtIdValue) {\r\n      setSelectedDistrictId(null);\r\n      setSelectedSubdistrictId(null);\r\n      handleFieldChange(\"amphur\", \"\");\r\n      handleFieldChange(\"tumbon\", \"\");\r\n      handleFieldChange(\"zipcode\", \"\");\r\n      return;\r\n    }\r\n    const numericId = Number(districtIdValue);\r\n    if (!Number.isFinite(numericId)) return;\r\n    const district = thaiDistricts.find((item) => item.id === numericId);\r\n    setSelectedDistrictId(numericId);\r\n    setSelectedSubdistrictId(null);\r\n    handleFieldChange(\"amphur\", district?.name_th || district?.name_en || \"\");\r\n    handleFieldChange(\"tumbon\", \"\");\r\n    handleFieldChange(\"zipcode\", \"\");\r\n  };\r\n\r\n  const handleSubdistrictSelect = (subdistrictIdValue: string) => {\r\n    if (!subdistrictIdValue) {\r\n      setSelectedSubdistrictId(null);\r\n      handleFieldChange(\"tumbon\", \"\");\r\n      handleFieldChange(\"zipcode\", \"\");\r\n      return;\r\n    }\r\n    const numericId = Number(subdistrictIdValue);\r\n    if (!Number.isFinite(numericId)) return;\r\n    const subdistrict = thaiSubdistricts.find((item) => item.id === numericId);\r\n    setSelectedSubdistrictId(numericId);\r\n    handleFieldChange(\"tumbon\", subdistrict?.name_th || subdistrict?.name_en || \"\");\r\n    handleFieldChange(\r\n      \"zipcode\",\r\n      subdistrict?.zip_code !== null && subdistrict?.zip_code !== undefined\r\n        ? String(subdistrict.zip_code)\r\n        : \"\"\r\n    );\r\n  };\r\n  const handleSave = async (options?: { autoClose?: boolean; onSuccess?: () => void }) => {\r\n    // Prevent duplicate submissions\r\n    if (isLoading) return;\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      const response = await fetch(\"/api/customer-data\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          action: \"update\",\r\n          data: customerData,\r\n        }),\r\n      });\r\n\r\n      const result = await response.json();\r\n\r\n      const shouldClose = options?.autoClose !== false;\r\n      if (result.success) {\r\n        options?.onSuccess?.();\r\n        setNotification({\r\n          isOpen: true,\r\n          type: \"success\",\r\n          title: \"✨ บันทึกสำเร็จ!\",\r\n          message: \"ข้อมูลลูกค้าได้รับการอัปเดตเรียบร้อยแล้ว\",\r\n        });\r\n\r\n        // Wait for notification to display then close\r\n        setTimeout(() => {\r\n          setNotification((prev) => ({ ...prev, isOpen: false }));\r\n          if (shouldClose) {\r\n            setTimeout(() => {\r\n              onSave(customerData);\r\n              onClose();\r\n            }, 300); // Wait for fade out animation\r\n          }\r\n        }, 2000); // Show notification for 2 seconds\r\n      } else {\r\n        setNotification({\r\n          isOpen: true,\r\n          type: \"error\",\r\n          title: \"❌ บันทึกไม่สำเร็จ!\",\r\n          message:\r\n            result.error ||\r\n            \"เกิดข้อผิดพลาดในการบันทึกข้อมูล กรุณาลองใหม่อีกครั้ง\",\r\n        });\r\n        setTimeout(() => {\r\n          setNotification((prev) => ({ ...prev, isOpen: false }));\r\n        }, 3000);\r\n      }\r\n    } catch (error) {\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"error\",\r\n        title: \"❌ บันทึกไม่สำเร็จ!\",\r\n        message:\r\n          \"ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้ กรุณาตรวจสอบการเชื่อมต่ออินเทอร์เน็ต\",\r\n      });\r\n      setTimeout(() => {\r\n        setNotification((prev) => ({ ...prev, isOpen: false }));\r\n      }, 3000);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSaveFromOPD = () => {\r\n    handleFieldChange(\"is_opd\", 1);\r\n    handleSave({\r\n      autoClose: false,\r\n      onSuccess: () => {\r\n        setShowOPDPopup(false);\r\n      },\r\n    });\r\n  };\r\n\r\n  const handleSaveAppointment = async () => {\r\n    if (appointmentLoading) return;\r\n    const sanitizedForm = Object.entries(appointmentForm).reduce(\r\n      (acc, [key, value]) => {\r\n        const normalized = typeof value === \"string\" ? value.trim() : value;\r\n        if (\r\n          normalized !== \"\" &&\r\n          normalized !== null &&\r\n          normalized !== undefined\r\n        ) {\r\n          acc[key] = normalized as string | number;\r\n        }\r\n        return acc;\r\n      },\r\n      {} as Record<string, string | number>\r\n    );\r\n\r\n    delete sanitizedForm.record_no;\r\n    const normalizedIdAll =\r\n      sanitizedForm.id_all || customerIdAll || appointmentPrefillRef.current.id_all;\r\n    if (normalizedIdAll) {\r\n      sanitizedForm.id_all = normalizedIdAll;\r\n    }\r\n\r\n    if (!sanitizedForm.id_all) {\r\n      setAppointmentError(\"ต้องเลือกผู้รับบริการก่อนบันทึกนัดหมาย\");\r\n      return;\r\n    }\r\n\r\n    setAppointmentLoading(true);\r\n    setAppointmentError(null);\r\n    try {\r\n      const isEditing = Boolean(editingAppointmentCode);\r\n      const endpoint = isEditing\r\n        ? `/api/appointments/${encodeURIComponent(editingAppointmentCode!)}`\r\n        : \"/api/appointments\";\r\n      const response = await fetch(endpoint, {\r\n        method: isEditing ? \"PUT\" : \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ data: sanitizedForm }),\r\n      });\r\n      const result = await response.json();\r\n      if (!response.ok || result.success === false) {\r\n        throw new Error(result.error || \"ไม่สามารถบันทึกนัดหมายได้\");\r\n      }\r\n\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"success\",\r\n        title: isEditing ? \"แก้ไขเรียบร้อย\" : \"บันทึกนัดหมายแล้ว\",\r\n        message: isEditing\r\n          ? \"ข้อมูลการนัดหมายได้รับการอัปเดตใน bjh_appointment\"\r\n          : \"ข้อมูลนัดหมายถูกส่งไปยัง bjh_appointment เรียบร้อย\",\r\n      });\r\n      resetAppointmentForm();\r\n      fetchAppointmentHistory();\r\n    } catch (error: any) {\r\n      setAppointmentError(error?.message || \"ไม่สามารถบันทึกนัดหมายได้\");\r\n    } finally {\r\n      setAppointmentLoading(false);\r\n    }\r\n  };\r\n\r\n  console.log(\"🎨 EditCustomerModal render - isOpen:\", isOpen);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  // Format date value for input (YYYY-MM-DD)\r\n  const formatDateForInput = (dateValue: any) => {\r\n    if (!dateValue) return \"\";\r\n    const date = new Date(dateValue);\r\n    if (isNaN(date.getTime())) return \"\";\r\n    return date.toISOString().split(\"T\")[0];\r\n  };\r\n\r\n  // Format time value for input (HH:MM)\r\n  const formatTimeForInput = (timeValue: any) => {\r\n    if (!timeValue) return \"\";\r\n    if (typeof timeValue === \"string\" && timeValue.match(/^\\d{2}:\\d{2}/)) {\r\n      return timeValue.substring(0, 5);\r\n    }\r\n    return timeValue;\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fadeIn\">\r\n      <div className=\"bg-white rounded-2xl shadow-2xl max-h-[90vh] overflow-hidden w-full max-w-4xl animate-slideUp transform transition-all\">\r\n        {/* Header with Gradient */}\r\n        <div className=\"sticky top-0 bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 z-10 shadow-lg\">\r\n          {/* Close button - top right */}\r\n          <div className=\"absolute top-3 right-3\">\r\n            <button\r\n              onClick={onClose}\r\n              className=\"p-2 hover:bg-white hover:bg-opacity-20 rounded-xl transition-all duration-200 group\"\r\n            >\r\n              <X className=\"w-5 h-5 text-white group-hover:rotate-90 transition-transform duration-200\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Centered Tabs */}\r\n          <div className=\"flex justify-center items-center gap-1 sm:gap-2 px-4 py-4\">\r\n            <button\r\n              onClick={() => setActiveTab(\"contact\")}\r\n              className={`flex flex-col sm:flex-row items-center justify-center gap-1 px-3 sm:px-4 py-2 sm:py-2.5 ${activeTab === \"contact\" ? \"bg-white/30 shadow-inner\" : \"bg-white/10 hover:bg-white/20\"\r\n                } text-white rounded-xl transition-all duration-200 min-w-[60px] sm:min-w-[80px]`}\r\n              title=\"Contact Information\"\r\n            >\r\n              <User className=\"w-5 h-5\" />\r\n              <span className=\"text-xs sm:text-sm font-medium hidden sm:block\">Contact</span>\r\n            </button>\r\n            <button\r\n              onClick={() => setActiveTab(\"opd\")}\r\n              className={`flex flex-col sm:flex-row items-center justify-center gap-1 px-3 sm:px-4 py-2 sm:py-2.5 ${activeTab === \"opd\" ? \"bg-white/30 shadow-inner\" : \"bg-white/10 hover:bg-white/20\"\r\n                } text-white rounded-xl transition-all duration-200 min-w-[60px] sm:min-w-[80px]`}\r\n              title=\"OPD\"\r\n            >\r\n              <FileText className=\"w-5 h-5\" />\r\n              <span className=\"text-xs sm:text-sm font-medium hidden sm:block\">OPD</span>\r\n            </button>\r\n            <button\r\n              onClick={() => setActiveTab(\"consent\")}\r\n              className={`flex flex-col sm:flex-row items-center justify-center gap-1 px-3 sm:px-4 py-2 sm:py-2.5 ${activeTab === \"consent\" ? \"bg-white/30 shadow-inner\" : \"bg-white/10 hover:bg-white/20\"\r\n                } text-white rounded-xl transition-all duration-200 min-w-[60px] sm:min-w-[80px]`}\r\n              title=\"Consent\"\r\n            >\r\n              <ClipboardCheck className=\"w-5 h-5\" />\r\n              <span className=\"text-xs sm:text-sm font-medium hidden sm:block\">Consent</span>\r\n            </button>\r\n            <button\r\n              onClick={() => {\r\n                setActiveTab(\"service\");\r\n                handleOpenServicePopup();\r\n              }}\r\n              className={`flex flex-col sm:flex-row items-center justify-center gap-1 px-3 sm:px-4 py-2 sm:py-2.5 ${activeTab === \"service\" ? \"bg-white/30 shadow-inner\" : \"bg-white/10 hover:bg-white/20\"\r\n                } text-white rounded-xl transition-all duration-200 min-w-[60px] sm:min-w-[80px] relative`}\r\n              title=\"บริการ\"\r\n            >\r\n              <Briefcase className=\"w-5 h-5\" />\r\n              <span className=\"text-xs sm:text-sm font-medium hidden sm:block\">บริการ</span>\r\n              {selectedServices.length > 0 && (\r\n                <span className=\"absolute -top-1 -right-1 bg-emerald-400 text-white text-xs w-5 h-5 flex items-center justify-center rounded-full\">\r\n                  {selectedServices.length}\r\n                </span>\r\n              )}\r\n            </button>\r\n            <button\r\n              onClick={() => setActiveTab(\"appointment\")}\r\n              className={`flex flex-col sm:flex-row items-center justify-center gap-1 px-3 sm:px-4 py-2 sm:py-2.5 ${activeTab === \"appointment\" ? \"bg-white/30 shadow-inner\" : \"bg-white/10 hover:bg-white/20\"\r\n                } text-white rounded-xl transition-all duration-200 min-w-[60px] sm:min-w-[80px]`}\r\n              title=\"นัดหมาย\"\r\n            >\r\n              <Calendar className=\"w-5 h-5\" />\r\n              <span className=\"text-xs sm:text-sm font-medium hidden sm:block\">นัดหมาย</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Scrollable Content - Show content based on active tab */}\r\n        <div\r\n          className=\"overflow-y-auto\"\r\n          style={{ maxHeight: \"calc(90vh - 180px)\" }}\r\n        >\r\n          {/* Contact Information Tab Content */}\r\n          {activeTab === \"contact\" && (\r\n            <div className=\"p-6 space-y-6\">\r\n              {/* Section 1: ข้อมูลส่วนตัว */}\r\n              <div className=\"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl p-6 border border-cyan-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-cyan-500 to-blue-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-cyan-600 to-blue-600 bg-clip-text text-transparent\">\r\n                    ข้อมูลส่วนตัว\r\n                  </h2>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n                  {/* status */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">สถานะ</label>\r\n                    <select\r\n                      value={customerData[\"status\"] || customerData[\"สถานะ\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"status\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    >\r\n                      <option value=\"\">เลือกสถานะ</option>\r\n                      {statusOptions.map((option) => (\r\n                        <option key={option.value} value={option.value}>{option.label}</option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                  {/* prefix */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">คำนำหน้า</label>\r\n                    <select\r\n                      value={customerData[\"prefix\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"prefix\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    >\r\n                      <option value=\"\">เลือกคำนำหน้า</option>\r\n                      <option value=\"นาย\">นาย</option>\r\n                      <option value=\"นาง\">นาง</option>\r\n                      <option value=\"นางสาว\">นางสาว</option>\r\n                      <option value=\"Mr.\">Mr.</option>\r\n                      <option value=\"Mrs.\">Mrs.</option>\r\n                      <option value=\"Ms.\">Ms.</option>\r\n                    </select>\r\n                  </div>\r\n                  {/* name */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ชื่อ *</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={customerData[\"name\"] || customerData[\"ชื่อ\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"name\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"กรอกชื่อ\"\r\n                    />\r\n                  </div>\r\n                  {/* surname */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">นามสกุล</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={customerData[\"surname\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"surname\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"กรอกนามสกุล\"\r\n                    />\r\n                  </div>\r\n                  {/* nickname */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ชื่อเล่น</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={customerData[\"nickname\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"nickname\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"กรอกชื่อเล่น\"\r\n                    />\r\n                  </div>\r\n                  {/* gender */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">เพศ</label>\r\n                    <select\r\n                      value={customerData[\"gender\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"gender\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    >\r\n                      <option value=\"\">เลือกเพศ</option>\r\n                      <option value=\"ชาย\">ชาย</option>\r\n                      <option value=\"หญิง\">หญิง</option>\r\n                      <option value=\"อื่นๆ\">อื่นๆ</option>\r\n                    </select>\r\n                  </div>\r\n                  {/* star_flag */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ติดดาว</label>\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => handleFieldChange(\"star_flag\", customerData[\"star_flag\"] === \"ติดดาว\" ? \"\" : \"ติดดาว\")}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl hover:border-cyan-300 transition-all duration-200 flex items-center justify-center gap-2\"\r\n                    >\r\n                      <Star className={`w-6 h-6 ${customerData[\"star_flag\"] === \"ติดดาว\" ? \"fill-yellow-400 text-yellow-400\" : \"text-gray-400\"}`} />\r\n                      <span className=\"text-sm font-medium text-gray-700\">\r\n                        {customerData[\"star_flag\"] === \"ติดดาว\" ? \"ติดดาวแล้ว\" : \"คลิกเพื่อติดดาว\"}\r\n                      </span>\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Section 2: ข้อมูลติดต่อ */}\r\n              <div className=\"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-xl p-6 border border-indigo-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-indigo-500 to-purple-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent\">\r\n                    ข้อมูลติดต่อ\r\n                  </h2>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                  {/* phone */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">เบอร์โทร</label>\r\n                    <input\r\n                      type=\"tel\"\r\n                      value={customerData[\"phone\"] || customerData[\"เบอร์โทร\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"phone\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"กรอกเบอร์โทร\"\r\n                    />\r\n                  </div>\r\n                  {/* email */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">อีเมล</label>\r\n                    <input\r\n                      type=\"email\"\r\n                      value={customerData[\"email\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"email\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"กรอกอีเมล\"\r\n                    />\r\n                  </div>\r\n                  {/* lineid */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ไลน์ไอดี</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={customerData[\"lineid\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"lineid\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"กรอกไลน์ไอดี\"\r\n                    />\r\n                  </div>\r\n                  {/* facebook */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">เฟสบุ๊ค</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={customerData[\"facebook\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"facebook\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"กรอกเฟสบุ๊ค\"\r\n                    />\r\n                  </div>\r\n                  {/* country */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ประเทศ</label>\r\n                    <select\r\n                      value={customerData[\"country\"] || customerData[\"ประเทศ\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"country\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    >\r\n                      <option value=\"\">เลือกประเทศ</option>\r\n                      {countryOptions.map((option) => (\r\n                        <option key={option.value} value={option.value}>{option.label}</option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Section 3: ข้อมูลธุรกิจ */}\r\n              <div className=\"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl p-6 border border-emerald-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-emerald-500 to-teal-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent\">\r\n                    ข้อมูลธุรกิจ\r\n                  </h2>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n                  {/* source */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">แหล่งที่มา</label>\r\n                    <select\r\n                      value={customerData[\"source\"] || customerData[\"  แหล่งที่มา\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"source\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    >\r\n                      <option value=\"\">เลือกแหล่งที่มา</option>\r\n                      {sourceOptions.map((option) => (\r\n                        <option key={option.value} value={option.value}>{option.label}</option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                  {/* interested_product */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ผลิตภัณฑ์ที่สนใจ</label>\r\n                    <select\r\n                      value={customerData[\"interested_product\"] || customerData[\" ผลิตภัณฑ์ที่สนใจ\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"interested_product\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    >\r\n                      <option value=\"\">เลือกผลิตภัณฑ์</option>\r\n                      {productOptions.map((option) => (\r\n                        <option key={option.value} value={option.value}>{option.label}</option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                  {/* contact_staff */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ผู้ติดต่อ</label>\r\n                    <select\r\n                      value={customerData[\"contact_staff\"] || customerData[\"ผู้ติดต่อ\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"contact_staff\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    >\r\n                      <option value=\"\">เลือกผู้ติดต่อ</option>\r\n                      {contactPersonOptions.map((option) => (\r\n                        <option key={option.value} value={option.value}>{option.label}</option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                  {/* proposed_amount */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ยอดนำเสนอ</label>\r\n                    <input\r\n                      type=\"number\"\r\n                      value={customerData[\"proposed_amount\"] || customerData[\"ยอดนำเสนอ\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"proposed_amount\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"กรอกยอดนำเสนอ\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Section 4: วันที่ติดตาม */}\r\n              <div className=\"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl p-6 border border-cyan-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-cyan-500 to-blue-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-cyan-600 to-blue-600 bg-clip-text text-transparent\">\r\n                    วันที่ติดตาม\r\n                  </h2>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                  {/* got_contact_date */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                      <span>📅</span> วันที่ได้ชื่อ เบอร์\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={formatDateForInput(customerData[\"got_contact_date\"] || customerData[\"วันที่ได้ชื่อ เบอร์ \"])}\r\n                      onChange={(e) => handleFieldChange(\"got_contact_date\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    />\r\n                  </div>\r\n                  {/* last_followup */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                      <span>📅</span> วันที่ติดตามครั้งล่าสุด\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={formatDateForInput(customerData[\"last_followup\"] || customerData[\"วันที่ติดตามครั้งล่าสุด\"])}\r\n                      onChange={(e) => handleFieldChange(\"last_followup\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    />\r\n                  </div>\r\n                  {/* next_followup */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                      <span>📅</span> วันที่ติดตามครั้งถัดไป\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={formatDateForInput(customerData[\"next_followup\"] || customerData[\"วันที่ติดตามครั้งถัดไป\"])}\r\n                      onChange={(e) => handleFieldChange(\"next_followup\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Section 5: วันที่ Consult */}\r\n              <div className=\"bg-gradient-to-br from-purple-50 to-violet-50 rounded-xl p-6 border border-purple-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-purple-500 to-violet-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-purple-600 to-violet-600 bg-clip-text text-transparent\">\r\n                    วันที่ Consult\r\n                  </h2>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  {/* booked_consult_date */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                      <span>📅</span> วันที่ได้นัด consult\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={formatDateForInput(customerData[\"booked_consult_date\"] || customerData[\"วันที่ได้นัด consult\"])}\r\n                      onChange={(e) => handleFieldChange(\"booked_consult_date\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-purple-200 bg-white rounded-xl focus:ring-2 focus:ring-purple-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    />\r\n                  </div>\r\n                  {/* consult_date */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                      <span>📅</span> วันที่ Consult\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={formatDateForInput(customerData[\"consult_date\"] || customerData[\"  วันที่ Consult\"])}\r\n                      onChange={(e) => handleFieldChange(\"consult_date\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-purple-200 bg-white rounded-xl focus:ring-2 focus:ring-purple-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Section 6: วันที่ผ่าตัด */}\r\n              <div className=\"bg-gradient-to-br from-rose-50 to-pink-50 rounded-xl p-6 border border-rose-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-rose-500 to-pink-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-rose-600 to-pink-600 bg-clip-text text-transparent\">\r\n                    วันที่ผ่าตัด\r\n                  </h2>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  {/* booked_surgery_date */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                      <span>📅</span> วันที่ได้นัดผ่าตัด\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={formatDateForInput(customerData[\"booked_surgery_date\"] || customerData[\"วันที่ได้นัดผ่าตัด\"])}\r\n                      onChange={(e) => handleFieldChange(\"booked_surgery_date\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-rose-200 bg-white rounded-xl focus:ring-2 focus:ring-rose-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    />\r\n                  </div>\r\n                  {/* surgery_date */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                      <span>📅</span> วันที่ผ่าตัด\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={formatDateForInput(customerData[\"surgery_date\"] || customerData[\"วันที่ผ่าตัด\"])}\r\n                      onChange={(e) => handleFieldChange(\"surgery_date\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-rose-200 bg-white rounded-xl focus:ring-2 focus:ring-rose-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    />\r\n                  </div>\r\n                  {/* appointment_time */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                      <span>⏰</span> เวลาที่นัด\r\n                    </label>\r\n                    <input\r\n                      type=\"time\"\r\n                      value={formatTimeForInput(customerData[\"appointment_time\"] || customerData[\"เวลาที่นัด\"])}\r\n                      onChange={(e) => handleFieldChange(\"appointment_time\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-rose-200 bg-white rounded-xl focus:ring-2 focus:ring-rose-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Section 7: หมายเหตุ */}\r\n              <div className=\"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl p-6 border border-amber-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-amber-500 to-yellow-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-amber-600 to-yellow-600 bg-clip-text text-transparent\">\r\n                    หมายเหตุ\r\n                  </h2>\r\n                </div>\r\n                <textarea\r\n                  value={customerData[\"note\"] || customerData[\"หมายเหตุ\"] || \"\"}\r\n                  onChange={(e) => handleFieldChange(\"note\", e.target.value)}\r\n                  className=\"w-full px-4 py-3 border-2 border-amber-200 bg-white rounded-xl focus:ring-2 focus:ring-amber-400 focus:border-transparent outline-none min-h-[120px] resize-none\"\r\n                  placeholder=\"📝 พิมพ์หมายเหตุ...\"\r\n                />\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* OPD Tab Content */}\r\n          {activeTab === \"opd\" && (\r\n            <div className=\"p-6 space-y-6\">\r\n              <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-blue-500 to-indigo-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent\">\r\n                    ข้อมูล OPD - ที่อยู่\r\n                  </h2>\r\n                </div>\r\n                {thaiAddressLoading && (\r\n                  <p className=\"text-xs text-emerald-600 mb-4\">กำลังโหลดข้อมูลจังหวัด/อำเภอ/ตำบล...</p>\r\n                )}\r\n                {thaiAddressError && (\r\n                  <p className=\"text-xs text-red-600 mb-4\">{thaiAddressError}</p>\r\n                )}\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">บ้านเลขที่</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={customerData[\"locno\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"locno\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-blue-200 bg-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"ระบุบ้านเลขที่\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">จังหวัด</label>\r\n                      <select\r\n                        value={selectedProvinceId ? String(selectedProvinceId) : \"\"}\r\n                        onChange={(e) => handleProvinceSelect(e.target.value)}\r\n                        className=\"w-full px-4 py-3 border-2 border-blue-200 bg-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-transparent outline-none cursor-pointer\"\r\n                      >\r\n                        <option value=\"\">เลือกจังหวัด</option>\r\n                        {provinceOptions.map((option) => (\r\n                          <option key={option.id} value={option.id}>{option.label}</option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">อำเภอ / เขต</label>\r\n                      <select\r\n                        value={selectedDistrictId ? String(selectedDistrictId) : \"\"}\r\n                        onChange={(e) => handleDistrictSelect(e.target.value)}\r\n                        disabled={!districtOptions.length}\r\n                        className=\"w-full px-4 py-3 border-2 border-blue-200 bg-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-transparent outline-none cursor-pointer disabled:bg-gray-100\"\r\n                      >\r\n                        <option value=\"\">เลือกอำเภอ / เขต</option>\r\n                        {districtOptions.map((option) => (\r\n                          <option key={option.id} value={option.id}>{option.label}</option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ตำบล / แขวง</label>\r\n                      <select\r\n                        value={selectedSubdistrictId ? String(selectedSubdistrictId) : \"\"}\r\n                        onChange={(e) => handleSubdistrictSelect(e.target.value)}\r\n                        disabled={!subdistrictOptions.length}\r\n                        className=\"w-full px-4 py-3 border-2 border-blue-200 bg-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-transparent outline-none cursor-pointer disabled:bg-gray-100\"\r\n                      >\r\n                        <option value=\"\">เลือกตำบล / แขวง</option>\r\n                        {subdistrictOptions.map((option) => (\r\n                          <option key={option.id} value={option.id}>{option.label}</option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">รหัสไปรษณีย์</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={customerData[\"zipcode\"] || \"\"}\r\n                        readOnly\r\n                        className=\"w-full px-4 py-3 border-2 border-blue-200 bg-gray-100 rounded-xl outline-none text-gray-700\"\r\n                        placeholder=\"รหัสไปรษณีย์ (อัตโนมัติ)\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Consent Tab Content */}\r\n          {activeTab === \"consent\" && (\r\n            <div className=\"p-6 space-y-6\">\r\n              <div className=\"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl p-6 border border-emerald-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-emerald-500 to-teal-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent\">\r\n                    Consent Form\r\n                  </h2>\r\n                </div>\r\n                {/* Consent Part Tabs */}\r\n                <div className=\"flex gap-2 mb-6\">\r\n                  {consentPartMeta.map((part) => (\r\n                    <button\r\n                      key={part.key}\r\n                      onClick={() => setSelectedConsentPart(part.key)}\r\n                      className={`px-4 py-2 rounded-lg font-medium transition-all ${selectedConsentPart === part.key\r\n                        ? \"bg-emerald-500 text-white shadow-md\"\r\n                        : \"bg-white border border-emerald-200 text-emerald-700 hover:bg-emerald-50\"\r\n                        }`}\r\n                    >\r\n                      {part.label}\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n                {consentLoading ? (\r\n                  <div className=\"flex items-center justify-center py-8\">\r\n                    <Loader2 className=\"w-8 h-8 animate-spin text-emerald-500\" />\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                      <div className=\"group\">\r\n                        <label className=\"block text-sm font-semibold text-gray-700 mb-2\">น้ำหนัก (kg)</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={consentSections[selectedConsentPart]?.weight || \"\"}\r\n                          onChange={(e) => setConsentSections((prev) => ({\r\n                            ...prev,\r\n                            [selectedConsentPart]: { ...prev[selectedConsentPart], weight: e.target.value }\r\n                          }))}\r\n                          className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none\"\r\n                          placeholder=\"ระบุน้ำหนัก\"\r\n                        />\r\n                      </div>\r\n                      <div className=\"group\">\r\n                        <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ส่วนสูง (cm)</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={consentSections[selectedConsentPart]?.height || \"\"}\r\n                          onChange={(e) => setConsentSections((prev) => ({\r\n                            ...prev,\r\n                            [selectedConsentPart]: { ...prev[selectedConsentPart], height: e.target.value }\r\n                          }))}\r\n                          className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none\"\r\n                          placeholder=\"ระบุส่วนสูง\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"group\">\r\n                      <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2\">\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={consentSections[selectedConsentPart]?.hasChronic || false}\r\n                          onChange={(e) => setConsentSections((prev) => ({\r\n                            ...prev,\r\n                            [selectedConsentPart]: { ...prev[selectedConsentPart], hasChronic: e.target.checked }\r\n                          }))}\r\n                          className=\"w-4 h-4 rounded border-gray-300 text-emerald-500 focus:ring-emerald-400\"\r\n                        />\r\n                        มีโรคประจำตัว\r\n                      </label>\r\n                      {consentSections[selectedConsentPart]?.hasChronic && (\r\n                        <input\r\n                          type=\"text\"\r\n                          value={consentSections[selectedConsentPart]?.chronicDiseaseDetail || \"\"}\r\n                          onChange={(e) => setConsentSections((prev) => ({\r\n                            ...prev,\r\n                            [selectedConsentPart]: { ...prev[selectedConsentPart], chronicDiseaseDetail: e.target.value }\r\n                          }))}\r\n                          className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none mt-2\"\r\n                          placeholder=\"ระบุโรคประจำตัว\"\r\n                        />\r\n                      )}\r\n                    </div>\r\n                    <div className=\"group\">\r\n                      <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2\">\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={consentSections[selectedConsentPart]?.hasDrugAllergy || false}\r\n                          onChange={(e) => setConsentSections((prev) => ({\r\n                            ...prev,\r\n                            [selectedConsentPart]: { ...prev[selectedConsentPart], hasDrugAllergy: e.target.checked }\r\n                          }))}\r\n                          className=\"w-4 h-4 rounded border-gray-300 text-emerald-500 focus:ring-emerald-400\"\r\n                        />\r\n                        มีประวัติแพ้ยา\r\n                      </label>\r\n                      {consentSections[selectedConsentPart]?.hasDrugAllergy && (\r\n                        <input\r\n                          type=\"text\"\r\n                          value={consentSections[selectedConsentPart]?.drugAllergyDetail || \"\"}\r\n                          onChange={(e) => setConsentSections((prev) => ({\r\n                            ...prev,\r\n                            [selectedConsentPart]: { ...prev[selectedConsentPart], drugAllergyDetail: e.target.value }\r\n                          }))}\r\n                          className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none mt-2\"\r\n                          placeholder=\"ระบุยาที่แพ้\"\r\n                        />\r\n                      )}\r\n                    </div>\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ยินยอมรับการรักษา</label>\r\n                      <select\r\n                        value={consentSections[selectedConsentPart]?.medicalConsent || \"\"}\r\n                        onChange={(e) => setConsentSections((prev) => ({\r\n                          ...prev,\r\n                          [selectedConsentPart]: { ...prev[selectedConsentPart], medicalConsent: e.target.value }\r\n                        }))}\r\n                        className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                      >\r\n                        <option value=\"\">เลือก</option>\r\n                        {medicalConsentOptions.map((opt) => (\r\n                          <option key={opt} value={opt}>{opt}</option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ยอมรับ PDPA</label>\r\n                      <select\r\n                        value={consentSections[selectedConsentPart]?.acceptPdpa || \"\"}\r\n                        onChange={(e) => setConsentSections((prev) => ({\r\n                          ...prev,\r\n                          [selectedConsentPart]: { ...prev[selectedConsentPart], acceptPdpa: e.target.value }\r\n                        }))}\r\n                        className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                      >\r\n                        <option value=\"\">เลือก</option>\r\n                        {acceptOptions.map((opt) => (\r\n                          <option key={opt} value={opt}>{opt}</option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ยินยอมเผยแพร่สื่อ</label>\r\n                      <select\r\n                        value={consentSections[selectedConsentPart]?.acceptMedia || \"\"}\r\n                        onChange={(e) => setConsentSections((prev) => ({\r\n                          ...prev,\r\n                          [selectedConsentPart]: { ...prev[selectedConsentPart], acceptMedia: e.target.value }\r\n                        }))}\r\n                        className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                      >\r\n                        <option value=\"\">เลือก</option>\r\n                        {acceptOptions.map((opt) => (\r\n                          <option key={opt} value={opt}>{opt}</option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n                    {/* Signature Pad */}\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ลายเซ็น</label>\r\n                      <SignaturePad\r\n                        value={consentSections[selectedConsentPart]?.signatureUrl || \"\"}\r\n                        onChange={(url) => setConsentSections((prev) => ({\r\n                          ...prev,\r\n                          [selectedConsentPart]: { ...prev[selectedConsentPart], signatureUrl: url }\r\n                        }))}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Service Tab Content */}\r\n          {activeTab === \"service\" && (\r\n            <div className=\"p-6 space-y-6\">\r\n              <div className=\"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-purple-500 to-pink-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent\">\r\n                    บริการ\r\n                  </h2>\r\n                </div>\r\n                {/* Service Group Selection */}\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">กลุ่มบริการ</label>\r\n                    <select\r\n                      value={selectedOpdGroupCode}\r\n                      onChange={(e) => setSelectedOpdGroupCode(e.target.value)}\r\n                      disabled={groupsLoading}\r\n                      className=\"w-full px-4 py-3 border-2 border-purple-200 bg-white rounded-xl focus:ring-2 focus:ring-purple-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    >\r\n                      <option value=\"\">เลือกกลุ่มบริการ</option>\r\n                      {opdGroups.map((group) => (\r\n                        <option key={group.groupcode} value={group.groupcode}>{group.groupname}</option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                  {/* Service Search */}\r\n                  {selectedOpdGroupCode && (\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ค้นหาบริการ</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={serviceSearchTerm}\r\n                        onChange={(e) => setServiceSearchTerm(e.target.value)}\r\n                        className=\"w-full px-4 py-3 border-2 border-purple-200 bg-white rounded-xl focus:ring-2 focus:ring-purple-400 focus:border-transparent outline-none\"\r\n                        placeholder=\"พิมพ์ชื่อบริการ...\"\r\n                      />\r\n                    </div>\r\n                  )}\r\n                  {/* Selected Services Summary */}\r\n                  {selectedServices.length > 0 && (\r\n                    <div className=\"bg-purple-100 rounded-xl p-4\">\r\n                      <h3 className=\"font-semibold text-purple-800 mb-2\">บริการที่เลือก ({selectedServices.length})</h3>\r\n                      <div className=\"space-y-2\">\r\n                        {selectedServices.map((svc) => (\r\n                          <div key={svc.id} className=\"flex justify-between items-center bg-white rounded-lg p-2\">\r\n                            <span className=\"text-sm text-gray-700\">{svc.itemname}</span>\r\n                            <span className=\"text-sm font-semibold text-purple-600\">\r\n                              {formatCurrencyDisplay(calculateServiceEntryTotal(svc))} ฿\r\n                            </span>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Appointment Tab Content */}\r\n          {activeTab === \"appointment\" && (\r\n            <div className=\"p-6 space-y-6\">\r\n              <div className=\"bg-gradient-to-br from-orange-50 to-amber-50 rounded-xl p-6 border border-orange-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-orange-500 to-amber-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-orange-600 to-amber-600 bg-clip-text text-transparent\">\r\n                    นัดหมาย\r\n                  </h2>\r\n                </div>\r\n                {appointmentLoading ? (\r\n                  <div className=\"flex items-center justify-center py-8\">\r\n                    <Loader2 className=\"w-8 h-8 animate-spin text-orange-500\" />\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"space-y-4\">\r\n                    {appointmentSections.map((section, idx) => (\r\n                      <div key={idx} className=\"space-y-4\">\r\n                        <h3 className=\"font-semibold text-gray-800\">{section.title}</h3>\r\n                        <div className={`grid ${section.columns || \"grid-cols-1 md:grid-cols-2\"} gap-4`}>\r\n                          {section.fields.map((fieldKey) => {\r\n                            const fieldMeta = appointmentFieldMetaMap[fieldKey];\r\n                            if (!fieldMeta) return null;\r\n                            return (\r\n                              <div key={fieldKey} className={fieldMeta.fullWidth ? \"col-span-full\" : \"\"}>\r\n                                <label className=\"block text-sm font-semibold text-gray-700 mb-2\">{fieldMeta.label}</label>\r\n                                {fieldMeta.type === \"textarea\" ? (\r\n                                  <textarea\r\n                                    value={appointmentForm[fieldKey] || \"\"}\r\n                                    onChange={(e) => setAppointmentForm((prev) => ({ ...prev, [fieldKey]: e.target.value }))}\r\n                                    readOnly={fieldMeta.readOnly}\r\n                                    className=\"w-full px-4 py-3 border-2 border-orange-200 bg-white rounded-xl focus:ring-2 focus:ring-orange-400 focus:border-transparent outline-none min-h-[100px] resize-none\"\r\n                                    placeholder={fieldMeta.placeholder}\r\n                                  />\r\n                                ) : (\r\n                                  <input\r\n                                    type={fieldMeta.type || \"text\"}\r\n                                    value={appointmentForm[fieldKey] || \"\"}\r\n                                    onChange={(e) => setAppointmentForm((prev) => ({ ...prev, [fieldKey]: e.target.value }))}\r\n                                    readOnly={fieldMeta.readOnly}\r\n                                    className={`w-full px-4 py-3 border-2 border-orange-200 ${fieldMeta.readOnly ? \"bg-gray-100\" : \"bg-white\"} rounded-xl focus:ring-2 focus:ring-orange-400 focus:border-transparent outline-none`}\r\n                                    placeholder={fieldMeta.placeholder}\r\n                                  />\r\n                                )}\r\n                              </div>\r\n                            );\r\n                          })}\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                    {/* Appointment History */}\r\n                    {appointmentHistory.length > 0 && (\r\n                      <div className=\"mt-6\">\r\n                        <h3 className=\"font-semibold text-gray-800 mb-4\">ประวัตินัดหมาย</h3>\r\n                        <div className=\"space-y-2\">\r\n                          {appointmentHistory.map((item, idx) => (\r\n                            <div\r\n                              key={resolveAppointmentHistoryKey(item, idx)}\r\n                              className=\"bg-white border border-orange-200 rounded-lg p-3 hover:shadow-md transition-shadow cursor-pointer\"\r\n                              onClick={() => {\r\n                                const key = resolveAppointmentHistoryKey(item, idx);\r\n                                setSelectedAppointmentHistoryKey(selectedAppointmentHistoryKey === key ? null : key);\r\n                              }}\r\n                            >\r\n                              <div className=\"flex justify-between items-center\">\r\n                                <span className=\"text-sm font-medium text-gray-700\">{item.activity || \"ไม่ระบุกิจกรรม\"}</span>\r\n                                <span className=\"text-xs text-gray-500\">{formatAppointmentDateTimeLabel(item.start_date)}</span>\r\n                              </div>\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Footer with Gradient */}\r\n        <div className=\"sticky bottom-0 bg-gradient-to-t from-gray-50 to-white border-t border-gray-200 p-4 sm:p-5 flex justify-center gap-4 shadow-lg\">\r\n          <button\r\n            onClick={onClose}\r\n            disabled={isLoading}\r\n            className=\"px-6 sm:px-8 py-2.5 sm:py-3 border-2 border-gray-300 rounded-xl text-gray-700 text-sm sm:text-base font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          >\r\n            ยกเลิก\r\n          </button>\r\n          <button\r\n            onClick={() => handleSave()}\r\n            disabled={isLoading}\r\n            className=\"flex items-center gap-2 px-6 sm:px-8 py-2.5 sm:py-3 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white text-sm sm:text-base font-semibold rounded-xl transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed shadow-lg hover:shadow-xl\"\r\n          >\r\n            {isLoading ? (\r\n              <>\r\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                กำลังบันทึก...\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Save className=\"w-4 h-4\" />\r\n                บันทึก\r\n              </>\r\n            )}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Notification Popup */}\r\n      <NotificationPopup\r\n        isOpen={notification.isOpen}\r\n        onClose={() => setNotification({ ...notification, isOpen: false })}\r\n        type={notification.type}\r\n        title={notification.title}\r\n        message={notification.message}\r\n      />\r\n\r\n      {/* OPD Popup Modal */}\r\n      {showOPDPopup && (\r\n        <div className=\"fixed inset-0 z-[60] flex items-center justify-center p-4\">\r\n          <div\r\n            className=\"absolute inset-0 bg-black/50\"\r\n            onClick={() => setShowOPDPopup(false)}\r\n          />\r\n          <div className=\"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[80vh] overflow-hidden animate-slideUp\">\r\n            <div className=\"bg-gradient-to-r from-blue-500 to-blue-600 px-6 py-4 flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <FileText className=\"w-6 h-6 text-white\" />\r\n                <h2 className=\"text-lg font-semibold text-white\">เปิด OPD</h2>\r\n              </div>\r\n              <button\r\n                onClick={() => setShowOPDPopup(false)}\r\n                className=\"p-2 hover:bg-white/20 rounded-full transition-colors\"\r\n              >\r\n                <X className=\"w-5 h-5 text-white\" />\r\n              </button>\r\n            </div>\r\n            <div className=\"p-6 overflow-y-auto max-h-[calc(80vh-80px)] space-y-6\">\r\n              <div className=\"space-y-2 text-sm text-slate-600\">\r\n                <p className=\"text-base font-semibold text-slate-800\">ข้อมูล OPD</p>\r\n                <p className=\"text-slate-500\">เลือกตำแหน่งที่ตั้งเพื่อบันทึกลง bjh_master_customers พร้อม LocNo และ Zipcode อัตโนมัติ</p>\r\n                {thaiAddressLoading && (\r\n                  <p className=\"text-xs text-emerald-600\">กำลังโหลดข้อมูลจังหวัด/อำเภอ/ตำบล...</p>\r\n                )}\r\n                {thaiAddressError && (\r\n                  <p className=\"text-xs text-red-600\">{thaiAddressError}</p>\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"space-y-4\">\r\n                <div className=\"group\">\r\n                  <label className=\"block text-sm font-semibold text-gray-700 mb-2\">บ้านเลขที่</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={customerData[\"locno\"] || \"\"}\r\n                    onChange={(event) => handleFieldChange(\"locno\", event.target.value)}\r\n                    className=\"w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white text-gray-900 placeholder:text-slate-400 focus:border-cyan-400 focus:ring-2 focus:ring-cyan-400 outline-none transition\"\r\n                    placeholder=\"ระบุบ้านเลขที่\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">จังหวัด</label>\r\n                    <select\r\n                      value={selectedProvinceId ? String(selectedProvinceId) : \"\"}\r\n                      onChange={(event) => handleProvinceSelect(event.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white text-gray-900 transition focus:ring-2 focus:ring-cyan-400 focus:border-transparent\"\r\n                    >\r\n                      <option value=\"\">เลือกจังหวัด</option>\r\n                      {provinceOptions.map((option) => (\r\n                        <option key={option.id} value={option.id}>\r\n                          {option.label}\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">อำเภอ / เขต</label>\r\n                    <select\r\n                      value={selectedDistrictId ? String(selectedDistrictId) : \"\"}\r\n                      onChange={(event) => handleDistrictSelect(event.target.value)}\r\n                      disabled={!districtOptions.length}\r\n                      className=\"w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white text-gray-900 transition focus:ring-2 focus:ring-cyan-400 focus:border-transparent disabled:cursor-not-allowed disabled:bg-slate-50\"\r\n                    >\r\n                      <option value=\"\">เลือกอำเภอ / เขต</option>\r\n                      {districtOptions.map((option) => (\r\n                        <option key={option.id} value={option.id}>\r\n                          {option.label}\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"group\">\r\n                  <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ตำบล / แขวง</label>\r\n                  <select\r\n                    value={selectedSubdistrictId ? String(selectedSubdistrictId) : \"\"}\r\n                    onChange={(event) => handleSubdistrictSelect(event.target.value)}\r\n                    disabled={!subdistrictOptions.length}\r\n                    className=\"w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white text-gray-900 transition focus:ring-2 focus:ring-cyan-400 focus:border-transparent disabled:cursor-not-allowed disabled:bg-slate-50\"\r\n                  >\r\n                    <option value=\"\">เลือกตำบล / แขวง</option>\r\n                    {subdistrictOptions.map((option) => (\r\n                      <option key={option.id} value={option.id}>\r\n                        {option.label}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Zipcode</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={customerData[\"zipcode\"] || \"\"}\r\n                      readOnly\r\n                      className=\"w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-slate-100 text-gray-700\"\r\n                      placeholder=\"จะถูกกรอกอัตโนมัติ\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Country</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={customerData[\"country\"] || \"Thailand\"}\r\n                      readOnly\r\n                      className=\"w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-slate-100 text-gray-700\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex justify-end gap-3\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowOPDPopup(false)}\r\n                  className=\"px-4 py-2 border border-slate-300 rounded-xl text-slate-700 font-semibold hover:border-slate-400 transition\"\r\n                >\r\n                  ปิด\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleSaveFromOPD}\r\n                  disabled={isLoading}\r\n                  className=\"px-4 py-2 bg-gradient-to-r from-emerald-500 to-cyan-600 text-white font-semibold rounded-xl shadow-lg hover:from-emerald-600 hover:to-cyan-700 disabled:opacity-60\"\r\n                >\r\n                  {isLoading ? \"กำลังบันทึก...\" : \"บันทึก OPD\"}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Consent Popup Modal */}\r\n      {showConsentPopup && (\r\n        <div className=\"fixed inset-0 z-[60] flex items-center justify-center p-4\">\r\n          <div\r\n            className=\"absolute inset-0 bg-black/50\"\r\n            onClick={() => setShowConsentPopup(false)}\r\n          />\r\n          <div className=\"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[80vh] overflow-hidden animate-slideUp\">\r\n            <div className=\"bg-gradient-to-r from-purple-500 to-purple-600 px-6 py-4 flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <ClipboardCheck className=\"w-6 h-6 text-white\" />\r\n                <h2 className=\"text-lg font-semibold text-white\">Consent</h2>\r\n              </div>\r\n              <button\r\n                onClick={() => setShowConsentPopup(false)}\r\n                className=\"p-2 hover:bg-white/20 rounded-full transition-colors\"\r\n              >\r\n                <X className=\"w-5 h-5 text-white\" />\r\n              </button>\r\n            </div>\r\n            <div className=\"p-6 overflow-y-auto max-h-[calc(80vh-80px)] space-y-5\">\r\n              <div className=\"flex flex-wrap items-center justify-between gap-3\">\r\n                <div className=\"space-y-1 text-center md:text-left\">\r\n                  <p className=\"text-lg font-semibold text-slate-800\">ข้อมูล Consent</p>\r\n                  <p className=\"text-sm text-slate-500\">\r\n                    บันทึกน้ำหนัก, ส่วนสูง และประวัติสุขภาพเพื่อนำไปใช้ใน Consent Form\r\n                  </p>\r\n                </div>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleSaveConsentForms}\r\n                  disabled={consentSaving || consentLoading}\r\n                  className=\"rounded-xl bg-gradient-to-r from-purple-600 to-indigo-600 px-5 py-2 text-sm font-semibold text-white shadow-lg transition hover:from-purple-700 hover:to-indigo-700 disabled:opacity-60\"\r\n                >\r\n                  {consentSaving ? \"กำลังบันทึก\" : \"บันทึก Consent\"}\r\n                </button>\r\n              </div>\r\n              <div className=\"space-y-1\">\r\n                {consentLoadError && (\r\n                  <p className=\"text-xs text-red-600\">{consentLoadError}</p>\r\n                )}\r\n                {consentLoading && (\r\n                  <p className=\"text-xs text-slate-500\">กำลังโหลดข้อมูล Consent...</p>\r\n                )}\r\n              </div>\r\n              <div className=\"flex flex-wrap gap-2\">\r\n                {consentPartMeta.map((part) => (\r\n                  <button\r\n                    key={part.key}\r\n                    type=\"button\"\r\n                    onClick={() => setSelectedConsentPart(part.key)}\r\n                    className={`rounded-2xl px-4 py-2 text-xs font-semibold transition border shadow-sm ${selectedConsentPart === part.key\r\n                      ? \"bg-purple-600 text-white border-transparent\"\r\n                      : \"bg-white text-slate-600 border-slate-200 hover:border-slate-300\"\r\n                      }`}\r\n                  >\r\n                    {part.label}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n              <div className=\"grid gap-4 md:grid-cols-2\">\r\n                <label className=\"flex flex-col text-xs font-semibold uppercase tracking-wider text-slate-500\">\r\n                  น้ำหนัก (กก.)\r\n                  <input\r\n                    type=\"number\"\r\n                    value={currentConsentSection.weight}\r\n                    onChange={(e) =>\r\n                      handleConsentSectionChange(selectedConsentPart, { weight: e.target.value })\r\n                    }\r\n                    className=\"mt-1 rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-100\"\r\n                    placeholder=\"เช่น 60\"\r\n                  />\r\n                </label>\r\n                <label className=\"flex flex-col text-xs font-semibold uppercase tracking-wider text-slate-500\">\r\n                  ส่วนสูง (ซม.)\r\n                  <input\r\n                    type=\"number\"\r\n                    value={currentConsentSection.height}\r\n                    onChange={(e) =>\r\n                      handleConsentSectionChange(selectedConsentPart, { height: e.target.value })\r\n                    }\r\n                    className=\"mt-1 rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-100\"\r\n                    placeholder=\"เช่น 170\"\r\n                  />\r\n                </label>\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <p className=\"text-[11px] font-semibold uppercase tracking-wider text-slate-500\">\r\n                  มีโรคประจำตัวหรือไม่\r\n                </p>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {[{ label: \"ไม่มี\", value: false }, { label: \"มี\", value: true }].map((option) => (\r\n                    <button\r\n                      key={`chronic-${option.value}`}\r\n                      type=\"button\"\r\n                      onClick={() =>\r\n                        handleConsentToggle(selectedConsentPart, \"hasChronic\", option.value)\r\n                      }\r\n                      className={`rounded-2xl px-3 py-1.5 text-xs font-semibold transition border ${currentConsentSection.hasChronic === option.value\r\n                        ? \"bg-indigo-600 text-white border-transparent\"\r\n                        : \"bg-white text-slate-600 border-slate-200 hover:border-slate-300\"\r\n                        }`}\r\n                    >\r\n                      {option.label}\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n                {currentConsentSection.hasChronic && (\r\n                  <textarea\r\n                    value={currentConsentSection.chronicDiseaseDetail}\r\n                    onChange={(e) =>\r\n                      handleConsentSectionChange(selectedConsentPart, {\r\n                        chronicDiseaseDetail: e.target.value,\r\n                      })\r\n                    }\r\n                    className=\"w-full rounded-2xl border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-100\"\r\n                    placeholder=\"โปรดระบุชื่อโรค / การรักษาที่กำลังรับอยู่\"\r\n                    rows={3}\r\n                  />\r\n                )}\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <p className=\"text-[11px] font-semibold uppercase tracking-wider text-slate-500\">\r\n                  มีประวัติแพ้ยาหรือไม่\r\n                </p>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {[{ label: \"ไม่มี\", value: false }, { label: \"มี\", value: true }].map((option) => (\r\n                    <button\r\n                      key={`drug-${option.value}`}\r\n                      type=\"button\"\r\n                      onClick={() =>\r\n                        handleConsentToggle(selectedConsentPart, \"hasDrugAllergy\", option.value)\r\n                      }\r\n                      className={`rounded-2xl px-3 py-1.5 text-xs font-semibold transition border ${currentConsentSection.hasDrugAllergy === option.value\r\n                        ? \"bg-indigo-600 text-white border-transparent\"\r\n                        : \"bg-white text-slate-600 border-slate-200 hover:border-slate-300\"\r\n                        }`}\r\n                    >\r\n                      {option.label}\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n                {currentConsentSection.hasDrugAllergy && (\r\n                  <textarea\r\n                    value={currentConsentSection.drugAllergyDetail}\r\n                    onChange={(e) =>\r\n                      handleConsentSectionChange(selectedConsentPart, {\r\n                        drugAllergyDetail: e.target.value,\r\n                      })\r\n                    }\r\n                    className=\"w-full rounded-2xl border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-100\"\r\n                    placeholder=\"ระบุชื่อยา / อาการแพ้\"\r\n                    rows={3}\r\n                  />\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"space-y-3\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <p className=\"text-[11px] font-semibold uppercase tracking-wider text-slate-500\">\r\n                    ลายเซ็น ({\r\n                      consentPartMeta.find((part) => part.key === selectedConsentPart)?.label\r\n                    })\r\n                  </p>\r\n                </div>\r\n                <div className=\"space-y-3 rounded-2xl border border-slate-200 bg-white/90 p-3\">\r\n                  <div className=\"flex items-center justify-between gap-2\">\r\n                    <div>\r\n                      <p className=\"text-xs font-semibold uppercase tracking-wider text-slate-500\">\r\n                        medical_consent\r\n                      </p>\r\n                      <p className=\"text-sm font-medium text-slate-800\">\r\n                        เพียงเลือก \"ยินยอม\" หรือ \"ไม่ยินยอม\" ก่อนบันทึกลายเซ็น\r\n                      </p>\r\n                    </div>\r\n                    <span className=\"text-[11px] text-slate-400\">\r\n                      สถานะ: {currentConsentSection.medicalConsent || \"ยังไม่เลือก\"}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex flex-wrap gap-2\">\r\n                    {medicalConsentOptions.map((option) => (\r\n                      <button\r\n                        key={option}\r\n                        type=\"button\"\r\n                        onClick={() => handleConsentSectionChange(selectedConsentPart, { medicalConsent: option })}\r\n                        className={`px-4 py-1.5 rounded-2xl text-xs font-semibold transition-colors border shadow-sm ${currentConsentSection.medicalConsent === option\r\n                          ? \"bg-purple-600 text-white border-transparent\"\r\n                          : \"bg-white text-purple-700 border-purple-200 hover:border-purple-400\"\r\n                          }`}\r\n                      >\r\n                        {option}\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                  <div className=\"max-h-36 overflow-y-auto text-xs leading-relaxed text-slate-600 space-y-1\">\r\n                    {medicalConsentAcknowledgementText.map((line, index) => (\r\n                      <p key={`${line}-${index}`} className={index === 0 ? \"font-semibold text-slate-900\" : \"\"}>\r\n                        {line}\r\n                      </p>\r\n                    ))}\r\n                    <p className=\"text-[10px] text-slate-400\">\r\n                      เลื่อนอ่านก่อนตัดสินใจ แล้วลงลายเซ็นด้านล่าง\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"space-y-3 rounded-2xl border border-slate-200 bg-white/90 p-3\">\r\n                  <div className=\"flex items-center justify-between gap-2\">\r\n                    <div>\r\n                      <p className=\"text-xs font-semibold uppercase tracking-wider text-slate-500\">\r\n                        accept_pdpa\r\n                      </p>\r\n                      <p className=\"text-sm font-medium text-slate-800\">\r\n                        PDPA – ยินยอมให้ข้อมูลส่วนบุคคลถูกใช้ตามนโยบาย\r\n                      </p>\r\n                    </div>\r\n                    <span className=\"text-[11px] text-slate-400\">\r\n                      สถานะ: {currentConsentSection.acceptPdpa || \"ยังไม่เลือก\"}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex flex-wrap gap-2\">\r\n                    {acceptOptions.map((option) => (\r\n                      <button\r\n                        key={`pdpa-${option}`}\r\n                        type=\"button\"\r\n                        onClick={() => handleConsentSectionChange(selectedConsentPart, { acceptPdpa: option })}\r\n                        className={`px-4 py-1.5 rounded-2xl text-xs font-semibold transition-colors border shadow-sm ${currentConsentSection.acceptPdpa === option\r\n                          ? \"bg-purple-600 text-white border-transparent\"\r\n                          : \"bg-white text-purple-700 border-purple-200 hover:border-purple-400\"\r\n                          }`}\r\n                      >\r\n                        {option}\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                  <div className=\"max-h-36 overflow-y-auto text-xs leading-relaxed text-slate-600 space-y-1\">\r\n                    {pdpaTextBlock.map((line, index) => (\r\n                      <p key={`${line}-${index}`} className={index === 0 ? \"font-semibold text-slate-900\" : \"\"}>\r\n                        {line}\r\n                      </p>\r\n                    ))}\r\n                    <p className=\"text-[10px] text-slate-400\">เลื่อนอ่านก่อนตัดสินใจ</p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"space-y-3 rounded-2xl border border-slate-200 bg-white/90 p-3\">\r\n                  <div className=\"flex items-center justify-between gap-2\">\r\n                    <div>\r\n                      <p className=\"text-xs font-semibold uppercase tracking-wider text-slate-500\">\r\n                        accept_media\r\n                      </p>\r\n                      <p className=\"text-sm font-medium text-slate-800\">\r\n                        ยินยอมรับข่าวสารหรือการใช้ภาพสำหรับงานประชาสัมพันธ์\r\n                      </p>\r\n                    </div>\r\n                    <span className=\"text-[11px] text-slate-400\">\r\n                      สถานะ: {currentConsentSection.acceptMedia || \"ยังไม่เลือก\"}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex flex-wrap gap-2\">\r\n                    {acceptOptions.map((option) => (\r\n                      <button\r\n                        key={`media-${option}`}\r\n                        type=\"button\"\r\n                        onClick={() => handleConsentSectionChange(selectedConsentPart, { acceptMedia: option })}\r\n                        className={`px-4 py-1.5 rounded-2xl text-xs font-semibold transition-colors border shadow-sm ${currentConsentSection.acceptMedia === option\r\n                          ? \"bg-purple-600 text-white border-transparent\"\r\n                          : \"bg-white text-purple-700 border-purple-200 hover:border-purple-400\"\r\n                          }`}\r\n                      >\r\n                        {option}\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                  <div className=\"max-h-36 overflow-y-auto text-xs leading-relaxed text-slate-600 space-y-1\">\r\n                    {mediaTextBlock.map((line, index) => (\r\n                      <p key={`${line}-${index}`} className={index === 0 ? \"font-semibold text-slate-900\" : \"\"}>\r\n                        {line}\r\n                      </p>\r\n                    ))}\r\n                    <p className=\"text-[10px] text-slate-400\">เลื่อนอ่านก่อนตัดสินใจ</p>\r\n                  </div>\r\n                </div>\r\n                <p className=\"text-xs text-slate-500\">\r\n                  ข้อมูลน้ำหนัก ส่วนสูง และประวัติสุขภาพที่ระบุด้านบนจะถูกแนบใน Consent Form พร้อมสัญญาและลายเซ็น\r\n                </p>\r\n                <SignaturePad\r\n                  value={currentConsentSection.signatureUrl}\r\n                  onChange={(value) => handleConsentSignatureChange(selectedConsentPart, value)}\r\n                />\r\n                {currentConsentSection.signatureUrl && (\r\n                  <div className=\"space-y-1 rounded-2xl border border-slate-200 p-3\">\r\n                    <p className=\"text-[10px] uppercase tracking-wider text-slate-400\">\r\n                      ตัวอย่างลายเซ็นที่บันทึกไว้\r\n                    </p>\r\n                    <img\r\n                      src={currentConsentSection.signatureUrl}\r\n                      alt=\"Signature preview\"\r\n                      className=\"h-16 w-full rounded-lg border border-slate-100 object-contain\"\r\n                    />\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <div className=\"flex justify-between border-t px-6 py-4\">\r\n              <div>\r\n                <p className=\"text-xs text-slate-500\">\r\n                  บันทึก Consent จะถูกเก็บแยกตามส่วน (part) ที่เลือก\r\n                </p>\r\n              </div>\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleSaveConsentForms}\r\n                disabled={consentSaving || consentLoading}\r\n                className=\"rounded-xl bg-gradient-to-r from-purple-600 to-indigo-600 px-6 py-2 text-sm font-semibold text-white shadow-lg transition hover:from-purple-700 hover:to-indigo-700 disabled:opacity-60\"\r\n              >\r\n                {consentSaving ? \"กำลังบันทึก Consent...\" : \"บันทึก Consent\"}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Service Popup Modal - OPD Service */}\r\n      {showServicePopup && (\r\n        <div className=\"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm\">\r\n          <div\r\n            className=\"relative w-full max-w-6xl overflow-hidden rounded-3xl bg-white shadow-2xl\"\r\n            onClick={(e) => e.stopPropagation()}\r\n          >\r\n            {/* Header */}\r\n            <div className=\"flex items-center justify-between bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 px-8 py-5 text-white\">\r\n              <div>\r\n                <h2 className=\"text-2xl font-bold\">บริการ OPD</h2>\r\n                <p className=\"mt-1 text-sm text-white/80\">\r\n                  เลือกบริการและกำหนด Charge / Discount\r\n                </p>\r\n              </div>\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleCloseServicePopup}\r\n                className=\"rounded-full bg-white/20 p-2 transition hover:bg-white/30\"\r\n              >\r\n                <X className=\"w-6 h-6\" />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Group selector */}\r\n            <div className=\"border-b bg-gray-50 px-8 py-4\">\r\n              <div className=\"flex flex-wrap items-center gap-4\">\r\n                <label className=\"text-sm font-semibold text-gray-700\">กลุ่มบริการ:</label>\r\n                <select\r\n                  className=\"rounded-xl border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-800 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\r\n                  value={selectedOpdGroupCode}\r\n                  onChange={(e) => handleGroupSelect(e.target.value)}\r\n                >\r\n                  <option value=\"\">เลือกกลุ่มบริการ</option>\r\n                  {opdGroups.map((group) => (\r\n                    <option key={group.groupcode} value={group.groupcode}>\r\n                      {group.groupname}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n                {groupsLoading && (\r\n                  <span className=\"text-sm text-gray-500\">กำลังโหลดกลุ่มบริการ...</span>\r\n                )}\r\n                {selectedServices.length > 0 && (\r\n                  <span className=\"rounded-full bg-emerald-100 px-3 py-1 text-sm font-semibold text-emerald-700\">\r\n                    เลือกแล้ว {selectedServices.length} รายการ\r\n                  </span>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <div className=\"border-b bg-white/80 px-8 py-3 text-sm text-gray-600\">\r\n              {saleItemsHistoryLoading ? (\r\n                <span>กำลังโหลดประวัติ b_saleitem...</span>\r\n              ) : saleItemsHistoryError ? (\r\n                <span className=\"text-red-600\">{saleItemsHistoryError}</span>\r\n              ) : saleHistorySummary.count === 0 ? (\r\n                <span>ยังไม่มีรายการบันทึกใน b_saleitem</span>\r\n              ) : (\r\n                <div className=\"flex flex-wrap items-center gap-2\">\r\n                  <span>\r\n                    บันทึกแล้ว {saleHistorySummary.count} รายการ · ยอดรวม {formatCurrencyDisplay(\r\n                      saleHistorySummary.total\r\n                    )}\r\n                  </span>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={handleShowHistory}\r\n                    className=\"rounded-full border border-slate-200 bg-white px-3 py-1 text-[11px] font-semibold text-slate-600 transition hover:border-slate-300\"\r\n                  >\r\n                    ดูประวัติทั้งหมด\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Two-column content */}\r\n            <div className=\"grid max-h-[65vh] grid-cols-1 gap-0 md:grid-cols-2\">\r\n              {/* Left: Selected services */}\r\n              <div className=\"flex flex-col border-r border-gray-200 bg-gradient-to-br from-blue-50 to-indigo-50 max-h-[65vh]\">\r\n                <div className=\"border-b bg-white/80 px-6 py-4\">\r\n                  <h3 className=\"text-lg font-bold text-gray-800\">📝 บริการที่เลือก</h3>\r\n                  <p className=\"text-xs text-gray-500\">\r\n                    {selectedServices.length} รายการ\r\n                    {selectedOpdGroup && ` · ${selectedOpdGroup.groupname}`}\r\n                  </p>\r\n                </div>\r\n                <div className=\"flex-1 overflow-y-auto p-4\">\r\n                  {selectedServices.length === 0 ? (\r\n                    <div className=\"flex h-full flex-col items-center justify-center text-center\">\r\n                      <div className=\"mb-3 text-5xl\">📂</div>\r\n                      <p className=\"text-sm text-gray-500\">ยังไม่มีบริการที่เลือก</p>\r\n                      <p className=\"text-xs text-gray-400\">เลือกจากรายการทางขวามือ</p>\r\n                    </div>\r\n                  ) : (\r\n                    <>\r\n                      <div className=\"space-y-3\">\r\n                        {selectedServices.map((entry) => (\r\n                          <div\r\n                            key={entry.id}\r\n                            className=\"rounded-2xl border border-white bg-white p-4 shadow-md transition hover:shadow-lg\"\r\n                          >\r\n                            <div className=\"flex items-start justify-between\">\r\n                              <div className=\"flex-1\">\r\n                                <p className=\"font-semibold text-gray-800\">{entry.itemname}</p>\r\n                                <p className=\"text-xs text-gray-500\">\r\n                                  รหัส {entry.itemcode} · ราคา {formatCurrencyDisplay(entry.salesprice)}\r\n                                </p>\r\n                              </div>\r\n                              <button\r\n                                type=\"button\"\r\n                                onClick={() => handleRemoveServiceEntry(entry.id)}\r\n                                className=\"ml-2 rounded-full bg-red-100 p-1.5 text-red-600 transition hover:bg-red-200\"\r\n                              >\r\n                                <X className=\"w-4 h-4\" />\r\n                              </button>\r\n                            </div>\r\n\r\n                            <div className=\"mt-3 grid grid-cols-2 gap-3\">\r\n                              <div className=\"rounded-xl bg-emerald-50 p-3\">\r\n                                <p className=\"mb-1 text-xs font-semibold uppercase tracking-wide text-emerald-700\">\r\n                                  Charge\r\n                                </p>\r\n                                <div className=\"flex gap-2\">\r\n                                  <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"บาท\"\r\n                                    value={entry.chargePrice}\r\n                                    onChange={(e) => handleChargePriceChange(entry.id, e.target.value)}\r\n                                    className=\"w-full rounded-lg border border-emerald-200 bg-white px-2 py-1.5 text-sm focus:border-emerald-400 focus:outline-none\"\r\n                                  />\r\n                                  <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"%\"\r\n                                    value={entry.chargePercent}\r\n                                    onChange={(e) => handleChargePercentChange(entry.id, e.target.value)}\r\n                                    className=\"w-16 rounded-lg border border-emerald-200 bg-white px-2 py-1.5 text-center text-sm focus:border-emerald-400 focus:outline-none\"\r\n                                  />\r\n                                </div>\r\n                              </div>\r\n                              <div className=\"rounded-xl bg-rose-50 p-3\">\r\n                                <p className=\"mb-1 text-xs font-semibold uppercase tracking-wide text-rose-700\">\r\n                                  Discount\r\n                                </p>\r\n                                <div className=\"flex gap-2\">\r\n                                  <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"บาท\"\r\n                                    value={entry.discountPrice}\r\n                                    onChange={(e) => handleDiscountPriceChange(entry.id, e.target.value)}\r\n                                    className=\"w-full rounded-lg border border-rose-200 bg-white px-2 py-1.5 text-sm focus:border-rose-400 focus:outline-none\"\r\n                                  />\r\n                                  <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"%\"\r\n                                    value={entry.discountPercent}\r\n                                    onChange={(e) => handleDiscountPercentChange(entry.id, e.target.value)}\r\n                                    className=\"w-16 rounded-lg border border-rose-200 bg-white px-2 py-1.5 text-center text-sm focus:border-rose-400 focus:outline-none\"\r\n                                  />\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                            <div className=\"mt-3 flex items-center justify-between rounded-2xl border border-indigo-100 bg-indigo-50/40 px-3 py-2 text-sm font-semibold text-indigo-600\">\r\n                              <span>ยอดสุทธิ</span>\r\n                              <span>{formatCurrencyDisplay(calculateServiceEntryTotal(entry))}</span>\r\n                            </div>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                      <div className=\"mt-4 rounded-2xl border border-dashed border-indigo-200 bg-white/80 px-4 py-3 text-sm text-gray-600 shadow-inner\">\r\n                        <div className=\"flex items-center justify-between text-xs font-semibold uppercase tracking-wide text-gray-500\">\r\n                          <span>สรุปยอด</span>\r\n                          <span>{selectedServices.length} รายการ</span>\r\n                        </div>\r\n                        <div className=\"mt-2 space-y-1\">\r\n                          <div className=\"flex justify-between\">\r\n                            <span>รวมราคาพื้นฐาน</span>\r\n                            <span className=\"font-semibold text-gray-700\">\r\n                              {formatCurrencyDisplay(selectedServicesTotals.baseTotal)}\r\n                            </span>\r\n                          </div>\r\n                          <div className=\"flex justify-between\">\r\n                            <span>รวมค่า Charge</span>\r\n                            <span className=\"font-semibold text-gray-700\">\r\n                              {formatCurrencyDisplay(selectedServicesTotals.chargeTotal)}\r\n                            </span>\r\n                          </div>\r\n                          <div className=\"flex justify-between\">\r\n                            <span>รวมส่วนลด</span>\r\n                            <span className=\"font-semibold text-gray-700\">\r\n                              {formatCurrencyDisplay(selectedServicesTotals.discountTotal)}\r\n                            </span>\r\n                          </div>\r\n                          <div className=\"flex justify-between text-base font-semibold text-indigo-600\">\r\n                            <span>ยอดสุทธิทั้งหมด</span>\r\n                            <span>{formatCurrencyDisplay(selectedServicesTotals.netTotal)}</span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Right: Available services */}\r\n              <div className=\"flex flex-col bg-white max-h-[65vh]\">\r\n                <div className=\"border-b px-6 py-4\">\r\n                  <h3 className=\"text-lg font-bold text-gray-800\">📜 รายการบริการ</h3>\r\n                  {selectedOpdGroup && (\r\n                    <p className=\"text-xs text-gray-500\">{selectedOpdGroup.groupname}</p>\r\n                  )}\r\n                </div>\r\n                <div className=\"px-6 py-3\">\r\n                  <div className=\"relative\">\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"🔍 ค้นหาบริการ...\"\r\n                      value={serviceSearchTerm}\r\n                      onChange={(e) => setServiceSearchTerm(e.target.value)}\r\n                      className=\"w-full rounded-xl border border-gray-200 bg-gray-50 px-4 py-2.5 text-sm focus:border-indigo-400 focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-100\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex-1 overflow-y-auto px-6 pb-4\">\r\n                  {servicesLoading && (\r\n                    <div className=\"flex items-center justify-center py-8\">\r\n                      <div className=\"h-8 w-8 animate-spin rounded-full border-4 border-indigo-200 border-t-indigo-600\"></div>\r\n                    </div>\r\n                  )}\r\n                  {serviceError && (\r\n                    <p className=\"py-4 text-center text-sm text-red-600\">{serviceError}</p>\r\n                  )}\r\n                  {!servicesLoading && !serviceError && filteredServiceItems.length === 0 && (\r\n                    <div className=\"flex flex-col items-center justify-center py-8 text-center\">\r\n                      <div className=\"mb-2 text-4xl\">💭</div>\r\n                      <p className=\"text-sm text-gray-500\">\r\n                        {selectedOpdGroupCode ? \"ไม่พบรายการบริการ\" : \"เลือกกลุ่มบริการก่อน\"}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                  <div className=\"space-y-2\">\r\n                    {filteredServiceItems.map((item) => {\r\n                      const alreadyAdded = selectedServices.some(\r\n                        (entry) => entry.itemcode === item.itemcode\r\n                      );\r\n                      return (\r\n                        <div\r\n                          key={item.itemcode}\r\n                          className={`flex items-center justify-between rounded-xl border px-4 py-3 transition ${alreadyAdded\r\n                            ? \"border-emerald-200 bg-emerald-50\"\r\n                            : \"border-gray-100 bg-gray-50 hover:border-indigo-200 hover:bg-indigo-50\"\r\n                            }`}\r\n                        >\r\n                          <div>\r\n                            <p className=\"font-medium text-gray-800\">{item.itemname}</p>\r\n                            <p className=\"text-xs text-gray-500\">\r\n                              ราคา {formatCurrencyDisplay(item.saleprice)}\r\n                            </p>\r\n                          </div>\r\n                          <button\r\n                            type=\"button\"\r\n                            onClick={() => handleAddService(item)}\r\n                            disabled={alreadyAdded}\r\n                            className={`rounded-full px-4 py-1.5 text-xs font-semibold transition ${alreadyAdded\r\n                              ? \"bg-emerald-200 text-emerald-700\"\r\n                              : \"bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow hover:shadow-md\"\r\n                              }`}\r\n                          >\r\n                            {alreadyAdded ? \"✓ เลือกแล้ว\" : \"เพิ่ม\"}\r\n                          </button>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n\r\n\r\n            {/* Footer */}\r\n            <div className=\"flex items-center justify-between border-t bg-gray-50 px-8 py-4\">\r\n              <p className=\"text-sm text-gray-600\">\r\n                เลือกแล้ว <span className=\"font-bold text-indigo-600\">{selectedServices.length}</span> รายการ\r\n                <span className=\"mx-2 hidden text-xs text-gray-400 md:inline\">·</span>\r\n                <span className=\"mr-1\">ยอดสุทธิ</span>\r\n                <span className=\"font-bold text-indigo-600\">\r\n                  {formatCurrencyDisplay(selectedServicesTotals.netTotal)}\r\n                </span>\r\n              </p>\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleCompleteServiceSelection}\r\n                disabled={savingServices || selectedServices.length === 0}\r\n                className=\"rounded-xl bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-2.5 font-semibold text-white shadow-lg transition hover:from-indigo-700 hover:to-purple-700 disabled:opacity-60 disabled:cursor-not-allowed\"\r\n              >\r\n                {savingServices ? \"กำลังบันทึกบริการ...\" : \"เสร็จสิ้น\"}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Sale History Modal */}\r\n      {showHistoryModal && (\r\n        <div className=\"fixed inset-0 z-[65] flex items-center justify-center p-4\">\r\n          <div\r\n            className=\"absolute inset-0 bg-slate-900/60\"\r\n            onClick={handleCloseHistory}\r\n          />\r\n          <div className=\"relative z-10 w-full max-w-2xl rounded-2xl bg-white p-6 shadow-2xl\">\r\n            <div className=\"flex items-center justify-between border-b pb-4\">\r\n              <div>\r\n                <p className=\"text-lg font-semibold text-slate-800\">ประวัติ b_saleitem</p>\r\n                <p className=\"text-xs text-slate-500\">แสดงรายการรวมที่เก็บไว้สำหรับลูกค้านี้</p>\r\n              </div>\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleCloseHistory}\r\n                className=\"rounded-full p-2 text-slate-600 transition hover:bg-slate-100\"\r\n              >\r\n                <X className=\"h-4 w-4\" />\r\n              </button>\r\n            </div>\r\n            <div className=\"mt-4 space-y-3 max-h-[55vh] overflow-y-auto\">\r\n              {saleItemsHistory.length === 0 ? (\r\n                <p className=\"text-sm text-slate-500\">ยังไม่มีประวัติการบันทึกในหน้าต่างนี้</p>\r\n              ) : (\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"grid grid-cols-[120px_120px_1fr_96px] items-center gap-2 text-[11px] font-semibold uppercase text-slate-500\">\r\n                    <span>วันที่</span>\r\n                    <span>เลขที่ใบเสร็จ</span>\r\n                    <span>รายการ</span>\r\n                    <span className=\"text-right\">ยอดสุทธิ</span>\r\n                  </div>\r\n                  <div className=\"space-y-1\">\r\n                    {saleItemsHistory.map((historyItem, index) => (\r\n                      <div\r\n                        key={`${historyItem.sale_date}-${historyItem.receipt_no}-${index}`}\r\n                        className=\"grid grid-cols-[120px_120px_1fr_96px] items-center gap-2 rounded-xl border border-slate-100 bg-slate-50 px-3 py-2 text-sm text-slate-700\"\r\n                      >\r\n                        <span className=\"text-[13px] font-medium text-slate-600\">\r\n                          {historyItem.sale_date || \"-\"}\r\n                        </span>\r\n                        <span className=\"text-[13px] font-medium text-slate-600\">\r\n                          {historyItem.receipt_no || \"-\"}\r\n                        </span>\r\n                        <span className=\"truncate\" title={historyItem.item_name}>\r\n                          {historyItem.item_name || \"-\"}\r\n                        </span>\r\n                        <span className=\"text-right font-semibold text-slate-800\">\r\n                          {formatCurrencyDisplay(toNumericValue(historyItem.amount))}\r\n                        </span>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div className=\"mt-5 flex justify-end\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleCloseHistory}\r\n                className=\"rounded-xl border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-600 transition hover:bg-slate-50\"\r\n              >\r\n                ปิด\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Appointment Popup Modal */}\r\n      {showAppointmentPopup && (\r\n        <div className=\"fixed inset-0 z-[60] flex items-center justify-center p-4\">\r\n          <div\r\n            className=\"absolute inset-0 bg-black/50\"\r\n            onClick={() => setShowAppointmentPopup(false)}\r\n          />\r\n          <div className=\"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[80vh] overflow-hidden animate-slideUp\">\r\n            <div className=\"bg-gradient-to-r from-teal-500 to-teal-600 px-6 py-4 flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <Calendar className=\"w-6 h-6 text-white\" />\r\n                <h2 className=\"text-lg font-semibold text-white\">นัดหมาย</h2>\r\n              </div>\r\n              <button\r\n                onClick={() => setShowAppointmentPopup(false)}\r\n                className=\"p-2 hover:bg-white/20 rounded-full transition-colors\"\r\n              >\r\n                <X className=\"w-5 h-5 text-white\" />\r\n              </button>\r\n            </div>\r\n            <div className=\"p-6 overflow-y-auto max-h-[calc(80vh-80px)] space-y-6\">\r\n              <div className=\"space-y-2 text-sm text-slate-600\">\r\n                <p className=\"text-base font-semibold text-slate-800\">ตารางนัดหมาย</p>\r\n                <p className=\"text-slate-500\">\r\n                  กรอกข้อมูลเพื่อสร้างเรกคอร์ดในตาราง `bjh_appointment` พร้อมผูกกับลูกค้ารายนี้\r\n                </p>\r\n              </div>\r\n\r\n              <div className=\"space-y-3 rounded-2xl border border-slate-200 bg-slate-50 p-4\">\r\n                <div className=\"flex items-start justify-between gap-3\">\r\n                  <div>\r\n                    <p className=\"text-sm font-semibold text-slate-800\">\r\n                      ประวัตินัดหมาย ({appointmentHistory.length})\r\n                    </p>\r\n                    <p className=\"text-[11px] text-slate-500\">\r\n                      แสดงรายการล่าสุดจาก `id_all` เดียวกัน\r\n                    </p>\r\n                  </div>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={handleOpenNewAppointment}\r\n                    className=\"rounded-full border border-slate-300 px-3 py-1 text-xs font-semibold text-slate-600 hover:border-slate-400\"\r\n                  >\r\n                    เพิ่มนัดหมายใหม่\r\n                  </button>\r\n                </div>\r\n                {appointmentHistoryLoading ? (\r\n                  <p className=\"text-xs text-slate-500\">กำลังโหลดประวัตินัดหมาย...</p>\r\n                ) : appointmentHistoryError ? (\r\n                  <p className=\"text-xs text-rose-600\">{appointmentHistoryError}</p>\r\n                ) : appointmentHistory.length === 0 ? (\r\n                  <p className=\"text-xs text-slate-500\">ยังไม่มีบันทึกนัดหมายในระบบ</p>\r\n                ) : (\r\n                  <div className=\"space-y-2\">\r\n                    {appointmentHistory.map((entry, index) => {\r\n                      const cardKey = resolveAppointmentHistoryKey(entry, index);\r\n                      const start = formatAppointmentDateTimeLabel(entry.start_date);\r\n                      const end = formatAppointmentDateTimeLabel(entry.end_date);\r\n                      const recordLabel = entry.record_no\r\n                        ? `Record No. ${entry.record_no}`\r\n                        : entry.appoint_code || \"ไม่ระบุรหัส\";\r\n                      const activity = entry.activity ? String(entry.activity) : null;\r\n                      const note = entry.note ? String(entry.note) : null;\r\n                      return (\r\n                        <div\r\n                          key={cardKey}\r\n                          className={`rounded-2xl border bg-white px-3 py-3 shadow-sm transition ${selectedAppointmentHistoryKey === cardKey\r\n                            ? \"border-teal-300 ring-1 ring-teal-200\"\r\n                            : \"border-slate-200\"\r\n                            }`}\r\n                        >\r\n                          <div className=\"flex items-start justify-between gap-3\">\r\n                            <div className=\"space-y-1\">\r\n                              <p className=\"text-sm font-semibold text-slate-800\">{recordLabel}</p>\r\n                              <p className=\"text-[11px] text-slate-500\">\r\n                                วันนัด {start} · ครบกำหนด {end}\r\n                              </p>\r\n                              {activity && (\r\n                                <p className=\"text-[11px] text-slate-500\">\r\n                                  กิจกรรม: {activity}\r\n                                </p>\r\n                              )}\r\n                              {note && (\r\n                                <p className=\"text-[11px] text-slate-500\">\r\n                                  หมายเหตุ: {note}\r\n                                </p>\r\n                              )}\r\n                            </div>\r\n                            <div className=\"flex flex-col gap-2\">\r\n                              <button\r\n                                type=\"button\"\r\n                                disabled={!entry.appoint_code}\r\n                                title={!entry.appoint_code ? \"รหัสนัดหมายไม่พร้อม\" : \"แก้ไขนัดหมายนี้\"}\r\n                                onClick={() => handleSelectAppointmentHistory(entry, cardKey)}\r\n                                className={`rounded-full px-3 py-1 text-xs font-semibold transition ${entry.appoint_code\r\n                                  ? \"border border-slate-300 text-slate-600 hover:border-slate-400\"\r\n                                  : \"border border-slate-200 text-slate-400 cursor-not-allowed\"\r\n                                  }`}\r\n                              >\r\n                                แก้ไขนัดหมาย\r\n                              </button>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {appointmentSections.map((section) => (\r\n                <div key={section.title} className=\"space-y-3\">\r\n                  <p className=\"text-sm font-semibold text-slate-700\">{section.title}</p>\r\n                  <div\r\n                    className={`grid ${section.columns || \"grid-cols-1 md:grid-cols-2\"} gap-4`}\r\n                  >\r\n                    {section.fields.map((fieldKey) => {\r\n                      const meta = appointmentFieldMetaMap[fieldKey];\r\n                      if (!meta) return null;\r\n                      const value = appointmentForm[fieldKey] || \"\";\r\n                      const isTextarea = meta.type === \"textarea\";\r\n                      const inputType =\r\n                        meta.type === \"date\"\r\n                          ? \"date\"\r\n                          : meta.type === \"datetime-local\"\r\n                            ? \"datetime-local\"\r\n                            : meta.type === \"tel\"\r\n                              ? \"tel\"\r\n                              : \"text\";\r\n                      return (\r\n                        <div\r\n                          key={fieldKey}\r\n                          className={`group ${meta.fullWidth ? \"md:col-span-2\" : \"\"}`}\r\n                        >\r\n                          <label className=\"block text-xs font-semibold uppercase tracking-wider text-slate-500 mb-1\">\r\n                            {meta.label}\r\n                          </label>\r\n                          {isTextarea ? (\r\n                            <textarea\r\n                              rows={4}\r\n                              value={value}\r\n                              onChange={(event) =>\r\n                                handleAppointmentFieldChange(fieldKey, event.target.value)\r\n                              }\r\n                              placeholder={meta.placeholder}\r\n                              className=\"w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 focus:border-slate-400 focus:outline-none focus:ring-2 focus:ring-cyan-100\"\r\n                            />\r\n                          ) : (\r\n                            <input\r\n                              type={inputType}\r\n                              value={value}\r\n                              onChange={(event) =>\r\n                                handleAppointmentFieldChange(fieldKey, event.target.value)\r\n                              }\r\n                              placeholder={meta.placeholder}\r\n                              readOnly={meta.readOnly}\r\n                              disabled={meta.readOnly}\r\n                              className={`w-full px-4 py-3 border-2 rounded-2xl transition focus:border-cyan-400 focus:ring-2 focus:ring-cyan-100 outline-none text-gray-900 ${meta.readOnly\r\n                                ? \"bg-slate-100 border-slate-200\"\r\n                                : \"border-slate-200 bg-white\"\r\n                                } disabled:cursor-not-allowed`}\r\n                            />\r\n                          )}\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n\r\n              {appointmentError && (\r\n                <p className=\"text-sm text-red-600\">{appointmentError}</p>\r\n              )}\r\n\r\n              <div className=\"flex justify-end gap-3\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowAppointmentPopup(false)}\r\n                  className=\"px-5 py-2 border border-slate-300 rounded-xl text-slate-700 font-semibold hover:border-slate-400 transition\"\r\n                >\r\n                  ปิด\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleSaveAppointment}\r\n                  disabled={appointmentLoading}\r\n                  className=\"px-5 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl font-semibold shadow-lg transition hover:from-blue-700 hover:to-indigo-700 disabled:opacity-70 disabled:cursor-not-allowed\"\r\n                >\r\n                  {appointmentLoading ? \"กำลังบันทึก...\" : \"บันทึกนัดหมาย\"}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","\"use client\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { X, Save, Loader2, User, FileText, ClipboardCheck, Briefcase, Calendar, Star } from \"lucide-react\";\r\nimport { NotificationPopup } from \"./NotificationPopup\";\r\n\r\ninterface AddCustomerModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onSuccess: () => void;\r\n}\r\n\r\ntype TabType = \"contact\" | \"opd\" | \"consent\" | \"service\" | \"appointment\";\r\n\r\ninterface ThaiProvince {\r\n    id: number;\r\n    name_th: string;\r\n    name_en: string;\r\n}\r\n\r\ninterface ThaiDistrict {\r\n    id: number;\r\n    province_id: number;\r\n    name_th: string;\r\n    name_en: string;\r\n}\r\n\r\ninterface ThaiSubDistrict {\r\n    id: number;\r\n    district_id: number;\r\n    name_th: string;\r\n    name_en: string;\r\n    zip_code: number | string | null;\r\n}\r\n\r\nconst THAI_DATA_BASE_URL =\r\n    \"https://raw.githubusercontent.com/kongvut/thai-province-data/refs/heads/master/api/latest\";\r\n\r\nexport const AddCustomerModal = ({\r\n    isOpen,\r\n    onClose,\r\n    onSuccess,\r\n}: AddCustomerModalProps) => {\r\n    const [activeTab, setActiveTab] = useState<TabType>(\"contact\");\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [notification, setNotification] = useState({\r\n        isOpen: false,\r\n        type: \"success\" as \"success\" | \"error\",\r\n        title: \"\",\r\n        message: \"\",\r\n    });\r\n\r\n    // Form state - Contact Information (matching EditCustomerModal fields)\r\n    const [formData, setFormData] = useState({\r\n        // Personal Info\r\n        status: \"\",\r\n        prefix: \"\",\r\n        name: \"\",\r\n        surname: \"\",\r\n        nickname: \"\",\r\n        gender: \"\",\r\n        star_flag: \"\",\r\n        // Contact Info\r\n        phone: \"\",\r\n        email: \"\",\r\n        lineid: \"\",\r\n        facebook: \"\",\r\n        country: \"\",\r\n        // Business Info\r\n        source: \"\",\r\n        interested_product: \"\",\r\n        contact_staff: \"\",\r\n        proposed_amount: \"\",\r\n        // Follow-up Dates\r\n        got_contact_date: \"\",\r\n        last_followup: \"\",\r\n        next_followup: \"\",\r\n        // Consult/Surgery Dates\r\n        consult_date: \"\",\r\n        booked_consult_date: \"\",\r\n        surgery_date: \"\",\r\n        booked_surgery_date: \"\",\r\n        appointment_time: \"\",\r\n        // Notes\r\n        note: \"\",\r\n    });\r\n\r\n    // OPD form state\r\n    const [opdData, setOpdData] = useState({\r\n        locno: \"\",\r\n        province: \"\",\r\n        amphur: \"\",\r\n        tumbon: \"\",\r\n        zipcode: \"\",\r\n    });\r\n\r\n    // Consent form state\r\n    const [consentData, setConsentData] = useState({\r\n        weight: \"\",\r\n        height: \"\",\r\n        hasChronic: false,\r\n        chronicDiseaseDetail: \"\",\r\n        hasDrugAllergy: false,\r\n        drugAllergyDetail: \"\",\r\n        medicalConsent: \"\",\r\n        acceptPdpa: \"\",\r\n        acceptMedia: \"\",\r\n    });\r\n\r\n    // Options from API\r\n    const [statusOptions, setStatusOptions] = useState<Array<{ value: string; label: string; color: string }>>([]);\r\n    const [sourceOptions, setSourceOptions] = useState<Array<{ value: string; label: string }>>([]);\r\n    const [productOptions, setProductOptions] = useState<Array<{ value: string; label: string }>>([]);\r\n    const [countryOptions, setCountryOptions] = useState<Array<{ value: string; label: string }>>([]);\r\n    const [contactPersonOptions, setContactPersonOptions] = useState<Array<{ value: string; label: string }>>([]);\r\n\r\n    // Thai address data\r\n    const [thaiProvinces, setThaiProvinces] = useState<ThaiProvince[]>([]);\r\n    const [thaiDistricts, setThaiDistricts] = useState<ThaiDistrict[]>([]);\r\n    const [thaiSubdistricts, setThaiSubdistricts] = useState<ThaiSubDistrict[]>([]);\r\n    const [selectedProvinceId, setSelectedProvinceId] = useState<number | null>(null);\r\n    const [selectedDistrictId, setSelectedDistrictId] = useState<number | null>(null);\r\n    const [selectedSubdistrictId, setSelectedSubdistrictId] = useState<number | null>(null);\r\n    const [thaiAddressLoading, setThaiAddressLoading] = useState(false);\r\n\r\n    // Fallback data for when API is unavailable\r\n    const fallbackStatusOptions = [\r\n        { value: \"ติดตามต่อเนื่อง\", label: \"ติดตามต่อเนื่อง\", color: \"#FFD700\" },\r\n        { value: \"ปิดการขาย\", label: \"ปิดการขาย\", color: \"#90EE90\" },\r\n        { value: \"ยกเลิก\", label: \"ยกเลิก\", color: \"#FFB6C1\" },\r\n        { value: \"รอตอบกลับ\", label: \"รอตอบกลับ\", color: \"#87CEEB\" },\r\n        { value: \"ได้นัด Consult\", label: \"ได้นัด Consult\", color: \"#FFA500\" },\r\n        { value: \"ได้นัดผ่าตัด\", label: \"ได้นัดผ่าตัด\", color: \"#FF6347\" },\r\n        { value: \"ผ่าตัดแล้ว\", label: \"ผ่าตัดแล้ว\", color: \"#32CD32\" },\r\n    ];\r\n\r\n    const fallbackSourceOptions = [\r\n        { value: \"Facebook\", label: \"Facebook\" },\r\n        { value: \"Instagram\", label: \"Instagram\" },\r\n        { value: \"Google Ads\", label: \"Google Ads\" },\r\n        { value: \"Line\", label: \"Line\" },\r\n        { value: \"Walk-in\", label: \"Walk-in\" },\r\n        { value: \"Referral\", label: \"Referral\" },\r\n    ];\r\n\r\n    const fallbackProductOptions = [\r\n        { value: \"ตีตัวไล่ตัว\", label: \"ตีตัวไล่ตัว\" },\r\n        { value: \"Sub brow lift\", label: \"Sub brow lift\" },\r\n        { value: \"แก้ตาหมื่อตอนและแก้ว\", label: \"แก้ตาหมื่อตอนและแก้ว\" },\r\n        { value: \"ตาสองชั้น\", label: \"ตาสองชั้น\" },\r\n        { value: \"เสริมจมูก\", label: \"เสริมจมูก\" },\r\n        { value: \"แก้จมูก\", label: \"แก้จมูก\" },\r\n        { value: \"เสริมตาขาว\", label: \"เสริมตาขาว\" },\r\n        { value: \"ลิฟหน้า\", label: \"ลิฟหน้า\" },\r\n        { value: \"Skin\", label: \"Skin\" },\r\n    ];\r\n\r\n    const fallbackCountryOptions = [\r\n        { value: \"ไทย\", label: \"ไทย\" },\r\n        { value: \"จีน\", label: \"จีน\" },\r\n        { value: \"ญี่ปุ่น\", label: \"ญี่ปุ่น\" },\r\n        { value: \"เกาหลี\", label: \"เกาหลี\" },\r\n        { value: \"สิงคโปร์\", label: \"สิงคโปร์\" },\r\n        { value: \"มาเลเซีย\", label: \"มาเลเซีย\" },\r\n        { value: \"อินโดนีเซีย\", label: \"อินโดนีเซีย\" },\r\n        { value: \"เวียดนาม\", label: \"เวียดนาม\" },\r\n        { value: \"ฟิลิปปินส์\", label: \"ฟิลิปปินส์\" },\r\n        { value: \"พม่า\", label: \"พม่า\" },\r\n        { value: \"อื่นๆ\", label: \"อื่นๆ\" },\r\n    ];\r\n\r\n    const fallbackContactPersonOptions = [\r\n        { value: \"ไม่ระบุ\", label: \"ไม่ระบุ\" },\r\n    ];\r\n\r\n    // Fetch options on mount\r\n    useEffect(() => {\r\n        if (!isOpen) return;\r\n\r\n        const fetchStatusOptions = async () => {\r\n            try {\r\n                const response = await fetch(\"/api/status-options\");\r\n                const result = await response.json();\r\n                if (result.success && result.data) {\r\n                    setStatusOptions(result.data);\r\n                } else {\r\n                    setStatusOptions(fallbackStatusOptions);\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Failed to fetch status options:\", error);\r\n                setStatusOptions(fallbackStatusOptions);\r\n            }\r\n        };\r\n\r\n        const fetchSourceOptions = async () => {\r\n            try {\r\n                const response = await fetch(\"/api/source-options\");\r\n                const result = await response.json();\r\n                if (result.success && result.data) {\r\n                    setSourceOptions(result.data);\r\n                } else {\r\n                    setSourceOptions(fallbackSourceOptions);\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Failed to fetch source options:\", error);\r\n                setSourceOptions(fallbackSourceOptions);\r\n            }\r\n        };\r\n\r\n        const fetchProductOptions = async () => {\r\n            try {\r\n                const response = await fetch(\"/api/product-options\");\r\n                const result = await response.json();\r\n                if (result.success && result.data) {\r\n                    setProductOptions(result.data);\r\n                } else {\r\n                    setProductOptions(fallbackProductOptions);\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Failed to fetch product options:\", error);\r\n                setProductOptions(fallbackProductOptions);\r\n            }\r\n        };\r\n\r\n        const fetchCountryOptions = async () => {\r\n            try {\r\n                const response = await fetch(\"/api/country-options\");\r\n                const result = await response.json();\r\n                if (result.success && result.data) {\r\n                    setCountryOptions(result.data);\r\n                } else {\r\n                    setCountryOptions(fallbackCountryOptions);\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Failed to fetch country options:\", error);\r\n                setCountryOptions(fallbackCountryOptions);\r\n            }\r\n        };\r\n\r\n        const fetchContactPersonOptions = async () => {\r\n            try {\r\n                const response = await fetch(\"/api/n-staff\");\r\n                const result = await response.json();\r\n                if (result.success && result.data) {\r\n                    // Transform n_staff data to option format\r\n                    setContactPersonOptions(result.data.map((staff: { nickname: string; code: string }) => ({\r\n                        value: staff.nickname,\r\n                        label: staff.nickname,\r\n                    })));\r\n                } else {\r\n                    setContactPersonOptions(fallbackContactPersonOptions);\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Failed to fetch contact person options:\", error);\r\n                setContactPersonOptions(fallbackContactPersonOptions);\r\n            }\r\n        };\r\n\r\n        // Fetch all options\r\n        fetchStatusOptions();\r\n        fetchSourceOptions();\r\n        fetchProductOptions();\r\n        fetchCountryOptions();\r\n        fetchContactPersonOptions();\r\n    }, [isOpen]);\r\n\r\n    // Fetch Thai address data\r\n    useEffect(() => {\r\n        if (!isOpen) return;\r\n\r\n        const fetchThaiData = async () => {\r\n            setThaiAddressLoading(true);\r\n            try {\r\n                const [provincesRes, districtsRes, subdistrictsRes] = await Promise.all([\r\n                    fetch(`${THAI_DATA_BASE_URL}/province.json`),\r\n                    fetch(`${THAI_DATA_BASE_URL}/district.json`),\r\n                    fetch(`${THAI_DATA_BASE_URL}/sub_district.json`),\r\n                ]);\r\n\r\n                if (provincesRes.ok) {\r\n                    const provinces = await provincesRes.json();\r\n                    setThaiProvinces(provinces);\r\n                }\r\n                if (districtsRes.ok) {\r\n                    const districts = await districtsRes.json();\r\n                    setThaiDistricts(districts);\r\n                }\r\n                if (subdistrictsRes.ok) {\r\n                    const subdistricts = await subdistrictsRes.json();\r\n                    setThaiSubdistricts(subdistricts);\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Failed to fetch Thai address data:\", error);\r\n            } finally {\r\n                setThaiAddressLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchThaiData();\r\n    }, [isOpen]);\r\n\r\n    // Filter districts by province\r\n    const filteredDistricts = selectedProvinceId\r\n        ? thaiDistricts.filter((d) => d.province_id === selectedProvinceId)\r\n        : [];\r\n\r\n    // Filter subdistricts by district\r\n    const filteredSubdistricts = selectedDistrictId\r\n        ? thaiSubdistricts.filter((s) => s.district_id === selectedDistrictId)\r\n        : [];\r\n\r\n    const handleProvinceSelect = (provinceId: string) => {\r\n        const id = provinceId ? parseInt(provinceId) : null;\r\n        setSelectedProvinceId(id);\r\n        setSelectedDistrictId(null);\r\n        setSelectedSubdistrictId(null);\r\n\r\n        const province = thaiProvinces.find((p) => p.id === id);\r\n        setOpdData((prev) => ({\r\n            ...prev,\r\n            province: province?.name_th || \"\",\r\n            amphur: \"\",\r\n            tumbon: \"\",\r\n            zipcode: \"\",\r\n        }));\r\n    };\r\n\r\n    const handleDistrictSelect = (districtId: string) => {\r\n        const id = districtId ? parseInt(districtId) : null;\r\n        setSelectedDistrictId(id);\r\n        setSelectedSubdistrictId(null);\r\n\r\n        const district = thaiDistricts.find((d) => d.id === id);\r\n        setOpdData((prev) => ({\r\n            ...prev,\r\n            amphur: district?.name_th || \"\",\r\n            tumbon: \"\",\r\n            zipcode: \"\",\r\n        }));\r\n    };\r\n\r\n    const handleSubdistrictSelect = (subdistrictId: string) => {\r\n        const id = subdistrictId ? parseInt(subdistrictId) : null;\r\n        setSelectedSubdistrictId(id);\r\n\r\n        const subdistrict = thaiSubdistricts.find((s) => s.id === id);\r\n        setOpdData((prev) => ({\r\n            ...prev,\r\n            tumbon: subdistrict?.name_th || \"\",\r\n            zipcode: subdistrict?.zip_code?.toString() || \"\",\r\n        }));\r\n    };\r\n\r\n    const handleSave = async () => {\r\n        // Validate mandatory fields: ชื่อ, สถานะ, เบอร์โทร, เพศ, แหล่งที่มา, ผลิตภัณฑ์ที่สนใจ\r\n        const missingFields: string[] = [];\r\n        if (!formData.name.trim()) missingFields.push(\"ชื่อ\");\r\n        if (!formData.status) missingFields.push(\"สถานะ\");\r\n        if (!formData.phone.trim()) missingFields.push(\"เบอร์โทร\");\r\n        if (!formData.gender) missingFields.push(\"เพศ\");\r\n        if (!formData.source) missingFields.push(\"แหล่งที่มา\");\r\n        if (!formData.interested_product) missingFields.push(\"ผลิตภัณฑ์ที่สนใจ\");\r\n\r\n        if (missingFields.length > 0) {\r\n            setNotification({\r\n                isOpen: true,\r\n                type: \"error\",\r\n                title: \"ข้อมูลไม่ครบ\",\r\n                message: `กรุณากรอกข้อมูลที่จำเป็น: ${missingFields.join(\", \")}`,\r\n            });\r\n            return;\r\n        }\r\n\r\n        setIsLoading(true);\r\n        try {\r\n            const customerPayload = {\r\n                // Personal Info\r\n                prefix: formData.prefix,\r\n                name: formData.name,\r\n                surname: formData.surname,\r\n                nickname: formData.nickname,\r\n                gender: formData.gender,\r\n                star_flag: formData.star_flag === \"ติดดาว\" ? 1 : 0,\r\n                status: formData.status,\r\n                // Contact Info\r\n                phone: formData.phone,\r\n                email: formData.email,\r\n                lineid: formData.lineid,\r\n                facebook: formData.facebook,\r\n                country: formData.country,\r\n                // Business Info\r\n                source: formData.source,\r\n                interested_product: formData.interested_product,\r\n                contact_staff: formData.contact_staff,\r\n                proposed_amount: formData.proposed_amount || null,\r\n                // Follow-up Dates\r\n                got_contact_date: formData.got_contact_date || null,\r\n                last_followup: formData.last_followup || null,\r\n                next_followup: formData.next_followup || null,\r\n                // Consult/Surgery Dates\r\n                consult_date: formData.consult_date || null,\r\n                booked_consult_date: formData.booked_consult_date || null,\r\n                surgery_date: formData.surgery_date || null,\r\n                booked_surgery_date: formData.booked_surgery_date || null,\r\n                appointment_time: formData.appointment_time || null,\r\n                // Notes\r\n                note: formData.note,\r\n                // OPD data\r\n                locno: opdData.locno,\r\n                province: opdData.province,\r\n                amphur: opdData.amphur,\r\n                tumbon: opdData.tumbon,\r\n                zipcode: opdData.zipcode,\r\n            };\r\n\r\n            const response = await fetch(\"/api/customer-add\", {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n                body: JSON.stringify(customerPayload),\r\n            });\r\n\r\n            if (!response.ok) {\r\n                const errorData = await response.json();\r\n                throw new Error(errorData.error || \"Failed to save customer\");\r\n            }\r\n\r\n            setNotification({\r\n                isOpen: true,\r\n                type: \"success\",\r\n                title: \"สำเร็จ\",\r\n                message: \"บันทึกข้อมูลลูกค้าเรียบร้อยแล้ว\",\r\n            });\r\n\r\n            // Reset form\r\n            setFormData({\r\n                status: \"\",\r\n                prefix: \"\",\r\n                name: \"\",\r\n                surname: \"\",\r\n                nickname: \"\",\r\n                gender: \"\",\r\n                star_flag: \"\",\r\n                phone: \"\",\r\n                email: \"\",\r\n                lineid: \"\",\r\n                facebook: \"\",\r\n                country: \"\",\r\n                source: \"\",\r\n                interested_product: \"\",\r\n                contact_staff: \"\",\r\n                proposed_amount: \"\",\r\n                got_contact_date: \"\",\r\n                last_followup: \"\",\r\n                next_followup: \"\",\r\n                consult_date: \"\",\r\n                booked_consult_date: \"\",\r\n                surgery_date: \"\",\r\n                booked_surgery_date: \"\",\r\n                appointment_time: \"\",\r\n                note: \"\",\r\n            });\r\n            setOpdData({\r\n                locno: \"\",\r\n                province: \"\",\r\n                amphur: \"\",\r\n                tumbon: \"\",\r\n                zipcode: \"\",\r\n            });\r\n            setActiveTab(\"contact\");\r\n\r\n            setTimeout(() => {\r\n                onSuccess();\r\n            }, 1500);\r\n        } catch (error: any) {\r\n            setNotification({\r\n                isOpen: true,\r\n                type: \"error\",\r\n                title: \"เกิดข้อผิดพลาด\",\r\n                message: error.message || \"ไม่สามารถบันทึกข้อมูลได้\",\r\n            });\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    const tabs = [\r\n        { id: \"contact\" as TabType, label: \"Contact Information\", icon: User },\r\n        { id: \"opd\" as TabType, label: \"OPD\", icon: FileText },\r\n        { id: \"consent\" as TabType, label: \"Consent\", icon: ClipboardCheck },\r\n        { id: \"service\" as TabType, label: \"บริการ\", icon: Briefcase },\r\n        { id: \"appointment\" as TabType, label: \"นัดหมาย\", icon: Calendar },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fadeIn\">\r\n            <div className=\"bg-white rounded-2xl shadow-2xl max-h-[90vh] overflow-hidden w-full max-w-4xl animate-slideUp transform transition-all\">\r\n                {/* Header with Gradient */}\r\n                <div className=\"sticky top-0 bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 z-10 shadow-lg\">\r\n                    {/* Close button - top right */}\r\n                    <div className=\"absolute top-3 right-3\">\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"p-2 hover:bg-white hover:bg-opacity-20 rounded-xl transition-all duration-200 group\"\r\n                        >\r\n                            <X className=\"w-5 h-5 text-white group-hover:rotate-90 transition-transform duration-200\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Centered Tabs */}\r\n                    <div className=\"flex justify-center items-center gap-1 sm:gap-2 px-4 py-4\">\r\n                        {tabs.map((tab) => (\r\n                            <button\r\n                                key={tab.id}\r\n                                onClick={() => setActiveTab(tab.id)}\r\n                                className={`flex flex-col sm:flex-row items-center justify-center gap-1 px-3 sm:px-4 py-2 sm:py-2.5 ${activeTab === tab.id\r\n                                        ? \"bg-white/30 shadow-inner\"\r\n                                        : \"bg-white/10 hover:bg-white/20\"\r\n                                    } text-white rounded-xl transition-all duration-200 min-w-[60px] sm:min-w-[80px]`}\r\n                                title={tab.label}\r\n                            >\r\n                                <tab.icon className=\"w-5 h-5\" />\r\n                                <span className=\"text-xs sm:text-sm font-medium hidden sm:block\">{tab.label}</span>\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Scrollable Content */}\r\n                <div className=\"overflow-y-auto\" style={{ maxHeight: \"calc(90vh - 180px)\" }}>\r\n                    <div className=\"p-6 space-y-6\">\r\n                        {/* Contact Information Tab */}\r\n                        {activeTab === \"contact\" && (\r\n                            <>\r\n                                {/* Section 1: Personal Info */}\r\n                                <div className=\"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl p-6 border border-cyan-100 shadow-sm\">\r\n                                    <div className=\"flex items-center gap-2 mb-4\">\r\n                                        <div className=\"w-1 h-6 bg-gradient-to-b from-cyan-500 to-blue-500 rounded-full\"></div>\r\n                                        <h2 className=\"text-lg font-bold bg-gradient-to-r from-cyan-600 to-blue-600 bg-clip-text text-transparent\">\r\n                                            ข้อมูลส่วนตัว\r\n                                        </h2>\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n                                        {/* Status */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">สถานะ <span className=\"text-red-500\">*</span></label>\r\n                                            <select\r\n                                                value={formData.status}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, status: e.target.value }))}\r\n                                                className={`w-full pl-4 pr-8 py-3 border-2 ${!formData.status ? 'border-red-300' : 'border-cyan-200'} bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer`}\r\n                                            >\r\n                                                <option value=\"\">เลือกสถานะ</option>\r\n                                                {statusOptions.map((option) => (\r\n                                                    <option key={option.value} value={option.value}>{option.label}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                        {/* Prefix */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">คำนำหน้า</label>\r\n                                            <select\r\n                                                value={formData.prefix}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, prefix: e.target.value }))}\r\n                                                className=\"w-full pl-4 pr-8 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            >\r\n                                                <option value=\"\">เลือกคำนำหน้า</option>\r\n                                                <option value=\"นาย\">นาย</option>\r\n                                                <option value=\"นาง\">นาง</option>\r\n                                                <option value=\"นางสาว\">นางสาว</option>\r\n                                                <option value=\"Mr.\">Mr.</option>\r\n                                                <option value=\"Mrs.\">Mrs.</option>\r\n                                                <option value=\"Ms.\">Ms.</option>\r\n                                            </select>\r\n                                        </div>\r\n                                        {/* Name */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ชื่อ <span className=\"text-red-500\">*</span></label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={formData.name}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, name: e.target.value }))}\r\n                                                className={`w-full px-4 py-3 border-2 ${!formData.name.trim() ? 'border-red-300' : 'border-cyan-200'} bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none`}\r\n                                                placeholder=\"กรอกชื่อ\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Surname */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">นามสกุล</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={formData.surname}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, surname: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none\"\r\n                                                placeholder=\"กรอกนามสกุล\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Nickname */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ชื่อเล่น</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={formData.nickname}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, nickname: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none\"\r\n                                                placeholder=\"กรอกชื่อเล่น\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Gender */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">เพศ <span className=\"text-red-500\">*</span></label>\r\n                                            <select\r\n                                                value={formData.gender}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, gender: e.target.value }))}\r\n                                                className={`w-full pl-4 pr-8 py-3 border-2 ${!formData.gender ? 'border-red-300' : 'border-cyan-200'} bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer`}\r\n                                            >\r\n                                                <option value=\"\">เลือกเพศ</option>\r\n                                                <option value=\"ชาย\">ชาย</option>\r\n                                                <option value=\"หญิง\">หญิง</option>\r\n                                                <option value=\"อื่นๆ\">อื่นๆ</option>\r\n                                            </select>\r\n                                        </div>\r\n                                        {/* Star Flag */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ติดดาว</label>\r\n                                            <button\r\n                                                type=\"button\"\r\n                                                onClick={() => setFormData((prev) => ({ ...prev, star_flag: prev.star_flag === \"ติดดาว\" ? \"\" : \"ติดดาว\" }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl hover:border-cyan-300 transition-all duration-200 flex items-center justify-center gap-2\"\r\n                                            >\r\n                                                <Star className={`w-6 h-6 ${formData.star_flag === \"ติดดาว\" ? \"fill-yellow-400 text-yellow-400\" : \"text-gray-400\"}`} />\r\n                                                <span className=\"text-sm font-medium text-gray-700\">\r\n                                                    {formData.star_flag === \"ติดดาว\" ? \"ติดดาวแล้ว\" : \"คลิกเพื่อติดดาว\"}\r\n                                                </span>\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Section 2: Contact Info */}\r\n                                <div className=\"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-xl p-6 border border-indigo-100 shadow-sm\">\r\n                                    <div className=\"flex items-center gap-2 mb-4\">\r\n                                        <div className=\"w-1 h-6 bg-gradient-to-b from-indigo-500 to-purple-500 rounded-full\"></div>\r\n                                        <h2 className=\"text-lg font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent\">\r\n                                            ข้อมูลติดต่อ\r\n                                        </h2>\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                        {/* Phone */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">เบอร์โทร <span className=\"text-red-500\">*</span></label>\r\n                                            <input\r\n                                                type=\"tel\"\r\n                                                value={formData.phone}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, phone: e.target.value }))}\r\n                                                className={`w-full px-4 py-3 border-2 ${!formData.phone.trim() ? 'border-red-300' : 'border-indigo-200'} bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none`}\r\n                                                placeholder=\"กรอกเบอร์โทร\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Email */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">อีเมล</label>\r\n                                            <input\r\n                                                type=\"email\"\r\n                                                value={formData.email}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, email: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none\"\r\n                                                placeholder=\"กรอกอีเมล\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Line ID */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ไลน์ไอดี</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={formData.lineid}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, lineid: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none\"\r\n                                                placeholder=\"กรอกไลน์ไอดี\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Facebook */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">เฟสบุ๊ค</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={formData.facebook}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, facebook: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none\"\r\n                                                placeholder=\"กรอกเฟสบุ๊ค\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Country */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ประเทศ</label>\r\n                                            <select\r\n                                                value={formData.country}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, country: e.target.value }))}\r\n                                                className=\"w-full pl-4 pr-8 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            >\r\n                                                <option value=\"\">เลือกประเทศ</option>\r\n                                                {countryOptions.map((option) => (\r\n                                                    <option key={option.value} value={option.value}>{option.label}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Section 3: Business Info */}\r\n                                <div className=\"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl p-6 border border-emerald-100 shadow-sm\">\r\n                                    <div className=\"flex items-center gap-2 mb-4\">\r\n                                        <div className=\"w-1 h-6 bg-gradient-to-b from-emerald-500 to-teal-500 rounded-full\"></div>\r\n                                        <h2 className=\"text-lg font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent\">\r\n                                            ข้อมูลธุรกิจ\r\n                                        </h2>\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n                                        {/* Source */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">แหล่งที่มา <span className=\"text-red-500\">*</span></label>\r\n                                            <select\r\n                                                value={formData.source}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, source: e.target.value }))}\r\n                                                className={`w-full pl-4 pr-8 py-3 border-2 ${!formData.source ? 'border-red-300' : 'border-emerald-200'} bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer`}\r\n                                            >\r\n                                                <option value=\"\">เลือกแหล่งที่มา</option>\r\n                                                {sourceOptions.map((option) => (\r\n                                                    <option key={option.value} value={option.value}>{option.label}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                        {/* Interested Product */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ผลิตภัณฑ์ที่สนใจ <span className=\"text-red-500\">*</span></label>\r\n                                            <select\r\n                                                value={formData.interested_product}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, interested_product: e.target.value }))}\r\n                                                className={`w-full pl-4 pr-8 py-3 border-2 ${!formData.interested_product ? 'border-red-300' : 'border-emerald-200'} bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer`}\r\n                                            >\r\n                                                <option value=\"\">เลือกผลิตภัณฑ์</option>\r\n                                                {productOptions.map((option) => (\r\n                                                    <option key={option.value} value={option.value}>{option.label}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                        {/* Contact Staff */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ผู้ติดต่อ</label>\r\n                                            <select\r\n                                                value={formData.contact_staff}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, contact_staff: e.target.value }))}\r\n                                                className=\"w-full pl-4 pr-8 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            >\r\n                                                <option value=\"\">เลือกผู้ติดต่อ</option>\r\n                                                {contactPersonOptions.map((option) => (\r\n                                                    <option key={option.value} value={option.value}>{option.label}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                        {/* Proposed Amount */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ยอดนำเสนอ</label>\r\n                                            <input\r\n                                                type=\"number\"\r\n                                                value={formData.proposed_amount}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, proposed_amount: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none\"\r\n                                                placeholder=\"กรอกยอดนำเสนอ\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Section 4: วันที่ติดตาม */}\r\n                                <div className=\"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl p-6 border border-cyan-100 shadow-sm\">\r\n                                    <div className=\"flex items-center gap-2 mb-4\">\r\n                                        <div className=\"w-1 h-6 bg-gradient-to-b from-cyan-500 to-blue-500 rounded-full\"></div>\r\n                                        <h2 className=\"text-lg font-bold bg-gradient-to-r from-cyan-600 to-blue-600 bg-clip-text text-transparent\">\r\n                                            วันที่ติดตาม\r\n                                        </h2>\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                        {/* Got Contact Date */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                                                <span>📅</span> วันที่ได้ชื่อ เบอร์\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"date\"\r\n                                                value={formData.got_contact_date}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, got_contact_date: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Last Follow-up */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                                                <span>📅</span> วันที่ติดตามครั้งล่าสุด\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"date\"\r\n                                                value={formData.last_followup}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, last_followup: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Next Follow-up */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                                                <span>📅</span> วันที่ติดตามครั้งถัดไป\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"date\"\r\n                                                value={formData.next_followup}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, next_followup: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Section 5: วันที่ Consult */}\r\n                                <div className=\"bg-gradient-to-br from-purple-50 to-violet-50 rounded-xl p-6 border border-purple-100 shadow-sm\">\r\n                                    <div className=\"flex items-center gap-2 mb-4\">\r\n                                        <div className=\"w-1 h-6 bg-gradient-to-b from-purple-500 to-violet-500 rounded-full\"></div>\r\n                                        <h2 className=\"text-lg font-bold bg-gradient-to-r from-purple-600 to-violet-600 bg-clip-text text-transparent\">\r\n                                            วันที่ Consult\r\n                                        </h2>\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                        {/* Booked Consult Date */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                                                <span>📅</span> วันที่ได้นัด consult\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"date\"\r\n                                                value={formData.booked_consult_date}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, booked_consult_date: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-purple-200 bg-white rounded-xl focus:ring-2 focus:ring-purple-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Consult Date */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                                                <span>📅</span> วันที่ Consult\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"date\"\r\n                                                value={formData.consult_date}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, consult_date: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-purple-200 bg-white rounded-xl focus:ring-2 focus:ring-purple-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Section 6: วันที่ผ่าตัด */}\r\n                                <div className=\"bg-gradient-to-br from-rose-50 to-pink-50 rounded-xl p-6 border border-rose-100 shadow-sm\">\r\n                                    <div className=\"flex items-center gap-2 mb-4\">\r\n                                        <div className=\"w-1 h-6 bg-gradient-to-b from-rose-500 to-pink-500 rounded-full\"></div>\r\n                                        <h2 className=\"text-lg font-bold bg-gradient-to-r from-rose-600 to-pink-600 bg-clip-text text-transparent\">\r\n                                            วันที่ผ่าตัด\r\n                                        </h2>\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                        {/* Booked Surgery Date */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                                                <span>📅</span> วันที่ได้นัดผ่าตัด\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"date\"\r\n                                                value={formData.booked_surgery_date}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, booked_surgery_date: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-rose-200 bg-white rounded-xl focus:ring-2 focus:ring-rose-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Surgery Date */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                                                <span>📅</span> วันที่ผ่าตัด\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"date\"\r\n                                                value={formData.surgery_date}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, surgery_date: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-rose-200 bg-white rounded-xl focus:ring-2 focus:ring-rose-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Appointment Time */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                                                <span>⏰</span> เวลาที่นัด\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"time\"\r\n                                                value={formData.appointment_time}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, appointment_time: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-rose-200 bg-white rounded-xl focus:ring-2 focus:ring-rose-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Section 6: Notes */}\r\n                                <div className=\"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl p-6 border border-amber-100 shadow-sm\">\r\n                                    <div className=\"flex items-center gap-2 mb-4\">\r\n                                        <div className=\"w-1 h-6 bg-gradient-to-b from-amber-500 to-yellow-500 rounded-full\"></div>\r\n                                        <h2 className=\"text-lg font-bold bg-gradient-to-r from-amber-600 to-yellow-600 bg-clip-text text-transparent\">\r\n                                            หมายเหตุ\r\n                                        </h2>\r\n                                    </div>\r\n                                    <textarea\r\n                                        value={formData.note}\r\n                                        onChange={(e) => setFormData((prev) => ({ ...prev, note: e.target.value }))}\r\n                                        className=\"w-full px-4 py-3 border-2 border-amber-200 bg-white rounded-xl focus:ring-2 focus:ring-amber-400 focus:border-transparent outline-none min-h-[120px] resize-none\"\r\n                                        placeholder=\"📝 พิมพ์หมายเหตุ...\"\r\n                                    />\r\n                                </div>\r\n                            </>\r\n                        )}\r\n\r\n                        {/* OPD Tab */}\r\n                        {activeTab === \"opd\" && (\r\n                            <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100 shadow-sm\">\r\n                                <div className=\"flex items-center gap-2 mb-4\">\r\n                                    <div className=\"w-1 h-6 bg-gradient-to-b from-blue-500 to-indigo-500 rounded-full\"></div>\r\n                                    <h2 className=\"text-lg font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent\">\r\n                                        ข้อมูล OPD - ที่อยู่\r\n                                    </h2>\r\n                                </div>\r\n                                {thaiAddressLoading && (\r\n                                    <p className=\"text-xs text-emerald-600 mb-4\">กำลังโหลดข้อมูลจังหวัด/อำเภอ/ตำบล...</p>\r\n                                )}\r\n                                <div className=\"space-y-4\">\r\n                                    <div className=\"group\">\r\n                                        <label className=\"block text-sm font-semibold text-gray-700 mb-2\">บ้านเลขที่</label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={opdData.locno}\r\n                                            onChange={(e) => setOpdData((prev) => ({ ...prev, locno: e.target.value }))}\r\n                                            className=\"w-full px-4 py-3 border-2 border-blue-200 bg-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-transparent outline-none\"\r\n                                            placeholder=\"ระบุบ้านเลขที่\"\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">จังหวัด</label>\r\n                                            <select\r\n                                                value={selectedProvinceId ? String(selectedProvinceId) : \"\"}\r\n                                                onChange={(e) => handleProvinceSelect(e.target.value)}\r\n                                                className=\"w-full pl-4 pr-8 py-3 border-2 border-blue-200 bg-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            >\r\n                                                <option value=\"\">เลือกจังหวัด</option>\r\n                                                {thaiProvinces.map((province) => (\r\n                                                    <option key={province.id} value={province.id}>{province.name_th}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">อำเภอ / เขต</label>\r\n                                            <select\r\n                                                value={selectedDistrictId ? String(selectedDistrictId) : \"\"}\r\n                                                onChange={(e) => handleDistrictSelect(e.target.value)}\r\n                                                disabled={!filteredDistricts.length}\r\n                                                className=\"w-full pl-4 pr-8 py-3 border-2 border-blue-200 bg-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-transparent outline-none cursor-pointer disabled:bg-gray-100\"\r\n                                            >\r\n                                                <option value=\"\">เลือกอำเภอ / เขต</option>\r\n                                                {filteredDistricts.map((district) => (\r\n                                                    <option key={district.id} value={district.id}>{district.name_th}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ตำบล / แขวง</label>\r\n                                            <select\r\n                                                value={selectedSubdistrictId ? String(selectedSubdistrictId) : \"\"}\r\n                                                onChange={(e) => handleSubdistrictSelect(e.target.value)}\r\n                                                disabled={!filteredSubdistricts.length}\r\n                                                className=\"w-full pl-4 pr-8 py-3 border-2 border-blue-200 bg-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-transparent outline-none cursor-pointer disabled:bg-gray-100\"\r\n                                            >\r\n                                                <option value=\"\">เลือกตำบล / แขวง</option>\r\n                                                {filteredSubdistricts.map((subdistrict) => (\r\n                                                    <option key={subdistrict.id} value={subdistrict.id}>{subdistrict.name_th}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">รหัสไปรษณีย์</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={opdData.zipcode}\r\n                                                readOnly\r\n                                                className=\"w-full px-4 py-3 border-2 border-blue-200 bg-gray-100 rounded-xl outline-none text-gray-700\"\r\n                                                placeholder=\"รหัสไปรษณีย์ (อัตโนมัติ)\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Consent Tab */}\r\n                        {activeTab === \"consent\" && (\r\n                            <div className=\"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl p-6 border border-emerald-100 shadow-sm\">\r\n                                <div className=\"flex items-center gap-2 mb-4\">\r\n                                    <div className=\"w-1 h-6 bg-gradient-to-b from-emerald-500 to-teal-500 rounded-full\"></div>\r\n                                    <h2 className=\"text-lg font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent\">\r\n                                        Consent Form\r\n                                    </h2>\r\n                                </div>\r\n                                <div className=\"space-y-4\">\r\n                                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">น้ำหนัก (kg)</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={consentData.weight}\r\n                                                onChange={(e) => setConsentData((prev) => ({ ...prev, weight: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none\"\r\n                                                placeholder=\"ระบุน้ำหนัก\"\r\n                                            />\r\n                                        </div>\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ส่วนสูง (cm)</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={consentData.height}\r\n                                                onChange={(e) => setConsentData((prev) => ({ ...prev, height: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none\"\r\n                                                placeholder=\"ระบุส่วนสูง\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"group\">\r\n                                        <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2\">\r\n                                            <input\r\n                                                type=\"checkbox\"\r\n                                                checked={consentData.hasChronic}\r\n                                                onChange={(e) => setConsentData((prev) => ({ ...prev, hasChronic: e.target.checked }))}\r\n                                                className=\"w-4 h-4 rounded border-gray-300 text-emerald-500 focus:ring-emerald-400\"\r\n                                            />\r\n                                            มีโรคประจำตัว\r\n                                        </label>\r\n                                        {consentData.hasChronic && (\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={consentData.chronicDiseaseDetail}\r\n                                                onChange={(e) => setConsentData((prev) => ({ ...prev, chronicDiseaseDetail: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none mt-2\"\r\n                                                placeholder=\"ระบุโรคประจำตัว\"\r\n                                            />\r\n                                        )}\r\n                                    </div>\r\n                                    <div className=\"group\">\r\n                                        <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2\">\r\n                                            <input\r\n                                                type=\"checkbox\"\r\n                                                checked={consentData.hasDrugAllergy}\r\n                                                onChange={(e) => setConsentData((prev) => ({ ...prev, hasDrugAllergy: e.target.checked }))}\r\n                                                className=\"w-4 h-4 rounded border-gray-300 text-emerald-500 focus:ring-emerald-400\"\r\n                                            />\r\n                                            มีประวัติแพ้ยา\r\n                                        </label>\r\n                                        {consentData.hasDrugAllergy && (\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={consentData.drugAllergyDetail}\r\n                                                onChange={(e) => setConsentData((prev) => ({ ...prev, drugAllergyDetail: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none mt-2\"\r\n                                                placeholder=\"ระบุยาที่แพ้\"\r\n                                            />\r\n                                        )}\r\n                                    </div>\r\n                                    <div className=\"group\">\r\n                                        <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ยินยอมรับการรักษา</label>\r\n                                        <select\r\n                                            value={consentData.medicalConsent}\r\n                                            onChange={(e) => setConsentData((prev) => ({ ...prev, medicalConsent: e.target.value }))}\r\n                                            className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                        >\r\n                                            <option value=\"\">เลือก</option>\r\n                                            <option value=\"ยินยอม\">ยินยอม</option>\r\n                                            <option value=\"ไม่ยินยอม\">ไม่ยินยอม</option>\r\n                                        </select>\r\n                                    </div>\r\n                                    <div className=\"group\">\r\n                                        <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ยอมรับ PDPA</label>\r\n                                        <select\r\n                                            value={consentData.acceptPdpa}\r\n                                            onChange={(e) => setConsentData((prev) => ({ ...prev, acceptPdpa: e.target.value }))}\r\n                                            className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                        >\r\n                                            <option value=\"\">เลือก</option>\r\n                                            <option value=\"ยอมรับ\">ยอมรับ</option>\r\n                                            <option value=\"ไม่ยอมรับ\">ไม่ยอมรับ</option>\r\n                                        </select>\r\n                                    </div>\r\n                                    <div className=\"group\">\r\n                                        <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ยินยอมเผยแพร่สื่อ</label>\r\n                                        <select\r\n                                            value={consentData.acceptMedia}\r\n                                            onChange={(e) => setConsentData((prev) => ({ ...prev, acceptMedia: e.target.value }))}\r\n                                            className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                        >\r\n                                            <option value=\"\">เลือก</option>\r\n                                            <option value=\"ยอมรับ\">ยอมรับ</option>\r\n                                            <option value=\"ไม่ยอมรับ\">ไม่ยอมรับ</option>\r\n                                        </select>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Service Tab */}\r\n                        {activeTab === \"service\" && (\r\n                            <div className=\"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-100 shadow-sm\">\r\n                                <div className=\"flex items-center gap-2 mb-4\">\r\n                                    <div className=\"w-1 h-6 bg-gradient-to-b from-purple-500 to-pink-500 rounded-full\"></div>\r\n                                    <h2 className=\"text-lg font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent\">\r\n                                        บริการ\r\n                                    </h2>\r\n                                </div>\r\n                                <div className=\"text-center py-12 text-gray-500\">\r\n                                    <Briefcase className=\"w-16 h-16 mx-auto mb-4 text-gray-300\" />\r\n                                    <p className=\"text-lg font-medium\">กรุณาบันทึกข้อมูลลูกค้าก่อน</p>\r\n                                    <p className=\"text-sm mt-2\">หลังจากบันทึกแล้ว สามารถเพิ่มบริการได้ในหน้าแก้ไขข้อมูล</p>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Appointment Tab */}\r\n                        {activeTab === \"appointment\" && (\r\n                            <div className=\"bg-gradient-to-br from-orange-50 to-amber-50 rounded-xl p-6 border border-orange-100 shadow-sm\">\r\n                                <div className=\"flex items-center gap-2 mb-4\">\r\n                                    <div className=\"w-1 h-6 bg-gradient-to-b from-orange-500 to-amber-500 rounded-full\"></div>\r\n                                    <h2 className=\"text-lg font-bold bg-gradient-to-r from-orange-600 to-amber-600 bg-clip-text text-transparent\">\r\n                                        นัดหมาย\r\n                                    </h2>\r\n                                </div>\r\n                                <div className=\"text-center py-12 text-gray-500\">\r\n                                    <Calendar className=\"w-16 h-16 mx-auto mb-4 text-gray-300\" />\r\n                                    <p className=\"text-lg font-medium\">กรุณาบันทึกข้อมูลลูกค้าก่อน</p>\r\n                                    <p className=\"text-sm mt-2\">หลังจากบันทึกแล้ว สามารถเพิ่มนัดหมายได้ในหน้าแก้ไขข้อมูล</p>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Footer */}\r\n                <div className=\"sticky bottom-0 bg-gradient-to-t from-gray-50 to-white border-t border-gray-200 p-4 sm:p-5 flex justify-center gap-4 shadow-lg\">\r\n                    <button\r\n                        onClick={onClose}\r\n                        disabled={isLoading}\r\n                        className=\"px-6 sm:px-8 py-2.5 sm:py-3 border-2 border-gray-300 rounded-xl text-gray-700 text-sm sm:text-base font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 disabled:opacity-50\"\r\n                    >\r\n                        ยกเลิก\r\n                    </button>\r\n                    <button\r\n                        onClick={handleSave}\r\n                        disabled={isLoading}\r\n                        className=\"flex items-center gap-2 px-6 sm:px-8 py-2.5 sm:py-3 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white text-sm sm:text-base font-semibold rounded-xl transition-all duration-200 disabled:opacity-70 shadow-lg hover:shadow-xl\"\r\n                    >\r\n                        {isLoading ? (\r\n                            <>\r\n                                <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                                กำลังบันทึก...\r\n                            </>\r\n                        ) : (\r\n                            <>\r\n                                <Save className=\"w-4 h-4\" />\r\n                                บันทึก\r\n                            </>\r\n                        )}\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Notification Popup */}\r\n            <NotificationPopup\r\n                isOpen={notification.isOpen}\r\n                onClose={() => setNotification((prev) => ({ ...prev, isOpen: false }))}\r\n                type={notification.type}\r\n                title={notification.title}\r\n                message={notification.message}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n","\"use client\";\r\nimport React, { useState, useEffect, useMemo, useCallback, useRef, Suspense } from \"react\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport {\r\n  Search,\r\n  RefreshCw,\r\n  Download,\r\n  ChevronUp,\r\n  ChevronDown,\r\n  Filter,\r\n  X,\r\n  Plus,\r\n  ArrowLeft,\r\n} from \"lucide-react\";\r\nimport { EditCustomerModal } from \"@/components/EditCustomerModal\";\r\nimport { AddCustomerModal } from \"@/components/AddCustomerModal\";\r\nimport UserMenu from \"@/components/UserMenu\";\r\nimport { getLatestUpdatedAt } from \"@/app/api/customer-data/utils\";\r\n// Add custom styles for scrollbar (horizontal and vertical)\r\nconst customScrollbarStyle = `\r\n  .custom-scrollbar::-webkit-scrollbar {\r\n    width: 8px;\r\n    height: 8px;\r\n  }\r\n  .custom-scrollbar::-webkit-scrollbar-track {\r\n    background: rgba(219, 234, 254, 0.5);\r\n    border-radius: 10px;\r\n  }\r\n  .custom-scrollbar::-webkit-scrollbar-thumb {\r\n    background: linear-gradient(to bottom, #3b82f6, #06b6d4);\r\n    border-radius: 10px;\r\n  }\r\n  .custom-scrollbar::-webkit-scrollbar-thumb:hover {\r\n    background: linear-gradient(to bottom, #0284c7, #0891b2);\r\n  }\r\n  .custom-scrollbar-horizontal::-webkit-scrollbar {\r\n    height: 8px;\r\n    width: 8px;\r\n  }\r\n  .custom-scrollbar-horizontal::-webkit-scrollbar-track {\r\n    background: rgba(219, 234, 254, 0.5);\r\n    border-radius: 10px;\r\n  }\r\n  .custom-scrollbar-horizontal::-webkit-scrollbar-thumb {\r\n    background: linear-gradient(to right, #3b82f6, #06b6d4);\r\n    border-radius: 10px;\r\n  }\r\n  .custom-scrollbar-horizontal::-webkit-scrollbar-thumb:hover {\r\n    background: linear-gradient(to right, #0284c7, #0891b2);\r\n  }\r\n`;\r\ninterface TableData {\r\n  tableNumber: number;\r\n  headers: string[];\r\n  rowCount: number;\r\n  data: Record<string, any>[];\r\n}\r\ninterface ApiResponse {\r\n  success: boolean;\r\n  error?: string;\r\n  totalTables: number;\r\n  tables: TableData[];\r\n  rawData: {\r\n    totalRows: number;\r\n    totalColumns: number;\r\n  };\r\n}\r\n\r\ninterface TableSizeOption {\r\n  id: number;\r\n  size_value: number;\r\n  size_label: string;\r\n  sort_order: number;\r\n}\r\nconst CustomerAllDataPage = () => {\r\n  const router = useRouter();\r\n  const searchParams = useSearchParams();\r\n  const customerType = searchParams.get(\"type\"); // \"existing\" or \"new\"\r\n  const [tableData, setTableData] = useState<TableData[]>([]);\r\n  const [lastUpdateTimestamp, setLastUpdateTimestamp] = useState<string | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [currentUser, setCurrentUser] = useState<any>(null);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [debouncedSearchTerm, setDebouncedSearchTerm] = useState(\"\");\r\n  const [filterColumn, setFilterColumn] = useState<string>(\"all\");\r\n  const [showFilterMenu, setShowFilterMenu] = useState(false);\r\n  const [statusFilter, setStatusFilter] = useState<string>(\"all\");\r\n  const [showStatusMenu, setShowStatusMenu] = useState(false);\r\n  const [productFilter, setProductFilter] = useState<string>(\"all\");\r\n  const [showProductMenu, setShowProductMenu] = useState(false);\r\n  const [contactFilter, setContactFilter] = useState<string>(\"all\");\r\n  const [showContactMenu, setShowContactMenu] = useState(false);\r\n  const [showFollowUpLastMenu, setShowFollowUpLastMenu] = useState(false);\r\n  const [followUpLastDate, setFollowUpLastDate] = useState<string>(\"\");\r\n  const [showFollowUpNextMenu, setShowFollowUpNextMenu] = useState(false);\r\n  const [followUpNextDate, setFollowUpNextDate] = useState<string>(\"\");\r\n  const [showConsultMenu, setShowConsultMenu] = useState(false);\r\n  const [consultDate, setConsultDate] = useState<string>(\"\");\r\n  const [showSurgeryMenu, setShowSurgeryMenu] = useState(false);\r\n  const [surgeryDate, setSurgeryDate] = useState<string>(\"\");\r\n  const [showGetNameMenu, setShowGetNameMenu] = useState(false);\r\n  const [getNameDate, setGetNameDate] = useState<string>(\"\");\r\n  const [showGetConsultApptMenu, setShowGetConsultApptMenu] = useState(false);\r\n  const [getConsultApptDate, setGetConsultApptDate] = useState<string>(\"\");\r\n  const [showGetSurgeryApptMenu, setShowGetSurgeryApptMenu] = useState(false);\r\n  const [getSurgeryApptDate, setGetSurgeryApptDate] = useState<string>(\"\");\r\n  const [sortColumn, setSortColumn] = useState<string | null>(null);\r\n  const [sortDirection, setSortDirection] = useState<\"asc\" | \"desc\">(\"asc\");\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [itemsPerPage, setItemsPerPage] = useState(500);\r\n  const [selectedRow, setSelectedRow] = useState<Record<string, any> | null>(\r\n    null\r\n  );\r\n  const [editedRow, setEditedRow] = useState<Record<string, any> | null>(null);\r\n  const [isEditModalOpen, setIsEditModalOpen] = useState(false);\r\n  const [editingCustomer, setEditingCustomer] = useState<Record<\r\n    string,\r\n    any\r\n  > | null>(null);\r\n  const [isAddModalOpen, setIsAddModalOpen] = useState(false);\r\n  const [selectedIds, setSelectedIds] = useState<number[]>([]);\r\n  const [isDeleting, setIsDeleting] = useState(false);\r\n  const [showFilterSheet, setShowFilterSheet] = useState(false);\r\n  const [statusOptions, setStatusOptions] = useState<\r\n    Array<{ value: string; label: string; color: string }>\r\n  >([]);\r\n  const [tableSizeOptions, setTableSizeOptions] = useState<TableSizeOption[]>(\r\n    []\r\n  );\r\n  const [showTableSizeMenu, setShowTableSizeMenu] = useState(false);\r\n  const [tableSize, setTableSize] = useState<number>(500);\r\n  const tableDataRef = useRef<TableData[]>([]);\r\n  const fetchData = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      // ใช้ API endpoint ที่เชื่อมกับ n8n database\r\n      const response = await fetch(\"/api/customer-data\");\r\n      const result = await response.json();\r\n      if (\r\n        !result.success ||\r\n        !result.columns ||\r\n        !result.data ||\r\n        result.data.length === 0\r\n      ) {\r\n        return;\r\n      }\r\n      // API ตอนนี้ return format: { success: true, columns: [...], data: [{...}, {...}], ... }\r\n      // ข้อมูลเป็น array of objects แล้ว ไม่ต้องแปลง\r\n      // รวม 'id' ใน headers เพื่อแสดงในตาราง\r\n      const headers = result.columns;\r\n      const formattedData = result.data;\r\n      const tables = [\r\n        {\r\n          tableNumber: 1,\r\n          headers: headers,\r\n          rowCount: formattedData.length,\r\n          data: formattedData,\r\n        },\r\n      ];\r\n      if (tables && tables.length > 0) {\r\n        const sanitizedTables = tables.map((table: TableData) => {\r\n          // Trim whitespace so columns with stray spaces still render and match filters\r\n          const sanitizedHeaders = table.headers.map((header: string) =>\r\n            header.trim()\r\n          );\r\n          const sanitizedData = table.data.map((row: Record<string, any>) => {\r\n            const sanitizedRow: Record<string, any> = {};\r\n            Object.entries(row).forEach(([key, value]) => {\r\n              sanitizedRow[key.trim()] = value;\r\n            });\r\n            return sanitizedRow;\r\n          });\r\n          return {\r\n            ...table,\r\n            headers: sanitizedHeaders,\r\n            data: sanitizedData,\r\n            rowCount: sanitizedData.length,\r\n          };\r\n        });\r\n        // Define the desired column order for consistency between table and form\r\n        const columnOrder = [\r\n          \"ผู้ติดต่อ\",\r\n          \"สถานะ\",\r\n          \"ผลิตภัณฑ์ที่สนใจ\",\r\n          \"ชื่อ\",\r\n          \"เบอร์โทร\",\r\n          \"เพศ\",\r\n          \"แหล่งที่มา\",\r\n          \"หมายเหตุ\",\r\n          \"วันที่ได้ชื่อ เบอร์\",\r\n          \"วันที่ติดตามครั้งล่าสุด\",\r\n          \"วันที่ติดตามครั้งถัดไป\",\r\n          \"วันที่ได้นัด consult\",\r\n          \"วันที่ Consult\",\r\n          \"วันที่ได้นัดผ่าตัด\",\r\n          \"วันที่ผ่าตัด\",\r\n          \"เวลาที่นัด\",\r\n          \"หมอ\",\r\n          \"ยอดนำเสนอ\",\r\n          \"รหัสลูกค้า\",\r\n          \"ติดดาว\",\r\n          \"ประเทศ\",\r\n          \"เวลาให้เรียกรถ\",\r\n          \"Lat\",\r\n          \"Long\",\r\n          \"id\",\r\n        ];\r\n        \r\n        // Mandatory fields that should always be shown even if empty\r\n        const mandatoryFields = [\r\n          \"สถานะ\",\r\n          \"ผลิตภัณฑ์ที่สนใจ\",\r\n          \"ชื่อ\",\r\n          \"เบอร์โทร\",\r\n          \"แหล่งที่มา\",\r\n          \"เพศ\",\r\n        ];\r\n        \r\n        const allHeadersSet = new Set<string>();\r\n        const allHeaders: string[] = [];\r\n        \r\n        // First add mandatory fields in the column order\r\n        columnOrder.forEach((header) => {\r\n          if (mandatoryFields.includes(header) && !allHeadersSet.has(header)) {\r\n            allHeadersSet.add(header);\r\n            allHeaders.push(header);\r\n          }\r\n        });\r\n        \r\n        // Then add other headers in the desired order that exist in data\r\n        columnOrder.forEach((header) => {\r\n          if (!allHeadersSet.has(header)) {\r\n            sanitizedTables.forEach((table) => {\r\n              if (table.headers.includes(header) && !allHeadersSet.has(header)) {\r\n                allHeadersSet.add(header);\r\n                allHeaders.push(header);\r\n              }\r\n            });\r\n          }\r\n        });\r\n        // Then add any remaining headers not in the columnOrder\r\n        sanitizedTables.forEach((table: TableData) => {\r\n          table.headers.forEach((header: string) => {\r\n            if (!allHeadersSet.has(header)) {\r\n              allHeadersSet.add(header);\r\n              allHeaders.push(header);\r\n            }\r\n          });\r\n        });\r\n        \r\n        const filteredHeaders = allHeaders.filter((header: string) => {\r\n          // Exclude specified columns\r\n          const excludedColumns = [\r\n            \"รูป\",\r\n            \"อายุ\",\r\n            \"รหัสลูกค้า\",\r\n            \"อาชีพ\",\r\n            \"มาจากจังหวัด\",\r\n            \"จะเดินทางมารพ.ยังไง\",\r\n            \"Event ID\",\r\n            \"htmlLink\",\r\n            \"iCalUID\",\r\n            \"Log\",\r\n            \"Doc Calendar\",\r\n            \"Doc Event ID\",\r\n            \"Doc htmlLink\",\r\n            \"Doc iCalUID\",\r\n            \"line\",\r\n            \"line หมอ\",\r\n            \"IVR\",\r\n            \"TRANSFER_TO\",\r\n            \"status_call\",\r\n          ];\r\n          if (excludedColumns.includes(header)) {\r\n            return false;\r\n          }\r\n          // Always include mandatory fields\r\n          if (mandatoryFields.includes(header)) {\r\n            return true;\r\n          }\r\n          return sanitizedTables.some((table: TableData) => {\r\n            return table.data.some(\r\n              (row: Record<string, any>) =>\r\n                row[header] !== undefined &&\r\n                row[header] !== null &&\r\n                row[header] !== \"\"\r\n            );\r\n          });\r\n        });\r\n        const allData: Record<string, any>[] = [];\r\n        sanitizedTables.forEach((table: TableData) => {\r\n          allData.push(...table.data);\r\n        });\r\n        // Filter by customer type based on CN number (cn column from OPD system)\r\n        let typeFilteredData = allData;\r\n        if (customerType === \"existing\") {\r\n          // ลูกค้าเก่า - customers with CN number (opened OPD)\r\n          typeFilteredData = allData.filter((row) => {\r\n            const cnValue = row[\"cn\"];\r\n            return cnValue && cnValue.toString().trim() !== \"\";\r\n          });\r\n        } else if (customerType === \"new\") {\r\n          // ลูกค้าใหม่ - customers without CN number (not opened OPD yet)\r\n          typeFilteredData = allData.filter((row) => {\r\n            const cnValue = row[\"cn\"];\r\n            return !cnValue || cnValue.toString().trim() === \"\";\r\n          });\r\n        }\r\n        // Keep all rows that have at least one value in any header\r\n        const filteredData = typeFilteredData.filter((row) => {\r\n          return filteredHeaders.some((header) => {\r\n            const value = row[header];\r\n            return value !== undefined && value !== null && value !== \"\";\r\n          });\r\n        });\r\n        const mergedTable: TableData = {\r\n          tableNumber: 1,\r\n          headers: filteredHeaders,\r\n          rowCount: filteredData.length,\r\n          data: filteredData,\r\n        };\r\n        setTableData([mergedTable]);\r\n        const latestTimestamp = getLatestUpdatedAt(result.data);\r\n        if (latestTimestamp) {\r\n          setLastUpdateTimestamp(latestTimestamp);\r\n        }\r\n      } else {\r\n        setTableData([]);\r\n      }\r\n    } catch (err) {\r\n      // Error during fetch\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n  const fetchStatusOptions = async () => {\r\n    try {\r\n      const response = await fetch(\"/api/status-options\");\r\n      const result = await response.json();\r\n      if (result.success && result.data) {\r\n        setStatusOptions(result.data);\r\n      } else {\r\n        console.error(\"Failed to fetch status options:\", result.error);\r\n        // Fallback to default if API fails\r\n        setStatusOptions([\r\n          {\r\n            value: \"all\",\r\n            label: \"ทั้งหมด\",\r\n            color: \"bg-gray-200 text-gray-800\",\r\n          },\r\n        ]);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching status options:\", error);\r\n      // Fallback to default if API fails\r\n      setStatusOptions([\r\n        { value: \"all\", label: \"ทั้งหมด\", color: \"bg-gray-200 text-gray-800\" },\r\n      ]);\r\n    }\r\n  };\r\n\r\n  const fetchTableSizeOptions = async () => {\r\n    try {\r\n      const response = await fetch(\"/api/table-size-options\");\r\n      const result = await response.json();\r\n      if (result.success && result.data) {\r\n        setTableSizeOptions(result.data);\r\n      } else {\r\n        console.error(\"Failed to fetch table size options:\", result.error);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching table size options:\", error);\r\n    }\r\n  };\r\n  const fetchRealtimeUpdates = useCallback(async () => {\r\n    if (!lastUpdateTimestamp || tableDataRef.current.length === 0) {\r\n      return;\r\n    }\r\n    try {\r\n      const response = await fetch(\r\n        `/api/customer-updates?since=${encodeURIComponent(lastUpdateTimestamp)}`\r\n      );\r\n      const result = await response.json();\r\n      if (!response.ok || result.success === false) {\r\n        return;\r\n      }\r\n      if (!Array.isArray(result.data) || result.data.length === 0) {\r\n        return;\r\n      }\r\n      const currentTable = tableDataRef.current[0];\r\n      if (!currentTable) {\r\n        return;\r\n      }\r\n      const mergedMap = new Map<any, Record<string, any>>();\r\n      currentTable.data.forEach((row) => {\r\n        if (row.id !== undefined && row.id !== null) {\r\n          mergedMap.set(row.id, row);\r\n        }\r\n      });\r\n      result.data.forEach((incoming: Record<string, any>) => {\r\n        if (incoming.id === undefined || incoming.id === null) {\r\n          return;\r\n        }\r\n        const existing = mergedMap.get(incoming.id);\r\n        mergedMap.set(\r\n          incoming.id,\r\n          existing ? { ...existing, ...incoming } : incoming\r\n        );\r\n      });\r\n      const updatedData = Array.from(mergedMap.values());\r\n      const mergedHeaders = [...currentTable.headers];\r\n      (result.columns || []).forEach((column: string) => {\r\n        if (!mergedHeaders.includes(column)) {\r\n          mergedHeaders.push(column);\r\n        }\r\n      });\r\n      setTableData([\r\n        {\r\n          ...currentTable,\r\n          headers: mergedHeaders,\r\n          data: updatedData,\r\n          rowCount: updatedData.length,\r\n        },\r\n      ]);\r\n      if (result.latestUpdatedAt) {\r\n        setLastUpdateTimestamp(result.latestUpdatedAt);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching realtime updates:\", error);\r\n    }\r\n  }, [lastUpdateTimestamp]);\r\n  useEffect(() => {\r\n    tableDataRef.current = tableData;\r\n  }, [tableData]);\r\n  useEffect(() => {\r\n    // Check authentication and get user data\r\n    const checkAuth = () => {\r\n      const userStr = localStorage.getItem(\"user\");\r\n      if (!userStr) {\r\n        window.location.href = \"/login\";\r\n        return;\r\n      }\r\n      const user = JSON.parse(userStr);\r\n      setCurrentUser(user);\r\n    };\r\n    checkAuth();\r\n    fetchData();\r\n    fetchStatusOptions();\r\n    fetchTableSizeOptions();\r\n  }, []);\r\n  useEffect(() => {\r\n    if (!lastUpdateTimestamp || tableData.length === 0) {\r\n      return;\r\n    }\r\n    fetchRealtimeUpdates();\r\n    const interval = setInterval(fetchRealtimeUpdates, 8000);\r\n    return () => clearInterval(interval);\r\n  }, [lastUpdateTimestamp, fetchRealtimeUpdates, tableData.length]);\r\n\r\n  // Debounce search term - only update after 300ms of no typing and when 3+ chars\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      if (searchTerm.length >= 3 || searchTerm.length === 0) {\r\n        setDebouncedSearchTerm(searchTerm);\r\n      }\r\n    }, 300);\r\n    return () => clearTimeout(timer);\r\n  }, [searchTerm]);\r\n\r\n  // Close all menus when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      const target = event.target as HTMLElement;\r\n      // Close dropdowns when clicking outside the filter toolbar\r\n      if (!target.closest('.filter-toolbar')) {\r\n        closeAllFilterMenus();\r\n      }\r\n    };\r\n\r\n    // Add event listener\r\n    document.addEventListener(\"mousedown\", handleClickOutside);\r\n\r\n    // Cleanup\r\n    return () => {\r\n      document.removeEventListener(\"mousedown\", handleClickOutside);\r\n    };\r\n  }, []);\r\n  // Helper function to format date values and remove timezone\r\n  const formatDateValue = (value: any): string => {\r\n    if (!value) return \"\";\r\n    const strValue = String(value);\r\n\r\n    // Check if value contains ISO date format with timezone (T...Z)\r\n    if (strValue.includes(\"T\") && strValue.includes(\"Z\")) {\r\n      try {\r\n        // Extract just the date part (YYYY-MM-DD)\r\n        const dateOnly = strValue.split(\"T\")[0];\r\n        return dateOnly;\r\n      } catch (error) {\r\n        return strValue;\r\n      }\r\n    }\r\n\r\n    return strValue;\r\n  };\r\n\r\n  const handleSort = (column: string) => {\r\n    if (sortColumn === column) {\r\n      setSortDirection(sortDirection === \"asc\" ? \"desc\" : \"asc\");\r\n    } else {\r\n      setSortColumn(column);\r\n      setSortDirection(\"asc\");\r\n    }\r\n  };\r\n  const handleEditRow = (row: Record<string, any>) => {\r\n    setSelectedRow(row);\r\n    setEditedRow({ ...row });\r\n  };\r\n  const handleFieldChange = (fieldName: string, value: any) => {\r\n    if (editedRow) {\r\n      setEditedRow({\r\n        ...editedRow,\r\n        [fieldName]: value,\r\n      });\r\n    }\r\n  };\r\n  const handleSaveRow = () => {\r\n    if (editedRow) {\r\n      // Data saved successfully\r\n    }\r\n  };\r\n  const exportToCSV = () => {\r\n    if (tableData.length === 0) return;\r\n    const table = tableData[0];\r\n    const headers = table.headers.join(\",\");\r\n    const rows = filteredAndSortedData\r\n      .map((row) =>\r\n        table.headers\r\n          .map((header) => {\r\n            const value = row[header] || \"\";\r\n            const stringValue = String(value).replace(/\"/g, '\"\"');\r\n            return stringValue.includes(\",\") ? `\"${stringValue}\"` : stringValue;\r\n          })\r\n          .join(\",\")\r\n      )\r\n      .join(\"\\n\");\r\n    const csv = `\\ufeff${headers}\\n${rows}`;\r\n    const blob = new Blob([csv], { type: \"text/csv;charset=utf-8;\" });\r\n    const link = document.createElement(\"a\");\r\n    const url = URL.createObjectURL(blob);\r\n    link.setAttribute(\"href\", url);\r\n    link.setAttribute(\r\n      \"download\",\r\n      `customer_data_${new Date().toISOString().split(\"T\")[0]}.csv`\r\n    );\r\n    link.style.visibility = \"hidden\";\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  };\r\n  const exportToExcel = () => {\r\n    if (tableData.length === 0) return;\r\n    const table = tableData[0];\r\n    let html = '<html xmlns:x=\"urn:schemas-microsoft-com:office:excel\">';\r\n    html += '<head><meta charset=\"UTF-8\"></head><body>';\r\n    html += '<table border=\"1\">';\r\n    html += \"<tr>\";\r\n    table.headers.forEach((header) => {\r\n      html += `<th style=\"background-color: #fde047; font-weight: bold;\">${header}</th>`;\r\n    });\r\n    html += \"</tr>\";\r\n    filteredAndSortedData.forEach((row, idx) => {\r\n      const bgColor = idx % 2 === 0 ? \"#ffffff\" : \"#fbcfe8\";\r\n      html += `<tr style=\"background-color: ${bgColor};\">`;\r\n      table.headers.forEach((header) => {\r\n        const value = row[header] || \"-\";\r\n        html += `<td>${value}</td>`;\r\n      });\r\n      html += \"</tr>\";\r\n    });\r\n    html += \"</table></body></html>\";\r\n    const blob = new Blob([html], { type: \"application/vnd.ms-excel\" });\r\n    const link = document.createElement(\"a\");\r\n    const url = URL.createObjectURL(blob);\r\n    link.setAttribute(\"href\", url);\r\n    link.setAttribute(\r\n      \"download\",\r\n      `customer_data_${new Date().toISOString().split(\"T\")[0]}.xls`\r\n    );\r\n    link.style.visibility = \"hidden\";\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  };\r\n  const handleEditCustomer = (row: Record<string, any>) => {\r\n    console.log(\"🔧 Opening edit modal for:\", row);\r\n    setEditingCustomer(row);\r\n    setIsEditModalOpen(true);\r\n  };\r\n  const handleSaveCustomer = async (updatedData: Record<string, any>) => {\r\n    try {\r\n      const response = await fetch(\"/api/customer-data\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          action: \"update\",\r\n          data: updatedData,\r\n        }),\r\n      });\r\n      const result = await response.json();\r\n      if (result.success) {\r\n        setIsEditModalOpen(false);\r\n        // รีโหลดข้อมูลใหม่\r\n        await fetchData();\r\n      } else {\r\n        console.error(`เกิดข้อผิดพลาด: ${result.error}`);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"เกิดข้อผิดพลาดในการบันทึกข้อมูล\");\r\n    }\r\n  };\r\n\r\n  const handleAddCustomer = async (newData: Record<string, any>) => {\r\n    try {\r\n      const response = await fetch(\"/api/customer-data\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          action: \"create\",\r\n          data: newData,\r\n        }),\r\n      });\r\n      const result = await response.json();\r\n      if (result.success) {\r\n        setIsAddModalOpen(false);\r\n        // รีโหลดข้อมูลใหม่\r\n        await fetchData();\r\n      } else {\r\n        console.error(`เกิดข้อผิดพลาด: ${result.error}`);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"เกิดข้อผิดพลาดในการเพิ่มข้อมูล\");\r\n    }\r\n  };\r\n\r\n  const handleDeleteMultiple = async () => {\r\n    if (selectedIds.length === 0) {\r\n      alert(\"กรุณาเลือกรายการที่ต้องการลบ\");\r\n      return;\r\n    }\r\n\r\n    const confirmMessage = `คุณต้องการลบข้อมูล ${selectedIds.length\r\n      } รายการใช่หรือไม่?\\n\\nID ที่จะลบ: ${selectedIds.join(\r\n        \", \"\r\n      )}\\n\\nการดำเนินการนี้ไม่สามารถย้อนกลับได้`;\r\n\r\n    if (!confirm(confirmMessage)) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsDeleting(true);\r\n      const response = await fetch(\"/api/customer-data\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          action: \"deleteMultiple\",\r\n          data: { ids: selectedIds },\r\n        }),\r\n      });\r\n\r\n      const result = await response.json();\r\n\r\n      if (result.success) {\r\n        alert(`ลบข้อมูลสำเร็จ ${result.deletedCount} รายการ`);\r\n        setSelectedIds([]);\r\n        await fetchData();\r\n      } else {\r\n        alert(`เกิดข้อผิดพลาด: ${result.error}`);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"เกิดข้อผิดพลาดในการลบข้อมูล:\", error);\r\n      alert(\"เกิดข้อผิดพลาดในการลบข้อมูล\");\r\n    } finally {\r\n      setIsDeleting(false);\r\n    }\r\n  };\r\n\r\n  const handleToggleSelectAll = () => {\r\n    if (selectedIds.length === filteredAndSortedData.length) {\r\n      setSelectedIds([]);\r\n    } else {\r\n      const allIds = filteredAndSortedData\r\n        .map((row) => row[\"id\"])\r\n        .filter((id) => id != null);\r\n      setSelectedIds(allIds);\r\n    }\r\n  };\r\n\r\n  const handleToggleSelect = (id: number) => {\r\n    setSelectedIds((prev) => {\r\n      if (prev.includes(id)) {\r\n        return prev.filter((selectedId) => selectedId !== id);\r\n      } else {\r\n        return [...prev, id];\r\n      }\r\n    });\r\n  };\r\n  const filteredAndSortedData = useMemo(() => {\r\n    if (tableData.length === 0) return [];\r\n\r\n    // Only consider search term active if it has 3+ characters\r\n    const effectiveSearchTerm = debouncedSearchTerm.length >= 3 ? debouncedSearchTerm : \"\";\r\n\r\n    // Check if any filter is active - if not, return empty for performance\r\n    const hasActiveFilter =\r\n      statusFilter !== \"all\" ||\r\n      productFilter !== \"all\" ||\r\n      contactFilter !== \"all\" ||\r\n      followUpLastDate ||\r\n      followUpNextDate ||\r\n      consultDate ||\r\n      surgeryDate ||\r\n      getNameDate ||\r\n      getConsultApptDate ||\r\n      getSurgeryApptDate ||\r\n      effectiveSearchTerm;\r\n\r\n    // Return empty array if no filters applied (for mobile performance)\r\n    if (!hasActiveFilter) return [];\r\n\r\n    let filtered = [...tableData[0].data];\r\n    // Filter by current user if not superadmin or admin\r\n    if (\r\n      currentUser &&\r\n      currentUser.role_tag !== \"superadmin\" &&\r\n      currentUser.role_tag !== \"admin\"\r\n    ) {\r\n      const contactColumnIndex = tableData[0].headers.findIndex(\r\n        (h) =>\r\n          h.toLowerCase().includes(\"ผู้ติดต่อ\") ||\r\n          h.toLowerCase().includes(\"contact\") ||\r\n          h.toLowerCase().includes(\"ติดต่อ\")\r\n      );\r\n      if (contactColumnIndex !== -1) {\r\n        const contactColumn = tableData[0].headers[contactColumnIndex];\r\n        filtered = filtered.filter((row) => {\r\n          const value = row[contactColumn];\r\n          // Match by user's name\r\n          return value && String(value).trim() === currentUser.name;\r\n        });\r\n      }\r\n    }\r\n    if (statusFilter !== \"all\") {\r\n      const statusColumnIndex = tableData[0].headers.findIndex(\r\n        (h) =>\r\n          h.toLowerCase().includes(\"สถานะ\") ||\r\n          h.toLowerCase().includes(\"status\")\r\n      );\r\n      if (statusColumnIndex !== -1) {\r\n        const statusColumn = tableData[0].headers[statusColumnIndex];\r\n        filtered = filtered.filter((row) => {\r\n          const value = row[statusColumn];\r\n          return value && String(value).trim() === statusFilter;\r\n        });\r\n      }\r\n    }\r\n    if (productFilter !== \"all\") {\r\n      const productColumnIndex = tableData[0].headers.findIndex(\r\n        (h) =>\r\n          h.toLowerCase().includes(\"ผลิตภัณฑ์\") ||\r\n          h.toLowerCase().includes(\"product\") ||\r\n          h.toLowerCase().includes(\"สนใจ\")\r\n      );\r\n      if (productColumnIndex !== -1) {\r\n        const productColumn = tableData[0].headers[productColumnIndex];\r\n        filtered = filtered.filter((row) => {\r\n          const value = row[productColumn];\r\n          if (value) {\r\n            const products = String(value)\r\n              .split(/[,\\n]+/)\r\n              .map((p) => p.trim());\r\n            return products.some((p) => p === productFilter);\r\n          }\r\n          return false;\r\n        });\r\n      }\r\n    }\r\n    if (contactFilter !== \"all\") {\r\n      const contactColumnIndex = tableData[0].headers.findIndex(\r\n        (h) =>\r\n          h.toLowerCase().includes(\"ผู้ติดต่อ\") ||\r\n          h.toLowerCase().includes(\"contact\") ||\r\n          h.toLowerCase().includes(\"ติดต่อ\")\r\n      );\r\n      if (contactColumnIndex !== -1) {\r\n        const contactColumn = tableData[0].headers[contactColumnIndex];\r\n        filtered = filtered.filter((row) => {\r\n          const value = row[contactColumn];\r\n          return value && String(value).trim() === contactFilter;\r\n        });\r\n      }\r\n    }\r\n    const filterByDate = (columnName: string, dateValue: string) => {\r\n      if (!dateValue) return;\r\n      const dateColumnIndex = tableData[0].headers.findIndex(\r\n        (h) => h.trim() === columnName\r\n      );\r\n      if (dateColumnIndex !== -1) {\r\n        const dateColumn = tableData[0].headers[dateColumnIndex];\r\n        filtered = filtered.filter((row) => {\r\n          const value = row[dateColumn];\r\n          if (!value) return false;\r\n          const dateStr = String(value).trim();\r\n          let rowDate: Date | null = null;\r\n          const ddmmyyyyMatch = dateStr.match(/(\\d{1,2})\\/(\\d{1,2})\\/(\\d{4})/);\r\n          if (ddmmyyyyMatch) {\r\n            const [, day, month, year] = ddmmyyyyMatch;\r\n            rowDate = new Date(\r\n              parseInt(year),\r\n              parseInt(month) - 1,\r\n              parseInt(day)\r\n            );\r\n          } else if (dateStr.match(/\\d{4}-\\d{2}-\\d{2}/)) {\r\n            rowDate = new Date(dateStr);\r\n          }\r\n          if (!rowDate || isNaN(rowDate.getTime())) return false;\r\n          const filterDate = new Date(dateValue);\r\n\r\n          // Set time to start of day for comparison\r\n          filterDate.setHours(0, 0, 0, 0);\r\n          rowDate.setHours(0, 0, 0, 0);\r\n\r\n          return rowDate.getTime() === filterDate.getTime();\r\n        });\r\n      }\r\n    };\r\n    filterByDate(\"วันที่ติดตามครั้งล่าสุด\", followUpLastDate);\r\n    filterByDate(\"วันที่ติดตามครั้งถัดไป\", followUpNextDate);\r\n    filterByDate(\"วันที่ Consult\", consultDate);\r\n    filterByDate(\"วันที่ผ่าตัด\", surgeryDate);\r\n    filterByDate(\"วันที่ได้ชื่อ เบอร์\", getNameDate);\r\n    filterByDate(\"วันที่ได้นัด Consult\", getConsultApptDate);\r\n    filterByDate(\"วันที่ได้นัดผ่าตัด\", getSurgeryApptDate);\r\n    // Use effective search term (only if 3+ characters)\r\n    if (effectiveSearchTerm) {\r\n      filtered = filtered.filter((row) => {\r\n        if (filterColumn === \"all\") {\r\n          return tableData[0].headers.some((header) => {\r\n            const value = row[header];\r\n            return (\r\n              value &&\r\n              String(value).toLowerCase().includes(effectiveSearchTerm.toLowerCase())\r\n            );\r\n          });\r\n        } else {\r\n          const value = row[filterColumn];\r\n          return (\r\n            value &&\r\n            String(value).toLowerCase().includes(effectiveSearchTerm.toLowerCase())\r\n          );\r\n        }\r\n      });\r\n    }\r\n    if (sortColumn) {\r\n      filtered.sort((a, b) => {\r\n        const aVal = a[sortColumn] || \"\";\r\n        const bVal = b[sortColumn] || \"\";\r\n        const aStr = String(aVal).toLowerCase();\r\n        const bStr = String(bVal).toLowerCase();\r\n        if (aStr < bStr) return sortDirection === \"asc\" ? -1 : 1;\r\n        if (aStr > bStr) return sortDirection === \"asc\" ? 1 : -1;\r\n        return 0;\r\n      });\r\n    }\r\n    return filtered;\r\n  }, [\r\n    tableData,\r\n    debouncedSearchTerm,\r\n    filterColumn,\r\n    sortColumn,\r\n    sortDirection,\r\n    statusFilter,\r\n    productFilter,\r\n    contactFilter,\r\n    followUpLastDate,\r\n    currentUser,\r\n    followUpNextDate,\r\n    consultDate,\r\n    surgeryDate,\r\n    getNameDate,\r\n    getConsultApptDate,\r\n    getSurgeryApptDate,\r\n  ]);\r\n\r\n  // Helper to check if any filter is active (for UI display)\r\n  const hasActiveFilter = useMemo(() => {\r\n    const effectiveSearch = debouncedSearchTerm.length >= 3;\r\n    return (\r\n      statusFilter !== \"all\" ||\r\n      productFilter !== \"all\" ||\r\n      contactFilter !== \"all\" ||\r\n      followUpLastDate ||\r\n      followUpNextDate ||\r\n      consultDate ||\r\n      surgeryDate ||\r\n      getNameDate ||\r\n      getConsultApptDate ||\r\n      getSurgeryApptDate ||\r\n      effectiveSearch\r\n    );\r\n  }, [statusFilter, productFilter, contactFilter, followUpLastDate, followUpNextDate, consultDate, surgeryDate, getNameDate, getConsultApptDate, getSurgeryApptDate, debouncedSearchTerm]);\r\n\r\n  // Check if user is typing but hasn't reached minimum characters yet\r\n  const isTypingSearch = searchTerm.length > 0 && searchTerm.length < 3;\r\n\r\n  // Compact columns to show when filter/search is active\r\n  const compactColumns = [\"สถานะ\", \"ชื่อ\", \"เบอร์โทร\", \"ผลิตภัณฑ์ที่สนใจ\"];\r\n\r\n  // Get display headers based on filter state\r\n  const displayHeaders = useMemo(() => {\r\n    if (hasActiveFilter && tableData.length > 0) {\r\n      return compactColumns.filter(col => tableData[0].headers.includes(col));\r\n    }\r\n    return tableData.length > 0 ? tableData[0].headers : [];\r\n  }, [hasActiveFilter, tableData]);\r\n\r\n  const paginatedData = useMemo(() => {\r\n    const startIndex = (currentPage - 1) * itemsPerPage;\r\n    const endIndex = startIndex + itemsPerPage;\r\n    return filteredAndSortedData.slice(startIndex, endIndex);\r\n  }, [filteredAndSortedData, currentPage, itemsPerPage]);\r\n  const totalPages = Math.ceil(filteredAndSortedData.length / itemsPerPage);\r\n\r\n  // ฟังก์ชันสำหรับปิดตัวกรองทั้งหมด\r\n  const closeAllFilterMenus = () => {\r\n    setShowFilterMenu(false);\r\n    setShowStatusMenu(false);\r\n    setShowProductMenu(false);\r\n    setShowContactMenu(false);\r\n    setShowFollowUpLastMenu(false);\r\n    setShowFollowUpNextMenu(false);\r\n    setShowConsultMenu(false);\r\n    setShowSurgeryMenu(false);\r\n    setShowGetNameMenu(false);\r\n    setShowGetConsultApptMenu(false);\r\n    setShowGetSurgeryApptMenu(false);\r\n    setShowTableSizeMenu(false);\r\n  };\r\n\r\n  const contactOptions = [\r\n    { value: \"all\", label: \"ทั้งหมด\" },\r\n    { value: \"สา\", label: \"สา\" },\r\n    { value: \"เจ\", label: \"เจ\" },\r\n    { value: \"พิดยา\", label: \"พิดยา\" },\r\n    { value: \"ว่าน\", label: \"ว่าน\" },\r\n    { value: \"จีน\", label: \"จีน\" },\r\n    { value: \"มุก\", label: \"มุก\" },\r\n    { value: \"ตั้งโอ๋\", label: \"ตั้งโอ๋\" },\r\n  ];\r\n  const productOptions = [\r\n    { value: \"all\", label: \"ทั้งหมด\" },\r\n    { value: \"ตีตัวไล่ตัว\", label: \"ตีตัวไล่ตัว\" },\r\n    { value: \"Sub brow lift\", label: \"Sub brow lift\" },\r\n    { value: \"แก้ตาหมื่อตอนและแก้ว\", label: \"แก้ตาหมื่อตอนและแก้ว\" },\r\n    { value: \"ตาสองชั้น\", label: \"ตาสองชั้น\" },\r\n    { value: \"เสริมจมูก\", label: \"เสริมจมูก\" },\r\n    { value: \"แก้จมูก\", label: \"แก้จมูก\" },\r\n    { value: \"เสร็จตาขาว\", label: \"เสร็จตาขาว\" },\r\n    { value: \"ลิงหน้า\", label: \"ลิงหน้า\" },\r\n    { value: \"Skin\", label: \"Skin\" },\r\n    { value: \"ตื่อ\", label: \"ตื่อ\" },\r\n  ];\r\n  useEffect(() => {\r\n    setCurrentPage(1);\r\n  }, [\r\n    searchTerm,\r\n    filterColumn,\r\n    statusFilter,\r\n    productFilter,\r\n    contactFilter,\r\n    followUpLastDate,\r\n    followUpNextDate,\r\n    consultDate,\r\n    surgeryDate,\r\n    getNameDate,\r\n    getConsultApptDate,\r\n    getSurgeryApptDate,\r\n  ]);\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"w-full h-screen flex items-center justify-center bg-white\">\r\n        <div className=\"text-gray-600\">กำลังโหลดข้อมูล...</div>\r\n      </div>\r\n    );\r\n  }\r\n  return (\r\n    <>\r\n      <style>{customScrollbarStyle}</style>\r\n      <div className=\"w-full min-h-screen bg-gradient-to-b from-slate-50 to-slate-100 p-3 flex flex-col\">\r\n        {/* Header - Back and Add buttons */}\r\n        <div className=\"flex justify-between items-center mb-3\">\r\n          <button\r\n            onClick={() => router.push(\"/customer-selection\")}\r\n            className=\"flex items-center justify-center w-11 h-11 bg-white hover:bg-slate-50 text-slate-600 rounded-xl transition-all shadow-sm border border-slate-200 active:scale-95\"\r\n          >\r\n            <ArrowLeft className=\"w-5 h-5\" />\r\n          </button>\r\n          {/* Title showing customer type */}\r\n          <div className=\"flex-1 text-center\">\r\n            <h1 className=\"text-lg font-semibold text-slate-700\">\r\n              {customerType === \"existing\" ? \"ลูกค้าเก่า\" : customerType === \"new\" ? \"ลูกค้าใหม่\" : \"ลูกค้าทั้งหมด\"}\r\n            </h1>\r\n          </div>\r\n          <button\r\n            onClick={() => setIsAddModalOpen(true)}\r\n            className=\"flex items-center justify-center w-11 h-11 bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 text-white rounded-xl transition-all shadow-md active:scale-95\"\r\n          >\r\n            <Plus className=\"w-6 h-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Search Bar */}\r\n        <div className=\"mb-3\">\r\n          <div className=\"relative\">\r\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400\" />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"ค้นหาลูกค้า (พิมพ์อย่างน้อย 3 ตัวอักษร)...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              className={`w-full pl-10 pr-4 py-3 bg-white border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm text-sm ${isTypingSearch ? \"border-yellow-400\" : \"border-slate-200\"\r\n                }`}\r\n            />\r\n            {isTypingSearch && (\r\n              <span className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-yellow-600\">\r\n                +{3 - searchTerm.length}\r\n              </span>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Mobile Filter Button & Active Count */}\r\n        <div className=\"flex md:hidden items-center gap-2 mb-3\">\r\n          <button\r\n            onClick={() => setShowFilterSheet(true)}\r\n            className={`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-xl transition-all text-sm font-medium ${hasActiveFilter\r\n              ? \"bg-blue-500 text-white shadow-md\"\r\n              : \"bg-white text-slate-600 border border-slate-200 shadow-sm\"\r\n              }`}\r\n          >\r\n            <Filter className=\"w-5 h-5\" />\r\n            <span>ตัวกรอง</span>\r\n            {hasActiveFilter && (\r\n              <span className=\"bg-white text-blue-500 px-2 py-0.5 rounded-full text-xs font-bold\">\r\n                {[\r\n                  statusFilter !== \"all\",\r\n                  productFilter !== \"all\",\r\n                  contactFilter !== \"all\",\r\n                  followUpLastDate,\r\n                  followUpNextDate,\r\n                  consultDate,\r\n                  surgeryDate,\r\n                  getNameDate,\r\n                  getConsultApptDate,\r\n                  getSurgeryApptDate,\r\n                  searchTerm\r\n                ].filter(Boolean).length}\r\n              </span>\r\n            )}\r\n          </button>\r\n        </div>\r\n\r\n        {/* Mobile Delete Button - Show when items selected */}\r\n        {selectedIds.length > 0 && (\r\n          <div className=\"mb-3 md:hidden\">\r\n            <button\r\n              onClick={handleDeleteMultiple}\r\n              disabled={isDeleting}\r\n              className=\"w-full flex items-center justify-center gap-2 px-4 py-3 bg-rose-500 text-white rounded-xl text-sm font-medium hover:bg-rose-600 disabled:opacity-50 shadow-md\"\r\n            >\r\n              <X className=\"w-4 h-4\" />\r\n              {isDeleting ? \"กำลังลบ...\" : `ลบรายการที่เลือก (${selectedIds.length})`}\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Mobile Filter Bottom Sheet */}\r\n        {showFilterSheet && (\r\n          <div className=\"fixed inset-0 z-50 md:hidden\">\r\n            {/* Backdrop */}\r\n            <div\r\n              className=\"absolute inset-0 bg-black/50 transition-opacity\"\r\n              onClick={() => setShowFilterSheet(false)}\r\n            />\r\n\r\n            {/* Sheet */}\r\n            <div className=\"absolute bottom-0 left-0 right-0 bg-white rounded-t-3xl max-h-[85vh] overflow-hidden animate-slide-up\">\r\n              {/* Handle */}\r\n              <div className=\"flex justify-center py-3\">\r\n                <div className=\"w-10 h-1 bg-slate-300 rounded-full\" />\r\n              </div>\r\n\r\n              {/* Header */}\r\n              <div className=\"flex items-center justify-between px-4 pb-3 border-b border-slate-100\">\r\n                <h3 className=\"text-lg font-semibold text-slate-800\">ตัวกรอง</h3>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <button\r\n                    onClick={() => {\r\n                      setStatusFilter(\"all\");\r\n                      setProductFilter(\"all\");\r\n                      setContactFilter(\"all\");\r\n                      setFollowUpLastDate(\"\");\r\n                      setFollowUpNextDate(\"\");\r\n                      setConsultDate(\"\");\r\n                      setSurgeryDate(\"\");\r\n                      setGetNameDate(\"\");\r\n                      setGetConsultApptDate(\"\");\r\n                      setGetSurgeryApptDate(\"\");\r\n                    }}\r\n                    className=\"px-3 py-1.5 text-sm text-rose-500 hover:bg-rose-50 rounded-lg\"\r\n                  >\r\n                    ล้างทั้งหมด\r\n                  </button>\r\n                  <button\r\n                    onClick={() => setShowFilterSheet(false)}\r\n                    className=\"p-2 hover:bg-slate-100 rounded-full\"\r\n                  >\r\n                    <X className=\"w-5 h-5 text-slate-500\" />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Filter Content - Scrollable */}\r\n              <div className=\"overflow-y-auto max-h-[calc(85vh-120px)] px-4 py-4\">\r\n                {/* Status Filter */}\r\n                <div className=\"mb-5\">\r\n                  <label className=\"block text-sm font-medium text-slate-700 mb-2\">สถานะ</label>\r\n                  <select\r\n                    value={statusFilter}\r\n                    onChange={(e) => setStatusFilter(e.target.value)}\r\n                    className=\"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                  >\r\n                    <option value=\"all\">ทั้งหมด</option>\r\n                    {statusOptions.map((status) => (\r\n                      <option key={status.value} value={status.value}>{status.label}</option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n\r\n                {/* Product Filter */}\r\n                <div className=\"mb-5\">\r\n                  <label className=\"block text-sm font-medium text-slate-700 mb-2\">สินค้า</label>\r\n                  <select\r\n                    value={productFilter}\r\n                    onChange={(e) => setProductFilter(e.target.value)}\r\n                    className=\"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                  >\r\n                    {productOptions.map((product) => (\r\n                      <option key={product.value} value={product.value}>{product.label}</option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n\r\n                {/* Contact Filter - Only for admin */}\r\n                {currentUser && (currentUser.role_tag === \"superadmin\" || currentUser.role_tag === \"admin\") && (\r\n                  <div className=\"mb-5\">\r\n                    <label className=\"block text-sm font-medium text-slate-700 mb-2\">ผู้ติดต่อ</label>\r\n                    <select\r\n                      value={contactFilter}\r\n                      onChange={(e) => setContactFilter(e.target.value)}\r\n                      className=\"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                    >\r\n                      {contactOptions.map((contact) => (\r\n                        <option key={contact.value} value={contact.value}>{contact.label}</option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Date Filters Section */}\r\n                <div className=\"mb-2\">\r\n                  <label className=\"block text-sm font-medium text-slate-700 mb-3\">กรองตามวันที่</label>\r\n\r\n                  <div className=\"space-y-4\">\r\n                    {/* วันติดตาม-ล่าสุด */}\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <span className=\"text-xs text-slate-500 w-24 shrink-0\">ติดตาม-ล่าสุด</span>\r\n                      <input\r\n                        type=\"date\"\r\n                        value={followUpLastDate}\r\n                        onChange={(e) => setFollowUpLastDate(e.target.value)}\r\n                        className=\"flex-1 px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                      />\r\n                      {followUpLastDate && (\r\n                        <button onClick={() => setFollowUpLastDate(\"\")} className=\"p-1 text-rose-500\">\r\n                          <X className=\"w-4 h-4\" />\r\n                        </button>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* วันติดตาม-ถัดไป */}\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <span className=\"text-xs text-slate-500 w-24 shrink-0\">ติดตาม-ถัดไป</span>\r\n                      <input\r\n                        type=\"date\"\r\n                        value={followUpNextDate}\r\n                        onChange={(e) => setFollowUpNextDate(e.target.value)}\r\n                        className=\"flex-1 px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                      />\r\n                      {followUpNextDate && (\r\n                        <button onClick={() => setFollowUpNextDate(\"\")} className=\"p-1 text-rose-500\">\r\n                          <X className=\"w-4 h-4\" />\r\n                        </button>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* วันที่ Consult */}\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <span className=\"text-xs text-slate-500 w-24 shrink-0\">วัน Consult</span>\r\n                      <input\r\n                        type=\"date\"\r\n                        value={consultDate}\r\n                        onChange={(e) => setConsultDate(e.target.value)}\r\n                        className=\"flex-1 px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                      />\r\n                      {consultDate && (\r\n                        <button onClick={() => setConsultDate(\"\")} className=\"p-1 text-rose-500\">\r\n                          <X className=\"w-4 h-4\" />\r\n                        </button>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* วันที่ผ่าตัด */}\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <span className=\"text-xs text-slate-500 w-24 shrink-0\">วันผ่าตัด</span>\r\n                      <input\r\n                        type=\"date\"\r\n                        value={surgeryDate}\r\n                        onChange={(e) => setSurgeryDate(e.target.value)}\r\n                        className=\"flex-1 px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                      />\r\n                      {surgeryDate && (\r\n                        <button onClick={() => setSurgeryDate(\"\")} className=\"p-1 text-rose-500\">\r\n                          <X className=\"w-4 h-4\" />\r\n                        </button>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* วันได้ชื่อ */}\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <span className=\"text-xs text-slate-500 w-24 shrink-0\">วันได้ชื่อ</span>\r\n                      <input\r\n                        type=\"date\"\r\n                        value={getNameDate}\r\n                        onChange={(e) => setGetNameDate(e.target.value)}\r\n                        className=\"flex-1 px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                      />\r\n                      {getNameDate && (\r\n                        <button onClick={() => setGetNameDate(\"\")} className=\"p-1 text-rose-500\">\r\n                          <X className=\"w-4 h-4\" />\r\n                        </button>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* วันได้นัด Consult */}\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <span className=\"text-xs text-slate-500 w-24 shrink-0\">ได้นัด Consult</span>\r\n                      <input\r\n                        type=\"date\"\r\n                        value={getConsultApptDate}\r\n                        onChange={(e) => setGetConsultApptDate(e.target.value)}\r\n                        className=\"flex-1 px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                      />\r\n                      {getConsultApptDate && (\r\n                        <button onClick={() => setGetConsultApptDate(\"\")} className=\"p-1 text-rose-500\">\r\n                          <X className=\"w-4 h-4\" />\r\n                        </button>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* วันได้นัดผ่าตัด */}\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <span className=\"text-xs text-slate-500 w-24 shrink-0\">ได้นัดผ่าตัด</span>\r\n                      <input\r\n                        type=\"date\"\r\n                        value={getSurgeryApptDate}\r\n                        onChange={(e) => setGetSurgeryApptDate(e.target.value)}\r\n                        className=\"flex-1 px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                      />\r\n                      {getSurgeryApptDate && (\r\n                        <button onClick={() => setGetSurgeryApptDate(\"\")} className=\"p-1 text-rose-500\">\r\n                          <X className=\"w-4 h-4\" />\r\n                        </button>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Apply Button */}\r\n              <div className=\"px-4 py-4 border-t border-slate-100 bg-white\">\r\n                <button\r\n                  onClick={() => setShowFilterSheet(false)}\r\n                  className=\"w-full py-3 bg-blue-500 text-white rounded-xl font-medium hover:bg-blue-600 transition-colors\"\r\n                >\r\n                  แสดงผลลัพธ์\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Desktop Filters - Hidden on mobile */}\r\n        <div className=\"hidden md:block bg-white rounded-xl shadow-sm border border-slate-200 p-4 mb-4\">\r\n          <div className=\"flex flex-wrap items-center gap-3 mb-3 filter-toolbar\">\r\n            {/* Status Filter */}\r\n            <div className=\"relative\">\r\n              <button\r\n                onClick={() => {\r\n                  closeAllFilterMenus();\r\n                  setShowStatusMenu(!showStatusMenu);\r\n                }}\r\n                className={`px-4 py-2 rounded-lg flex items-center gap-2 transition-all text-sm font-medium border ${statusFilter !== \"all\"\r\n                  ? \"bg-cyan-50 border-cyan-300 text-cyan-700\"\r\n                  : \"bg-white border-slate-200 text-slate-600 hover:bg-slate-50\"\r\n                  }`}\r\n              >\r\n                <span>สถานะ</span>\r\n                <ChevronDown className={`w-4 h-4 transition-transform ${showStatusMenu ? \"rotate-180\" : \"\"}`} />\r\n              </button>\r\n              {showStatusMenu && (\r\n                <div className=\"absolute top-full left-0 mt-2 bg-white border border-slate-200 rounded-xl shadow-lg z-50 min-w-[200px] overflow-hidden\">\r\n                  <div className=\"max-h-64 overflow-y-auto\">\r\n                    {statusOptions.map((status) => (\r\n                      <button\r\n                        key={status.value}\r\n                        onClick={() => {\r\n                          setStatusFilter(status.value);\r\n                          setShowStatusMenu(false);\r\n                        }}\r\n                        className={`w-full text-left px-4 py-2.5 transition-all text-sm ${statusFilter === status.value\r\n                          ? \"bg-cyan-50 text-cyan-700 font-medium\"\r\n                          : \"text-slate-600 hover:bg-slate-50\"\r\n                          }`}\r\n                      >\r\n                        {statusFilter === status.value && \"✓ \"}\r\n                        {status.label}\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Product Filter */}\r\n            <div className=\"relative\">\r\n              <button\r\n                onClick={() => {\r\n                  closeAllFilterMenus();\r\n                  setShowProductMenu(!showProductMenu);\r\n                }}\r\n                className={`px-4 py-2 rounded-lg flex items-center gap-2 transition-all text-sm font-medium border ${productFilter !== \"all\"\r\n                  ? \"bg-indigo-50 border-indigo-300 text-indigo-700\"\r\n                  : \"bg-white border-slate-200 text-slate-600 hover:bg-slate-50\"\r\n                  }`}\r\n              >\r\n                <span>สินค้า</span>\r\n                <ChevronDown className={`w-4 h-4 transition-transform ${showProductMenu ? \"rotate-180\" : \"\"}`} />\r\n              </button>\r\n              {showProductMenu && (\r\n                <div className=\"absolute top-full left-0 mt-2 bg-white border border-slate-200 rounded-xl shadow-lg z-50 min-w-[200px] overflow-hidden\">\r\n                  <div className=\"max-h-64 overflow-y-auto\">\r\n                    {productOptions.map((product) => (\r\n                      <button\r\n                        key={product.value}\r\n                        onClick={() => {\r\n                          setProductFilter(product.value);\r\n                          setShowProductMenu(false);\r\n                        }}\r\n                        className={`w-full text-left px-4 py-2.5 transition-all text-sm ${productFilter === product.value\r\n                          ? \"bg-indigo-50 text-indigo-700 font-medium\"\r\n                          : \"text-slate-600 hover:bg-slate-50\"\r\n                          }`}\r\n                      >\r\n                        {productFilter === product.value && \"✓ \"}\r\n                        {product.label}\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Contact Filter - Only for admin */}\r\n            {currentUser && (currentUser.role_tag === \"superadmin\" || currentUser.role_tag === \"admin\") && (\r\n              <div className=\"relative\">\r\n                <button\r\n                  onClick={() => {\r\n                    closeAllFilterMenus();\r\n                    setShowContactMenu(!showContactMenu);\r\n                  }}\r\n                  className={`px-4 py-2 rounded-lg flex items-center gap-2 transition-all text-sm font-medium border ${contactFilter !== \"all\"\r\n                    ? \"bg-rose-50 border-rose-300 text-rose-700\"\r\n                    : \"bg-white border-slate-200 text-slate-600 hover:bg-slate-50\"\r\n                    }`}\r\n                >\r\n                  <span>ผู้ติดต่อ</span>\r\n                  <ChevronDown className={`w-4 h-4 transition-transform ${showContactMenu ? \"rotate-180\" : \"\"}`} />\r\n                </button>\r\n                {showContactMenu && (\r\n                  <div className=\"absolute top-full left-0 mt-2 bg-white border border-slate-200 rounded-xl shadow-lg z-50 min-w-[180px] overflow-hidden\">\r\n                    <div className=\"max-h-64 overflow-y-auto\">\r\n                      {contactOptions.map((contact) => (\r\n                        <button\r\n                          key={contact.value}\r\n                          onClick={() => {\r\n                            setContactFilter(contact.value);\r\n                            setShowContactMenu(false);\r\n                          }}\r\n                          className={`w-full text-left px-4 py-2.5 transition-all text-sm ${contactFilter === contact.value\r\n                            ? \"bg-rose-50 text-rose-700 font-medium\"\r\n                            : \"text-slate-600 hover:bg-slate-50\"\r\n                            }`}\r\n                        >\r\n                          {contactFilter === contact.value && \"✓ \"}\r\n                          {contact.label}\r\n                        </button>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {/* Date Filters */}\r\n            <div className=\"relative\">\r\n              <button\r\n                onClick={() => {\r\n                  closeAllFilterMenus();\r\n                  setShowFollowUpLastMenu(!showFollowUpLastMenu);\r\n                }}\r\n                className={`px-4 py-2 rounded-lg flex items-center gap-2 transition-all text-sm font-medium border ${followUpLastDate\r\n                  ? \"bg-emerald-50 border-emerald-300 text-emerald-700\"\r\n                  : \"bg-white border-slate-200 text-slate-600 hover:bg-slate-50\"\r\n                  }`}\r\n              >\r\n                <span>ติดตาม-ล่าสุด</span>\r\n                <ChevronDown className={`w-4 h-4 transition-transform ${showFollowUpLastMenu ? \"rotate-180\" : \"\"}`} />\r\n              </button>\r\n              {showFollowUpLastMenu && (\r\n                <div className=\"absolute top-full left-0 mt-2 bg-white border border-slate-200 rounded-xl shadow-lg z-50 p-3 w-64\">\r\n                  <input\r\n                    type=\"date\"\r\n                    value={followUpLastDate}\r\n                    onChange={(e) => setFollowUpLastDate(e.target.value)}\r\n                    className=\"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-sm\"\r\n                  />\r\n                  {followUpLastDate && (\r\n                    <button onClick={() => setFollowUpLastDate(\"\")} className=\"mt-2 w-full px-3 py-2 text-sm text-rose-600 hover:bg-rose-50 rounded-lg\">\r\n                      ล้างตัวกรอง\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"relative\">\r\n              <button\r\n                onClick={() => {\r\n                  closeAllFilterMenus();\r\n                  setShowFollowUpNextMenu(!showFollowUpNextMenu);\r\n                }}\r\n                className={`px-4 py-2 rounded-lg flex items-center gap-2 transition-all text-sm font-medium border ${followUpNextDate\r\n                  ? \"bg-violet-50 border-violet-300 text-violet-700\"\r\n                  : \"bg-white border-slate-200 text-slate-600 hover:bg-slate-50\"\r\n                  }`}\r\n              >\r\n                <span>ติดตาม-ถัดไป</span>\r\n                <ChevronDown className={`w-4 h-4 transition-transform ${showFollowUpNextMenu ? \"rotate-180\" : \"\"}`} />\r\n              </button>\r\n              {showFollowUpNextMenu && (\r\n                <div className=\"absolute top-full left-0 mt-2 bg-white border border-slate-200 rounded-xl shadow-lg z-50 p-3 w-64\">\r\n                  <input\r\n                    type=\"date\"\r\n                    value={followUpNextDate}\r\n                    onChange={(e) => setFollowUpNextDate(e.target.value)}\r\n                    className=\"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-violet-500 focus:border-transparent text-sm\"\r\n                  />\r\n                  {followUpNextDate && (\r\n                    <button onClick={() => setFollowUpNextDate(\"\")} className=\"mt-2 w-full px-3 py-2 text-sm text-rose-600 hover:bg-rose-50 rounded-lg\">\r\n                      ล้างตัวกรอง\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"relative\">\r\n              <button\r\n                onClick={() => {\r\n                  closeAllFilterMenus();\r\n                  setShowConsultMenu(!showConsultMenu);\r\n                }}\r\n                className={`px-4 py-2 rounded-lg flex items-center gap-2 transition-all text-sm font-medium border ${consultDate\r\n                  ? \"bg-fuchsia-50 border-fuchsia-300 text-fuchsia-700\"\r\n                  : \"bg-white border-slate-200 text-slate-600 hover:bg-slate-50\"\r\n                  }`}\r\n              >\r\n                <span>Consult</span>\r\n                <ChevronDown className={`w-4 h-4 transition-transform ${showConsultMenu ? \"rotate-180\" : \"\"}`} />\r\n              </button>\r\n              {showConsultMenu && (\r\n                <div className=\"absolute top-full left-0 mt-2 bg-white border border-slate-200 rounded-xl shadow-lg z-50 p-3 w-64\">\r\n                  <input\r\n                    type=\"date\"\r\n                    value={consultDate}\r\n                    onChange={(e) => setConsultDate(e.target.value)}\r\n                    className=\"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-fuchsia-500 focus:border-transparent text-sm\"\r\n                  />\r\n                  {consultDate && (\r\n                    <button onClick={() => setConsultDate(\"\")} className=\"mt-2 w-full px-3 py-2 text-sm text-rose-600 hover:bg-rose-50 rounded-lg\">\r\n                      ล้างตัวกรอง\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"relative\">\r\n              <button\r\n                onClick={() => {\r\n                  closeAllFilterMenus();\r\n                  setShowSurgeryMenu(!showSurgeryMenu);\r\n                }}\r\n                className={`px-4 py-2 rounded-lg flex items-center gap-2 transition-all text-sm font-medium border ${surgeryDate\r\n                  ? \"bg-orange-50 border-orange-300 text-orange-700\"\r\n                  : \"bg-white border-slate-200 text-slate-600 hover:bg-slate-50\"\r\n                  }`}\r\n              >\r\n                <span>ผ่าตัด</span>\r\n                <ChevronDown className={`w-4 h-4 transition-transform ${showSurgeryMenu ? \"rotate-180\" : \"\"}`} />\r\n              </button>\r\n              {showSurgeryMenu && (\r\n                <div className=\"absolute top-full left-0 mt-2 bg-white border border-slate-200 rounded-xl shadow-lg z-50 p-3 w-64\">\r\n                  <input\r\n                    type=\"date\"\r\n                    value={surgeryDate}\r\n                    onChange={(e) => setSurgeryDate(e.target.value)}\r\n                    className=\"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm\"\r\n                  />\r\n                  {surgeryDate && (\r\n                    <button onClick={() => setSurgeryDate(\"\")} className=\"mt-2 w-full px-3 py-2 text-sm text-rose-600 hover:bg-rose-50 rounded-lg\">\r\n                      ล้างตัวกรอง\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"relative\">\r\n              <button\r\n                onClick={() => {\r\n                  closeAllFilterMenus();\r\n                  setShowGetNameMenu(!showGetNameMenu);\r\n                }}\r\n                className={`px-4 py-2 rounded-lg flex items-center gap-2 transition-all text-sm font-medium border ${getNameDate\r\n                  ? \"bg-teal-50 border-teal-300 text-teal-700\"\r\n                  : \"bg-white border-slate-200 text-slate-600 hover:bg-slate-50\"\r\n                  }`}\r\n              >\r\n                <span>วันได้ชื่อ</span>\r\n                <ChevronDown className={`w-4 h-4 transition-transform ${showGetNameMenu ? \"rotate-180\" : \"\"}`} />\r\n              </button>\r\n              {showGetNameMenu && (\r\n                <div className=\"absolute top-full left-0 mt-2 bg-white border border-slate-200 rounded-xl shadow-lg z-50 p-3 w-64\">\r\n                  <input\r\n                    type=\"date\"\r\n                    value={getNameDate}\r\n                    onChange={(e) => setGetNameDate(e.target.value)}\r\n                    className=\"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm\"\r\n                  />\r\n                  {getNameDate && (\r\n                    <button onClick={() => setGetNameDate(\"\")} className=\"mt-2 w-full px-3 py-2 text-sm text-rose-600 hover:bg-rose-50 rounded-lg\">\r\n                      ล้างตัวกรอง\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"relative\">\r\n              <button\r\n                onClick={() => {\r\n                  closeAllFilterMenus();\r\n                  setShowGetConsultApptMenu(!showGetConsultApptMenu);\r\n                }}\r\n                className={`px-4 py-2 rounded-lg flex items-center gap-2 transition-all text-sm font-medium border ${getConsultApptDate\r\n                  ? \"bg-sky-50 border-sky-300 text-sky-700\"\r\n                  : \"bg-white border-slate-200 text-slate-600 hover:bg-slate-50\"\r\n                  }`}\r\n              >\r\n                <span>ได้นัด Consult</span>\r\n                <ChevronDown className={`w-4 h-4 transition-transform ${showGetConsultApptMenu ? \"rotate-180\" : \"\"}`} />\r\n              </button>\r\n              {showGetConsultApptMenu && (\r\n                <div className=\"absolute top-full left-0 mt-2 bg-white border border-slate-200 rounded-xl shadow-lg z-50 p-3 w-64\">\r\n                  <input\r\n                    type=\"date\"\r\n                    value={getConsultApptDate}\r\n                    onChange={(e) => setGetConsultApptDate(e.target.value)}\r\n                    className=\"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent text-sm\"\r\n                  />\r\n                  {getConsultApptDate && (\r\n                    <button onClick={() => setGetConsultApptDate(\"\")} className=\"mt-2 w-full px-3 py-2 text-sm text-rose-600 hover:bg-rose-50 rounded-lg\">\r\n                      ล้างตัวกรอง\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"relative\">\r\n              <button\r\n                onClick={() => {\r\n                  closeAllFilterMenus();\r\n                  setShowGetSurgeryApptMenu(!showGetSurgeryApptMenu);\r\n                }}\r\n                className={`px-4 py-2 rounded-lg flex items-center gap-2 transition-all text-sm font-medium border ${getSurgeryApptDate\r\n                  ? \"bg-amber-50 border-amber-300 text-amber-700\"\r\n                  : \"bg-white border-slate-200 text-slate-600 hover:bg-slate-50\"\r\n                  }`}\r\n              >\r\n                <span>ได้นัดผ่าตัด</span>\r\n                <ChevronDown className={`w-4 h-4 transition-transform ${showGetSurgeryApptMenu ? \"rotate-180\" : \"\"}`} />\r\n              </button>\r\n              {showGetSurgeryApptMenu && (\r\n                <div className=\"absolute top-full left-0 mt-2 bg-white border border-slate-200 rounded-xl shadow-lg z-50 p-3 w-64\">\r\n                  <input\r\n                    type=\"date\"\r\n                    value={getSurgeryApptDate}\r\n                    onChange={(e) => setGetSurgeryApptDate(e.target.value)}\r\n                    className=\"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent text-sm\"\r\n                  />\r\n                  {getSurgeryApptDate && (\r\n                    <button onClick={() => setGetSurgeryApptDate(\"\")} className=\"mt-2 w-full px-3 py-2 text-sm text-rose-600 hover:bg-rose-50 rounded-lg\">\r\n                      ล้างตัวกรอง\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Clear All Filters */}\r\n            {hasActiveFilter && (\r\n              <button\r\n                onClick={() => {\r\n                  setStatusFilter(\"all\");\r\n                  setProductFilter(\"all\");\r\n                  setContactFilter(\"all\");\r\n                  setFollowUpLastDate(\"\");\r\n                  setFollowUpNextDate(\"\");\r\n                  setConsultDate(\"\");\r\n                  setSurgeryDate(\"\");\r\n                  setGetNameDate(\"\");\r\n                  setGetConsultApptDate(\"\");\r\n                  setGetSurgeryApptDate(\"\");\r\n                }}\r\n                className=\"px-4 py-2 bg-rose-500 text-white rounded-lg text-sm font-medium hover:bg-rose-600\"\r\n              >\r\n                ล้างทั้งหมด\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          {/* Results count and delete button */}\r\n          <div className=\"flex justify-between items-center pt-3 border-t border-slate-100\">\r\n            <span className=\"text-sm text-slate-600\">\r\n              <span className=\"font-medium\">{filteredAndSortedData.length}</span> รายการ\r\n            </span>\r\n            {selectedIds.length > 0 && (\r\n              <button\r\n                onClick={handleDeleteMultiple}\r\n                disabled={isDeleting}\r\n                className=\"flex items-center gap-2 px-4 py-2 bg-rose-500 text-white rounded-lg text-sm font-medium hover:bg-rose-600 disabled:opacity-50\"\r\n              >\r\n                <X className=\"w-4 h-4\" />\r\n                {isDeleting ? \"กำลังลบ...\" : `ลบรายการที่เลือก (${selectedIds.length})`}\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Pagination - Only show when filter is active (mobile) */}\r\n        {hasActiveFilter &&\r\n          tableData.length > 0 && totalPages > 1 && (\r\n            <div className=\"flex md:hidden justify-center items-center gap-1 mb-3\">\r\n              <button\r\n                onClick={() => setCurrentPage(currentPage - 1)}\r\n                disabled={currentPage === 1}\r\n                className=\"px-3 py-2 bg-white border border-slate-200 rounded-lg text-sm disabled:opacity-50 shadow-sm\"\r\n              >\r\n                ←\r\n              </button>\r\n              <div className=\"flex items-center gap-1\">\r\n                {Array.from({ length: Math.min(5, totalPages) }, (_, i) => {\r\n                  let page;\r\n                  if (totalPages <= 5) {\r\n                    page = i + 1;\r\n                  } else if (currentPage <= 3) {\r\n                    page = i + 1;\r\n                  } else if (currentPage >= totalPages - 2) {\r\n                    page = totalPages - 4 + i;\r\n                  } else {\r\n                    page = currentPage - 2 + i;\r\n                  }\r\n                  return (\r\n                    <button\r\n                      key={page}\r\n                      onClick={() => setCurrentPage(page)}\r\n                      className={`px-3 py-2 rounded-lg text-sm font-medium transition-all ${page === currentPage\r\n                        ? \"bg-blue-500 text-white shadow-md\"\r\n                        : \"bg-white border border-slate-200 text-slate-600 hover:bg-slate-50\"\r\n                        }`}\r\n                    >\r\n                      {page}\r\n                    </button>\r\n                  );\r\n                })}\r\n                {totalPages > 5 && currentPage < totalPages - 2 && (\r\n                  <>\r\n                    <span className=\"text-slate-400\">...</span>\r\n                    <button\r\n                      onClick={() => setCurrentPage(totalPages)}\r\n                      className=\"px-3 py-2 bg-white border border-slate-200 rounded-lg text-sm text-slate-600 hover:bg-slate-50\"\r\n                    >\r\n                      {totalPages}\r\n                    </button>\r\n                  </>\r\n                )}\r\n              </div>\r\n              <button\r\n                onClick={() => setCurrentPage(currentPage + 1)}\r\n                disabled={currentPage === totalPages}\r\n                className=\"px-3 py-2 bg-white border border-slate-200 rounded-lg text-sm disabled:opacity-50 shadow-sm\"\r\n              >\r\n                →\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n        {/* Desktop Pagination - Always show */}\r\n        {tableData.length > 0 && totalPages > 1 && (\r\n          <div className=\"hidden md:flex justify-center items-center gap-1 mb-3\">\r\n            <button\r\n              onClick={() => setCurrentPage(currentPage - 1)}\r\n              disabled={currentPage === 1}\r\n              className=\"px-3 py-2 bg-white border border-slate-200 rounded-lg text-sm disabled:opacity-50 shadow-sm\"\r\n            >\r\n              ←\r\n            </button>\r\n            <div className=\"flex items-center gap-1\">\r\n              {Array.from({ length: Math.min(5, totalPages) }, (_, i) => {\r\n                let page;\r\n                if (totalPages <= 5) {\r\n                  page = i + 1;\r\n                } else if (currentPage <= 3) {\r\n                  page = i + 1;\r\n                } else if (currentPage >= totalPages - 2) {\r\n                  page = totalPages - 4 + i;\r\n                } else {\r\n                  page = currentPage - 2 + i;\r\n                }\r\n                return (\r\n                  <button\r\n                    key={page}\r\n                    onClick={() => setCurrentPage(page)}\r\n                    className={`px-3 py-2 rounded-lg text-sm font-medium transition-all ${page === currentPage\r\n                      ? \"bg-blue-500 text-white shadow-md\"\r\n                      : \"bg-white border border-slate-200 text-slate-600 hover:bg-slate-50\"\r\n                      }`}\r\n                  >\r\n                    {page}\r\n                  </button>\r\n                );\r\n              })}\r\n              {totalPages > 5 && currentPage < totalPages - 2 && (\r\n                <>\r\n                  <span className=\"text-slate-400\">...</span>\r\n                  <button\r\n                    onClick={() => setCurrentPage(totalPages)}\r\n                    className=\"px-3 py-2 bg-white border border-slate-200 rounded-lg text-sm text-slate-600 hover:bg-slate-50\"\r\n                  >\r\n                    {totalPages}\r\n                  </button>\r\n                </>\r\n              )}\r\n            </div>\r\n            <button\r\n              onClick={() => setCurrentPage(currentPage + 1)}\r\n              disabled={currentPage === totalPages}\r\n              className=\"px-3 py-2 bg-white border border-slate-200 rounded-lg text-sm disabled:opacity-50 shadow-sm\"\r\n            >\r\n              →\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Mobile: Show message when no filter applied */}\r\n        {!hasActiveFilter && (\r\n          <div className=\"md:hidden flex-1 flex flex-col items-center justify-center py-16\">\r\n            <Filter className=\"w-16 h-16 text-slate-300 mb-4\" />\r\n            {isTypingSearch ? (\r\n              <p className=\"text-slate-500 text-center text-sm\">\r\n                พิมพ์อีก {3 - searchTerm.length} ตัวอักษรเพื่อค้นหา\r\n              </p>\r\n            ) : (\r\n              <p className=\"text-slate-500 text-center text-sm\">กรุณาเลือกตัวกรองหรือพิมพ์อย่างน้อย 3 ตัวอักษรเพื่อค้นหา</p>\r\n            )}\r\n            <button\r\n              onClick={() => setShowFilterSheet(true)}\r\n              className=\"mt-4 px-6 py-2 bg-blue-500 text-white rounded-xl text-sm font-medium hover:bg-blue-600 transition-colors\"\r\n            >\r\n              เลือกตัวกรอง\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Data Table - Desktop always shows, Mobile only when filter active */}\r\n        {hasActiveFilter &&\r\n          tableData.length > 0 && (\r\n            <div className=\"md:hidden bg-white rounded-lg shadow-md overflow-hidden mb-4\">\r\n              {/* Horizontal scrollbar on top */}\r\n              <div\r\n                className=\"overflow-x-auto custom-scrollbar-horizontal\"\r\n                style={{\r\n                  overflowY: \"hidden\",\r\n                  height: \"12px\",\r\n                }}\r\n                onScroll={(e) => {\r\n                  const target = e.currentTarget;\r\n                  const tableContainer = target.nextElementSibling as HTMLElement;\r\n                  if (tableContainer) {\r\n                    tableContainer.scrollLeft = target.scrollLeft;\r\n                  }\r\n                }}\r\n              >\r\n                <div\r\n                  style={{\r\n                    width: tableData[0].headers.length * 150 + \"px\",\r\n                    height: \"1px\",\r\n                  }}\r\n                />\r\n              </div>\r\n              <div\r\n                className=\"overflow-x-auto overflow-y-auto custom-scrollbar\"\r\n                style={{\r\n                  maxHeight: `calc(100vh + ${tableSize}px)`,\r\n                  position: \"relative\",\r\n                }}\r\n                onScroll={(e) => {\r\n                  const target = e.currentTarget;\r\n                  const topScroller =\r\n                    target.previousElementSibling as HTMLElement;\r\n                  if (topScroller) {\r\n                    topScroller.scrollLeft = target.scrollLeft;\r\n                  }\r\n                }}\r\n              >\r\n                <table\r\n                  className=\"w-full border-collapse text-sm table-auto\"\r\n                  style={{ position: \"relative\", zIndex: 1 }}\r\n                >\r\n                  <thead className=\"sticky top-0 z-30 bg-yellow-300\">\r\n                    <tr className=\"bg-yellow-300 border border-gray-400\">\r\n                      <th className=\"px-3 py-2 text-center font-bold text-gray-900 border-r border-gray-400\">\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={\r\n                            selectedIds.length === filteredAndSortedData.length &&\r\n                            filteredAndSortedData.length > 0\r\n                          }\r\n                          onChange={handleToggleSelectAll}\r\n                          className=\"w-4 h-4 cursor-pointer\"\r\n                          title=\"เลือกทั้งหมด\"\r\n                        />\r\n                      </th>\r\n                      {displayHeaders.map((header, idx) => {\r\n                        // Define gradient colors for header date columns\r\n                        const headerGradients: Record<string, string> = {\r\n                          วันที่ติดตามครั้งล่าสุด:\r\n                            \"bg-gradient-to-r from-emerald-300 to-emerald-400\",\r\n                          วันที่ติดตามครั้งถัดไป:\r\n                            \"bg-gradient-to-r from-emerald-300 to-emerald-400\",\r\n                          \"วันที่ Consult\":\r\n                            \"bg-gradient-to-r from-fuchsia-300 to-fuchsia-400\",\r\n                          วันที่ผ่าตัด:\r\n                            \"bg-gradient-to-r from-orange-300 to-orange-400\",\r\n                          เวลาที่นัด:\r\n                            \"bg-gradient-to-r from-orange-300 to-orange-400\",\r\n                          \"วันที่ได้ชื่อ เบอร์\":\r\n                            \"bg-gradient-to-r from-blue-300 to-blue-400\",\r\n                          \"วันที่ได้นัด consult\":\r\n                            \"bg-gradient-to-r from-fuchsia-300 to-fuchsia-400\",\r\n                          วันที่ได้นัดผ่าตัด:\r\n                            \"bg-gradient-to-r from-orange-300 to-orange-400\",\r\n                        };\r\n\r\n                        const headerGradient =\r\n                          headerGradients[header] || \"bg-yellow-300\";\r\n                        const hoverClass = headerGradients[header]\r\n                          ? \"hover:opacity-90\"\r\n                          : \"hover:bg-yellow-400\";\r\n\r\n                        return (\r\n                          <th\r\n                            key={idx}\r\n                            onClick={() => handleSort(header)}\r\n                            className={`px-3 py-2 text-center text-xs font-bold text-gray-900 border-r border-gray-400 whitespace-nowrap cursor-pointer ${hoverClass} transition-all ${headerGradient}`}\r\n                            style={{ fontSize: \"11px\" }}\r\n                          >\r\n                            <div className=\"flex items-center justify-center gap-1\">\r\n                              <span>{header}</span>\r\n                              {sortColumn === header &&\r\n                                (sortDirection === \"asc\" ? (\r\n                                  <ChevronUp className=\"w-3 h-3\" />\r\n                                ) : (\r\n                                  <ChevronDown className=\"w-3 h-3\" />\r\n                                ))}\r\n                            </div>\r\n                          </th>\r\n                        );\r\n                      })}\r\n                      {/* View More column header - only show when filter is active */}\r\n                      {hasActiveFilter && (\r\n                        <th className=\"px-3 py-2 text-center text-xs font-bold text-gray-900 border-r border-gray-400 whitespace-nowrap bg-blue-300\" style={{ fontSize: \"11px\" }}>\r\n                          ดูเพิ่มเติม\r\n                        </th>\r\n                      )}\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {(() => {\r\n                      console.log(\r\n                        \"📊 Rendering tbody with\",\r\n                        paginatedData.length,\r\n                        \"rows\"\r\n                      );\r\n                      return null;\r\n                    })()}\r\n                    {paginatedData.map((row, rowIndex) => {\r\n                      const absoluteIndex =\r\n                        (currentPage - 1) * itemsPerPage + rowIndex;\r\n                      const patternIndex = absoluteIndex % 4;\r\n                      const rowId = row[\"id\"];\r\n                      const isChecked = selectedIds.includes(rowId);\r\n                      // Pattern: white (0) → pink (1) → white (2) → purple-light (3)\r\n                      let bgColor = \"bg-white\";\r\n                      if (patternIndex === 1) {\r\n                        bgColor = \"bg-pink-200\";\r\n                      } else if (patternIndex === 3) {\r\n                        bgColor = \"bg-purple-200\";\r\n                      }\r\n\r\n                      if (isChecked) {\r\n                        bgColor = \"bg-blue-100\";\r\n                      }\r\n\r\n                      return (\r\n                        <tr\r\n                          key={rowIndex}\r\n                          onClick={() => {\r\n                            setEditingCustomer(row);\r\n                            setIsEditModalOpen(true);\r\n                          }}\r\n                          className={`border border-gray-300 transition-all duration-200 group ${bgColor} hover:bg-blue-50 cursor-pointer`}\r\n                        >\r\n                          <td\r\n                            className=\"px-3 py-2 border-r border-gray-300 text-center\"\r\n                            onClick={(e) => e.stopPropagation()}\r\n                          >\r\n                            <input\r\n                              type=\"checkbox\"\r\n                              checked={isChecked}\r\n                              onChange={() => handleToggleSelect(rowId)}\r\n                              className=\"w-4 h-4 cursor-pointer\"\r\n                            />\r\n                          </td>\r\n                          {displayHeaders.map((header, colIdx) => {\r\n                            const value = row[header];\r\n                            const hasValue =\r\n                              value !== undefined &&\r\n                              value !== null &&\r\n                              value !== \"\";\r\n                            const displayValue = formatDateValue(value);\r\n                            const isNotesColumn = header === \"หมายเหตุ\";\r\n\r\n                            // Define gradient colors for specific date columns\r\n                            const dateColumns: Record<string, string> = {\r\n                              วันที่ติดตามครั้งล่าสุด:\r\n                                \"bg-gradient-to-r from-emerald-100 to-emerald-200\",\r\n                              วันที่ติดตามครั้งถัดไป:\r\n                                \"bg-gradient-to-r from-emerald-100 to-emerald-200\",\r\n                              \"วันที่ Consult\":\r\n                                \"bg-gradient-to-r from-fuchsia-100 to-fuchsia-200\",\r\n                              วันที่ผ่าตัด:\r\n                                \"bg-gradient-to-r from-orange-100 to-orange-200\",\r\n                              เวลาที่นัด:\r\n                                \"bg-gradient-to-r from-orange-100 to-orange-200\",\r\n                              \"วันที่ได้ชื่อ เบอร์\":\r\n                                \"bg-gradient-to-r from-blue-100 to-blue-200\",\r\n                              \"วันที่ได้นัด consult\":\r\n                                \"bg-gradient-to-r from-fuchsia-100 to-fuchsia-200\",\r\n                              วันที่ได้นัดผ่าตัด:\r\n                                \"bg-gradient-to-r from-orange-100 to-orange-200\",\r\n                            };\r\n\r\n                            const gradientClass = dateColumns[header] || \"\";\r\n                            const isDateColumn = !!dateColumns[header];\r\n\r\n                            return (\r\n                              <td\r\n                                key={colIdx}\r\n                                className={`px-3 py-2 text-xs text-gray-900 border-r border-gray-300 text-center align-middle ${isNotesColumn ? \"\" : \"whitespace-nowrap\"\r\n                                  } ${gradientClass}`}\r\n                                style={{\r\n                                  fontSize: \"11px\",\r\n                                  minWidth: isNotesColumn\r\n                                    ? \"450px\"\r\n                                    : isDateColumn\r\n                                      ? \"80px\"\r\n                                      : undefined,\r\n                                  maxWidth: isNotesColumn\r\n                                    ? \"450px\"\r\n                                    : isDateColumn\r\n                                      ? \"80px\"\r\n                                      : undefined,\r\n                                }}\r\n                              >\r\n                                {hasValue ? (\r\n                                  <span\r\n                                    className={\r\n                                      isNotesColumn\r\n                                        ? \"block text-left whitespace-pre-wrap break-words\"\r\n                                        : \"block\"\r\n                                    }\r\n                                  >\r\n                                    {displayValue}\r\n                                  </span>\r\n                                ) : (\r\n                                  <span className=\"text-gray-400 block\">-</span>\r\n                                )}\r\n                              </td>\r\n                            );\r\n                          })}\r\n                          {/* View More button - only show when filter is active */}\r\n                          {hasActiveFilter && (\r\n                            <td\r\n                              className=\"px-3 py-2 text-center border-r border-gray-300\"\r\n                              onClick={(e) => e.stopPropagation()}\r\n                            >\r\n                              <button\r\n                                onClick={() => {\r\n                                  setEditingCustomer(row);\r\n                                  setIsEditModalOpen(true);\r\n                                }}\r\n                                className=\"px-3 py-1.5 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white text-xs font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md\"\r\n                              >\r\n                                ดูเพิ่มเติม\r\n                              </button>\r\n                            </td>\r\n                          )}\r\n                        </tr>\r\n                      );\r\n                    })}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n        {/* Desktop: Show message when no filter applied */}\r\n        {!hasActiveFilter && tableData.length > 0 && (\r\n          <div className=\"hidden md:flex flex-col items-center justify-center py-16 bg-white rounded-xl shadow-sm border border-slate-200\">\r\n            <Filter className=\"w-16 h-16 text-slate-300 mb-4\" />\r\n            {isTypingSearch ? (\r\n              <p className=\"text-slate-500 text-center text-sm\">\r\n                พิมพ์อีก {3 - searchTerm.length} ตัวอักษรเพื่อค้นหา\r\n              </p>\r\n            ) : (\r\n              <p className=\"text-slate-500 text-center text-sm\">กรุณาเลือกตัวกรองหรือพิมพ์อย่างน้อย 3 ตัวอักษรเพื่อค้นหา</p>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Desktop Data Table - Only visible when filter is active */}\r\n        {hasActiveFilter && tableData.length > 0 && (\r\n          <div className=\"hidden md:block bg-white rounded-lg shadow-md overflow-hidden mb-4\">\r\n            {/* Horizontal scrollbar on top */}\r\n            <div\r\n              className=\"overflow-x-auto custom-scrollbar-horizontal\"\r\n              style={{\r\n                overflowY: \"hidden\",\r\n                height: \"12px\",\r\n              }}\r\n              onScroll={(e) => {\r\n                const target = e.currentTarget;\r\n                const tableContainer = target.nextElementSibling as HTMLElement;\r\n                if (tableContainer) {\r\n                  tableContainer.scrollLeft = target.scrollLeft;\r\n                }\r\n              }}\r\n            >\r\n              <div\r\n                style={{\r\n                  width: tableData[0].headers.length * 150 + \"px\",\r\n                  height: \"1px\",\r\n                }}\r\n              />\r\n            </div>\r\n            <div\r\n              className=\"overflow-x-auto overflow-y-auto custom-scrollbar\"\r\n              style={{\r\n                maxHeight: `calc(100vh + ${tableSize}px)`,\r\n                position: \"relative\",\r\n              }}\r\n              onScroll={(e) => {\r\n                const target = e.currentTarget;\r\n                const topScroller = target.previousElementSibling as HTMLElement;\r\n                if (topScroller) {\r\n                  topScroller.scrollLeft = target.scrollLeft;\r\n                }\r\n              }}\r\n            >\r\n              <table\r\n                className=\"w-full border-collapse text-sm table-auto\"\r\n                style={{ position: \"relative\", zIndex: 1 }}\r\n              >\r\n                <thead className=\"sticky top-0 z-30 bg-yellow-300\">\r\n                  <tr className=\"bg-yellow-300 border border-gray-400\">\r\n                    <th className=\"px-3 py-2 text-center font-bold text-gray-900 border-r border-gray-400\">\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={\r\n                          selectedIds.length === filteredAndSortedData.length &&\r\n                          filteredAndSortedData.length > 0\r\n                        }\r\n                        onChange={handleToggleSelectAll}\r\n                        className=\"w-4 h-4 cursor-pointer\"\r\n                        title=\"เลือกทั้งหมด\"\r\n                      />\r\n                    </th>\r\n                    {displayHeaders.map((header, idx) => (\r\n                      <th\r\n                        key={idx}\r\n                        className=\"px-3 py-2 text-center font-bold text-gray-900 whitespace-nowrap border-r border-gray-400\"\r\n                      >\r\n                        {header}\r\n                      </th>\r\n                    ))}\r\n                    {/* View More column header */}\r\n                    <th className=\"px-3 py-2 text-center font-bold text-gray-900 whitespace-nowrap border-r border-gray-400 bg-blue-300\">\r\n                      ดูเพิ่มเติม\r\n                    </th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {paginatedData.map((row, rowIdx) => {\r\n                    const rowId = row[\"ไอดี\"] || row[\"id\"] || rowIdx;\r\n                    const isSelected = selectedIds.includes(rowId);\r\n                    return (\r\n                      <tr\r\n                        key={rowIdx}\r\n                        className={`border-b border-gray-200 ${isSelected ? \"bg-blue-50\" : rowIdx % 2 === 0 ? \"bg-white\" : \"bg-gray-50\"\r\n                          } hover:bg-blue-100 transition-colors`}\r\n                      >\r\n                        <td\r\n                          className=\"px-3 py-2 text-center border-r border-gray-200\"\r\n                          onClick={(e) => e.stopPropagation()}\r\n                        >\r\n                          <input\r\n                            type=\"checkbox\"\r\n                            checked={isSelected}\r\n                            onChange={() => handleToggleSelect(rowId)}\r\n                            className=\"w-4 h-4 cursor-pointer\"\r\n                          />\r\n                        </td>\r\n                        {displayHeaders.map((header, colIdx) => {\r\n                          const value = row[header];\r\n                          const hasValue = value !== undefined && value !== null && value !== \"\";\r\n                          const displayValue = hasValue ? String(value) : \"-\";\r\n                          return (\r\n                            <td\r\n                              key={colIdx}\r\n                              className=\"px-3 py-2 text-center border-r border-gray-200 whitespace-nowrap\"\r\n                              style={{ fontSize: \"11px\" }}\r\n                            >\r\n                              {hasValue ? displayValue : <span className=\"text-gray-400\">-</span>}\r\n                            </td>\r\n                          );\r\n                        })}\r\n                        {/* View More button */}\r\n                        <td className=\"px-3 py-2 text-center border-r border-gray-200\">\r\n                          <button\r\n                            onClick={() => {\r\n                              setEditingCustomer(row);\r\n                              setIsEditModalOpen(true);\r\n                            }}\r\n                            className=\"px-3 py-1.5 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white text-xs font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md\"\r\n                          >\r\n                            ดูเพิ่มเติม\r\n                          </button>\r\n                        </td>\r\n                      </tr>\r\n                    );\r\n                  })}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n      <EditCustomerModal\r\n        isOpen={isEditModalOpen}\r\n        onClose={() => setIsEditModalOpen(false)}\r\n        customerData={editingCustomer || {}}\r\n        onSave={handleSaveCustomer}\r\n      />\r\n      <AddCustomerModal\r\n        isOpen={isAddModalOpen}\r\n        onClose={() => setIsAddModalOpen(false)}\r\n        onSuccess={() => {\r\n          setIsAddModalOpen(false);\r\n          fetchData();\r\n        }}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\n// Wrapper component with Suspense for useSearchParams\r\nexport default function CustomerAllDataPageWrapper() {\r\n  return (\r\n    <Suspense fallback={\r\n      <div className=\"w-full min-h-screen bg-gradient-to-b from-slate-50 to-slate-100 flex items-center justify-center\">\r\n        <div className=\"text-slate-500\">กำลังโหลด...</div>\r\n      </div>\r\n    }>\r\n      <CustomerAllDataPage />\r\n    </Suspense>\r\n  );\r\n}\r\n","import type { FieldDef } from \"pg\";\r\n\r\nexport const columnMapping: Record<string, string> = {\r\n  id: \"id\",\r\n  id_all: \"id_all\",\r\n  status: \"สถานะ\",\r\n  source: \"แหล่งที่มา\",\r\n  interested_product: \"ผลิตภัณฑ์ที่สนใจ\",\r\n  doctor: \"หมอ\",\r\n  contact_staff: \"ผู้ติดต่อ\",\r\n  customer_name: \"ชื่อ\",\r\n  phone: \"เบอร์โทร\",\r\n  note: \"หมายเหตุ\",\r\n  last_followup: \"วันที่ติดตามครั้งล่าสุด\",\r\n  next_followup: \"วันที่ติดตามครั้งถัดไป\",\r\n  consult_date: \"วันที่ Consult\",\r\n  surgery_date: \"วันที่ผ่าตัด\",\r\n  appointment_time: \"เวลาที่นัด\",\r\n  got_contact_date: \"วันที่ได้ชื่อ เบอร์\",\r\n  booked_consult_date: \"วันที่ได้นัด consult\",\r\n  booked_surgery_date: \"วันที่ได้นัดผ่าตัด\",\r\n  proposed_amount: \"ยอดนำเสนอ\",\r\n  customer_code: \"รหัสลูกค้า\",\r\n  star_flag: \"ติดดาว\",\r\n  country: \"ประเทศ\",\r\n  car_call_time: \"เวลาให้เรียกรถ\",\r\n  lat: \"Lat\",\r\n  long: \"Long\",\r\n  photo_note: \"รูป\",\r\n  gender: \"เพศ\",\r\n  age: \"อายุ\",\r\n  occupation: \"อาชีพ\",\r\n  from_province: \"มาจากจังหวัด\",\r\n  travel_method: \"จะเดินทางมารพ.ยังไง\",\r\n  contact_prefer_date: \"วันที่สะดวกให้ติดต่อ\",\r\n  contact_prefer_time: \"ช่วงเวลาที่สะดวกให้ติดต่อ\",\r\n  free_program: \"โครงการฟรี\",\r\n  event_id: \"Event ID\",\r\n  html_link: \"htmlLink\",\r\n  ical_uid: \"iCalUID\",\r\n  log: \"Log\",\r\n  doc_calendar: \"Doc Calendar\",\r\n  doc_event_id: \"Doc Event ID\",\r\n  doc_html_link: \"Doc htmlLink\",\r\n  doc_ical_uid: \"Doc iCalUID\",\r\n  line_note: \"line\",\r\n  line_doctor_note: \"line หมอ\",\r\n  ivr: \"IVR\",\r\n  transfer_to: \"TRANSFER_TO\",\r\n  status_call: \"status_call\",\r\n  created_at: \"created_at\",\r\n  updated_at: \"updated_at\",\r\n};\r\n\r\nexport const reverseColumnMapping: Record<string, string> = Object.entries(\r\n  columnMapping\r\n).reduce((acc, [eng, thai]) => {\r\n  acc[thai] = eng;\r\n  return acc;\r\n}, {} as Record<string, string>);\r\n\r\nconst mapFieldNameToThai = (fieldName: string) => columnMapping[fieldName] || fieldName;\r\n\r\nexport const getThaiHeaders = (fields: FieldDef[]) =>\r\n  fields.map((field) => mapFieldNameToThai(field.name));\r\n\r\nexport const mapRowsToThai = (rows: Record<string, any>[], fields: FieldDef[]) =>\r\n  rows.map((row) => {\r\n    const rowObj: Record<string, any> = {};\r\n    fields.forEach((field, index) => {\r\n      const thaiColumnName = mapFieldNameToThai(field.name);\r\n      rowObj[thaiColumnName] = row[field.name];\r\n    });\r\n    return rowObj;\r\n  });\r\n\r\nexport const getLatestUpdatedAt = (rows: Record<string, any>[]) => {\r\n  let latest: string | null = null;\r\n  rows.forEach((row) => {\r\n    if (row.updated_at) {\r\n      const date = new Date(row.updated_at);\r\n      if (!Number.isNaN(date.getTime())) {\r\n        const iso = date.toISOString();\r\n        if (!latest || iso > latest) {\r\n          latest = iso;\r\n        }\r\n      }\r\n    }\r\n  });\r\n  return latest;\r\n};\r\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z',\n      key: 'sc7q7i',\n    },\n  ],\n];\n\n/**\n * @component @name Funnel\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTAgMjBhMSAxIDAgMCAwIC41NTMuODk1bDIgMUExIDEgMCAwIDAgMTQgMjF2LTdhMiAyIDAgMCAxIC41MTctMS4zNDFMMjEuNzQgNC42N0ExIDEgMCAwIDAgMjEgM0gzYTEgMSAwIDAgMC0uNzQyIDEuNjdsNy4yMjUgNy45ODlBMiAyIDAgMCAxIDEwIDE0eiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/funnel\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Funnel = createLucideIcon('funnel', __iconNode);\n\nexport default Funnel;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [['path', { d: 'm18 15-6-6-6 6', key: '153udz' }]];\n\n/**\n * @component @name ChevronUp\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTggMTUtNi02LTYgNiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/chevron-up\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ChevronUp = createLucideIcon('chevron-up', __iconNode);\n\nexport default ChevronUp;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['rect', { width: '8', height: '4', x: '8', y: '2', rx: '1', ry: '1', key: 'tgr4d6' }],\n  [\n    'path',\n    {\n      d: 'M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2',\n      key: '116196',\n    },\n  ],\n  ['path', { d: 'm9 14 2 2 4-4', key: 'df797q' }],\n];\n\n/**\n * @component @name ClipboardCheck\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cmVjdCB3aWR0aD0iOCIgaGVpZ2h0PSI0IiB4PSI4IiB5PSIyIiByeD0iMSIgcnk9IjEiIC8+CiAgPHBhdGggZD0iTTE2IDRoMmEyIDIgMCAwIDEgMiAydjE0YTIgMiAwIDAgMS0yIDJINmEyIDIgMCAwIDEtMi0yVjZhMiAyIDAgMCAxIDItMmgyIiAvPgogIDxwYXRoIGQ9Im05IDE0IDIgMiA0LTQiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/clipboard-check\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ClipboardCheck = createLucideIcon('clipboard-check', __iconNode);\n\nexport default ClipboardCheck;\n"],"names":[],"mappings":"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","ignoreList":[5,6,7]}