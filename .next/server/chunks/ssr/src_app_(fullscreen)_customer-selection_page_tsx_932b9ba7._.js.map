{"version":3,"sources":["../../../../src/app/%28fullscreen%29/customer-selection/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { motion } from \"framer-motion\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { FaUsers, FaUserPlus, FaArrowLeft } from \"react-icons/fa\";\r\n\r\ninterface CustomerCount {\r\n  existingCount: number;\r\n  newCount: number;\r\n}\r\n\r\nexport default function CustomerSelectionPage() {\r\n  const router = useRouter();\r\n  const [counts, setCounts] = useState<CustomerCount>({\r\n    existingCount: 0,\r\n    newCount: 0,\r\n  });\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    fetchCustomerCounts();\r\n  }, []);\r\n\r\n  const fetchCustomerCounts = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const response = await fetch(\"/api/customer-data\");\r\n      const result = await response.json();\r\n\r\n      if (result.success && result.data) {\r\n        // Count existing customers (with CN/รหัสลูกค้า) and new customers (without)\r\n        let existingCount = 0;\r\n        let newCount = 0;\r\n\r\n        result.data.forEach((row: Record<string, any>) => {\r\n          // Check 'cn' column for existing customers (customers with CN number from OPD)\r\n          const cnValue = row[\"cn\"];\r\n          if (cnValue && cnValue.toString().trim() !== \"\") {\r\n            existingCount++;\r\n          } else {\r\n            newCount++;\r\n          }\r\n        });\r\n\r\n        console.log(\"Customer counts:\", { existingCount, newCount, total: result.data.length });\r\n        setCounts({ existingCount, newCount });\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching customer counts:\", error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSelectType = (type: \"existing\" | \"new\") => {\r\n    router.push(`/customer-all-data?type=${type}`);\r\n  };\r\n\r\n  const handleBack = () => {\r\n    router.push(\"/home\");\r\n  };\r\n\r\n  const customerTypes = [\r\n    {\r\n      id: \"existing\",\r\n      title: \"ลูกค้าเก่า\",\r\n      description: \"ลูกค้าที่มีรหัส CN\",\r\n      icon: <FaUsers className=\"text-5xl\" />,\r\n      count: counts.existingCount,\r\n      color: \"from-blue-500 to-blue-700\",\r\n      hoverColor: \"hover:from-blue-600 hover:to-blue-800\",\r\n    },\r\n    {\r\n      id: \"new\",\r\n      title: \"ลูกค้าใหม่\",\r\n      description: \"ลูกค้าที่ยังไม่มีรหัส CN\",\r\n      icon: <FaUserPlus className=\"text-5xl\" />,\r\n      count: counts.newCount,\r\n      color: \"from-emerald-500 to-emerald-700\",\r\n      hoverColor: \"hover:from-emerald-600 hover:to-emerald-800\",\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-purple-900 via-purple-700 to-pink-600 relative overflow-hidden\">\r\n      {/* Animated background elements */}\r\n      <div className=\"absolute inset-0 overflow-hidden\">\r\n        {[...Array(20)].map((_, i) => (\r\n          <motion.div\r\n            key={i}\r\n            className=\"absolute rounded-full\"\r\n            style={{\r\n              width: Math.random() * 10 + 5,\r\n              height: Math.random() * 10 + 5,\r\n              background: `hsl(${Math.random() * 60 + 280}, 80%, 60%)`,\r\n              left: `${Math.random() * 100}%`,\r\n              top: `${Math.random() * 100}%`,\r\n            }}\r\n            animate={{\r\n              y: [0, -30, 0],\r\n              opacity: [0.3, 0.8, 0.3],\r\n            }}\r\n            transition={{\r\n              duration: Math.random() * 3 + 2,\r\n              repeat: Infinity,\r\n              ease: \"easeInOut\",\r\n            }}\r\n          />\r\n        ))}\r\n      </div>\r\n\r\n      {/* Header */}\r\n      <div className=\"relative z-10 p-4\">\r\n        <div className=\"flex items-center justify-between max-w-4xl mx-auto\">\r\n          <motion.button\r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            whileHover={{ scale: 1.05 }}\r\n            whileTap={{ scale: 0.95 }}\r\n            onClick={handleBack}\r\n            className=\"p-3 bg-white/20 backdrop-blur-sm rounded-xl text-white hover:bg-white/30 transition-colors\"\r\n          >\r\n            <FaArrowLeft className=\"text-xl\" />\r\n          </motion.button>\r\n\r\n          <motion.h1\r\n            initial={{ opacity: 0, y: -20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            className=\"text-2xl font-bold text-white\"\r\n          >\r\n            ลูกค้าสัมพันธ์\r\n          </motion.h1>\r\n\r\n          <div className=\"w-12\" /> {/* Spacer for alignment */}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main content - positioned higher for mobile */}\r\n      <div className=\"relative z-10 flex flex-col items-center pt-8 px-4\">\r\n        {/* Customer type selection */}\r\n        <div className=\"w-full max-w-md space-y-4\">\r\n          {customerTypes.map((type, index) => (\r\n            <motion.div\r\n              key={type.id}\r\n              initial={{ opacity: 0, y: 30 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              transition={{ duration: 0.5, delay: index * 0.1 + 0.2 }}\r\n            >\r\n              <motion.button\r\n                whileHover={{ scale: 1.02, y: -2 }}\r\n                whileTap={{ scale: 0.98 }}\r\n                onClick={() => handleSelectType(type.id as \"existing\" | \"new\")}\r\n                className={`w-full bg-gradient-to-r ${type.color} ${type.hoverColor} rounded-2xl p-6 text-white shadow-lg transition-all duration-300`}\r\n              >\r\n                <div className=\"flex items-center gap-4\">\r\n                  <div className=\"p-3 bg-white/20 rounded-xl\">\r\n                    {type.icon}\r\n                  </div>\r\n                  <div className=\"flex-1 text-left\">\r\n                    <h3 className=\"text-xl font-bold\">{type.title}</h3>\r\n                    <p className=\"text-white/80 text-sm\">{type.description}</p>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    {isLoading ? (\r\n                      <div className=\"animate-pulse bg-white/30 rounded-lg h-8 w-16\" />\r\n                    ) : (\r\n                      <div className=\"text-2xl font-bold\">\r\n                        {type.count.toLocaleString()}\r\n                      </div>\r\n                    )}\r\n                    <div className=\"text-white/80 text-xs\">รายการ</div>\r\n                  </div>\r\n                </div>\r\n              </motion.button>\r\n            </motion.div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Footer */}\r\n      <motion.div\r\n        initial={{ opacity: 0 }}\r\n        animate={{ opacity: 1 }}\r\n        transition={{ duration: 1, delay: 0.5 }}\r\n        className=\"relative z-10 text-center pb-6 text-white\"\r\n      >\r\n        <p className=\"text-sm opacity-75\">\r\n          © 2025 ระบบบริหารจัดการคลินิก - All Rights Reserved\r\n        </p>\r\n      </motion.div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}