{"version":3,"sources":["../../../../src/app/%28fullscreen%29/all-files-gallery/video/%5Bid%5D/page.tsx"],"sourcesContent":["import { Metadata, ResolvingMetadata } from \"next\";\r\nimport { notFound } from \"next/navigation\";\r\nimport fs from \"fs\";\r\nimport path from \"path\";\r\nimport Link from \"next/link\";\r\n\r\n// Base URL for the application\r\nconst BASE_URL =\r\n    process.env.NEXT_PUBLIC_BASE_URL || \"https://app.bjhbangkok.com\";\r\n\r\n// Root directory for videos\r\nconst VIDEO_ROOT = path.join(process.cwd(), \"public\", \"images\", \"video\");\r\n\r\ninterface VideoInfo {\r\n    id: string;\r\n    name: string;\r\n    displayName: string;\r\n    originalUrl: string;\r\n    videoUrl: string;  // URL for OG meta tags (API endpoint with range support)\r\n    thumbnail: string;\r\n    width: number;\r\n    height: number;\r\n    duration?: number;\r\n    mimeType: string;\r\n    size: number;\r\n    folder: string;\r\n}\r\n\r\n// Get clean display name from filename\r\nfunction getDisplayName(fileName: string): string {\r\n    const ext = path.extname(fileName).toLowerCase();\r\n    const baseName = path.basename(fileName, ext);\r\n    // Convert underscores/dashes to spaces and capitalize\r\n    return baseName\r\n        .replace(/[-_]/g, \" \")\r\n        .replace(/\\b\\w/g, (c) => c.toUpperCase())\r\n        .trim();\r\n}\r\n\r\n// Function to get video info from file system\r\nasync function getVideoInfo(id: string): Promise<VideoInfo | null> {\r\n    try {\r\n        // Decode the ID (it is base64url encoded path)\r\n        let decodedPath: string;\r\n        try {\r\n            decodedPath = Buffer.from(id, \"base64url\").toString(\"utf-8\");\r\n        } catch {\r\n            console.log(\"Failed to decode video ID:\", id);\r\n            return null;\r\n        }\r\n\r\n        // Security check - only allow images/video folder\r\n        const allowedPrefixes = [\"/images/video/\", \"images/video/\"];\r\n        const isAllowed = allowedPrefixes.some((p) => decodedPath.startsWith(p));\r\n        if (!isAllowed) {\r\n            console.log(\"Path not allowed:\", decodedPath);\r\n            return null;\r\n        }\r\n\r\n        // Normalize path\r\n        const normalizedPath = decodedPath.startsWith(\"/\")\r\n            ? decodedPath\r\n            : `/${decodedPath}`;\r\n        const relativePath = normalizedPath.replace(/^\\/images\\/video\\//, \"\");\r\n        const fullPath = path.join(VIDEO_ROOT, relativePath);\r\n\r\n        // Security: ensure path is within VIDEO_ROOT\r\n        const resolvedPath = path.resolve(fullPath);\r\n        const resolvedRoot = path.resolve(VIDEO_ROOT);\r\n        if (!resolvedPath.startsWith(resolvedRoot)) {\r\n            console.log(\"Path traversal attempt blocked:\", decodedPath);\r\n            return null;\r\n        }\r\n\r\n        // Check if file exists\r\n        if (!fs.existsSync(fullPath)) {\r\n            console.log(\"File not found:\", fullPath);\r\n            return null;\r\n        }\r\n\r\n        const stats = fs.statSync(fullPath);\r\n        if (!stats.isFile()) {\r\n            console.log(\"Not a file:\", fullPath);\r\n            return null;\r\n        }\r\n\r\n        const fileName = path.basename(fullPath);\r\n        const ext = path.extname(fullPath).toLowerCase();\r\n\r\n        // Only allow video files\r\n        const videoExtensions = [\".mp4\", \".webm\", \".mov\", \".m4v\"];\r\n        if (!videoExtensions.includes(ext)) {\r\n            console.log(\"Not a video file:\", ext);\r\n            return null;\r\n        }\r\n\r\n        // Determine MIME type\r\n        const mimeTypes: Record<string, string> = {\r\n            \".mp4\": \"video/mp4\",\r\n            \".webm\": \"video/webm\",\r\n            \".mov\": \"video/quicktime\",\r\n            \".m4v\": \"video/x-m4v\",\r\n        };\r\n        const mimeType = mimeTypes[ext] || \"video/mp4\";\r\n\r\n        // Get folder name for organization\r\n        const folder = path.dirname(relativePath) || \"root\";\r\n\r\n        // Check for existing thumbnail\r\n        const baseName = path.basename(fileName, ext);\r\n        const thumbnailCandidates = [\r\n            `${baseName}_thumb.jpg`,\r\n            `${baseName}_thumb.png`,\r\n            `${baseName}.jpg`,\r\n            `${baseName}.png`,\r\n        ];\r\n\r\n        let thumbnail = `${BASE_URL}/images/video-placeholder.svg`;\r\n        for (const thumbName of thumbnailCandidates) {\r\n            const thumbPath = path.join(path.dirname(fullPath), thumbName);\r\n            if (fs.existsSync(thumbPath)) {\r\n                const thumbRelative = path.join(path.dirname(relativePath), thumbName);\r\n                const encodedThumbPath = thumbRelative\r\n                    .split(\"/\")\r\n                    .map((s) => encodeURIComponent(s))\r\n                    .join(\"/\");\r\n                thumbnail = `${BASE_URL}/images/video/${encodedThumbPath}`;\r\n                break;\r\n            }\r\n        }\r\n\r\n        // Encode relative path for URLs (handles spaces and special characters)\r\n        const encodedRelativePath = relativePath\r\n            .split(\"/\")\r\n            .map((s) => encodeURIComponent(s))\r\n            .join(\"/\");\r\n\r\n        // Use serve-video API for video URL (supports byte-range requests)\r\n        const videoUrl = `${BASE_URL}/api/serve-video/${encodedRelativePath}`;\r\n        const originalUrl = `${BASE_URL}/images/video/${encodedRelativePath}`;\r\n\r\n        return {\r\n            id,\r\n            name: fileName,\r\n            displayName: getDisplayName(fileName),\r\n            originalUrl,\r\n            videoUrl,\r\n            thumbnail,\r\n            width: 1280,\r\n            height: 720,\r\n            mimeType,\r\n            size: stats.size,\r\n            folder,\r\n        };\r\n    } catch (error) {\r\n        console.error(\"Error getting video info:\", error);\r\n        return null;\r\n    }\r\n}\r\n\r\n// Generate metadata for LINE inline video playback\r\nexport async function generateMetadata(\r\n    { params }: { params: Promise<{ id: string }> },\r\n    parent: ResolvingMetadata\r\n): Promise<Metadata> {\r\n    const { id } = await params;\r\n    const video = await getVideoInfo(id);\r\n\r\n    if (!video) {\r\n        return {\r\n            title: \"Video Not Found - BJH Bangkok\",\r\n            description: \"The requested video could not be found.\",\r\n        };\r\n    }\r\n\r\n    const pageUrl = `${BASE_URL}/all-files-gallery/video/${id}`;\r\n\r\n    // Critical: These meta tags enable LINE inline video playback\r\n    return {\r\n        title: `${video.displayName} - BJH Bangkok`,\r\n        description: `Watch ${video.displayName} from BJH Bangkok Medical Center`,\r\n\r\n        // Open Graph for video - Essential for LINE inline playback\r\n        openGraph: {\r\n            title: video.displayName,\r\n            description: `Watch ${video.displayName} from BJH Bangkok Medical Center`,\r\n            url: pageUrl,\r\n            siteName: \"BJH Bangkok\",\r\n            type: \"video.other\", // Required for video content\r\n            images: [\r\n                {\r\n                    url: video.thumbnail,\r\n                    width: video.width,\r\n                    height: video.height,\r\n                    alt: video.displayName,\r\n                },\r\n            ],\r\n            videos: [\r\n                {\r\n                    url: video.videoUrl,\r\n                    secureUrl: video.videoUrl,\r\n                    type: \"video/mp4\",\r\n                    width: video.width,\r\n                    height: video.height,\r\n                },\r\n            ],\r\n        },\r\n\r\n        // Twitter Player Card\r\n        twitter: {\r\n            card: \"player\",\r\n            title: video.displayName,\r\n            description: `Watch ${video.displayName} from BJH Bangkok Medical Center`,\r\n            images: [video.thumbnail],\r\n        },\r\n\r\n        // Additional meta for LINE and other platforms\r\n        other: {\r\n            // Direct video URL for LINE - must be publicly accessible HTTPS\r\n            \"og:video\": video.videoUrl,\r\n            \"og:video:secure_url\": video.videoUrl,\r\n            \"og:video:type\": \"video/mp4\",\r\n            \"og:video:width\": String(video.width),\r\n            \"og:video:height\": String(video.height),\r\n\r\n            // LINE specific meta tags\r\n            \"line:title\": video.displayName,\r\n            \"line:description\": `Watch ${video.displayName}`,\r\n\r\n            // Twitter Player\r\n            \"twitter:player\": `${BASE_URL}/embed/video/${id}`,\r\n            \"twitter:player:width\": String(video.width),\r\n            \"twitter:player:height\": String(video.height),\r\n            \"twitter:player:stream\": video.videoUrl,\r\n            \"twitter:player:stream:content_type\": \"video/mp4\",\r\n\r\n            // Apple inline video support\r\n            \"apple-mobile-web-app-capable\": \"yes\",\r\n        },\r\n    };\r\n}\r\n\r\n// Format file size for display\r\nfunction formatFileSize(bytes: number): string {\r\n    if (bytes < 1024) return `${bytes} B`;\r\n    if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\r\n    if (bytes < 1024 * 1024 * 1024) return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\r\n    return `${(bytes / (1024 * 1024 * 1024)).toFixed(1)} GB`;\r\n}\r\n\r\n// Video page component\r\nexport default async function VideoPage({\r\n    params,\r\n}: {\r\n    params: Promise<{ id: string }>;\r\n}) {\r\n    const { id } = await params;\r\n    const video = await getVideoInfo(id);\r\n\r\n    if (!video) {\r\n        notFound();\r\n    }\r\n\r\n    const shareUrl = `${BASE_URL}/all-files-gallery/video/${id}`;\r\n    const lineShareUrl = `https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(shareUrl)}`;\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900\">\r\n            {/* Video Player Section */}\r\n            <div className=\"max-w-6xl mx-auto px-4 py-8\">\r\n                {/* Back Button */}\r\n                <Link\r\n                    href=\"/all-files-gallery\"\r\n                    className=\"inline-flex items-center gap-2 text-white/70 hover:text-white mb-6 transition-colors\"\r\n                >\r\n                    <svg\r\n                        className=\"w-5 h-5\"\r\n                        fill=\"none\"\r\n                        stroke=\"currentColor\"\r\n                        viewBox=\"0 0 24 24\"\r\n                    >\r\n                        <path\r\n                            strokeLinecap=\"round\"\r\n                            strokeLinejoin=\"round\"\r\n                            strokeWidth={2}\r\n                            d=\"M15 19l-7-7 7-7\"\r\n                        />\r\n                    </svg>\r\n                    Back to Gallery\r\n                </Link>\r\n\r\n                {/* Video Container */}\r\n                <div className=\"bg-black rounded-2xl overflow-hidden shadow-2xl\">\r\n                    <video\r\n                        controls\r\n                        autoPlay\r\n                        playsInline\r\n                        preload=\"metadata\"\r\n                        poster={video.thumbnail}\r\n                        className=\"w-full aspect-video\"\r\n                    >\r\n                        <source src={video.videoUrl} type=\"video/mp4\" />\r\n                        Your browser does not support the video tag.\r\n                    </video>\r\n                </div>\r\n\r\n                {/* Video Info */}\r\n                <div className=\"mt-6\">\r\n                    <h1 className=\"text-2xl md:text-3xl font-bold text-white mb-2\">\r\n                        {video.displayName}\r\n                    </h1>\r\n                    <div className=\"flex flex-wrap gap-4 text-white/60 text-sm mb-4\">\r\n                        <span> {video.folder}</span>\r\n                        <span> {formatFileSize(video.size)}</span>\r\n                    </div>\r\n\r\n                    {/* Share Section */}\r\n                    <div className=\"mt-8 p-6 bg-white/5 rounded-2xl border border-white/10\">\r\n                        <h2 className=\"text-lg font-semibold text-white mb-4\">\r\n                             Share this video\r\n                        </h2>\r\n                        <p className=\"text-white/60 text-sm mb-4\">\r\n                            Share this link on LINE for inline video playback\r\n                        </p>\r\n\r\n                        {/* Share URL Display */}\r\n                        <div className=\"flex items-center gap-2 bg-black/30 rounded-xl p-3 mb-4\">\r\n                            <input\r\n                                type=\"text\"\r\n                                readOnly\r\n                                value={shareUrl}\r\n                                className=\"flex-1 bg-transparent text-white/80 text-sm outline-none\"\r\n                            />\r\n                            <button\r\n                                onClick={() => {\r\n                                    if (typeof navigator !== \"undefined\") {\r\n                                        navigator.clipboard?.writeText(shareUrl);\r\n                                    }\r\n                                }}\r\n                                className=\"px-4 py-2 bg-white/10 hover:bg-white/20 text-white text-sm rounded-lg transition-colors\"\r\n                            >\r\n                                Copy\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* Share Buttons */}\r\n                        <div className=\"flex flex-wrap gap-3\">\r\n                            {/* LINE Share Button */}\r\n                            <a\r\n                                href={lineShareUrl}\r\n                                target=\"_blank\"\r\n                                rel=\"noopener noreferrer\"\r\n                                className=\"inline-flex items-center gap-2 px-6 py-3 bg-[#00B900] hover:bg-[#00A000] text-white rounded-xl font-medium transition-colors\"\r\n                            >\r\n                                <svg\r\n                                    className=\"w-5 h-5\"\r\n                                    viewBox=\"0 0 24 24\"\r\n                                    fill=\"currentColor\"\r\n                                >\r\n                                    <path d=\"M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.627-.63h2.386c.349 0 .63.285.63.63 0 .349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.627-.63.349 0 .631.285.631.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.349 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.281.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314\" />\r\n                                </svg>\r\n                                Share on LINE\r\n                            </a>\r\n\r\n                            {/* Copy Link Button */}\r\n                            <button\r\n                                onClick={() => {\r\n                                    if (typeof navigator !== \"undefined\") {\r\n                                        navigator.clipboard?.writeText(shareUrl);\r\n                                        alert(\"Link copied!\");\r\n                                    }\r\n                                }}\r\n                                className=\"inline-flex items-center gap-2 px-6 py-3 bg-white/10 hover:bg-white/20 text-white rounded-xl font-medium transition-colors\"\r\n                            >\r\n                                <svg\r\n                                    className=\"w-5 h-5\"\r\n                                    fill=\"none\"\r\n                                    stroke=\"currentColor\"\r\n                                    viewBox=\"0 0 24 24\"\r\n                                >\r\n                                    <path\r\n                                        strokeLinecap=\"round\"\r\n                                        strokeLinejoin=\"round\"\r\n                                        strokeWidth={2}\r\n                                        d=\"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3\"\r\n                                    />\r\n                                </svg>\r\n                                Copy Link\r\n                            </button>\r\n\r\n                            {/* Native Share (Mobile) */}\r\n                            <button\r\n                                onClick={() => {\r\n                                    if (typeof navigator !== \"undefined\" && navigator.share) {\r\n                                        navigator.share({\r\n                                            title: video.displayName,\r\n                                            text: `Watch ${video.displayName} from BJH Bangkok`,\r\n                                            url: shareUrl,\r\n                                        });\r\n                                    }\r\n                                }}\r\n                                className=\"inline-flex items-center gap-2 px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-xl font-medium transition-colors\"\r\n                            >\r\n                                <svg\r\n                                    className=\"w-5 h-5\"\r\n                                    fill=\"none\"\r\n                                    stroke=\"currentColor\"\r\n                                    viewBox=\"0 0 24 24\"\r\n                                >\r\n                                    <path\r\n                                        strokeLinecap=\"round\"\r\n                                        strokeLinejoin=\"round\"\r\n                                        strokeWidth={2}\r\n                                        d=\"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z\"\r\n                                    />\r\n                                </svg>\r\n                                Share\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Info Box */}\r\n                    <div className=\"mt-6 p-4 bg-green-500/10 border border-green-500/20 rounded-xl\">\r\n                        <h3 className=\"text-green-300 font-semibold mb-2 flex items-center gap-2\">\r\n                            <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                                <path d=\"M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.627-.63h2.386c.349 0 .63.285.63.63 0 .349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.627-.63.349 0 .631.285.631.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.349 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.281.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314\" />\r\n                            </svg>\r\n                            LINE Inline Video Playback\r\n                        </h3>\r\n                        <ul className=\"text-green-200/80 text-sm space-y-1\">\r\n                            <li> Copy and paste this link directly into LINE chat</li>\r\n                            <li> LINE will show a video preview thumbnail</li>\r\n                            <li> Tap play to watch inline without leaving LINE</li>\r\n                            <li> Or use the green \"Share on LINE\" button above</li>\r\n                        </ul>\r\n                    </div>\r\n\r\n                    {/* Download Button */}\r\n                    <div className=\"mt-6\">\r\n                        <a\r\n                            href={video.originalUrl}\r\n                            download={video.name}\r\n                            className=\"inline-flex items-center gap-2 px-6 py-3 bg-white/10 hover:bg-white/20 text-white rounded-xl font-medium transition-colors\"\r\n                        >\r\n                            <svg\r\n                                className=\"w-5 h-5\"\r\n                                fill=\"none\"\r\n                                stroke=\"currentColor\"\r\n                                viewBox=\"0 0 24 24\"\r\n                            >\r\n                                <path\r\n                                    strokeLinecap=\"round\"\r\n                                    strokeLinejoin=\"round\"\r\n                                    strokeWidth={2}\r\n                                    d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\"\r\n                                />\r\n                            </svg>\r\n                            Download Video\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}