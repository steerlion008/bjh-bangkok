{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/nut_z/OneDrive/%E0%B9%80%E0%B8%94%E0%B8%AA%E0%B8%81%E0%B9%8C%E0%B8%97%E0%B9%87%E0%B8%AD%E0%B8%9B/new-bjh/bjh-bangkok/src/components/NotificationPopup.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { CheckCircle, XCircle, X } from \"lucide-react\";\r\n\r\ninterface NotificationPopupProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  type: \"success\" | \"error\";\r\n  title: string;\r\n  message: string;\r\n}\r\n\r\nexport const NotificationPopup = ({\r\n  isOpen,\r\n  onClose,\r\n  type,\r\n  title,\r\n  message,\r\n}: NotificationPopupProps) => {\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const [isAnimating, setIsAnimating] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setIsVisible(true);\r\n      setTimeout(() => setIsAnimating(true), 10);\r\n\r\n      // Auto close after 3 seconds\r\n      const timer = setTimeout(() => {\r\n        handleClose();\r\n      }, 3000);\r\n\r\n      return () => clearTimeout(timer);\r\n    } else {\r\n      setIsAnimating(false);\r\n      setTimeout(() => setIsVisible(false), 300);\r\n    }\r\n  }, [isOpen]);\r\n\r\n  const handleClose = () => {\r\n    setIsAnimating(false);\r\n    setTimeout(() => {\r\n      setIsVisible(false);\r\n      onClose();\r\n    }, 300);\r\n  };\r\n\r\n  if (!isVisible) return null;\r\n\r\n  const isSuccess = type === \"success\";\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 flex items-center justify-center z-[9999] pointer-events-none\">\r\n      {/* Backdrop with blur effect */}\r\n      <div\r\n        className={`absolute inset-0 backdrop-blur-sm transition-opacity duration-300 pointer-events-auto ${\r\n          isAnimating ? \"opacity-100\" : \"opacity-0\"\r\n        }`}\r\n        style={{ backgroundColor: \"rgba(0, 0, 0, 0.3)\" }}\r\n        onClick={handleClose}\r\n      />\r\n\r\n      {/* Notification Card */}\r\n      <div\r\n        className={`relative pointer-events-auto transform transition-all duration-300 ${\r\n          isAnimating\r\n            ? \"scale-100 opacity-100 translate-y-0\"\r\n            : \"scale-95 opacity-0 -translate-y-4\"\r\n        }`}\r\n      >\r\n        <div\r\n          className={`relative bg-white rounded-2xl shadow-2xl overflow-hidden w-96 ${\r\n            isSuccess ? \"border-4 border-green-400\" : \"border-4 border-red-400\"\r\n          }`}\r\n        >\r\n          {/* Animated Background Gradient */}\r\n          <div\r\n            className={`absolute inset-0 opacity-10 ${\r\n              isSuccess\r\n                ? \"bg-gradient-to-br from-green-400 via-emerald-400 to-teal-400\"\r\n                : \"bg-gradient-to-br from-red-400 via-rose-400 to-pink-400\"\r\n            } animate-gradient`}\r\n          />\r\n\r\n          {/* Close Button */}\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"absolute top-4 right-4 p-1 rounded-full hover:bg-gray-100 transition-colors z-10\"\r\n          >\r\n            <X className=\"w-5 h-5 text-gray-500\" />\r\n          </button>\r\n\r\n          {/* Content */}\r\n          <div className=\"relative p-8\">\r\n            {/* Icon with animation */}\r\n            <div className=\"flex justify-center mb-6\">\r\n              <div\r\n                className={`relative ${\r\n                  isSuccess ? \"animate-success-icon\" : \"animate-error-icon\"\r\n                }`}\r\n              >\r\n                {isSuccess ? (\r\n                  <div className=\"relative\">\r\n                    {/* Pulsing circles */}\r\n                    <div className=\"absolute inset-0 animate-ping-slow\">\r\n                      <div className=\"w-24 h-24 rounded-full bg-green-400 opacity-30\" />\r\n                    </div>\r\n                    <div className=\"absolute inset-0 animate-pulse-slow\">\r\n                      <div className=\"w-24 h-24 rounded-full bg-green-300 opacity-20\" />\r\n                    </div>\r\n                    {/* Main icon */}\r\n                    <CheckCircle className=\"w-24 h-24 text-green-500 relative z-10 drop-shadow-lg\" />\r\n                    {/* Sparkles */}\r\n                    <div className=\"absolute top-0 left-0 w-full h-full\">\r\n                      <div className=\"absolute top-2 right-2 w-3 h-3 bg-yellow-400 rounded-full animate-sparkle-1\" />\r\n                      <div className=\"absolute top-6 right-0 w-2 h-2 bg-yellow-300 rounded-full animate-sparkle-2\" />\r\n                      <div className=\"absolute top-0 right-6 w-2 h-2 bg-yellow-500 rounded-full animate-sparkle-3\" />\r\n                      <div className=\"absolute bottom-2 left-2 w-3 h-3 bg-green-300 rounded-full animate-sparkle-1\" />\r\n                      <div className=\"absolute bottom-6 left-0 w-2 h-2 bg-green-400 rounded-full animate-sparkle-2\" />\r\n                    </div>\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"relative\">\r\n                    {/* Pulsing circles */}\r\n                    <div className=\"absolute inset-0 animate-ping-slow\">\r\n                      <div className=\"w-24 h-24 rounded-full bg-red-400 opacity-30\" />\r\n                    </div>\r\n                    <div className=\"absolute inset-0 animate-pulse-slow\">\r\n                      <div className=\"w-24 h-24 rounded-full bg-red-300 opacity-20\" />\r\n                    </div>\r\n                    {/* Main icon */}\r\n                    <XCircle className=\"w-24 h-24 text-red-500 relative z-10 drop-shadow-lg animate-shake\" />\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Title */}\r\n            <h2\r\n              className={`text-2xl font-bold text-center mb-3 ${\r\n                isSuccess ? \"text-green-600\" : \"text-red-600\"\r\n              }`}\r\n            >\r\n              {title}\r\n            </h2>\r\n\r\n            {/* Message */}\r\n            <p className=\"text-gray-600 text-center text-base leading-relaxed\">\r\n              {message}\r\n            </p>\r\n\r\n            {/* Progress bar */}\r\n            <div className=\"mt-6\">\r\n              <div className=\"w-full h-1 bg-gray-200 rounded-full overflow-hidden\">\r\n                <div\r\n                  className={`h-full ${\r\n                    isSuccess ? \"bg-green-500\" : \"bg-red-500\"\r\n                  } animate-progress`}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Bottom decoration */}\r\n          <div\r\n            className={`h-2 ${\r\n              isSuccess\r\n                ? \"bg-gradient-to-r from-green-400 via-emerald-400 to-teal-400\"\r\n                : \"bg-gradient-to-r from-red-400 via-rose-400 to-pink-400\"\r\n            }`}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <style jsx>{`\r\n        @keyframes gradient {\r\n          0%,\r\n          100% {\r\n            transform: scale(1) rotate(0deg);\r\n          }\r\n          50% {\r\n            transform: scale(1.1) rotate(5deg);\r\n          }\r\n        }\r\n\r\n        @keyframes ping-slow {\r\n          0% {\r\n            transform: scale(1);\r\n            opacity: 0.3;\r\n          }\r\n          50% {\r\n            transform: scale(1.2);\r\n            opacity: 0.15;\r\n          }\r\n          100% {\r\n            transform: scale(1.4);\r\n            opacity: 0;\r\n          }\r\n        }\r\n\r\n        @keyframes pulse-slow {\r\n          0%,\r\n          100% {\r\n            transform: scale(1);\r\n            opacity: 0.2;\r\n          }\r\n          50% {\r\n            transform: scale(1.15);\r\n            opacity: 0.3;\r\n          }\r\n        }\r\n\r\n        @keyframes success-icon {\r\n          0% {\r\n            transform: scale(0) rotate(-180deg);\r\n          }\r\n          50% {\r\n            transform: scale(1.2) rotate(10deg);\r\n          }\r\n          100% {\r\n            transform: scale(1) rotate(0deg);\r\n          }\r\n        }\r\n\r\n        @keyframes error-icon {\r\n          0% {\r\n            transform: scale(0) rotate(0deg);\r\n          }\r\n          50% {\r\n            transform: scale(1.2);\r\n          }\r\n          100% {\r\n            transform: scale(1);\r\n          }\r\n        }\r\n\r\n        @keyframes shake {\r\n          0%,\r\n          100% {\r\n            transform: translateX(0);\r\n          }\r\n          10%,\r\n          30%,\r\n          50%,\r\n          70%,\r\n          90% {\r\n            transform: translateX(-3px);\r\n          }\r\n          20%,\r\n          40%,\r\n          60%,\r\n          80% {\r\n            transform: translateX(3px);\r\n          }\r\n        }\r\n\r\n        @keyframes sparkle-1 {\r\n          0%,\r\n          100% {\r\n            transform: scale(0) rotate(0deg);\r\n            opacity: 0;\r\n          }\r\n          50% {\r\n            transform: scale(1) rotate(180deg);\r\n            opacity: 1;\r\n          }\r\n        }\r\n\r\n        @keyframes sparkle-2 {\r\n          0%,\r\n          100% {\r\n            transform: scale(0) rotate(0deg);\r\n            opacity: 0;\r\n          }\r\n          60% {\r\n            transform: scale(1) rotate(180deg);\r\n            opacity: 1;\r\n          }\r\n        }\r\n\r\n        @keyframes sparkle-3 {\r\n          0%,\r\n          100% {\r\n            transform: scale(0) rotate(0deg);\r\n            opacity: 0;\r\n          }\r\n          40% {\r\n            transform: scale(1) rotate(180deg);\r\n            opacity: 1;\r\n          }\r\n        }\r\n\r\n        @keyframes progress {\r\n          0% {\r\n            width: 0%;\r\n          }\r\n          100% {\r\n            width: 100%;\r\n          }\r\n        }\r\n\r\n        .animate-gradient {\r\n          animation: gradient 3s ease-in-out infinite;\r\n        }\r\n\r\n        .animate-ping-slow {\r\n          animation: ping-slow 2s cubic-bezier(0, 0, 0.2, 1) infinite;\r\n        }\r\n\r\n        .animate-pulse-slow {\r\n          animation: pulse-slow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\r\n        }\r\n\r\n        .animate-success-icon {\r\n          animation: success-icon 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);\r\n        }\r\n\r\n        .animate-error-icon {\r\n          animation: error-icon 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);\r\n        }\r\n\r\n        .animate-shake {\r\n          animation: shake 0.5s cubic-bezier(0.36, 0.07, 0.19, 0.97) 0.6s;\r\n        }\r\n\r\n        .animate-sparkle-1 {\r\n          animation: sparkle-1 1s ease-in-out 0.3s;\r\n        }\r\n\r\n        .animate-sparkle-2 {\r\n          animation: sparkle-2 1s ease-in-out 0.4s;\r\n        }\r\n\r\n        .animate-sparkle-3 {\r\n          animation: sparkle-3 1s ease-in-out 0.5s;\r\n        }\r\n\r\n        .animate-progress {\r\n          animation: progress 3s linear;\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n};\r\n"],"names":[],"mappings":";;;;;;AACA;AACA;AAAA;AAAA;;;AAFA;;;;AAYO,MAAM,oBAAoB,CAAC,EAChC,MAAM,EACN,OAAO,EACP,IAAI,EACJ,KAAK,EACL,OAAO,EACgB;;IACvB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAE/C,IAAA,0KAAS;uCAAC;YACR,IAAI,QAAQ;gBACV,aAAa;gBACb;mDAAW,IAAM,eAAe;kDAAO;gBAEvC,6BAA6B;gBAC7B,MAAM,QAAQ;yDAAW;wBACvB;oBACF;wDAAG;gBAEH;mDAAO,IAAM,aAAa;;YAC5B,OAAO;gBACL,eAAe;gBACf;mDAAW,IAAM,aAAa;kDAAQ;YACxC;QACF;sCAAG;QAAC;KAAO;IAEX,MAAM,cAAc;QAClB,eAAe;QACf,WAAW;YACT,aAAa;YACb;QACF,GAAG;IACL;IAEA,IAAI,CAAC,WAAW,OAAO;IAEvB,MAAM,YAAY,SAAS;IAE3B,qBACE,6LAAC;kDAAc;;0BAEb,6LAAC;gBAIC,OAAO;oBAAE,iBAAiB;gBAAqB;gBAC/C,SAAS;0DAJE,CAAC,sFAAsF,EAChG,cAAc,gBAAgB,aAC9B;;;;;;0BAMJ,6LAAC;0DACY,CAAC,mEAAmE,EAC7E,cACI,wCACA,qCACJ;0BAEF,cAAA,6LAAC;8DACY,CAAC,8DAA8D,EACxE,YAAY,8BAA8B,2BAC1C;;sCAGF,6LAAC;sEACY,CAAC,4BAA4B,EACtC,YACI,iEACA,0DACL,iBAAiB,CAAC;;;;;;sCAIrB,6LAAC;4BACC,SAAS;sEACC;sCAEV,cAAA,6LAAC,oMAAC;gCAAC,WAAU;;;;;;;;;;;sCAIf,6LAAC;sEAAc;;8CAEb,6LAAC;8EAAc;8CACb,cAAA,6LAAC;kFACY,CAAC,SAAS,EACnB,YAAY,yBAAyB,sBACrC;kDAED,0BACC,6LAAC;sFAAc;;8DAEb,6LAAC;8FAAc;8DACb,cAAA,6LAAC;kGAAc;;;;;;;;;;;8DAEjB,6LAAC;8FAAc;8DACb,cAAA,6LAAC;kGAAc;;;;;;;;;;;8DAGjB,6LAAC,6OAAW;oDAAC,WAAU;;;;;;8DAEvB,6LAAC;8FAAc;;sEACb,6LAAC;sGAAc;;;;;;sEACf,6LAAC;sGAAc;;;;;;sEACf,6LAAC;sGAAc;;;;;;sEACf,6LAAC;sGAAc;;;;;;sEACf,6LAAC;sGAAc;;;;;;;;;;;;;;;;;qGAInB,6LAAC;sFAAc;;8DAEb,6LAAC;8FAAc;8DACb,cAAA,6LAAC;kGAAc;;;;;;;;;;;8DAEjB,6LAAC;8FAAc;8DACb,cAAA,6LAAC;kGAAc;;;;;;;;;;;8DAGjB,6LAAC,0NAAO;oDAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;8CAO3B,6LAAC;8EACY,CAAC,oCAAoC,EAC9C,YAAY,mBAAmB,gBAC/B;8CAED;;;;;;8CAIH,6LAAC;8EAAY;8CACV;;;;;;8CAIH,6LAAC;8EAAc;8CACb,cAAA,6LAAC;kFAAc;kDACb,cAAA,6LAAC;sFACY,CAAC,OAAO,EACjB,YAAY,iBAAiB,aAC9B,iBAAiB,CAAC;;;;;;;;;;;;;;;;;;;;;;sCAO3B,6LAAC;sEACY,CAAC,IAAI,EACd,YACI,gEACA,0DACJ;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8Kd;GA3Ua;KAAA"}},
    {"offset": {"line": 331, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/nut_z/OneDrive/%E0%B9%80%E0%B8%94%E0%B8%AA%E0%B8%81%E0%B9%8C%E0%B8%97%E0%B9%87%E0%B8%AD%E0%B8%9B/new-bjh/bjh-bangkok/src/components/EditCustomerModal.tsx"],"sourcesContent":["\"use client\";\r\nimport { useState, useEffect, useMemo, useRef, useCallback, type PointerEvent } from \"react\";\r\nimport { X, Save, Loader2, Star, FileText, ClipboardCheck, Briefcase, Calendar, User } from \"lucide-react\";\r\nimport { NotificationPopup } from \"./NotificationPopup\";\r\n\r\ninterface CustomerData {\r\n  [key: string]: any;\r\n}\r\n\r\ninterface ThaiProvince {\r\n  id: number;\r\n  name_th: string;\r\n  name_en: string;\r\n}\r\n\r\ninterface ThaiDistrict {\r\n  id: number;\r\n  province_id: number;\r\n  name_th: string;\r\n  name_en: string;\r\n}\r\n\r\ninterface ThaiSubDistrict {\r\n  id: number;\r\n  district_id: number;\r\n  name_th: string;\r\n  name_en: string;\r\n  zip_code: number | string | null;\r\n}\r\n\r\ninterface ThaiAdministrativeData {\r\n  provinces: ThaiProvince[];\r\n  districts: ThaiDistrict[];\r\n  subdistricts: ThaiSubDistrict[];\r\n}\r\n\r\nconst THAI_DATA_BASE_URL =\r\n  \"https://raw.githubusercontent.com/kongvut/thai-province-data/refs/heads/master/api/latest\";\r\n\r\nlet thaiAdministrativeCache: ThaiAdministrativeData | null = null;\r\nlet thaiAdministrativePromise: Promise<ThaiAdministrativeData> | null = null;\r\n\r\nconst fetchThaiAdministrativeData = async () => {\r\n  if (thaiAdministrativeCache) {\r\n    return thaiAdministrativeCache;\r\n  }\r\n\r\n  if (!thaiAdministrativePromise) {\r\n    thaiAdministrativePromise = Promise.all([\r\n      fetch(`${THAI_DATA_BASE_URL}/province.json`).then((response) => {\r\n        if (!response.ok) {\r\n          throw new Error(\"ไม่สามารถโหลดข้อมูลจังหวัดได้\");\r\n        }\r\n        return response.json() as Promise<ThaiProvince[]>;\r\n      }),\r\n      fetch(`${THAI_DATA_BASE_URL}/district.json`).then((response) => {\r\n        if (!response.ok) {\r\n          throw new Error(\"ไม่สามารถโหลดข้อมูลอำเภอได้\");\r\n        }\r\n        return response.json() as Promise<ThaiDistrict[]>;\r\n      }),\r\n      fetch(`${THAI_DATA_BASE_URL}/sub_district.json`).then((response) => {\r\n        if (!response.ok) {\r\n          throw new Error(\"ไม่สามารถโหลดข้อมูลตำบลได้\");\r\n        }\r\n        return response.json() as Promise<ThaiSubDistrict[]>;\r\n      }),\r\n    ]).then(([provinces, districts, subdistricts]) => {\r\n      const payload: ThaiAdministrativeData = {\r\n        provinces,\r\n        districts,\r\n        subdistricts,\r\n      };\r\n      thaiAdministrativeCache = payload;\r\n      return payload;\r\n    });\r\n  }\r\n\r\n  return thaiAdministrativePromise;\r\n};\r\n\r\nconst normalizeAdministrativeName = (value: string | null | undefined) =>\r\n  value ? value.trim().toLowerCase() : \"\";\r\n\r\nconst matchesAdministrativeName = (\r\n  candidate: { name_th: string; name_en: string },\r\n  target: string\r\n) => {\r\n  const normalizedTarget = normalizeAdministrativeName(target);\r\n  if (!normalizedTarget) {\r\n    return false;\r\n  }\r\n  return (\r\n    normalizeAdministrativeName(candidate.name_th) === normalizedTarget ||\r\n    normalizeAdministrativeName(candidate.name_en) === normalizedTarget\r\n  );\r\n};\r\n\r\n// OPD Service interfaces\r\ninterface OPDServiceGroup {\r\n  groupcode: string;\r\n  groupname: string;\r\n}\r\n\r\ninterface OPDServiceItem {\r\n  itemcode: string;\r\n  itemname: string;\r\n  saleprice: number;\r\n}\r\n\r\ninterface SelectedServiceEntry {\r\n  id: string;\r\n  itemcode: string;\r\n  itemname: string;\r\n  salesprice: number;\r\n  chargePrice: string;\r\n  chargePercent: string;\r\n  discountPrice: string;\r\n  discountPercent: string;\r\n  saleType?: string;\r\n}\r\n\r\ninterface ConsentSection {\r\n  weight: string;\r\n  height: string;\r\n  hasChronic: boolean;\r\n  chronicDiseaseDetail: string;\r\n  hasDrugAllergy: boolean;\r\n  drugAllergyDetail: string;\r\n  signatureUrl: string;\r\n  medicalConsent: string;\r\n  acceptPdpa: string;\r\n  acceptMedia: string;\r\n}\r\n\r\nconst consentPartMeta = [\r\n  { key: \"patient\", label: \"ผู้รับบริการ\" },\r\n  { key: \"provider\", label: \"ผู้ให้ข้อมูล\" },\r\n] as const;\r\n\r\ntype ConsentPartKey = (typeof consentPartMeta)[number][\"key\"];\r\n\r\nconst buildEmptyConsentSections = () =>\r\n  consentPartMeta.reduce((acc, part) => {\r\n    acc[part.key] = {\r\n      weight: \"\",\r\n      height: \"\",\r\n      hasChronic: false,\r\n      chronicDiseaseDetail: \"\",\r\n      hasDrugAllergy: false,\r\n      drugAllergyDetail: \"\",\r\n      signatureUrl: \"\",\r\n      medicalConsent: \"\",\r\n      acceptPdpa: \"\",\r\n      acceptMedia: \"\",\r\n    };\r\n    return acc;\r\n  }, {} as Record<ConsentPartKey, ConsentSection>);\r\n\r\nconst medicalConsentOptions = [\"ยินยอม\", \"ไม่ยินยอม\"] as const;\r\nconst medicalConsentAcknowledgementText = [\r\n  \"ข้าพเจ้าขอแสดงความยินยอมและรับทราบเงื่อนไขการตรวจรักษาดังต่อไปนี้\",\r\n  \"ข้าพเจ้ายินยอมเข้ารับบริการหัตถการ, การศัลยกรรม หรือการรักษาทางการแพทย์อื่น ๆ ตามที่แพทย์เห็นสมควร\",\r\n  \"ข้าพเจ้าตกลงยินยอมให้ทีมแพทย์และบุคลากรทางการแพทย์ ดำเนินการตรวจวินิจฉัย รักษา ให้คำปรึกษา หรือทำหัตถการต่าง ๆ ที่จำเป็น อันรวมถึงแต่ไม่จำกัดเพียง การฉีดยา, การเจาะเลือด, การทำหัตถการเล็ก, การทำเลเซอร์, การผ่าตัดเฉพาะจุด และการรักษาโดยเทคโนโลยีต่าง ๆ ตามดุลยพินิจของแพทย์\",\r\n  \"ข้าพเจ้ารับทราบถึงผลลัพธ์ที่อาจเกิดขึ้น รวมถึงภาวะแทรกซ้อนหรือความเสี่ยงต่าง ๆ ที่อาจเกิดขึ้นได้จากการตรวจรักษาหรือหัตถการดังกล่าว และขอยืนยันว่าได้รับคำอธิบายจากบุคลากรทางการแพทย์อย่างเพียงพอแล้ว\",\r\n  \"ในกรณีเกิดเหตุการณ์ฉุกเฉิน ข้าพเจ้ายินยอมให้บุคลากรทางการแพทย์ดำเนินการรักษาอย่างเร่งด่วนตามความเหมาะสมโดยไม่จำเป็นต้องขอความยินยอมเพิ่มเติม\",\r\n  \"ข้าพเจ้ารับทราบถึงสิทธิ์ของข้าพเจ้าในการขอเข้าถึง แก้ไข หรือเพิกถอนความยินยอมในการใช้ข้อมูลส่วนบุคคล ตามที่กฎหมาย PDPA กำหนด\",\r\n  \"ข้าพเจ้าเข้าใจและยินยอมว่า เมื่อได้มีการชำระเงินมัดจำเพื่อยืนยันการจองบริการแล้ว จะไม่สามารถขอคืนเงินมัดจำดังกล่าวได้ไม่ว่ากรณีใด ๆ\",\r\n  \"ข้าพเจ้าได้อ่านและเข้าใจข้อความข้างต้นโดยชัดเจนแล้ว และยินยอมโดยสมัครใจ โดยไม่มีการบังคับหรือหลอกลวงใด ๆ ทั้งสิ้น\",\r\n  \"ผู้รับบริการขอรับรองว่าได้แสดงเจตนาไว้ก่อนเข้ารับบริการรักษาและ/หรือรับบริการใด ๆ ก็ตาม ผู้รับบริการหรือผู้แทนขอสละสิทธิ์ทุกประเภทที่จะเรียกร้องค่าเสียหายหรือค่าใช้จ่ายใด ๆ จากบริษัทหรือแพทย์ผู้เชี่ยวชาญหรือผู้ให้บริการ\",\r\n  \"ผู้รับบริการทราบดีว่าการรับบริการนี้เป็นความยินยอมและสมัครใจโดยไม่ได้ถูกบังคับ หลอกลวง หรือเข้าใจผิดในสาระสำคัญของข้อเท็จจริง\",\r\n  \"ไม่ว่ากรณีใด ๆ ผู้รับบริการจะไม่บอกเลิกการใช้บริการหรือขอคืนเงินที่ชำระไว้แล้ว\",\r\n  \"กรณีชำระเงินมัดจำไว้บางส่วนและขาดการติดต่อหรือไม่เข้ารับบริการเกิน 6 เดือน ผู้รับบริการจะหมดอายุการเป็นสมาชิก ยกเว้นกรณีชำระเงินครบถ้วนตามโปรแกรม ผู้รับบริการจะต้องเข้ารับบริการให้ครบภายในระยะเวลา 2 ปี หากเกินกำหนด บริษัทมีสิทธิ์ยกเลิกการให้บริการโดยไม่ต้องแจ้งล่วงหน้า\",\r\n  \"ผู้รับบริการต้องชำระค่าบริการให้ครบถ้วนตามที่ตกลงไว้ มิฉะนั้นโปรแกรมจะสิ้นสุดลงโดยอัตโนมัติ\",\r\n  \"หากผู้รับบริการชำระเงินไม่ครบถ้วน หากมีการรับบริการ บริษัทจะคำนวณหักค่าใช้บริการจากราคาเต็ม จนกว่าจะชำระครบแล้วจึงคิดราคาตามส่วนลดหรือโปรโมชั่น\",\r\n  \"โปรแกรมนี้เป็นโปรแกรมเฉพาะบุคคล ไม่สามารถโอนสิทธิ์ให้ผู้อื่นได้\",\r\n  \"กรณีมีปัญหาสุขภาพที่ไม่สามารถใช้โปรแกรมต่อได้ ต้องได้รับการตรวจและยืนยันจากแพทย์เท่านั้น บริษัทจะคืนเงินไม่เกิน 70% ของราคาเต็ม\",\r\n  \"ผู้รับบริการทราบและตกลงว่าจะไม่ถือเอาค่าโฆษณา คำชวน คำแนะนำ หรือคำบรรยายสรรพคุณใด ๆ จากพนักงานเป็นส่วนหนึ่งของข้อตกลง ทั้งนี้ผลลัพธ์ขึ้นกับสุขภาพร่างกาย สภาพผิว การใช้ยา สิ่งแวดล้อม และพฤติกรรมของผู้รับบริการ\",\r\n  \"หากบริษัทพิจารณาว่าสภาพผิวหรือร่างกายผู้รับบริการไม่พร้อม บริษัทขอสงวนสิทธิ์หยุดหรือยกเลิกบริการบางส่วนหรือทั้งหมดได้ทันที\",\r\n  \"ผู้รับบริการยินยอมให้ตรวจสุขภาพและทำแบบทดสอบต่าง ๆ ตามที่บริษัทกำหนด\",\r\n  \"ผู้รับบริการตกลงรับผิดชอบต่อความเสียหายที่เกิดขึ้นกับทรัพย์สินของตนเอง\",\r\n  \"ผู้รับบริการตกลงรับผิดชอบต่อการกระทำใด ๆ ที่ก่อให้เกิดความเสียหายต่อทรัพย์สินหรือชื่อเสียงของบริษัท\",\r\n  \"บริษัทมีสิทธิ์หยุด ระงับ หรือยกเลิกการให้บริการหากผู้รับบริการมีพฤติกรรมไม่เหมาะสม\",\r\n  \"สัญญานี้ไม่สามารถดัดแปลง แก้ไข หรือขูดลบใด ๆ เว้นแต่มีข้อตกลงเป็นลายลักษณ์อักษร\",\r\n  \"กรณีชำระยอดคงเหลือ ผู้รับบริการต้องชำระภายใน 14 วันนับจากวันที่ตกลงใช้บริการ\",\r\n  \"จดคืนเงินทุกกรณี: No Refund\",\r\n];\r\n\r\nconst pdpaTextBlock = [\r\n  \"PDPA - ข้าพเจ้ายินยอมให้โรงพยาบาล/คลินิก เก็บ รวบรวม ใช้ และเปิดเผยข้อมูลส่วนบุคคลเพื่อวัตถุประสงค์ในการให้บริการทางการแพทย์ และ/หรือการใช้เพื่อประโยชน์ทางการแพทย์อื่น ๆ\",\r\n  \"ข้าพเจ้ายินยอมให้มีการบันทึกภาพถ่าย วิดีโอ หรือเอกสารทางการแพทย์ที่เกี่ยวข้อง เพื่อประกอบการรักษา ติดตามผล หรือใช้เพื่อการศึกษา วิจัย หรือประชาสัมพันธ์ (โดยไม่เปิดเผยตัวตน เว้นแต่จะได้รับความยินยอมเป็นลายลักษณ์อักษรเพิ่มเติม)\",\r\n];\r\nconst mediaTextBlock = [\r\n  \"ข้าพเจ้ายินยอมให้คลินิกใช้ภาพถ่าย หรือวิดีโอที่เกิดขึ้นระหว่างการรักษาเพื่อประกอบการศึกษาภายในหรือประชาสัมพันธ์ โดยไม่ระบุชื่อบุคคล และขอสงวนสิทธิ์ในการขอความยินยอมเพิ่มเติมหากมีการเปิดเผยตัวตน\",\r\n  \"ข้าพเจ้ายินยอมรับข้อมูลประชาสัมพันธ์เกี่ยวกับการรักษา ผ่านช่องทางที่คลินิกกำหนด เพื่อเป็นส่วนหนึ่งของการติดตามผลการรักษาหรือการให้ข่าวสารสำคัญ\",\r\n];\r\nconst acceptOptions = [\"ยอมรับ\", \"ไม่ยอมรับ\"] as const;\r\n\r\n// Currency formatting helpers\r\nconst currencyFormatter = new Intl.NumberFormat(\"th-TH\", {\r\n  minimumFractionDigits: 2,\r\n  maximumFractionDigits: 2,\r\n});\r\n\r\nconst formatCurrencyDisplay = (value: number) =>\r\n  Number.isFinite(value) ? currencyFormatter.format(value) : \"0.00\";\r\n\r\nconst formatDecimalInputValue = (value: number) =>\r\n  Number.isFinite(value) ? value.toFixed(2) : \"\";\r\n\r\nconst parseMonetaryInputValue = (value: string) => {\r\n  const trimmed = value.trim();\r\n  if (!trimmed) return 0;\r\n  const numeric = Number(trimmed);\r\n  return Number.isFinite(numeric) ? numeric : 0;\r\n};\r\n\r\nconst toNumericValue = (value: unknown) => {\r\n  if (value === null || value === undefined) return 0;\r\n  if (typeof value === \"number\" && Number.isFinite(value)) {\r\n    return value;\r\n  }\r\n  const numeric = Number(value);\r\n  return Number.isFinite(numeric) ? numeric : 0;\r\n};\r\n\r\nconst normalizeSalepriceValue = (value: number | string | null | undefined) => {\r\n  if (value === null || value === undefined) return 0;\r\n  const numeric = typeof value === \"number\" ? value : Number(value);\r\n  return Number.isFinite(numeric) ? numeric : 0;\r\n};\r\n\r\nconst calculateServiceEntryTotal = (entry: SelectedServiceEntry) => {\r\n  const baseAmount = Number.isFinite(entry.salesprice) ? entry.salesprice : 0;\r\n  const chargeAmount = parseMonetaryInputValue(entry.chargePrice);\r\n  const discountAmount = parseMonetaryInputValue(entry.discountPrice);\r\n  return baseAmount + chargeAmount - discountAmount;\r\n};\r\n\r\nconst generateReceiptNumber = () => {\r\n  const twoDigits = Math.floor(Math.random() * 90 + 10);\r\n  const fourDigits = Math.floor(Math.random() * 9000 + 1000);\r\n  return `Ex${twoDigits}-${fourDigits}`;\r\n};\r\n\r\nconst bjhMasterColumnDefinitions = [\r\n  { key: \"id_all\", label: \"id_all\", readOnly: true },\r\n  { key: \"cn\", label: \"cn\" },\r\n  { key: \"code\", label: \"code\" },\r\n  { key: \"status\", label: \"status\" },\r\n  { key: \"source\", label: \"source\" },\r\n  { key: \"interested_product\", label: \"interested_product\" },\r\n  { key: \"doctor\", label: \"doctor\" },\r\n  { key: \"contact_staff\", label: \"contact_staff\" },\r\n  { key: \"prefix\", label: \"prefix\" },\r\n  { key: \"name\", label: \"name\" },\r\n  { key: \"surname\", label: \"surname\" },\r\n  { key: \"nickname\", label: \"nickname\" },\r\n  { key: \"gender\", label: \"gender\" },\r\n  { key: \"birthdate\", label: \"birthdate\" },\r\n  { key: \"occupation\", label: \"occupation\" },\r\n  { key: \"member\", label: \"member\" },\r\n  { key: \"cusgroup\", label: \"cusgroup\" },\r\n  { key: \"customer_name\", label: \"customer_name\" },\r\n  { key: \"phone\", label: \"phone\" },\r\n  { key: \"mobilephone\", label: \"mobilephone\" },\r\n  { key: \"email\", label: \"email\" },\r\n  { key: \"lineid\", label: \"lineid\" },\r\n  { key: \"facebook\", label: \"facebook\" },\r\n  { key: \"country\", label: \"country\" },\r\n  { key: \"from_province\", label: \"from_province\" },\r\n  { key: \"medianame\", label: \"medianame\" },\r\n  { key: \"disease\", label: \"disease\" },\r\n  { key: \"allergic\", label: \"allergic\" },\r\n  { key: \"note\", label: \"note\", multiline: true },\r\n  { key: \"got_contact_date\", label: \"got_contact_date\" },\r\n  { key: \"last_followup\", label: \"last_followup\" },\r\n  { key: \"next_followup\", label: \"next_followup\" },\r\n  { key: \"consult_date\", label: \"consult_date\" },\r\n  { key: \"surgery_date\", label: \"surgery_date\" },\r\n  { key: \"appointment_time\", label: \"appointment_time\" },\r\n  { key: \"booked_consult_date\", label: \"booked_consult_date\" },\r\n  { key: \"booked_surgery_date\", label: \"booked_surgery_date\" },\r\n  { key: \"proposed_amount\", label: \"proposed_amount\" },\r\n  { key: \"star_flag\", label: \"star_flag\" },\r\n  { key: \"address\", label: \"address\", multiline: true },\r\n  { key: \"province\", label: \"province\" },\r\n  { key: \"zipcode\", label: \"zipcode\" },\r\n  { key: \"registerdate\", label: \"registerdate\" },\r\n  { key: \"ownername\", label: \"ownername\" },\r\n  { key: \"binddate\", label: \"binddate\" },\r\n  { key: \"is_opd\", label: \"is_opd\" },\r\n  { key: \"locno\", label: \"locno\" },\r\n  { key: \"road\", label: \"road\" },\r\n  { key: \"moo\", label: \"moo\" },\r\n  { key: \"tumbon\", label: \"tumbon\" },\r\n  { key: \"amphur\", label: \"amphur\" },\r\n  { key: \"id_card\", label: \"id_card\" },\r\n];\r\n\r\nconst getBjFieldType = (key: string) => {\r\n  const normalized = key.toLowerCase();\r\n  if (normalized.includes(\"date\")) return \"date\";\r\n  if (normalized.includes(\"time\")) return \"time\";\r\n  if (normalized === \"proposed_amount\") return \"number\";\r\n  return \"text\";\r\n};\r\n\r\ntype AppointmentFieldType = \"text\" | \"date\" | \"textarea\" | \"tel\" | \"time\" | \"datetime-local\";\r\n\r\ninterface AppointmentFieldMeta {\r\n  key: string;\r\n  label: string;\r\n  type?: AppointmentFieldType;\r\n  placeholder?: string;\r\n  readOnly?: boolean;\r\n  fullWidth?: boolean;\r\n}\r\n\r\nconst appointmentFieldMeta: AppointmentFieldMeta[] = [\r\n  { key: \"record_no\", label: \"Record No\", readOnly: true },\r\n  { key: \"code\", label: \"Code\", readOnly: true },\r\n  { key: \"appoint_code\", label: \"Appoint Code\", readOnly: true },\r\n  { key: \"register_date\", label: \"วันที่ลงทะเบียน\", type: \"date\" },\r\n  { key: \"start_date\", label: \"วันนัด\", type: \"datetime-local\" },\r\n  { key: \"end_date\", label: \"ครบกำหนด\", type: \"datetime-local\" },\r\n  { key: \"prefix\", label: \"คำนำหน้า\" },\r\n  { key: \"name\", label: \"ชื่อ\" },\r\n  { key: \"surname\", label: \"นามสกุล\" },\r\n  { key: \"nickname\", label: \"ชื่อเล่น\" },\r\n  {\r\n    key: \"display_name\",\r\n    label: \"ชื่อที่แสดง\",\r\n    placeholder: \"เช่น ชื่อที่ลูกค้าต้องการให้แสดง\",\r\n  },\r\n  { key: \"mobilephone\", label: \"เบอร์มือถือ\", type: \"tel\" },\r\n  { key: \"email\", label: \"อีเมล\" },\r\n  { key: \"activity\", label: \"กิจกรรม\" },\r\n  { key: \"note\", label: \"หมายเหตุ\", type: \"textarea\", fullWidth: true },\r\n  { key: \"doctor_code\", label: \"รหัสหมอ\" },\r\n  { key: \"doctor_name\", label: \"ชื่อหมอ\" },\r\n  { key: \"dest_code\", label: \"รหัสจุดหมาย\" },\r\n  { key: \"dest_name\", label: \"ชื่อจุดหมาย\" },\r\n  { key: \"organize\", label: \"หน่วยงาน\" },\r\n  { key: \"bind_code\", label: \"รหัส Bind\" },\r\n  { key: \"bind_date\", label: \"วันที่ Bind\", type: \"date\" },\r\n  { key: \"id_all\", label: \"ID ลูกค้า\", readOnly: true },\r\n];\r\n\r\nconst appointmentFieldMetaMap = appointmentFieldMeta.reduce((acc, field) => {\r\n  acc[field.key] = field;\r\n  return acc;\r\n}, {} as Record<string, AppointmentFieldMeta>);\r\n\r\ntype AppointmentHistoryItem = Record<string, unknown> & {\r\n  record_no?: string | number;\r\n  appoint_code?: string;\r\n  start_date?: string | number;\r\n  end_date?: string | number;\r\n  activity?: string;\r\n  note?: string;\r\n  id_all?: string;\r\n};\r\n\r\nconst formatAppointmentDateTimeLabel = (\r\n  value?: string | number | null\r\n) => {\r\n  if (value === undefined || value === null || value === \"\") return \"-\";\r\n\r\n  const normalized = typeof value === \"number\" ? value : String(value);\r\n  const parsed = new Date(normalized);\r\n  if (Number.isNaN(parsed.getTime())) {\r\n    const fallback = typeof normalized === \"string\" ? normalized : String(normalized);\r\n    return fallback.replace(\"T\", \" \").split(\".\")[0];\r\n  }\r\n\r\n  return new Intl.DateTimeFormat(\"th-TH\", {\r\n    dateStyle: \"medium\",\r\n    timeStyle: \"short\",\r\n  }).format(parsed);\r\n};\r\n\r\nconst resolveAppointmentHistoryKey = (\r\n  entry: AppointmentHistoryItem,\r\n  index: number\r\n) => {\r\n  if (entry.appoint_code) {\r\n    return `code-${entry.appoint_code}`;\r\n  }\r\n  if (entry.record_no !== undefined && entry.record_no !== null) {\r\n    return `record-${entry.record_no}`;\r\n  }\r\n  return `history-${index}`;\r\n};\r\n\r\ninterface AppointmentSection {\r\n  title: string;\r\n  fields: string[];\r\n  columns?: string;\r\n}\r\n\r\nconst appointmentSections: AppointmentSection[] = [\r\n  {\r\n    title: \"ข้อมูลการนัดหมาย\",\r\n    fields: [\r\n      \"register_date\",\r\n      \"start_date\",\r\n      \"end_date\",\r\n      \"bind_date\",\r\n    ],\r\n    columns: \"grid-cols-1 md:grid-cols-3\",\r\n  },\r\n  {\r\n    title: \"ข้อมูลผู้รับบริการ\",\r\n    fields: [\r\n      \"prefix\",\r\n      \"name\",\r\n      \"surname\",\r\n      \"nickname\",\r\n      \"display_name\",\r\n      \"mobilephone\",\r\n      \"email\",\r\n      \"id_all\",\r\n    ],\r\n    columns: \"grid-cols-1 md:grid-cols-2\",\r\n  },\r\n  {\r\n    title: \"รายละเอียดเพิ่มเติม\",\r\n    fields: [\r\n      \"activity\",\r\n      \"note\",\r\n      \"doctor_code\",\r\n      \"doctor_name\",\r\n      \"dest_code\",\r\n      \"dest_name\",\r\n      \"organize\",\r\n      \"bind_code\",\r\n    ],\r\n    columns: \"grid-cols-1 md:grid-cols-2\",\r\n  },\r\n];\r\n\r\nconst buildEmptyAppointmentForm = () =>\r\n  appointmentFieldMeta.reduce((acc, field) => {\r\n    acc[field.key] = \"\";\r\n    return acc;\r\n  }, {} as Record<string, string>);\r\n\r\nconst resolveConsentPartKey = (value: string | null | undefined): ConsentPartKey | null => {\r\n  if (!value) return null;\r\n  const normalized = value.toString().trim().toLowerCase();\r\n  if (!normalized) return null;\r\n  if (normalized === \"patient\" || normalized.includes(\"ผู้รับ\")) return \"patient\";\r\n  if (normalized === \"provider\" || normalized.includes(\"ผู้ให้\")) return \"provider\";\r\n  const directMatch = consentPartMeta.find((part) => part.key === normalized);\r\n  return directMatch ? directMatch.key : null;\r\n};\r\n\r\ninterface SignaturePadProps {\r\n  value: string;\r\n  onChange: (value: string) => void;\r\n}\r\n\r\nconst SignaturePad = ({ value, onChange }: SignaturePadProps) => {\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n  const ctxRef = useRef<CanvasRenderingContext2D | null>(null);\r\n  const drawingRef = useRef(false);\r\n  const [isReady, setIsReady] = useState(false);\r\n\r\n  const updateSignature = useCallback(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n    onChange(canvas.toDataURL(\"image/png\"));\r\n  }, [onChange]);\r\n\r\n  const clearCanvas = useCallback(() => {\r\n    const canvas = canvasRef.current;\r\n    const ctx = ctxRef.current;\r\n    if (!canvas || !ctx) return;\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    onChange(\"\");\r\n  }, [onChange]);\r\n\r\n  const drawFromValue = useCallback(() => {\r\n    const ctx = ctxRef.current;\r\n    const canvas = canvasRef.current;\r\n    if (!ctx || !canvas) return;\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    if (!value) return;\r\n    const image = new Image();\r\n    image.crossOrigin = \"anonymous\";\r\n    image.onload = () => {\r\n      ctx.drawImage(image, 0, 0, canvas.width, canvas.height);\r\n    };\r\n    image.src = value;\r\n  }, [value]);\r\n\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n    const ctx = canvas.getContext(\"2d\");\r\n    if (!ctx) return;\r\n    const ratio = Math.max(1, window.devicePixelRatio || 1);\r\n    const clientWidth = canvas.clientWidth || 400;\r\n    const fixedHeight = 150;\r\n    canvas.width = clientWidth * ratio;\r\n    canvas.height = fixedHeight * ratio;\r\n    canvas.style.width = \"100%\";\r\n    canvas.style.height = `${fixedHeight}px`;\r\n    ctx.scale(ratio, ratio);\r\n    ctx.lineCap = \"round\";\r\n    ctx.lineJoin = \"round\";\r\n    ctx.lineWidth = 1.8;\r\n    ctx.strokeStyle = \"#4c1d95\";\r\n    ctxRef.current = ctx;\r\n    setIsReady(true);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!isReady) return;\r\n    drawFromValue();\r\n  }, [drawFromValue, isReady]);\r\n\r\n  const getPointerCoords = (event: PointerEvent<HTMLCanvasElement>) => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return { x: 0, y: 0 };\r\n    const rect = canvas.getBoundingClientRect();\r\n    return {\r\n      x: event.clientX - rect.left,\r\n      y: event.clientY - rect.top,\r\n    };\r\n  };\r\n\r\n  const handlePointerDown = (event: PointerEvent<HTMLCanvasElement>) => {\r\n    event.preventDefault();\r\n    const ctx = ctxRef.current;\r\n    if (!ctx) return;\r\n    const { x, y } = getPointerCoords(event);\r\n    drawingRef.current = true;\r\n    ctx.beginPath();\r\n    ctx.moveTo(x, y);\r\n  };\r\n\r\n  const handlePointerMove = (event: PointerEvent<HTMLCanvasElement>) => {\r\n    if (!drawingRef.current) return;\r\n    const ctx = ctxRef.current;\r\n    if (!ctx) return;\r\n    const { x, y } = getPointerCoords(event);\r\n    ctx.lineTo(x, y);\r\n    ctx.stroke();\r\n  };\r\n\r\n  const stopDrawing = () => {\r\n    if (!drawingRef.current) return;\r\n    drawingRef.current = false;\r\n    updateSignature();\r\n  };\r\n\r\n  return (\r\n    <div className=\"rounded-2xl border border-slate-200 bg-slate-50 p-3\">\r\n      <canvas\r\n        ref={canvasRef}\r\n        className=\"w-full touch-none\"\r\n        onPointerDown={handlePointerDown}\r\n        onPointerMove={handlePointerMove}\r\n        onPointerUp={stopDrawing}\r\n        onPointerLeave={stopDrawing}\r\n      />\r\n      <div className=\"mt-2 flex items-center justify-between\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={clearCanvas}\r\n          className=\"rounded-lg border border-slate-300 px-3 py-1 text-xs font-semibold text-slate-600 transition hover:border-slate-400\"\r\n        >\r\n          ล้างลายเซ็น\r\n        </button>\r\n        <span className=\"text-[11px] text-slate-500\">ลงชื่อด้วยเมาส์หรือสัมผัส</span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\ninterface EditCustomerModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  customerData: CustomerData;\r\n  onSave: (data: CustomerData) => void;\r\n}\r\nexport const EditCustomerModal = ({\r\n  isOpen,\r\n  onClose,\r\n  customerData: initialData,\r\n  onSave,\r\n}: EditCustomerModalProps) => {\r\n  const [customerData, setCustomerData] = useState<CustomerData>({});\r\n  const [activeTab, setActiveTab] = useState<\"contact\" | \"opd\" | \"consent\" | \"service\" | \"appointment\">(\"contact\");\r\n  const [statusOptions, setStatusOptions] = useState<\r\n    Array<{ value: string; label: string; color: string }>\r\n  >([]);\r\n  const [sourceOptions, setSourceOptions] = useState<\r\n    Array<{ value: string; label: string }>\r\n  >([]);\r\n  const [productOptions, setProductOptions] = useState<\r\n    Array<{ value: string; label: string }>\r\n  >([]);\r\n  const [countryOptions, setCountryOptions] = useState<\r\n    Array<{ value: string; label: string }>\r\n  >([]);\r\n  const [contactPersonOptions, setContactPersonOptions] = useState<\r\n    Array<{ value: string; label: string }>\r\n  >([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [showOPDPopup, setShowOPDPopup] = useState(false);\r\n  const [showConsentPopup, setShowConsentPopup] = useState(false);\r\n  const [showServicePopup, setShowServicePopup] = useState(false);\r\n  const [showAppointmentPopup, setShowAppointmentPopup] = useState(false);\r\n  const [appointmentForm, setAppointmentForm] = useState<Record<string, string>>(\r\n    buildEmptyAppointmentForm\r\n  );\r\n  const [appointmentLoading, setAppointmentLoading] = useState(false);\r\n  const [appointmentError, setAppointmentError] = useState<string | null>(null);\r\n  const [appointmentHistory, setAppointmentHistory] = useState<AppointmentHistoryItem[]>(\r\n    []\r\n  );\r\n  const [appointmentHistoryLoading, setAppointmentHistoryLoading] = useState(false);\r\n  const [appointmentHistoryError, setAppointmentHistoryError] = useState<string | null>(null);\r\n  const [selectedAppointmentHistoryKey, setSelectedAppointmentHistoryKey] = useState<string | null>(\r\n    null\r\n  );\r\n  const [editingAppointmentCode, setEditingAppointmentCode] = useState<string | null>(null);\r\n  const appointmentPrefillRef = useRef<Record<string, string>>({});\r\n  const [thaiProvinces, setThaiProvinces] = useState<ThaiProvince[]>([]);\r\n  const [thaiDistricts, setThaiDistricts] = useState<ThaiDistrict[]>([]);\r\n  const [thaiSubdistricts, setThaiSubdistricts] = useState<ThaiSubDistrict[]>([]);\r\n  const [selectedProvinceId, setSelectedProvinceId] = useState<number | null>(null);\r\n  const [selectedDistrictId, setSelectedDistrictId] = useState<number | null>(null);\r\n  const [selectedSubdistrictId, setSelectedSubdistrictId] = useState<number | null>(null);\r\n  const [thaiAddressLoading, setThaiAddressLoading] = useState(false);\r\n  const [thaiAddressError, setThaiAddressError] = useState<string | null>(null);\r\n  const normalizeCustomerValue = (value: unknown) => {\r\n    if (value === undefined || value === null) return \"\";\r\n    const text = typeof value === \"string\" ? value : String(value);\r\n    return text.trim();\r\n  };\r\n  const customerIdentifier = useMemo(() => {\r\n    const priorityKeys = [\"id_all\", \"id\", \"รหัสลูกค้า\", \"customer_code\"];\r\n    for (const key of priorityKeys) {\r\n      if (key in customerData) {\r\n        const normalized = normalizeCustomerValue(customerData[key]);\r\n        if (normalized) return normalized;\r\n      }\r\n    }\r\n    return \"\";\r\n  }, [customerData]);\r\n  const customerIdAll = useMemo(() => {\r\n    const possible = [\"id_all\", \"idAll\", \"id\"];\r\n    for (const key of possible) {\r\n      if (key in customerData) {\r\n        const normalized = normalizeCustomerValue(customerData[key]);\r\n        if (normalized) return normalized;\r\n      }\r\n    }\r\n    return \"\";\r\n  }, [customerData]);\r\n  const customerDisplayName = useMemo(() => {\r\n    const labelKeys = [\"ชื่อ\", \"customer_name\", \"displayName\"];\r\n    for (const key of labelKeys) {\r\n      if (key in customerData) {\r\n        const normalized = normalizeCustomerValue(customerData[key]);\r\n        if (normalized) return normalized;\r\n      }\r\n    }\r\n    return \"\";\r\n  }, [customerData]);\r\n  const customerSaleCode = useMemo(() => {\r\n    const labelKeys = [\"รหัสลูกค้า\", \"customer_code\"];\r\n    for (const key of labelKeys) {\r\n      if (key in customerData) {\r\n        const normalized = normalizeCustomerValue(customerData[key]);\r\n        if (normalized) return normalized;\r\n      }\r\n    }\r\n    return \"\";\r\n  }, [customerData]);\r\n  // OPD Service states\r\n  const [opdGroups, setOpdGroups] = useState<OPDServiceGroup[]>([]);\r\n  const [groupsLoading, setGroupsLoading] = useState(false);\r\n  const [selectedOpdGroupCode, setSelectedOpdGroupCode] = useState<string>(\"\");\r\n  const [groupServiceItems, setGroupServiceItems] = useState<OPDServiceItem[]>([]);\r\n  const [servicesLoading, setServicesLoading] = useState(false);\r\n  const [serviceError, setServiceError] = useState<string | null>(null);\r\n  const [serviceSearchTerm, setServiceSearchTerm] = useState(\"\");\r\n  const [selectedServices, setSelectedServices] = useState<SelectedServiceEntry[]>([]);\r\n  const latestServiceFetchGroupRef = useRef<string | null>(null);\r\n  const [saleItemsHistory, setSaleItemsHistory] = useState<any[]>([]);\r\n  const [saleItemsHistoryLoading, setSaleItemsHistoryLoading] = useState(false);\r\n  const [saleItemsHistoryError, setSaleItemsHistoryError] = useState<string | null>(null);\r\n  const [savingServices, setSavingServices] = useState(false);\r\n  const [showHistoryModal, setShowHistoryModal] = useState(false);\r\n  const [lastReceiptNo, setLastReceiptNo] = useState<string | null>(null);\r\n  const [consentSections, setConsentSections] = useState<Record<ConsentPartKey, ConsentSection>>(\r\n    buildEmptyConsentSections()\r\n  );\r\n  const [selectedConsentPart, setSelectedConsentPart] = useState<ConsentPartKey>(\r\n    consentPartMeta[0].key\r\n  );\r\n  const [consentLoading, setConsentLoading] = useState(false);\r\n  const [consentLoadError, setConsentLoadError] = useState<string | null>(null);\r\n  const [consentSaving, setConsentSaving] = useState(false);\r\n  const [loggedInUser, setLoggedInUser] = useState(\"\");\r\n\r\n  const [notification, setNotification] = useState<{\r\n    isOpen: boolean;\r\n    type: \"success\" | \"error\";\r\n    title: string;\r\n    message: string;\r\n  }>({\r\n    isOpen: false,\r\n    type: \"success\",\r\n    title: \"\",\r\n    message: \"\",\r\n  });\r\n\r\n  const fetchStatusOptions = async () => {\r\n    try {\r\n      const response = await fetch(\"/api/status-options\");\r\n      const result = await response.json();\r\n      if (result.success && result.data) {\r\n        setStatusOptions(result.data);\r\n      } else {\r\n        // Use fallback data when database is not accessible\r\n        setStatusOptions([\r\n          {\r\n            value: \"ติดตามต่อเนื่อง\",\r\n            label: \"ติดตามต่อเนื่อง\",\r\n            color: \"#FFD700\",\r\n          },\r\n          { value: \"ปิดการขาย\", label: \"ปิดการขาย\", color: \"#90EE90\" },\r\n          { value: \"ยกเลิก\", label: \"ยกเลิก\", color: \"#FFB6C1\" },\r\n          { value: \"รอตอบกลับ\", label: \"รอตอบกลับ\", color: \"#87CEEB\" },\r\n          {\r\n            value: \"ได้นัด Consult\",\r\n            label: \"ได้นัด Consult\",\r\n            color: \"#FFA500\",\r\n          },\r\n          { value: \"ได้นัดผ่าตัด\", label: \"ได้นัดผ่าตัด\", color: \"#FF6347\" },\r\n          { value: \"ผ่าตัดแล้ว\", label: \"ผ่าตัดแล้ว\", color: \"#32CD32\" },\r\n        ]);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching status options:\", error);\r\n      // Use fallback data on network error\r\n      setStatusOptions([\r\n        {\r\n          value: \"ติดตามต่อเนื่อง\",\r\n          label: \"ติดตามต่อเนื่อง\",\r\n          color: \"#FFD700\",\r\n        },\r\n        { value: \"ปิดการขาย\", label: \"ปิดการขาย\", color: \"#90EE90\" },\r\n        { value: \"ยกเลิก\", label: \"ยกเลิก\", color: \"#FFB6C1\" },\r\n        { value: \"รอตอบกลับ\", label: \"รอตอบกลับ\", color: \"#87CEEB\" },\r\n        { value: \"ได้นัด Consult\", label: \"ได้นัด Consult\", color: \"#FFA500\" },\r\n        { value: \"ได้นัดผ่าตัด\", label: \"ได้นัดผ่าตัด\", color: \"#FF6347\" },\r\n        { value: \"ผ่าตัดแล้ว\", label: \"ผ่าตัดแล้ว\", color: \"#32CD32\" },\r\n      ]);\r\n    }\r\n  };\r\n\r\n  const fetchSourceOptions = async () => {\r\n    try {\r\n      const response = await fetch(\"/api/source-options\");\r\n      const result = await response.json();\r\n      if (result.success && result.data) {\r\n        setSourceOptions(result.data);\r\n      } else {\r\n        // Use fallback data\r\n        setSourceOptions([\r\n          { value: \"Facebook\", label: \"Facebook\" },\r\n          { value: \"Instagram\", label: \"Instagram\" },\r\n          { value: \"Google Ads\", label: \"Google Ads\" },\r\n          { value: \"Line\", label: \"Line\" },\r\n          { value: \"Walk-in\", label: \"Walk-in\" },\r\n          { value: \"Referral\", label: \"Referral\" },\r\n        ]);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching source options:\", error);\r\n      // Use fallback data\r\n      setSourceOptions([\r\n        { value: \"Facebook\", label: \"Facebook\" },\r\n        { value: \"Instagram\", label: \"Instagram\" },\r\n        { value: \"Google Ads\", label: \"Google Ads\" },\r\n        { value: \"Line\", label: \"Line\" },\r\n        { value: \"Walk-in\", label: \"Walk-in\" },\r\n        { value: \"Referral\", label: \"Referral\" },\r\n      ]);\r\n    }\r\n  };\r\n\r\n  const fetchProductOptions = async () => {\r\n    try {\r\n      const response = await fetch(\"/api/product-options\");\r\n      const result = await response.json();\r\n      if (result.success && result.data) {\r\n        setProductOptions(result.data);\r\n      } else {\r\n        // Use fallback data\r\n        setProductOptions([\r\n          { value: \"ตีตัวไล่ตัว\", label: \"ตีตัวไล่ตัว\" },\r\n          { value: \"Sub brow lift\", label: \"Sub brow lift\" },\r\n          { value: \"แก้ตาหมื่อตอนและแก้ว\", label: \"แก้ตาหมื่อตอนและแก้ว\" },\r\n          { value: \"ตาสองชั้น\", label: \"ตาสองชั้น\" },\r\n          { value: \"เสริมจมูก\", label: \"เสริมจมูก\" },\r\n          { value: \"แก้จมูก\", label: \"แก้จมูก\" },\r\n          { value: \"เสริมตาขาว\", label: \"เสริมตาขาว\" },\r\n          { value: \"ลิฟหน้า\", label: \"ลิฟหน้า\" },\r\n          { value: \"Skin\", label: \"Skin\" },\r\n        ]);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching product options:\", error);\r\n      // Use fallback data\r\n      setProductOptions([\r\n        { value: \"ตีตัวไล่ตัว\", label: \"ตีตัวไล่ตัว\" },\r\n        { value: \"Sub brow lift\", label: \"Sub brow lift\" },\r\n        { value: \"แก้ตาหมื่อตอนและแก้ว\", label: \"แก้ตาหมื่อตอนและแก้ว\" },\r\n        { value: \"ตาสองชั้น\", label: \"ตาสองชั้น\" },\r\n        { value: \"เสริมจมูก\", label: \"เสริมจมูก\" },\r\n        { value: \"แก้จมูก\", label: \"แก้จมูก\" },\r\n        { value: \"เสริมตาขาว\", label: \"เสริมตาขาว\" },\r\n        { value: \"ลิฟหน้า\", label: \"ลิฟหน้า\" },\r\n        { value: \"Skin\", label: \"Skin\" },\r\n      ]);\r\n    }\r\n  };\r\n\r\n  const fetchCountryOptions = async () => {\r\n    try {\r\n      const response = await fetch(\"/api/country-options\");\r\n      const result = await response.json();\r\n      if (result.success && result.data) {\r\n        setCountryOptions(result.data);\r\n      } else {\r\n        // Use fallback data\r\n        setCountryOptions([\r\n          { value: \"ไทย\", label: \"ไทย\" },\r\n          { value: \"จีน\", label: \"จีน\" },\r\n          { value: \"ญี่ปุ่น\", label: \"ญี่ปุ่น\" },\r\n          { value: \"เกาหลี\", label: \"เกาหลี\" },\r\n          { value: \"สิงคโปร์\", label: \"สิงคโปร์\" },\r\n          { value: \"มาเลเซีย\", label: \"มาเลเซีย\" },\r\n          { value: \"อื่นๆ\", label: \"อื่นๆ\" },\r\n        ]);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching country options:\", error);\r\n      // Use fallback data\r\n      setCountryOptions([\r\n        { value: \"ไทย\", label: \"ไทย\" },\r\n        { value: \"จีน\", label: \"จีน\" },\r\n        { value: \"ญี่ปุ่น\", label: \"ญี่ปุ่น\" },\r\n        { value: \"เกาหลี\", label: \"เกาหลี\" },\r\n        { value: \"สิงคโปร์\", label: \"สิงคโปร์\" },\r\n        { value: \"มาเลเซีย\", label: \"มาเลเซีย\" },\r\n        { value: \"อื่นๆ\", label: \"อื่นๆ\" },\r\n      ]);\r\n    }\r\n  };\r\n\r\n  const fetchContactPersonOptions = async () => {\r\n    try {\r\n      const response = await fetch(\"/api/contact-person-options\");\r\n      const result = await response.json();\r\n      if (result.success && result.data) {\r\n        setContactPersonOptions(result.data);\r\n      } else {\r\n        // Use fallback data\r\n        setContactPersonOptions([\r\n          { value: \"ว่าน\", label: \"ว่าน\" },\r\n          { value: \"จีน\", label: \"จีน\" },\r\n          { value: \"สา\", label: \"สา\" },\r\n          { value: \"เจ\", label: \"เจ\" },\r\n          { value: \"พิดยา\", label: \"พิดยา\" },\r\n          { value: \"มุก\", label: \"มุก\" },\r\n        ]);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching contact person options:\", error);\r\n      // Use fallback data\r\n      setContactPersonOptions([\r\n        { value: \"ว่าน\", label: \"ว่าน\" },\r\n        { value: \"จีน\", label: \"จีน\" },\r\n        { value: \"สา\", label: \"สา\" },\r\n        { value: \"เจ\", label: \"เจ\" },\r\n        { value: \"พิดยา\", label: \"พิดยา\" },\r\n        { value: \"มุก\", label: \"มุก\" },\r\n      ]);\r\n    }\r\n  };\r\n\r\n  // Fetch OPD Groups\r\n  const fetchOpdGroups = async () => {\r\n    setGroupsLoading(true);\r\n    try {\r\n      const response = await fetch(\"/api/b-item-groups\");\r\n      const result = await response.json();\r\n      if (!response.ok || result.success === false) {\r\n        throw new Error(result.error || \"ไม่พบกลุ่มขาย OPD\");\r\n      }\r\n      setOpdGroups(Array.isArray(result.data) ? result.data : []);\r\n    } catch (error: any) {\r\n      console.error(\"Error fetching OPD groups:\", error);\r\n    } finally {\r\n      setGroupsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Load services for selected group\r\n  const loadServicesForGroup = async (groupCode: string) => {\r\n    if (!groupCode) {\r\n      setGroupServiceItems([]);\r\n      return;\r\n    }\r\n    latestServiceFetchGroupRef.current = groupCode;\r\n    setServicesLoading(true);\r\n    setServiceError(null);\r\n    setGroupServiceItems([]);\r\n    try {\r\n      const response = await fetch(\r\n        `/api/b-item-services?groupCode=${encodeURIComponent(groupCode)}`\r\n      );\r\n      const result = await response.json();\r\n      if (!response.ok || result.success === false) {\r\n        throw new Error(result.error || \"ไม่พบรายการบริการ\");\r\n      }\r\n      if (latestServiceFetchGroupRef.current !== groupCode) return;\r\n      const normalizedItems = Array.isArray(result.data)\r\n        ? result.data.map((item: OPDServiceItem) => ({\r\n          ...item,\r\n          saleprice: normalizeSalepriceValue(item.saleprice),\r\n        }))\r\n        : [];\r\n      setGroupServiceItems(normalizedItems as OPDServiceItem[]);\r\n    } catch (error: any) {\r\n      if (latestServiceFetchGroupRef.current !== groupCode) return;\r\n      setServiceError(error?.message || \"ไม่สามารถโหลดรายการบริการได้\");\r\n    } finally {\r\n      if (latestServiceFetchGroupRef.current === groupCode) {\r\n        setServicesLoading(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  const fetchSaleItemsHistory = useCallback(async (code: string) => {\r\n    setSaleItemsHistoryLoading(true);\r\n    setSaleItemsHistoryError(null);\r\n    try {\r\n      const response = await fetch(`/api/b-saleitem?code=${encodeURIComponent(code)}`);\r\n      const result = await response.json();\r\n      if (!response.ok || result.success === false) {\r\n        throw new Error(result.error || \"ไม่สามารถโหลดประวัติบริการได้\");\r\n      }\r\n      setSaleItemsHistory(Array.isArray(result.data) ? result.data : []);\r\n    } catch (error: any) {\r\n      setSaleItemsHistory([]);\r\n      setSaleItemsHistoryError(error?.message || \"ไม่สามารถโหลดประวัติบริการได้\");\r\n    } finally {\r\n      setSaleItemsHistoryLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const handleGroupSelect = (groupCode: string) => {\r\n    setSelectedOpdGroupCode(groupCode);\r\n    setServiceSearchTerm(\"\");\r\n    setServiceError(null);\r\n    if (!groupCode) {\r\n      setGroupServiceItems([]);\r\n      return;\r\n    }\r\n    loadServicesForGroup(groupCode);\r\n  };\r\n\r\n  const handleOpenServicePopup = () => {\r\n    setShowServicePopup(true);\r\n    setServiceError(null);\r\n    if (opdGroups.length === 0) {\r\n      fetchOpdGroups();\r\n    }\r\n    if (selectedOpdGroupCode) {\r\n      loadServicesForGroup(selectedOpdGroupCode);\r\n    }\r\n  };\r\n\r\n  const handleCloseServicePopup = () => {\r\n    setShowServicePopup(false);\r\n    setServiceSearchTerm(\"\");\r\n    setServiceError(null);\r\n  };\r\n\r\n  const handleShowHistory = () => {\r\n    if (!customerIdentifier) return;\r\n    fetchSaleItemsHistory(customerIdentifier);\r\n    setShowHistoryModal(true);\r\n  };\r\n\r\n  const handleCloseHistory = () => {\r\n    setShowHistoryModal(false);\r\n  };\r\n\r\n  const fetchConsentForms = useCallback(async () => {\r\n    if (!customerIdAll) return;\r\n    setConsentLoading(true);\r\n    setConsentLoadError(null);\r\n    setConsentSections(buildEmptyConsentSections());\r\n    try {\r\n      const response = await fetch(\r\n        `/api/consent-forms?id_all=${encodeURIComponent(customerIdAll)}`\r\n      );\r\n      const result = await response.json();\r\n      if (!response.ok || result.success === false) {\r\n        throw new Error(result.error || \"ไม่สามารถโหลด Consent form ได้\");\r\n      }\r\n      const nextSections = buildEmptyConsentSections();\r\n      if (Array.isArray(result.data)) {\r\n        result.data.forEach((item: Record<string, any>) => {\r\n          const partKey = resolveConsentPartKey(item.part);\r\n          if (!partKey) return;\r\n          const formatString = (value: unknown) =>\r\n            value === undefined || value === null ? \"\" : String(value);\r\n          nextSections[partKey] = {\r\n            weight: formatString(item.weight_kg ?? item.weight),\r\n            height: formatString(item.height_cm ?? item.height),\r\n            hasChronic: Boolean(\r\n              item.has_chronic_disease ?? item.has_chronic ?? item.hasChronic\r\n            ),\r\n            chronicDiseaseDetail:\r\n              item.chronic_disease_detail || item.chronicDiseaseDetail || \"\",\r\n            hasDrugAllergy: Boolean(\r\n              item.has_drug_allergy ?? item.hasDrugAllergy\r\n            ),\r\n            drugAllergyDetail:\r\n              item.drug_allergy_detail || item.drugAllergyDetail || \"\",\r\n            signatureUrl: item.signature_url || item.signatureUrl || \"\",\r\n            medicalConsent: item.medical_consent || item.medicalConsent || \"\",\r\n            acceptPdpa: item.accept_pdpa || item.acceptPdpa || \"\",\r\n            acceptMedia: item.accept_media || item.acceptMedia || \"\",\r\n          };\r\n        });\r\n      }\r\n      setConsentSections(nextSections);\r\n    } catch (error: any) {\r\n      console.error(\"Error fetching consent data:\", error);\r\n      setConsentLoadError(error?.message || \"ไม่สามารถโหลด Consent form ได้\");\r\n    } finally {\r\n      setConsentLoading(false);\r\n    }\r\n  }, [customerIdentifier]);\r\n\r\n  useEffect(() => {\r\n    if (showServicePopup && customerIdentifier) {\r\n      fetchSaleItemsHistory(customerIdentifier);\r\n    }\r\n  }, [showServicePopup, customerIdentifier, fetchSaleItemsHistory]);\r\n\r\n  useEffect(() => {\r\n    if (!showConsentPopup) return;\r\n    setSelectedConsentPart(consentPartMeta[0].key);\r\n    fetchConsentForms();\r\n  }, [showConsentPopup, fetchConsentForms]);\r\n\r\n  const handleConsentSectionChange = (\r\n    part: ConsentPartKey,\r\n    changes: Partial<ConsentSection>\r\n  ) => {\r\n    setConsentSections((current) => ({\r\n      ...current,\r\n      [part]: {\r\n        ...current[part],\r\n        ...changes,\r\n      },\r\n    }));\r\n  };\r\n\r\n  const handleConsentToggle = (\r\n    part: ConsentPartKey,\r\n    field: \"hasChronic\" | \"hasDrugAllergy\",\r\n    value: boolean\r\n  ) => {\r\n    const updates: Partial<ConsentSection> = { [field]: value } as Partial<ConsentSection>;\r\n    if (field === \"hasChronic\" && !value) {\r\n      updates.chronicDiseaseDetail = \"\";\r\n    }\r\n    if (field === \"hasDrugAllergy\" && !value) {\r\n      updates.drugAllergyDetail = \"\";\r\n    }\r\n    handleConsentSectionChange(part, updates);\r\n  };\r\n\r\n  const handleConsentSignatureChange = (part: ConsentPartKey, signatureUrl: string) => {\r\n    handleConsentSectionChange(part, { signatureUrl });\r\n  };\r\n\r\n  const handleSaveConsentForms = async () => {\r\n    if (!customerIdAll) {\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"error\",\r\n        title: \"ข้อมูลไม่ครบ\",\r\n        message: \"ไม่สามารถบันทึก Consent ได้ เพราะยังไม่รู้จักลูกค้า\",\r\n      });\r\n      return;\r\n    }\r\n    setConsentSaving(true);\r\n    try {\r\n      const payload = {\r\n        code: customerIdAll,\r\n        idAll: customerIdAll,\r\n        createdBy: loggedInUser || null,\r\n        sections: consentPartMeta.map((part) => {\r\n          const entry = consentSections[part.key];\r\n          return {\r\n            part: part.key,\r\n            weight: entry.weight,\r\n            height: entry.height,\r\n            hasChronic: entry.hasChronic,\r\n            chronicDiseaseDetail: entry.chronicDiseaseDetail,\r\n            hasDrugAllergy: entry.hasDrugAllergy,\r\n            drugAllergyDetail: entry.drugAllergyDetail,\r\n            signatureUrl: entry.signatureUrl,\r\n            medicalConsent: entry.medicalConsent || null,\r\n            acceptPdpa: entry.acceptPdpa || null,\r\n            acceptMedia: entry.acceptMedia || null,\r\n          };\r\n        }),\r\n      };\r\n\r\n      const response = await fetch(\"/api/consent-forms\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(payload),\r\n      });\r\n\r\n      let result: { success?: boolean; message?: string; error?: string };\r\n      try {\r\n        result = await response.json();\r\n      } catch (parseError) {\r\n        const fallbackText = await response.text();\r\n        throw new Error(\r\n          fallbackText ||\r\n          (parseError as Error).message ||\r\n          \"ไม่สามารถอ่านผลลัพธ์จากเซิร์ฟเวอร์\"\r\n        );\r\n      }\r\n      if (!response.ok || result.success === false) {\r\n        throw new Error(result.error || \"ไม่สามารถบันทึก Consent ได้\");\r\n      }\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"success\",\r\n        title: \"บันทึก Consent แล้ว\",\r\n        message: result.message || \"Consent form ถูกบันทึกเรียบร้อยแล้ว\",\r\n      });\r\n      await fetchConsentForms();\r\n    } catch (error: any) {\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"error\",\r\n        title: \"บันทึกไม่สำเร็จ\",\r\n        message: error?.message || \"เกิดข้อผิดพลาดในการบันทึก Consent\",\r\n      });\r\n    } finally {\r\n      setConsentSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleSaveSelectedServices = async () => {\r\n    if (!customerIdentifier) {\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"error\",\r\n        title: \"รหัสลูกค้าไม่ครบ\",\r\n        message: \"ไม่สามารถบันทึกบริการได้ เพราะยังไม่มีรหัสดึงข้อมูลลูกค้า\",\r\n      });\r\n      return false;\r\n    }\r\n    if (selectedServices.length === 0) {\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"error\",\r\n        title: \"ยังไม่มีบริการ\",\r\n        message: \"กรุณาเลือกบริการก่อนบันทึกลง b_saleitem\",\r\n      });\r\n      return false;\r\n    }\r\n    setSavingServices(true);\r\n    try {\r\n      const currentReceipt = lastReceiptNo ?? generateReceiptNumber();\r\n      const payload = {\r\n        code: customerIdentifier,\r\n        saleCode: customerSaleCode || null,\r\n        displayName: customerDisplayName || null,\r\n        receiptNo: currentReceipt,\r\n        services: selectedServices.map((entry) => ({\r\n          itemCode: entry.itemcode,\r\n          itemName: entry.itemname,\r\n          unitSale: entry.salesprice,\r\n          netAmount: calculateServiceEntryTotal(entry),\r\n          saleType: entry.saleType || \"20\",\r\n        })),\r\n      };\r\n\r\n      const response = await fetch(\"/api/b-saleitem\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(payload),\r\n      });\r\n\r\n      const result = await response.json();\r\n      if (!response.ok || result.success === false) {\r\n        throw new Error(result.error || \"เกิดข้อผิดพลาดในการบันทึกบริการ\");\r\n      }\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"success\",\r\n        title: \"บันทึกบริการ OPD แล้ว\",\r\n        message:\r\n          result.message ||\r\n          `บันทึก ${result.insertedCount ?? selectedServices.length} รายการลง b_saleitem แล้ว`,\r\n      });\r\n      setLastReceiptNo(currentReceipt);\r\n      if (customerIdentifier) {\r\n        fetchSaleItemsHistory(customerIdentifier);\r\n      }\r\n      return true;\r\n    } catch (error: any) {\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"error\",\r\n        title: \"ไม่สามารถบันทึกบริการได้\",\r\n        message:\r\n          error?.message || \"เกิดข้อผิดพลาดในการเชื่อมต่อกับเซิร์ฟเวอร์ กรุณาลองใหม่\",\r\n      });\r\n      return false;\r\n    } finally {\r\n      setSavingServices(false);\r\n    }\r\n  };\r\n\r\n  const handleCompleteServiceSelection = async () => {\r\n    const saved = await handleSaveSelectedServices();\r\n    if (saved) {\r\n      handleCloseServicePopup();\r\n    }\r\n  };\r\n\r\n  // Service entry update handlers\r\n  const updateSelectedServiceEntry = (\r\n    id: string,\r\n    updater: (entry: SelectedServiceEntry) => SelectedServiceEntry\r\n  ) => {\r\n    setSelectedServices((current) =>\r\n      current.map((entry) => (entry.id === id ? updater(entry) : entry))\r\n    );\r\n  };\r\n\r\n  const handleChargePriceChange = (id: string, value: string) => {\r\n    updateSelectedServiceEntry(id, (entry) => {\r\n      const trimmed = value.trim();\r\n      const numeric = Number(trimmed);\r\n      const hasValue = trimmed.length > 0 && Number.isFinite(numeric);\r\n      const nextPercent =\r\n        hasValue && entry.salesprice > 0\r\n          ? formatDecimalInputValue((numeric / entry.salesprice) * 100)\r\n          : \"\";\r\n      return { ...entry, chargePrice: value, chargePercent: nextPercent };\r\n    });\r\n  };\r\n\r\n  const handleChargePercentChange = (id: string, value: string) => {\r\n    updateSelectedServiceEntry(id, (entry) => {\r\n      const trimmed = value.trim();\r\n      const numeric = Number(trimmed);\r\n      const hasValue = trimmed.length > 0 && Number.isFinite(numeric);\r\n      const nextPrice =\r\n        hasValue && entry.salesprice > 0\r\n          ? formatDecimalInputValue((entry.salesprice * numeric) / 100)\r\n          : \"\";\r\n      return { ...entry, chargePrice: nextPrice, chargePercent: value };\r\n    });\r\n  };\r\n\r\n  const handleDiscountPriceChange = (id: string, value: string) => {\r\n    updateSelectedServiceEntry(id, (entry) => {\r\n      const trimmed = value.trim();\r\n      const numeric = Number(trimmed);\r\n      const hasValue = trimmed.length > 0 && Number.isFinite(numeric);\r\n      const nextPercent =\r\n        hasValue && entry.salesprice > 0\r\n          ? formatDecimalInputValue((numeric / entry.salesprice) * 100)\r\n          : \"\";\r\n      return { ...entry, discountPrice: value, discountPercent: nextPercent };\r\n    });\r\n  };\r\n\r\n  const handleDiscountPercentChange = (id: string, value: string) => {\r\n    updateSelectedServiceEntry(id, (entry) => {\r\n      const trimmed = value.trim();\r\n      const numeric = Number(trimmed);\r\n      const hasValue = trimmed.length > 0 && Number.isFinite(numeric);\r\n      const nextPrice =\r\n        hasValue && entry.salesprice > 0\r\n          ? formatDecimalInputValue((entry.salesprice * numeric) / 100)\r\n          : \"\";\r\n      return { ...entry, discountPrice: nextPrice, discountPercent: value };\r\n    });\r\n  };\r\n\r\n  const handleAddService = (item: OPDServiceItem) => {\r\n    setSelectedServices((current) => {\r\n      if (current.some((entry) => entry.itemcode === item.itemcode)) {\r\n        return current;\r\n      }\r\n      return [\r\n        ...current,\r\n        {\r\n          id: `${item.itemcode}-${Date.now()}`,\r\n          itemcode: item.itemcode,\r\n          itemname: item.itemname,\r\n          salesprice: normalizeSalepriceValue(item.saleprice),\r\n          chargePrice: \"\",\r\n          chargePercent: \"\",\r\n          discountPrice: \"\",\r\n          discountPercent: \"\",\r\n          saleType: \"20\",\r\n        },\r\n      ];\r\n    });\r\n  };\r\n\r\n  const handleRemoveServiceEntry = (id: string) => {\r\n    setSelectedServices((current) => current.filter((entry) => entry.id !== id));\r\n  };\r\n\r\n  // Memoized values for OPD Service\r\n  const selectedOpdGroup = useMemo(\r\n    () => opdGroups.find((group) => group.groupcode === selectedOpdGroupCode) ?? null,\r\n    [opdGroups, selectedOpdGroupCode]\r\n  );\r\n\r\n  const selectedServicesTotals = useMemo(\r\n    () =>\r\n      selectedServices.reduce(\r\n        (acc, entry) => {\r\n          const baseAmount = Number.isFinite(entry.salesprice) ? entry.salesprice : 0;\r\n          const chargeAmount = parseMonetaryInputValue(entry.chargePrice);\r\n          const discountAmount = parseMonetaryInputValue(entry.discountPrice);\r\n          const netAmount = baseAmount + chargeAmount - discountAmount;\r\n          acc.baseTotal += baseAmount;\r\n          acc.chargeTotal += chargeAmount;\r\n          acc.discountTotal += discountAmount;\r\n          acc.netTotal += netAmount;\r\n          return acc;\r\n        },\r\n        { baseTotal: 0, chargeTotal: 0, discountTotal: 0, netTotal: 0 }\r\n      ),\r\n    [selectedServices]\r\n  );\r\n\r\n  const saleHistorySummary = useMemo(\r\n    () =>\r\n      saleItemsHistory.reduce(\r\n        (acc, entry) => {\r\n          const amount = toNumericValue(entry?.amount);\r\n          acc.total += Number.isFinite(amount) ? amount : 0;\r\n          acc.count += 1;\r\n          return acc;\r\n        },\r\n        { count: 0, total: 0 }\r\n      ),\r\n    [saleItemsHistory]\r\n  );\r\n\r\n  const currentConsentSection = consentSections[selectedConsentPart];\r\n\r\n  const filteredServiceItems = useMemo(() => {\r\n    if (!serviceSearchTerm.trim()) return groupServiceItems;\r\n    const lowerTerm = serviceSearchTerm.trim().toLowerCase();\r\n    return groupServiceItems.filter(\r\n      (item) =>\r\n        item.itemname.toLowerCase().includes(lowerTerm) ||\r\n        item.itemcode.toLowerCase().includes(lowerTerm)\r\n    );\r\n  }, [groupServiceItems, serviceSearchTerm]);\r\n\r\n  useEffect(() => {\r\n    console.log(\r\n      \"📋 EditCustomerModal - isOpen:\",\r\n      isOpen,\r\n      \"initialData:\",\r\n      initialData\r\n    );\r\n    if (initialData) {\r\n      setCustomerData({ ...initialData });\r\n    }\r\n    if (isOpen) {\r\n      fetchStatusOptions();\r\n      fetchSourceOptions();\r\n      fetchProductOptions();\r\n      fetchCountryOptions();\r\n      fetchContactPersonOptions();\r\n    }\r\n  }, [initialData, isOpen]);\r\n\r\n  useEffect(() => {\r\n    try {\r\n      const storedUser = localStorage.getItem(\"user\");\r\n      if (storedUser) {\r\n        const parsed = JSON.parse(storedUser);\r\n        const name = parsed?.name || parsed?.username || parsed?.email || \"\";\r\n        setLoggedInUser(name);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Failed to load logged in user info\", error);\r\n    }\r\n  }, []);\r\n  const handleFieldChange = useCallback((fieldName: string, value: any) => {\r\n    setCustomerData((current) => ({\r\n      ...current,\r\n      [fieldName]: value,\r\n    }));\r\n  }, []);\r\n\r\n  const handleAppointmentFieldChange = useCallback((fieldName: string, value: string) => {\r\n    setAppointmentForm((current) => ({\r\n      ...current,\r\n      [fieldName]: value,\r\n    }));\r\n  }, []);\r\n\r\n  const resetAppointmentForm = useCallback(() => {\r\n    const today = new Date().toISOString().split(\"T\")[0];\r\n    setAppointmentForm({\r\n      ...buildEmptyAppointmentForm(),\r\n      ...appointmentPrefillRef.current,\r\n      register_date:\r\n        appointmentPrefillRef.current.register_date || today,\r\n      bind_date: appointmentPrefillRef.current.bind_date || today,\r\n    });\r\n    setEditingAppointmentCode(null);\r\n    setSelectedAppointmentHistoryKey(null);\r\n    setAppointmentError(null);\r\n  }, []);\r\n\r\n  const handleOpenNewAppointment = useCallback(() => {\r\n    resetAppointmentForm();\r\n  }, [resetAppointmentForm]);\r\n\r\n  const fetchAppointmentHistory = useCallback(async () => {\r\n    if (!customerIdAll) {\r\n      setAppointmentHistory([]);\r\n      setAppointmentHistoryError(\"ไม่พบ ID ลูกค้าสำหรับประวัติ\");\r\n      return;\r\n    }\r\n    setAppointmentHistoryLoading(true);\r\n    setAppointmentHistoryError(null);\r\n    try {\r\n      const response = await fetch(\r\n        `/api/appointments?id_all=${encodeURIComponent(customerIdAll)}`\r\n      );\r\n      const result = await response.json();\r\n      if (!response.ok || result.success === false) {\r\n        throw new Error(result.error || \"ไม่สามารถโหลดประวัตินัดหมายได้\");\r\n      }\r\n      setAppointmentHistory(Array.isArray(result.data) ? result.data : []);\r\n    } catch (error: any) {\r\n      setAppointmentHistory([]);\r\n      setAppointmentHistoryError(\r\n        error?.message || \"ไม่สามารถโหลดประวัตินัดหมายได้\"\r\n      );\r\n    } finally {\r\n      setAppointmentHistoryLoading(false);\r\n    }\r\n  }, [customerIdAll]);\r\n\r\n  const handleSelectAppointmentHistory = useCallback(\r\n    (entry: AppointmentHistoryItem, key: string) => {\r\n      const normalized: Record<string, string> = {};\r\n      appointmentFieldMeta.forEach((meta) => {\r\n        const rawValue = entry[meta.key];\r\n        normalized[meta.key] =\r\n          rawValue === undefined || rawValue === null ? \"\" : String(rawValue);\r\n      });\r\n      if (!normalized.id_all) {\r\n        normalized.id_all = customerIdAll;\r\n      }\r\n      setAppointmentForm({\r\n        ...buildEmptyAppointmentForm(),\r\n        ...normalized,\r\n      });\r\n      setEditingAppointmentCode(entry.appoint_code ? String(entry.appoint_code) : null);\r\n      setSelectedAppointmentHistoryKey(key);\r\n      setAppointmentError(null);\r\n    },\r\n    [customerIdAll]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!showOPDPopup) return;\r\n    setThaiAddressError(null);\r\n    if (\r\n      thaiProvinces.length &&\r\n      thaiDistricts.length &&\r\n      thaiSubdistricts.length\r\n    ) {\r\n      return;\r\n    }\r\n    let cancelled = false;\r\n    setThaiAddressLoading(true);\r\n    fetchThaiAdministrativeData()\r\n      .then((data) => {\r\n        if (cancelled) return;\r\n        setThaiProvinces(data.provinces);\r\n        setThaiDistricts(data.districts);\r\n        setThaiSubdistricts(data.subdistricts);\r\n      })\r\n      .catch((error: any) => {\r\n        if (cancelled) return;\r\n        setThaiAddressError(error?.message || \"ไม่สามารถโหลดข้อมูลที่อยู่ได้\");\r\n      })\r\n      .finally(() => {\r\n        if (cancelled) return;\r\n        setThaiAddressLoading(false);\r\n      });\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, [\r\n    showOPDPopup,\r\n    thaiProvinces.length,\r\n    thaiDistricts.length,\r\n    thaiSubdistricts.length,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    const today = new Date().toISOString().split(\"T\")[0];\r\n    appointmentPrefillRef.current = {\r\n      id_all: customerIdAll,\r\n      display_name: customerDisplayName,\r\n      prefix: customerData[\"prefix\"] || \"\",\r\n      name: customerData[\"name\"] || customerData[\"ชื่อ\"] || \"\",\r\n      surname: customerData[\"surname\"] || \"\",\r\n      nickname: customerData[\"nickname\"] || \"\",\r\n      mobilephone: customerData[\"mobilephone\"] || customerData[\"phone\"] || \"\",\r\n      email: customerData[\"email\"] || \"\",\r\n      activity: customerData[\"activity\"] || \"\",\r\n      note: customerData[\"note\"] || \"\",\r\n      register_date:\r\n        appointmentPrefillRef.current.register_date || today,\r\n      bind_date: appointmentPrefillRef.current.bind_date || today,\r\n    };\r\n  }, [customerIdAll, customerDisplayName, customerData]);\r\n\r\n  useEffect(() => {\r\n    if (!showAppointmentPopup) return;\r\n    fetchAppointmentHistory();\r\n    resetAppointmentForm();\r\n  }, [showAppointmentPopup, fetchAppointmentHistory, resetAppointmentForm]);\r\n\r\n  const provinceValue = customerData[\"province\"] || \"\";\r\n  const amphurValue = customerData[\"amphur\"] || \"\";\r\n  const tumbonValue = customerData[\"tumbon\"] || \"\";\r\n\r\n  useEffect(() => {\r\n    if (!thaiProvinces.length) {\r\n      setSelectedProvinceId(null);\r\n      return;\r\n    }\r\n    if (!provinceValue) {\r\n      setSelectedProvinceId(null);\r\n      return;\r\n    }\r\n    const match = thaiProvinces.find((item) =>\r\n      matchesAdministrativeName(item, provinceValue)\r\n    );\r\n    setSelectedProvinceId(match ? match.id : null);\r\n  }, [thaiProvinces, provinceValue]);\r\n\r\n  useEffect(() => {\r\n    if (!thaiDistricts.length) {\r\n      setSelectedDistrictId(null);\r\n      return;\r\n    }\r\n    if (!selectedProvinceId) {\r\n      setSelectedDistrictId(null);\r\n      return;\r\n    }\r\n    if (!amphurValue) {\r\n      setSelectedDistrictId(null);\r\n      return;\r\n    }\r\n    const match = thaiDistricts.find(\r\n      (item) =>\r\n        item.province_id === selectedProvinceId &&\r\n        matchesAdministrativeName(item, amphurValue)\r\n    );\r\n    setSelectedDistrictId(match ? match.id : null);\r\n  }, [thaiDistricts, selectedProvinceId, amphurValue]);\r\n\r\n  useEffect(() => {\r\n    if (!thaiSubdistricts.length) {\r\n      setSelectedSubdistrictId(null);\r\n      return;\r\n    }\r\n    if (!selectedDistrictId) {\r\n      setSelectedSubdistrictId(null);\r\n      return;\r\n    }\r\n    if (!tumbonValue) {\r\n      setSelectedSubdistrictId(null);\r\n      return;\r\n    }\r\n    const match = thaiSubdistricts.find(\r\n      (item) =>\r\n        item.district_id === selectedDistrictId &&\r\n        matchesAdministrativeName(item, tumbonValue)\r\n    );\r\n    setSelectedSubdistrictId(match ? match.id : null);\r\n  }, [thaiSubdistricts, selectedDistrictId, tumbonValue]);\r\n\r\n  useEffect(() => {\r\n    if (showOPDPopup && !customerData[\"country\"]) {\r\n      handleFieldChange(\"country\", \"Thailand\");\r\n    }\r\n  }, [showOPDPopup, customerData[\"country\"], handleFieldChange]);\r\n  const provinceOptions = useMemo(\r\n    () =>\r\n      thaiProvinces.map((province) => ({\r\n        id: province.id,\r\n        label: `${province.name_th} (${province.name_en})`,\r\n      })),\r\n    [thaiProvinces]\r\n  );\r\n  const districtOptions = useMemo(() => {\r\n    if (!selectedProvinceId) return [] as Array<{ id: number; label: string }>;\r\n    return thaiDistricts\r\n      .filter((district) => district.province_id === selectedProvinceId)\r\n      .map((district) => ({\r\n        id: district.id,\r\n        label: `${district.name_th} (${district.name_en})`,\r\n      }));\r\n  }, [thaiDistricts, selectedProvinceId]);\r\n  const subdistrictOptions = useMemo(() => {\r\n    if (!selectedDistrictId) return [] as Array<{ id: number; label: string }>;\r\n    return thaiSubdistricts\r\n      .filter((subdistrict) => subdistrict.district_id === selectedDistrictId)\r\n      .map((subdistrict) => ({\r\n        id: subdistrict.id,\r\n        label: `${subdistrict.name_th} (${subdistrict.name_en})`,\r\n      }));\r\n  }, [thaiSubdistricts, selectedDistrictId]);\r\n\r\n  const handleProvinceSelect = (provinceIdValue: string) => {\r\n    if (!provinceIdValue) {\r\n      setSelectedProvinceId(null);\r\n      setSelectedDistrictId(null);\r\n      setSelectedSubdistrictId(null);\r\n      handleFieldChange(\"province\", \"\");\r\n      handleFieldChange(\"amphur\", \"\");\r\n      handleFieldChange(\"tumbon\", \"\");\r\n      handleFieldChange(\"zipcode\", \"\");\r\n      return;\r\n    }\r\n    const numericId = Number(provinceIdValue);\r\n    if (!Number.isFinite(numericId)) return;\r\n    const province = thaiProvinces.find((item) => item.id === numericId);\r\n    setSelectedProvinceId(numericId);\r\n    setSelectedDistrictId(null);\r\n    setSelectedSubdistrictId(null);\r\n    handleFieldChange(\"province\", province?.name_th || province?.name_en || \"\");\r\n    handleFieldChange(\"amphur\", \"\");\r\n    handleFieldChange(\"tumbon\", \"\");\r\n    handleFieldChange(\"zipcode\", \"\");\r\n  };\r\n\r\n  const handleDistrictSelect = (districtIdValue: string) => {\r\n    if (!districtIdValue) {\r\n      setSelectedDistrictId(null);\r\n      setSelectedSubdistrictId(null);\r\n      handleFieldChange(\"amphur\", \"\");\r\n      handleFieldChange(\"tumbon\", \"\");\r\n      handleFieldChange(\"zipcode\", \"\");\r\n      return;\r\n    }\r\n    const numericId = Number(districtIdValue);\r\n    if (!Number.isFinite(numericId)) return;\r\n    const district = thaiDistricts.find((item) => item.id === numericId);\r\n    setSelectedDistrictId(numericId);\r\n    setSelectedSubdistrictId(null);\r\n    handleFieldChange(\"amphur\", district?.name_th || district?.name_en || \"\");\r\n    handleFieldChange(\"tumbon\", \"\");\r\n    handleFieldChange(\"zipcode\", \"\");\r\n  };\r\n\r\n  const handleSubdistrictSelect = (subdistrictIdValue: string) => {\r\n    if (!subdistrictIdValue) {\r\n      setSelectedSubdistrictId(null);\r\n      handleFieldChange(\"tumbon\", \"\");\r\n      handleFieldChange(\"zipcode\", \"\");\r\n      return;\r\n    }\r\n    const numericId = Number(subdistrictIdValue);\r\n    if (!Number.isFinite(numericId)) return;\r\n    const subdistrict = thaiSubdistricts.find((item) => item.id === numericId);\r\n    setSelectedSubdistrictId(numericId);\r\n    handleFieldChange(\"tumbon\", subdistrict?.name_th || subdistrict?.name_en || \"\");\r\n    handleFieldChange(\r\n      \"zipcode\",\r\n      subdistrict?.zip_code !== null && subdistrict?.zip_code !== undefined\r\n        ? String(subdistrict.zip_code)\r\n        : \"\"\r\n    );\r\n  };\r\n  const handleSave = async (options?: { autoClose?: boolean; onSuccess?: () => void }) => {\r\n    // Prevent duplicate submissions\r\n    if (isLoading) return;\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      const response = await fetch(\"/api/customer-data\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          action: \"update\",\r\n          data: customerData,\r\n        }),\r\n      });\r\n\r\n      const result = await response.json();\r\n\r\n      const shouldClose = options?.autoClose !== false;\r\n      if (result.success) {\r\n        options?.onSuccess?.();\r\n        setNotification({\r\n          isOpen: true,\r\n          type: \"success\",\r\n          title: \"✨ บันทึกสำเร็จ!\",\r\n          message: \"ข้อมูลลูกค้าได้รับการอัปเดตเรียบร้อยแล้ว\",\r\n        });\r\n\r\n        // Wait for notification to display then close\r\n        setTimeout(() => {\r\n          setNotification((prev) => ({ ...prev, isOpen: false }));\r\n          if (shouldClose) {\r\n            setTimeout(() => {\r\n              onSave(customerData);\r\n              onClose();\r\n            }, 300); // Wait for fade out animation\r\n          }\r\n        }, 2000); // Show notification for 2 seconds\r\n      } else {\r\n        setNotification({\r\n          isOpen: true,\r\n          type: \"error\",\r\n          title: \"❌ บันทึกไม่สำเร็จ!\",\r\n          message:\r\n            result.error ||\r\n            \"เกิดข้อผิดพลาดในการบันทึกข้อมูล กรุณาลองใหม่อีกครั้ง\",\r\n        });\r\n        setTimeout(() => {\r\n          setNotification((prev) => ({ ...prev, isOpen: false }));\r\n        }, 3000);\r\n      }\r\n    } catch (error) {\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"error\",\r\n        title: \"❌ บันทึกไม่สำเร็จ!\",\r\n        message:\r\n          \"ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้ กรุณาตรวจสอบการเชื่อมต่ออินเทอร์เน็ต\",\r\n      });\r\n      setTimeout(() => {\r\n        setNotification((prev) => ({ ...prev, isOpen: false }));\r\n      }, 3000);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSaveFromOPD = () => {\r\n    handleFieldChange(\"is_opd\", 1);\r\n    handleSave({\r\n      autoClose: false,\r\n      onSuccess: () => {\r\n        setShowOPDPopup(false);\r\n      },\r\n    });\r\n  };\r\n\r\n  const handleSaveAppointment = async () => {\r\n    if (appointmentLoading) return;\r\n    const sanitizedForm = Object.entries(appointmentForm).reduce(\r\n      (acc, [key, value]) => {\r\n        const normalized = typeof value === \"string\" ? value.trim() : value;\r\n        if (\r\n          normalized !== \"\" &&\r\n          normalized !== null &&\r\n          normalized !== undefined\r\n        ) {\r\n          acc[key] = normalized as string | number;\r\n        }\r\n        return acc;\r\n      },\r\n      {} as Record<string, string | number>\r\n    );\r\n\r\n    delete sanitizedForm.record_no;\r\n    const normalizedIdAll =\r\n      sanitizedForm.id_all || customerIdAll || appointmentPrefillRef.current.id_all;\r\n    if (normalizedIdAll) {\r\n      sanitizedForm.id_all = normalizedIdAll;\r\n    }\r\n\r\n    if (!sanitizedForm.id_all) {\r\n      setAppointmentError(\"ต้องเลือกผู้รับบริการก่อนบันทึกนัดหมาย\");\r\n      return;\r\n    }\r\n\r\n    setAppointmentLoading(true);\r\n    setAppointmentError(null);\r\n    try {\r\n      const isEditing = Boolean(editingAppointmentCode);\r\n      const endpoint = isEditing\r\n        ? `/api/appointments/${encodeURIComponent(editingAppointmentCode!)}`\r\n        : \"/api/appointments\";\r\n      const response = await fetch(endpoint, {\r\n        method: isEditing ? \"PUT\" : \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ data: sanitizedForm }),\r\n      });\r\n      const result = await response.json();\r\n      if (!response.ok || result.success === false) {\r\n        throw new Error(result.error || \"ไม่สามารถบันทึกนัดหมายได้\");\r\n      }\r\n\r\n      setNotification({\r\n        isOpen: true,\r\n        type: \"success\",\r\n        title: isEditing ? \"แก้ไขเรียบร้อย\" : \"บันทึกนัดหมายแล้ว\",\r\n        message: isEditing\r\n          ? \"ข้อมูลการนัดหมายได้รับการอัปเดตใน bjh_appointment\"\r\n          : \"ข้อมูลนัดหมายถูกส่งไปยัง bjh_appointment เรียบร้อย\",\r\n      });\r\n      resetAppointmentForm();\r\n      fetchAppointmentHistory();\r\n    } catch (error: any) {\r\n      setAppointmentError(error?.message || \"ไม่สามารถบันทึกนัดหมายได้\");\r\n    } finally {\r\n      setAppointmentLoading(false);\r\n    }\r\n  };\r\n\r\n  console.log(\"🎨 EditCustomerModal render - isOpen:\", isOpen);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  // Format date value for input (YYYY-MM-DD)\r\n  const formatDateForInput = (dateValue: any) => {\r\n    if (!dateValue) return \"\";\r\n    const date = new Date(dateValue);\r\n    if (isNaN(date.getTime())) return \"\";\r\n    return date.toISOString().split(\"T\")[0];\r\n  };\r\n\r\n  // Format time value for input (HH:MM)\r\n  const formatTimeForInput = (timeValue: any) => {\r\n    if (!timeValue) return \"\";\r\n    if (typeof timeValue === \"string\" && timeValue.match(/^\\d{2}:\\d{2}/)) {\r\n      return timeValue.substring(0, 5);\r\n    }\r\n    return timeValue;\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fadeIn\">\r\n      <div className=\"bg-white rounded-2xl shadow-2xl max-h-[90vh] overflow-hidden w-full max-w-4xl animate-slideUp transform transition-all\">\r\n        {/* Header with Gradient */}\r\n        <div className=\"sticky top-0 bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 z-10 shadow-lg\">\r\n          {/* Close button - top right */}\r\n          <div className=\"absolute top-3 right-3\">\r\n            <button\r\n              onClick={onClose}\r\n              className=\"p-2 hover:bg-white hover:bg-opacity-20 rounded-xl transition-all duration-200 group\"\r\n            >\r\n              <X className=\"w-5 h-5 text-white group-hover:rotate-90 transition-transform duration-200\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Centered Tabs */}\r\n          <div className=\"flex justify-center items-center gap-1 sm:gap-2 px-4 py-4\">\r\n            <button\r\n              onClick={() => setActiveTab(\"contact\")}\r\n              className={`flex flex-col sm:flex-row items-center justify-center gap-1 px-3 sm:px-4 py-2 sm:py-2.5 ${activeTab === \"contact\" ? \"bg-white/30 shadow-inner\" : \"bg-white/10 hover:bg-white/20\"\r\n                } text-white rounded-xl transition-all duration-200 min-w-[60px] sm:min-w-[80px]`}\r\n              title=\"Contact Information\"\r\n            >\r\n              <User className=\"w-5 h-5\" />\r\n              <span className=\"text-xs sm:text-sm font-medium hidden sm:block\">Contact</span>\r\n            </button>\r\n            <button\r\n              onClick={() => setActiveTab(\"opd\")}\r\n              className={`flex flex-col sm:flex-row items-center justify-center gap-1 px-3 sm:px-4 py-2 sm:py-2.5 ${activeTab === \"opd\" ? \"bg-white/30 shadow-inner\" : \"bg-white/10 hover:bg-white/20\"\r\n                } text-white rounded-xl transition-all duration-200 min-w-[60px] sm:min-w-[80px]`}\r\n              title=\"OPD\"\r\n            >\r\n              <FileText className=\"w-5 h-5\" />\r\n              <span className=\"text-xs sm:text-sm font-medium hidden sm:block\">OPD</span>\r\n            </button>\r\n            <button\r\n              onClick={() => setActiveTab(\"consent\")}\r\n              className={`flex flex-col sm:flex-row items-center justify-center gap-1 px-3 sm:px-4 py-2 sm:py-2.5 ${activeTab === \"consent\" ? \"bg-white/30 shadow-inner\" : \"bg-white/10 hover:bg-white/20\"\r\n                } text-white rounded-xl transition-all duration-200 min-w-[60px] sm:min-w-[80px]`}\r\n              title=\"Consent\"\r\n            >\r\n              <ClipboardCheck className=\"w-5 h-5\" />\r\n              <span className=\"text-xs sm:text-sm font-medium hidden sm:block\">Consent</span>\r\n            </button>\r\n            <button\r\n              onClick={() => {\r\n                setActiveTab(\"service\");\r\n                handleOpenServicePopup();\r\n              }}\r\n              className={`flex flex-col sm:flex-row items-center justify-center gap-1 px-3 sm:px-4 py-2 sm:py-2.5 ${activeTab === \"service\" ? \"bg-white/30 shadow-inner\" : \"bg-white/10 hover:bg-white/20\"\r\n                } text-white rounded-xl transition-all duration-200 min-w-[60px] sm:min-w-[80px] relative`}\r\n              title=\"บริการ\"\r\n            >\r\n              <Briefcase className=\"w-5 h-5\" />\r\n              <span className=\"text-xs sm:text-sm font-medium hidden sm:block\">บริการ</span>\r\n              {selectedServices.length > 0 && (\r\n                <span className=\"absolute -top-1 -right-1 bg-emerald-400 text-white text-xs w-5 h-5 flex items-center justify-center rounded-full\">\r\n                  {selectedServices.length}\r\n                </span>\r\n              )}\r\n            </button>\r\n            <button\r\n              onClick={() => setActiveTab(\"appointment\")}\r\n              className={`flex flex-col sm:flex-row items-center justify-center gap-1 px-3 sm:px-4 py-2 sm:py-2.5 ${activeTab === \"appointment\" ? \"bg-white/30 shadow-inner\" : \"bg-white/10 hover:bg-white/20\"\r\n                } text-white rounded-xl transition-all duration-200 min-w-[60px] sm:min-w-[80px]`}\r\n              title=\"นัดหมาย\"\r\n            >\r\n              <Calendar className=\"w-5 h-5\" />\r\n              <span className=\"text-xs sm:text-sm font-medium hidden sm:block\">นัดหมาย</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Scrollable Content - Show content based on active tab */}\r\n        <div\r\n          className=\"overflow-y-auto\"\r\n          style={{ maxHeight: \"calc(90vh - 180px)\" }}\r\n        >\r\n          {/* Contact Information Tab Content */}\r\n          {activeTab === \"contact\" && (\r\n            <div className=\"p-6 space-y-6\">\r\n              {/* Section 1: ข้อมูลส่วนตัว */}\r\n              <div className=\"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl p-6 border border-cyan-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-cyan-500 to-blue-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-cyan-600 to-blue-600 bg-clip-text text-transparent\">\r\n                    ข้อมูลส่วนตัว\r\n                  </h2>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n                  {/* status */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">สถานะ</label>\r\n                    <select\r\n                      value={customerData[\"status\"] || customerData[\"สถานะ\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"status\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    >\r\n                      <option value=\"\">เลือกสถานะ</option>\r\n                      {statusOptions.map((option) => (\r\n                        <option key={option.value} value={option.value}>{option.label}</option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                  {/* prefix */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">คำนำหน้า</label>\r\n                    <select\r\n                      value={customerData[\"prefix\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"prefix\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    >\r\n                      <option value=\"\">เลือกคำนำหน้า</option>\r\n                      <option value=\"นาย\">นาย</option>\r\n                      <option value=\"นาง\">นาง</option>\r\n                      <option value=\"นางสาว\">นางสาว</option>\r\n                      <option value=\"Mr.\">Mr.</option>\r\n                      <option value=\"Mrs.\">Mrs.</option>\r\n                      <option value=\"Ms.\">Ms.</option>\r\n                    </select>\r\n                  </div>\r\n                  {/* name */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ชื่อ *</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={customerData[\"name\"] || customerData[\"ชื่อ\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"name\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"กรอกชื่อ\"\r\n                    />\r\n                  </div>\r\n                  {/* surname */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">นามสกุล</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={customerData[\"surname\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"surname\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"กรอกนามสกุล\"\r\n                    />\r\n                  </div>\r\n                  {/* nickname */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ชื่อเล่น</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={customerData[\"nickname\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"nickname\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"กรอกชื่อเล่น\"\r\n                    />\r\n                  </div>\r\n                  {/* gender */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">เพศ</label>\r\n                    <select\r\n                      value={customerData[\"gender\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"gender\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    >\r\n                      <option value=\"\">เลือกเพศ</option>\r\n                      <option value=\"ชาย\">ชาย</option>\r\n                      <option value=\"หญิง\">หญิง</option>\r\n                      <option value=\"อื่นๆ\">อื่นๆ</option>\r\n                    </select>\r\n                  </div>\r\n                  {/* star_flag */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ติดดาว</label>\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => handleFieldChange(\"star_flag\", customerData[\"star_flag\"] === \"ติดดาว\" ? \"\" : \"ติดดาว\")}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl hover:border-cyan-300 transition-all duration-200 flex items-center justify-center gap-2\"\r\n                    >\r\n                      <Star className={`w-6 h-6 ${customerData[\"star_flag\"] === \"ติดดาว\" ? \"fill-yellow-400 text-yellow-400\" : \"text-gray-400\"}`} />\r\n                      <span className=\"text-sm font-medium text-gray-700\">\r\n                        {customerData[\"star_flag\"] === \"ติดดาว\" ? \"ติดดาวแล้ว\" : \"คลิกเพื่อติดดาว\"}\r\n                      </span>\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Section 2: ข้อมูลติดต่อ */}\r\n              <div className=\"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-xl p-6 border border-indigo-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-indigo-500 to-purple-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent\">\r\n                    ข้อมูลติดต่อ\r\n                  </h2>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                  {/* phone */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">เบอร์โทร</label>\r\n                    <input\r\n                      type=\"tel\"\r\n                      value={customerData[\"phone\"] || customerData[\"เบอร์โทร\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"phone\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"กรอกเบอร์โทร\"\r\n                    />\r\n                  </div>\r\n                  {/* email */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">อีเมล</label>\r\n                    <input\r\n                      type=\"email\"\r\n                      value={customerData[\"email\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"email\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"กรอกอีเมล\"\r\n                    />\r\n                  </div>\r\n                  {/* lineid */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ไลน์ไอดี</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={customerData[\"lineid\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"lineid\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"กรอกไลน์ไอดี\"\r\n                    />\r\n                  </div>\r\n                  {/* facebook */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">เฟสบุ๊ค</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={customerData[\"facebook\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"facebook\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"กรอกเฟสบุ๊ค\"\r\n                    />\r\n                  </div>\r\n                  {/* country */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ประเทศ</label>\r\n                    <select\r\n                      value={customerData[\"country\"] || customerData[\"ประเทศ\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"country\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    >\r\n                      <option value=\"\">เลือกประเทศ</option>\r\n                      {countryOptions.map((option) => (\r\n                        <option key={option.value} value={option.value}>{option.label}</option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Section 3: ข้อมูลธุรกิจ */}\r\n              <div className=\"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl p-6 border border-emerald-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-emerald-500 to-teal-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent\">\r\n                    ข้อมูลธุรกิจ\r\n                  </h2>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n                  {/* source */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">แหล่งที่มา</label>\r\n                    <select\r\n                      value={customerData[\"source\"] || customerData[\"  แหล่งที่มา\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"source\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    >\r\n                      <option value=\"\">เลือกแหล่งที่มา</option>\r\n                      {sourceOptions.map((option) => (\r\n                        <option key={option.value} value={option.value}>{option.label}</option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                  {/* interested_product */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ผลิตภัณฑ์ที่สนใจ</label>\r\n                    <select\r\n                      value={customerData[\"interested_product\"] || customerData[\" ผลิตภัณฑ์ที่สนใจ\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"interested_product\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    >\r\n                      <option value=\"\">เลือกผลิตภัณฑ์</option>\r\n                      {productOptions.map((option) => (\r\n                        <option key={option.value} value={option.value}>{option.label}</option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                  {/* contact_staff */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ผู้ติดต่อ</label>\r\n                    <select\r\n                      value={customerData[\"contact_staff\"] || customerData[\"ผู้ติดต่อ\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"contact_staff\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    >\r\n                      <option value=\"\">เลือกผู้ติดต่อ</option>\r\n                      {contactPersonOptions.map((option) => (\r\n                        <option key={option.value} value={option.value}>{option.label}</option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                  {/* proposed_amount */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ยอดนำเสนอ</label>\r\n                    <input\r\n                      type=\"number\"\r\n                      value={customerData[\"proposed_amount\"] || customerData[\"ยอดนำเสนอ\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"proposed_amount\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"กรอกยอดนำเสนอ\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Section 4: วันที่ติดตาม */}\r\n              <div className=\"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl p-6 border border-cyan-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-cyan-500 to-blue-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-cyan-600 to-blue-600 bg-clip-text text-transparent\">\r\n                    วันที่ติดตาม\r\n                  </h2>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                  {/* got_contact_date */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                      <span>📅</span> วันที่ได้ชื่อ เบอร์\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={formatDateForInput(customerData[\"got_contact_date\"] || customerData[\"วันที่ได้ชื่อ เบอร์ \"])}\r\n                      onChange={(e) => handleFieldChange(\"got_contact_date\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    />\r\n                  </div>\r\n                  {/* last_followup */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                      <span>📅</span> วันที่ติดตามครั้งล่าสุด\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={formatDateForInput(customerData[\"last_followup\"] || customerData[\"วันที่ติดตามครั้งล่าสุด\"])}\r\n                      onChange={(e) => handleFieldChange(\"last_followup\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    />\r\n                  </div>\r\n                  {/* next_followup */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                      <span>📅</span> วันที่ติดตามครั้งถัดไป\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={formatDateForInput(customerData[\"next_followup\"] || customerData[\"วันที่ติดตามครั้งถัดไป\"])}\r\n                      onChange={(e) => handleFieldChange(\"next_followup\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Section 5: วันที่ Consult */}\r\n              <div className=\"bg-gradient-to-br from-purple-50 to-violet-50 rounded-xl p-6 border border-purple-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-purple-500 to-violet-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-purple-600 to-violet-600 bg-clip-text text-transparent\">\r\n                    วันที่ Consult\r\n                  </h2>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  {/* booked_consult_date */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                      <span>📅</span> วันที่ได้นัด consult\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={formatDateForInput(customerData[\"booked_consult_date\"] || customerData[\"วันที่ได้นัด consult\"])}\r\n                      onChange={(e) => handleFieldChange(\"booked_consult_date\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-purple-200 bg-white rounded-xl focus:ring-2 focus:ring-purple-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    />\r\n                  </div>\r\n                  {/* consult_date */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                      <span>📅</span> วันที่ Consult\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={formatDateForInput(customerData[\"consult_date\"] || customerData[\"  วันที่ Consult\"])}\r\n                      onChange={(e) => handleFieldChange(\"consult_date\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-purple-200 bg-white rounded-xl focus:ring-2 focus:ring-purple-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Section 6: วันที่ผ่าตัด */}\r\n              <div className=\"bg-gradient-to-br from-rose-50 to-pink-50 rounded-xl p-6 border border-rose-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-rose-500 to-pink-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-rose-600 to-pink-600 bg-clip-text text-transparent\">\r\n                    วันที่ผ่าตัด\r\n                  </h2>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  {/* booked_surgery_date */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                      <span>📅</span> วันที่ได้นัดผ่าตัด\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={formatDateForInput(customerData[\"booked_surgery_date\"] || customerData[\"วันที่ได้นัดผ่าตัด\"])}\r\n                      onChange={(e) => handleFieldChange(\"booked_surgery_date\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-rose-200 bg-white rounded-xl focus:ring-2 focus:ring-rose-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    />\r\n                  </div>\r\n                  {/* surgery_date */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                      <span>📅</span> วันที่ผ่าตัด\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={formatDateForInput(customerData[\"surgery_date\"] || customerData[\"วันที่ผ่าตัด\"])}\r\n                      onChange={(e) => handleFieldChange(\"surgery_date\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-rose-200 bg-white rounded-xl focus:ring-2 focus:ring-rose-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    />\r\n                  </div>\r\n                  {/* appointment_time */}\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                      <span>⏰</span> เวลาที่นัด\r\n                    </label>\r\n                    <input\r\n                      type=\"time\"\r\n                      value={formatTimeForInput(customerData[\"appointment_time\"] || customerData[\"เวลาที่นัด\"])}\r\n                      onChange={(e) => handleFieldChange(\"appointment_time\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-rose-200 bg-white rounded-xl focus:ring-2 focus:ring-rose-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Section 7: หมายเหตุ */}\r\n              <div className=\"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl p-6 border border-amber-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-amber-500 to-yellow-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-amber-600 to-yellow-600 bg-clip-text text-transparent\">\r\n                    หมายเหตุ\r\n                  </h2>\r\n                </div>\r\n                <textarea\r\n                  value={customerData[\"note\"] || customerData[\"หมายเหตุ\"] || \"\"}\r\n                  onChange={(e) => handleFieldChange(\"note\", e.target.value)}\r\n                  className=\"w-full px-4 py-3 border-2 border-amber-200 bg-white rounded-xl focus:ring-2 focus:ring-amber-400 focus:border-transparent outline-none min-h-[120px] resize-none\"\r\n                  placeholder=\"📝 พิมพ์หมายเหตุ...\"\r\n                />\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* OPD Tab Content */}\r\n          {activeTab === \"opd\" && (\r\n            <div className=\"p-6 space-y-6\">\r\n              <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-blue-500 to-indigo-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent\">\r\n                    ข้อมูล OPD - ที่อยู่\r\n                  </h2>\r\n                </div>\r\n                {thaiAddressLoading && (\r\n                  <p className=\"text-xs text-emerald-600 mb-4\">กำลังโหลดข้อมูลจังหวัด/อำเภอ/ตำบล...</p>\r\n                )}\r\n                {thaiAddressError && (\r\n                  <p className=\"text-xs text-red-600 mb-4\">{thaiAddressError}</p>\r\n                )}\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">บ้านเลขที่</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={customerData[\"locno\"] || \"\"}\r\n                      onChange={(e) => handleFieldChange(\"locno\", e.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-blue-200 bg-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-transparent outline-none\"\r\n                      placeholder=\"ระบุบ้านเลขที่\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">จังหวัด</label>\r\n                      <select\r\n                        value={selectedProvinceId ? String(selectedProvinceId) : \"\"}\r\n                        onChange={(e) => handleProvinceSelect(e.target.value)}\r\n                        className=\"w-full px-4 py-3 border-2 border-blue-200 bg-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-transparent outline-none cursor-pointer\"\r\n                      >\r\n                        <option value=\"\">เลือกจังหวัด</option>\r\n                        {provinceOptions.map((option) => (\r\n                          <option key={option.id} value={option.id}>{option.label}</option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">อำเภอ / เขต</label>\r\n                      <select\r\n                        value={selectedDistrictId ? String(selectedDistrictId) : \"\"}\r\n                        onChange={(e) => handleDistrictSelect(e.target.value)}\r\n                        disabled={!districtOptions.length}\r\n                        className=\"w-full px-4 py-3 border-2 border-blue-200 bg-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-transparent outline-none cursor-pointer disabled:bg-gray-100\"\r\n                      >\r\n                        <option value=\"\">เลือกอำเภอ / เขต</option>\r\n                        {districtOptions.map((option) => (\r\n                          <option key={option.id} value={option.id}>{option.label}</option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ตำบล / แขวง</label>\r\n                      <select\r\n                        value={selectedSubdistrictId ? String(selectedSubdistrictId) : \"\"}\r\n                        onChange={(e) => handleSubdistrictSelect(e.target.value)}\r\n                        disabled={!subdistrictOptions.length}\r\n                        className=\"w-full px-4 py-3 border-2 border-blue-200 bg-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-transparent outline-none cursor-pointer disabled:bg-gray-100\"\r\n                      >\r\n                        <option value=\"\">เลือกตำบล / แขวง</option>\r\n                        {subdistrictOptions.map((option) => (\r\n                          <option key={option.id} value={option.id}>{option.label}</option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">รหัสไปรษณีย์</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={customerData[\"zipcode\"] || \"\"}\r\n                        readOnly\r\n                        className=\"w-full px-4 py-3 border-2 border-blue-200 bg-gray-100 rounded-xl outline-none text-gray-700\"\r\n                        placeholder=\"รหัสไปรษณีย์ (อัตโนมัติ)\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Consent Tab Content */}\r\n          {activeTab === \"consent\" && (\r\n            <div className=\"p-6 space-y-6\">\r\n              <div className=\"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl p-6 border border-emerald-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-emerald-500 to-teal-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent\">\r\n                    Consent Form\r\n                  </h2>\r\n                </div>\r\n                {/* Consent Part Tabs */}\r\n                <div className=\"flex gap-2 mb-6\">\r\n                  {consentPartMeta.map((part) => (\r\n                    <button\r\n                      key={part.key}\r\n                      onClick={() => setSelectedConsentPart(part.key)}\r\n                      className={`px-4 py-2 rounded-lg font-medium transition-all ${selectedConsentPart === part.key\r\n                        ? \"bg-emerald-500 text-white shadow-md\"\r\n                        : \"bg-white border border-emerald-200 text-emerald-700 hover:bg-emerald-50\"\r\n                        }`}\r\n                    >\r\n                      {part.label}\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n                {consentLoading ? (\r\n                  <div className=\"flex items-center justify-center py-8\">\r\n                    <Loader2 className=\"w-8 h-8 animate-spin text-emerald-500\" />\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                      <div className=\"group\">\r\n                        <label className=\"block text-sm font-semibold text-gray-700 mb-2\">น้ำหนัก (kg)</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={consentSections[selectedConsentPart]?.weight || \"\"}\r\n                          onChange={(e) => setConsentSections((prev) => ({\r\n                            ...prev,\r\n                            [selectedConsentPart]: { ...prev[selectedConsentPart], weight: e.target.value }\r\n                          }))}\r\n                          className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none\"\r\n                          placeholder=\"ระบุน้ำหนัก\"\r\n                        />\r\n                      </div>\r\n                      <div className=\"group\">\r\n                        <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ส่วนสูง (cm)</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={consentSections[selectedConsentPart]?.height || \"\"}\r\n                          onChange={(e) => setConsentSections((prev) => ({\r\n                            ...prev,\r\n                            [selectedConsentPart]: { ...prev[selectedConsentPart], height: e.target.value }\r\n                          }))}\r\n                          className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none\"\r\n                          placeholder=\"ระบุส่วนสูง\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"group\">\r\n                      <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2\">\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={consentSections[selectedConsentPart]?.hasChronic || false}\r\n                          onChange={(e) => setConsentSections((prev) => ({\r\n                            ...prev,\r\n                            [selectedConsentPart]: { ...prev[selectedConsentPart], hasChronic: e.target.checked }\r\n                          }))}\r\n                          className=\"w-4 h-4 rounded border-gray-300 text-emerald-500 focus:ring-emerald-400\"\r\n                        />\r\n                        มีโรคประจำตัว\r\n                      </label>\r\n                      {consentSections[selectedConsentPart]?.hasChronic && (\r\n                        <input\r\n                          type=\"text\"\r\n                          value={consentSections[selectedConsentPart]?.chronicDiseaseDetail || \"\"}\r\n                          onChange={(e) => setConsentSections((prev) => ({\r\n                            ...prev,\r\n                            [selectedConsentPart]: { ...prev[selectedConsentPart], chronicDiseaseDetail: e.target.value }\r\n                          }))}\r\n                          className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none mt-2\"\r\n                          placeholder=\"ระบุโรคประจำตัว\"\r\n                        />\r\n                      )}\r\n                    </div>\r\n                    <div className=\"group\">\r\n                      <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2\">\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={consentSections[selectedConsentPart]?.hasDrugAllergy || false}\r\n                          onChange={(e) => setConsentSections((prev) => ({\r\n                            ...prev,\r\n                            [selectedConsentPart]: { ...prev[selectedConsentPart], hasDrugAllergy: e.target.checked }\r\n                          }))}\r\n                          className=\"w-4 h-4 rounded border-gray-300 text-emerald-500 focus:ring-emerald-400\"\r\n                        />\r\n                        มีประวัติแพ้ยา\r\n                      </label>\r\n                      {consentSections[selectedConsentPart]?.hasDrugAllergy && (\r\n                        <input\r\n                          type=\"text\"\r\n                          value={consentSections[selectedConsentPart]?.drugAllergyDetail || \"\"}\r\n                          onChange={(e) => setConsentSections((prev) => ({\r\n                            ...prev,\r\n                            [selectedConsentPart]: { ...prev[selectedConsentPart], drugAllergyDetail: e.target.value }\r\n                          }))}\r\n                          className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none mt-2\"\r\n                          placeholder=\"ระบุยาที่แพ้\"\r\n                        />\r\n                      )}\r\n                    </div>\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ยินยอมรับการรักษา</label>\r\n                      <select\r\n                        value={consentSections[selectedConsentPart]?.medicalConsent || \"\"}\r\n                        onChange={(e) => setConsentSections((prev) => ({\r\n                          ...prev,\r\n                          [selectedConsentPart]: { ...prev[selectedConsentPart], medicalConsent: e.target.value }\r\n                        }))}\r\n                        className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                      >\r\n                        <option value=\"\">เลือก</option>\r\n                        {medicalConsentOptions.map((opt) => (\r\n                          <option key={opt} value={opt}>{opt}</option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ยอมรับ PDPA</label>\r\n                      <select\r\n                        value={consentSections[selectedConsentPart]?.acceptPdpa || \"\"}\r\n                        onChange={(e) => setConsentSections((prev) => ({\r\n                          ...prev,\r\n                          [selectedConsentPart]: { ...prev[selectedConsentPart], acceptPdpa: e.target.value }\r\n                        }))}\r\n                        className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                      >\r\n                        <option value=\"\">เลือก</option>\r\n                        {acceptOptions.map((opt) => (\r\n                          <option key={opt} value={opt}>{opt}</option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ยินยอมเผยแพร่สื่อ</label>\r\n                      <select\r\n                        value={consentSections[selectedConsentPart]?.acceptMedia || \"\"}\r\n                        onChange={(e) => setConsentSections((prev) => ({\r\n                          ...prev,\r\n                          [selectedConsentPart]: { ...prev[selectedConsentPart], acceptMedia: e.target.value }\r\n                        }))}\r\n                        className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                      >\r\n                        <option value=\"\">เลือก</option>\r\n                        {acceptOptions.map((opt) => (\r\n                          <option key={opt} value={opt}>{opt}</option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n                    {/* Signature Pad */}\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ลายเซ็น</label>\r\n                      <SignaturePad\r\n                        value={consentSections[selectedConsentPart]?.signatureUrl || \"\"}\r\n                        onChange={(url) => setConsentSections((prev) => ({\r\n                          ...prev,\r\n                          [selectedConsentPart]: { ...prev[selectedConsentPart], signatureUrl: url }\r\n                        }))}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Service Tab Content */}\r\n          {activeTab === \"service\" && (\r\n            <div className=\"p-6 space-y-6\">\r\n              <div className=\"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-purple-500 to-pink-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent\">\r\n                    บริการ\r\n                  </h2>\r\n                </div>\r\n                {/* Service Group Selection */}\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">กลุ่มบริการ</label>\r\n                    <select\r\n                      value={selectedOpdGroupCode}\r\n                      onChange={(e) => setSelectedOpdGroupCode(e.target.value)}\r\n                      disabled={groupsLoading}\r\n                      className=\"w-full px-4 py-3 border-2 border-purple-200 bg-white rounded-xl focus:ring-2 focus:ring-purple-400 focus:border-transparent outline-none cursor-pointer\"\r\n                    >\r\n                      <option value=\"\">เลือกกลุ่มบริการ</option>\r\n                      {opdGroups.map((group) => (\r\n                        <option key={group.groupcode} value={group.groupcode}>{group.groupname}</option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                  {/* Service Search */}\r\n                  {selectedOpdGroupCode && (\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ค้นหาบริการ</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={serviceSearchTerm}\r\n                        onChange={(e) => setServiceSearchTerm(e.target.value)}\r\n                        className=\"w-full px-4 py-3 border-2 border-purple-200 bg-white rounded-xl focus:ring-2 focus:ring-purple-400 focus:border-transparent outline-none\"\r\n                        placeholder=\"พิมพ์ชื่อบริการ...\"\r\n                      />\r\n                    </div>\r\n                  )}\r\n                  {/* Selected Services Summary */}\r\n                  {selectedServices.length > 0 && (\r\n                    <div className=\"bg-purple-100 rounded-xl p-4\">\r\n                      <h3 className=\"font-semibold text-purple-800 mb-2\">บริการที่เลือก ({selectedServices.length})</h3>\r\n                      <div className=\"space-y-2\">\r\n                        {selectedServices.map((svc) => (\r\n                          <div key={svc.id} className=\"flex justify-between items-center bg-white rounded-lg p-2\">\r\n                            <span className=\"text-sm text-gray-700\">{svc.itemname}</span>\r\n                            <span className=\"text-sm font-semibold text-purple-600\">\r\n                              {formatCurrencyDisplay(calculateServiceEntryTotal(svc))} ฿\r\n                            </span>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Appointment Tab Content */}\r\n          {activeTab === \"appointment\" && (\r\n            <div className=\"p-6 space-y-6\">\r\n              <div className=\"bg-gradient-to-br from-orange-50 to-amber-50 rounded-xl p-6 border border-orange-100 shadow-sm\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-1 h-6 bg-gradient-to-b from-orange-500 to-amber-500 rounded-full\"></div>\r\n                  <h2 className=\"text-lg font-bold bg-gradient-to-r from-orange-600 to-amber-600 bg-clip-text text-transparent\">\r\n                    นัดหมาย\r\n                  </h2>\r\n                </div>\r\n                {appointmentLoading ? (\r\n                  <div className=\"flex items-center justify-center py-8\">\r\n                    <Loader2 className=\"w-8 h-8 animate-spin text-orange-500\" />\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"space-y-4\">\r\n                    {appointmentSections.map((section, idx) => (\r\n                      <div key={idx} className=\"space-y-4\">\r\n                        <h3 className=\"font-semibold text-gray-800\">{section.title}</h3>\r\n                        <div className={`grid ${section.columns || \"grid-cols-1 md:grid-cols-2\"} gap-4`}>\r\n                          {section.fields.map((fieldKey) => {\r\n                            const fieldMeta = appointmentFieldMetaMap[fieldKey];\r\n                            if (!fieldMeta) return null;\r\n                            return (\r\n                              <div key={fieldKey} className={fieldMeta.fullWidth ? \"col-span-full\" : \"\"}>\r\n                                <label className=\"block text-sm font-semibold text-gray-700 mb-2\">{fieldMeta.label}</label>\r\n                                {fieldMeta.type === \"textarea\" ? (\r\n                                  <textarea\r\n                                    value={appointmentForm[fieldKey] || \"\"}\r\n                                    onChange={(e) => setAppointmentForm((prev) => ({ ...prev, [fieldKey]: e.target.value }))}\r\n                                    readOnly={fieldMeta.readOnly}\r\n                                    className=\"w-full px-4 py-3 border-2 border-orange-200 bg-white rounded-xl focus:ring-2 focus:ring-orange-400 focus:border-transparent outline-none min-h-[100px] resize-none\"\r\n                                    placeholder={fieldMeta.placeholder}\r\n                                  />\r\n                                ) : (\r\n                                  <input\r\n                                    type={fieldMeta.type || \"text\"}\r\n                                    value={appointmentForm[fieldKey] || \"\"}\r\n                                    onChange={(e) => setAppointmentForm((prev) => ({ ...prev, [fieldKey]: e.target.value }))}\r\n                                    readOnly={fieldMeta.readOnly}\r\n                                    className={`w-full px-4 py-3 border-2 border-orange-200 ${fieldMeta.readOnly ? \"bg-gray-100\" : \"bg-white\"} rounded-xl focus:ring-2 focus:ring-orange-400 focus:border-transparent outline-none`}\r\n                                    placeholder={fieldMeta.placeholder}\r\n                                  />\r\n                                )}\r\n                              </div>\r\n                            );\r\n                          })}\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                    {/* Appointment History */}\r\n                    {appointmentHistory.length > 0 && (\r\n                      <div className=\"mt-6\">\r\n                        <h3 className=\"font-semibold text-gray-800 mb-4\">ประวัตินัดหมาย</h3>\r\n                        <div className=\"space-y-2\">\r\n                          {appointmentHistory.map((item, idx) => (\r\n                            <div\r\n                              key={resolveAppointmentHistoryKey(item, idx)}\r\n                              className=\"bg-white border border-orange-200 rounded-lg p-3 hover:shadow-md transition-shadow cursor-pointer\"\r\n                              onClick={() => {\r\n                                const key = resolveAppointmentHistoryKey(item, idx);\r\n                                setSelectedAppointmentHistoryKey(selectedAppointmentHistoryKey === key ? null : key);\r\n                              }}\r\n                            >\r\n                              <div className=\"flex justify-between items-center\">\r\n                                <span className=\"text-sm font-medium text-gray-700\">{item.activity || \"ไม่ระบุกิจกรรม\"}</span>\r\n                                <span className=\"text-xs text-gray-500\">{formatAppointmentDateTimeLabel(item.start_date)}</span>\r\n                              </div>\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Footer with Gradient */}\r\n        <div className=\"sticky bottom-0 bg-gradient-to-t from-gray-50 to-white border-t border-gray-200 p-4 sm:p-5 flex justify-center gap-4 shadow-lg\">\r\n          <button\r\n            onClick={onClose}\r\n            disabled={isLoading}\r\n            className=\"px-6 sm:px-8 py-2.5 sm:py-3 border-2 border-gray-300 rounded-xl text-gray-700 text-sm sm:text-base font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          >\r\n            ยกเลิก\r\n          </button>\r\n          <button\r\n            onClick={() => handleSave()}\r\n            disabled={isLoading}\r\n            className=\"flex items-center gap-2 px-6 sm:px-8 py-2.5 sm:py-3 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white text-sm sm:text-base font-semibold rounded-xl transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed shadow-lg hover:shadow-xl\"\r\n          >\r\n            {isLoading ? (\r\n              <>\r\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                กำลังบันทึก...\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Save className=\"w-4 h-4\" />\r\n                บันทึก\r\n              </>\r\n            )}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Notification Popup */}\r\n      <NotificationPopup\r\n        isOpen={notification.isOpen}\r\n        onClose={() => setNotification({ ...notification, isOpen: false })}\r\n        type={notification.type}\r\n        title={notification.title}\r\n        message={notification.message}\r\n      />\r\n\r\n      {/* OPD Popup Modal */}\r\n      {showOPDPopup && (\r\n        <div className=\"fixed inset-0 z-[60] flex items-center justify-center p-4\">\r\n          <div\r\n            className=\"absolute inset-0 bg-black/50\"\r\n            onClick={() => setShowOPDPopup(false)}\r\n          />\r\n          <div className=\"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[80vh] overflow-hidden animate-slideUp\">\r\n            <div className=\"bg-gradient-to-r from-blue-500 to-blue-600 px-6 py-4 flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <FileText className=\"w-6 h-6 text-white\" />\r\n                <h2 className=\"text-lg font-semibold text-white\">เปิด OPD</h2>\r\n              </div>\r\n              <button\r\n                onClick={() => setShowOPDPopup(false)}\r\n                className=\"p-2 hover:bg-white/20 rounded-full transition-colors\"\r\n              >\r\n                <X className=\"w-5 h-5 text-white\" />\r\n              </button>\r\n            </div>\r\n            <div className=\"p-6 overflow-y-auto max-h-[calc(80vh-80px)] space-y-6\">\r\n              <div className=\"space-y-2 text-sm text-slate-600\">\r\n                <p className=\"text-base font-semibold text-slate-800\">ข้อมูล OPD</p>\r\n                <p className=\"text-slate-500\">เลือกตำแหน่งที่ตั้งเพื่อบันทึกลง bjh_master_customers พร้อม LocNo และ Zipcode อัตโนมัติ</p>\r\n                {thaiAddressLoading && (\r\n                  <p className=\"text-xs text-emerald-600\">กำลังโหลดข้อมูลจังหวัด/อำเภอ/ตำบล...</p>\r\n                )}\r\n                {thaiAddressError && (\r\n                  <p className=\"text-xs text-red-600\">{thaiAddressError}</p>\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"space-y-4\">\r\n                <div className=\"group\">\r\n                  <label className=\"block text-sm font-semibold text-gray-700 mb-2\">บ้านเลขที่</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={customerData[\"locno\"] || \"\"}\r\n                    onChange={(event) => handleFieldChange(\"locno\", event.target.value)}\r\n                    className=\"w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white text-gray-900 placeholder:text-slate-400 focus:border-cyan-400 focus:ring-2 focus:ring-cyan-400 outline-none transition\"\r\n                    placeholder=\"ระบุบ้านเลขที่\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">จังหวัด</label>\r\n                    <select\r\n                      value={selectedProvinceId ? String(selectedProvinceId) : \"\"}\r\n                      onChange={(event) => handleProvinceSelect(event.target.value)}\r\n                      className=\"w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white text-gray-900 transition focus:ring-2 focus:ring-cyan-400 focus:border-transparent\"\r\n                    >\r\n                      <option value=\"\">เลือกจังหวัด</option>\r\n                      {provinceOptions.map((option) => (\r\n                        <option key={option.id} value={option.id}>\r\n                          {option.label}\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">อำเภอ / เขต</label>\r\n                    <select\r\n                      value={selectedDistrictId ? String(selectedDistrictId) : \"\"}\r\n                      onChange={(event) => handleDistrictSelect(event.target.value)}\r\n                      disabled={!districtOptions.length}\r\n                      className=\"w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white text-gray-900 transition focus:ring-2 focus:ring-cyan-400 focus:border-transparent disabled:cursor-not-allowed disabled:bg-slate-50\"\r\n                    >\r\n                      <option value=\"\">เลือกอำเภอ / เขต</option>\r\n                      {districtOptions.map((option) => (\r\n                        <option key={option.id} value={option.id}>\r\n                          {option.label}\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"group\">\r\n                  <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ตำบล / แขวง</label>\r\n                  <select\r\n                    value={selectedSubdistrictId ? String(selectedSubdistrictId) : \"\"}\r\n                    onChange={(event) => handleSubdistrictSelect(event.target.value)}\r\n                    disabled={!subdistrictOptions.length}\r\n                    className=\"w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white text-gray-900 transition focus:ring-2 focus:ring-cyan-400 focus:border-transparent disabled:cursor-not-allowed disabled:bg-slate-50\"\r\n                  >\r\n                    <option value=\"\">เลือกตำบล / แขวง</option>\r\n                    {subdistrictOptions.map((option) => (\r\n                      <option key={option.id} value={option.id}>\r\n                        {option.label}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Zipcode</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={customerData[\"zipcode\"] || \"\"}\r\n                      readOnly\r\n                      className=\"w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-slate-100 text-gray-700\"\r\n                      placeholder=\"จะถูกกรอกอัตโนมัติ\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"group\">\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Country</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={customerData[\"country\"] || \"Thailand\"}\r\n                      readOnly\r\n                      className=\"w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-slate-100 text-gray-700\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex justify-end gap-3\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowOPDPopup(false)}\r\n                  className=\"px-4 py-2 border border-slate-300 rounded-xl text-slate-700 font-semibold hover:border-slate-400 transition\"\r\n                >\r\n                  ปิด\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleSaveFromOPD}\r\n                  disabled={isLoading}\r\n                  className=\"px-4 py-2 bg-gradient-to-r from-emerald-500 to-cyan-600 text-white font-semibold rounded-xl shadow-lg hover:from-emerald-600 hover:to-cyan-700 disabled:opacity-60\"\r\n                >\r\n                  {isLoading ? \"กำลังบันทึก...\" : \"บันทึก OPD\"}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Consent Popup Modal */}\r\n      {showConsentPopup && (\r\n        <div className=\"fixed inset-0 z-[60] flex items-center justify-center p-4\">\r\n          <div\r\n            className=\"absolute inset-0 bg-black/50\"\r\n            onClick={() => setShowConsentPopup(false)}\r\n          />\r\n          <div className=\"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[80vh] overflow-hidden animate-slideUp\">\r\n            <div className=\"bg-gradient-to-r from-purple-500 to-purple-600 px-6 py-4 flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <ClipboardCheck className=\"w-6 h-6 text-white\" />\r\n                <h2 className=\"text-lg font-semibold text-white\">Consent</h2>\r\n              </div>\r\n              <button\r\n                onClick={() => setShowConsentPopup(false)}\r\n                className=\"p-2 hover:bg-white/20 rounded-full transition-colors\"\r\n              >\r\n                <X className=\"w-5 h-5 text-white\" />\r\n              </button>\r\n            </div>\r\n            <div className=\"p-6 overflow-y-auto max-h-[calc(80vh-80px)] space-y-5\">\r\n              <div className=\"flex flex-wrap items-center justify-between gap-3\">\r\n                <div className=\"space-y-1 text-center md:text-left\">\r\n                  <p className=\"text-lg font-semibold text-slate-800\">ข้อมูล Consent</p>\r\n                  <p className=\"text-sm text-slate-500\">\r\n                    บันทึกน้ำหนัก, ส่วนสูง และประวัติสุขภาพเพื่อนำไปใช้ใน Consent Form\r\n                  </p>\r\n                </div>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleSaveConsentForms}\r\n                  disabled={consentSaving || consentLoading}\r\n                  className=\"rounded-xl bg-gradient-to-r from-purple-600 to-indigo-600 px-5 py-2 text-sm font-semibold text-white shadow-lg transition hover:from-purple-700 hover:to-indigo-700 disabled:opacity-60\"\r\n                >\r\n                  {consentSaving ? \"กำลังบันทึก\" : \"บันทึก Consent\"}\r\n                </button>\r\n              </div>\r\n              <div className=\"space-y-1\">\r\n                {consentLoadError && (\r\n                  <p className=\"text-xs text-red-600\">{consentLoadError}</p>\r\n                )}\r\n                {consentLoading && (\r\n                  <p className=\"text-xs text-slate-500\">กำลังโหลดข้อมูล Consent...</p>\r\n                )}\r\n              </div>\r\n              <div className=\"flex flex-wrap gap-2\">\r\n                {consentPartMeta.map((part) => (\r\n                  <button\r\n                    key={part.key}\r\n                    type=\"button\"\r\n                    onClick={() => setSelectedConsentPart(part.key)}\r\n                    className={`rounded-2xl px-4 py-2 text-xs font-semibold transition border shadow-sm ${selectedConsentPart === part.key\r\n                      ? \"bg-purple-600 text-white border-transparent\"\r\n                      : \"bg-white text-slate-600 border-slate-200 hover:border-slate-300\"\r\n                      }`}\r\n                  >\r\n                    {part.label}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n              <div className=\"grid gap-4 md:grid-cols-2\">\r\n                <label className=\"flex flex-col text-xs font-semibold uppercase tracking-wider text-slate-500\">\r\n                  น้ำหนัก (กก.)\r\n                  <input\r\n                    type=\"number\"\r\n                    value={currentConsentSection.weight}\r\n                    onChange={(e) =>\r\n                      handleConsentSectionChange(selectedConsentPart, { weight: e.target.value })\r\n                    }\r\n                    className=\"mt-1 rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-100\"\r\n                    placeholder=\"เช่น 60\"\r\n                  />\r\n                </label>\r\n                <label className=\"flex flex-col text-xs font-semibold uppercase tracking-wider text-slate-500\">\r\n                  ส่วนสูง (ซม.)\r\n                  <input\r\n                    type=\"number\"\r\n                    value={currentConsentSection.height}\r\n                    onChange={(e) =>\r\n                      handleConsentSectionChange(selectedConsentPart, { height: e.target.value })\r\n                    }\r\n                    className=\"mt-1 rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-100\"\r\n                    placeholder=\"เช่น 170\"\r\n                  />\r\n                </label>\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <p className=\"text-[11px] font-semibold uppercase tracking-wider text-slate-500\">\r\n                  มีโรคประจำตัวหรือไม่\r\n                </p>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {[{ label: \"ไม่มี\", value: false }, { label: \"มี\", value: true }].map((option) => (\r\n                    <button\r\n                      key={`chronic-${option.value}`}\r\n                      type=\"button\"\r\n                      onClick={() =>\r\n                        handleConsentToggle(selectedConsentPart, \"hasChronic\", option.value)\r\n                      }\r\n                      className={`rounded-2xl px-3 py-1.5 text-xs font-semibold transition border ${currentConsentSection.hasChronic === option.value\r\n                        ? \"bg-indigo-600 text-white border-transparent\"\r\n                        : \"bg-white text-slate-600 border-slate-200 hover:border-slate-300\"\r\n                        }`}\r\n                    >\r\n                      {option.label}\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n                {currentConsentSection.hasChronic && (\r\n                  <textarea\r\n                    value={currentConsentSection.chronicDiseaseDetail}\r\n                    onChange={(e) =>\r\n                      handleConsentSectionChange(selectedConsentPart, {\r\n                        chronicDiseaseDetail: e.target.value,\r\n                      })\r\n                    }\r\n                    className=\"w-full rounded-2xl border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-100\"\r\n                    placeholder=\"โปรดระบุชื่อโรค / การรักษาที่กำลังรับอยู่\"\r\n                    rows={3}\r\n                  />\r\n                )}\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <p className=\"text-[11px] font-semibold uppercase tracking-wider text-slate-500\">\r\n                  มีประวัติแพ้ยาหรือไม่\r\n                </p>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {[{ label: \"ไม่มี\", value: false }, { label: \"มี\", value: true }].map((option) => (\r\n                    <button\r\n                      key={`drug-${option.value}`}\r\n                      type=\"button\"\r\n                      onClick={() =>\r\n                        handleConsentToggle(selectedConsentPart, \"hasDrugAllergy\", option.value)\r\n                      }\r\n                      className={`rounded-2xl px-3 py-1.5 text-xs font-semibold transition border ${currentConsentSection.hasDrugAllergy === option.value\r\n                        ? \"bg-indigo-600 text-white border-transparent\"\r\n                        : \"bg-white text-slate-600 border-slate-200 hover:border-slate-300\"\r\n                        }`}\r\n                    >\r\n                      {option.label}\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n                {currentConsentSection.hasDrugAllergy && (\r\n                  <textarea\r\n                    value={currentConsentSection.drugAllergyDetail}\r\n                    onChange={(e) =>\r\n                      handleConsentSectionChange(selectedConsentPart, {\r\n                        drugAllergyDetail: e.target.value,\r\n                      })\r\n                    }\r\n                    className=\"w-full rounded-2xl border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-100\"\r\n                    placeholder=\"ระบุชื่อยา / อาการแพ้\"\r\n                    rows={3}\r\n                  />\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"space-y-3\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <p className=\"text-[11px] font-semibold uppercase tracking-wider text-slate-500\">\r\n                    ลายเซ็น ({\r\n                      consentPartMeta.find((part) => part.key === selectedConsentPart)?.label\r\n                    })\r\n                  </p>\r\n                </div>\r\n                <div className=\"space-y-3 rounded-2xl border border-slate-200 bg-white/90 p-3\">\r\n                  <div className=\"flex items-center justify-between gap-2\">\r\n                    <div>\r\n                      <p className=\"text-xs font-semibold uppercase tracking-wider text-slate-500\">\r\n                        medical_consent\r\n                      </p>\r\n                      <p className=\"text-sm font-medium text-slate-800\">\r\n                        เพียงเลือก \"ยินยอม\" หรือ \"ไม่ยินยอม\" ก่อนบันทึกลายเซ็น\r\n                      </p>\r\n                    </div>\r\n                    <span className=\"text-[11px] text-slate-400\">\r\n                      สถานะ: {currentConsentSection.medicalConsent || \"ยังไม่เลือก\"}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex flex-wrap gap-2\">\r\n                    {medicalConsentOptions.map((option) => (\r\n                      <button\r\n                        key={option}\r\n                        type=\"button\"\r\n                        onClick={() => handleConsentSectionChange(selectedConsentPart, { medicalConsent: option })}\r\n                        className={`px-4 py-1.5 rounded-2xl text-xs font-semibold transition-colors border shadow-sm ${currentConsentSection.medicalConsent === option\r\n                          ? \"bg-purple-600 text-white border-transparent\"\r\n                          : \"bg-white text-purple-700 border-purple-200 hover:border-purple-400\"\r\n                          }`}\r\n                      >\r\n                        {option}\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                  <div className=\"max-h-36 overflow-y-auto text-xs leading-relaxed text-slate-600 space-y-1\">\r\n                    {medicalConsentAcknowledgementText.map((line, index) => (\r\n                      <p key={`${line}-${index}`} className={index === 0 ? \"font-semibold text-slate-900\" : \"\"}>\r\n                        {line}\r\n                      </p>\r\n                    ))}\r\n                    <p className=\"text-[10px] text-slate-400\">\r\n                      เลื่อนอ่านก่อนตัดสินใจ แล้วลงลายเซ็นด้านล่าง\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"space-y-3 rounded-2xl border border-slate-200 bg-white/90 p-3\">\r\n                  <div className=\"flex items-center justify-between gap-2\">\r\n                    <div>\r\n                      <p className=\"text-xs font-semibold uppercase tracking-wider text-slate-500\">\r\n                        accept_pdpa\r\n                      </p>\r\n                      <p className=\"text-sm font-medium text-slate-800\">\r\n                        PDPA – ยินยอมให้ข้อมูลส่วนบุคคลถูกใช้ตามนโยบาย\r\n                      </p>\r\n                    </div>\r\n                    <span className=\"text-[11px] text-slate-400\">\r\n                      สถานะ: {currentConsentSection.acceptPdpa || \"ยังไม่เลือก\"}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex flex-wrap gap-2\">\r\n                    {acceptOptions.map((option) => (\r\n                      <button\r\n                        key={`pdpa-${option}`}\r\n                        type=\"button\"\r\n                        onClick={() => handleConsentSectionChange(selectedConsentPart, { acceptPdpa: option })}\r\n                        className={`px-4 py-1.5 rounded-2xl text-xs font-semibold transition-colors border shadow-sm ${currentConsentSection.acceptPdpa === option\r\n                          ? \"bg-purple-600 text-white border-transparent\"\r\n                          : \"bg-white text-purple-700 border-purple-200 hover:border-purple-400\"\r\n                          }`}\r\n                      >\r\n                        {option}\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                  <div className=\"max-h-36 overflow-y-auto text-xs leading-relaxed text-slate-600 space-y-1\">\r\n                    {pdpaTextBlock.map((line, index) => (\r\n                      <p key={`${line}-${index}`} className={index === 0 ? \"font-semibold text-slate-900\" : \"\"}>\r\n                        {line}\r\n                      </p>\r\n                    ))}\r\n                    <p className=\"text-[10px] text-slate-400\">เลื่อนอ่านก่อนตัดสินใจ</p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"space-y-3 rounded-2xl border border-slate-200 bg-white/90 p-3\">\r\n                  <div className=\"flex items-center justify-between gap-2\">\r\n                    <div>\r\n                      <p className=\"text-xs font-semibold uppercase tracking-wider text-slate-500\">\r\n                        accept_media\r\n                      </p>\r\n                      <p className=\"text-sm font-medium text-slate-800\">\r\n                        ยินยอมรับข่าวสารหรือการใช้ภาพสำหรับงานประชาสัมพันธ์\r\n                      </p>\r\n                    </div>\r\n                    <span className=\"text-[11px] text-slate-400\">\r\n                      สถานะ: {currentConsentSection.acceptMedia || \"ยังไม่เลือก\"}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex flex-wrap gap-2\">\r\n                    {acceptOptions.map((option) => (\r\n                      <button\r\n                        key={`media-${option}`}\r\n                        type=\"button\"\r\n                        onClick={() => handleConsentSectionChange(selectedConsentPart, { acceptMedia: option })}\r\n                        className={`px-4 py-1.5 rounded-2xl text-xs font-semibold transition-colors border shadow-sm ${currentConsentSection.acceptMedia === option\r\n                          ? \"bg-purple-600 text-white border-transparent\"\r\n                          : \"bg-white text-purple-700 border-purple-200 hover:border-purple-400\"\r\n                          }`}\r\n                      >\r\n                        {option}\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                  <div className=\"max-h-36 overflow-y-auto text-xs leading-relaxed text-slate-600 space-y-1\">\r\n                    {mediaTextBlock.map((line, index) => (\r\n                      <p key={`${line}-${index}`} className={index === 0 ? \"font-semibold text-slate-900\" : \"\"}>\r\n                        {line}\r\n                      </p>\r\n                    ))}\r\n                    <p className=\"text-[10px] text-slate-400\">เลื่อนอ่านก่อนตัดสินใจ</p>\r\n                  </div>\r\n                </div>\r\n                <p className=\"text-xs text-slate-500\">\r\n                  ข้อมูลน้ำหนัก ส่วนสูง และประวัติสุขภาพที่ระบุด้านบนจะถูกแนบใน Consent Form พร้อมสัญญาและลายเซ็น\r\n                </p>\r\n                <SignaturePad\r\n                  value={currentConsentSection.signatureUrl}\r\n                  onChange={(value) => handleConsentSignatureChange(selectedConsentPart, value)}\r\n                />\r\n                {currentConsentSection.signatureUrl && (\r\n                  <div className=\"space-y-1 rounded-2xl border border-slate-200 p-3\">\r\n                    <p className=\"text-[10px] uppercase tracking-wider text-slate-400\">\r\n                      ตัวอย่างลายเซ็นที่บันทึกไว้\r\n                    </p>\r\n                    <img\r\n                      src={currentConsentSection.signatureUrl}\r\n                      alt=\"Signature preview\"\r\n                      className=\"h-16 w-full rounded-lg border border-slate-100 object-contain\"\r\n                    />\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <div className=\"flex justify-between border-t px-6 py-4\">\r\n              <div>\r\n                <p className=\"text-xs text-slate-500\">\r\n                  บันทึก Consent จะถูกเก็บแยกตามส่วน (part) ที่เลือก\r\n                </p>\r\n              </div>\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleSaveConsentForms}\r\n                disabled={consentSaving || consentLoading}\r\n                className=\"rounded-xl bg-gradient-to-r from-purple-600 to-indigo-600 px-6 py-2 text-sm font-semibold text-white shadow-lg transition hover:from-purple-700 hover:to-indigo-700 disabled:opacity-60\"\r\n              >\r\n                {consentSaving ? \"กำลังบันทึก Consent...\" : \"บันทึก Consent\"}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Service Popup Modal - OPD Service */}\r\n      {showServicePopup && (\r\n        <div className=\"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm\">\r\n          <div\r\n            className=\"relative w-full max-w-6xl overflow-hidden rounded-3xl bg-white shadow-2xl\"\r\n            onClick={(e) => e.stopPropagation()}\r\n          >\r\n            {/* Header */}\r\n            <div className=\"flex items-center justify-between bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 px-8 py-5 text-white\">\r\n              <div>\r\n                <h2 className=\"text-2xl font-bold\">บริการ OPD</h2>\r\n                <p className=\"mt-1 text-sm text-white/80\">\r\n                  เลือกบริการและกำหนด Charge / Discount\r\n                </p>\r\n              </div>\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleCloseServicePopup}\r\n                className=\"rounded-full bg-white/20 p-2 transition hover:bg-white/30\"\r\n              >\r\n                <X className=\"w-6 h-6\" />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Group selector */}\r\n            <div className=\"border-b bg-gray-50 px-8 py-4\">\r\n              <div className=\"flex flex-wrap items-center gap-4\">\r\n                <label className=\"text-sm font-semibold text-gray-700\">กลุ่มบริการ:</label>\r\n                <select\r\n                  className=\"rounded-xl border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-800 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\r\n                  value={selectedOpdGroupCode}\r\n                  onChange={(e) => handleGroupSelect(e.target.value)}\r\n                >\r\n                  <option value=\"\">เลือกกลุ่มบริการ</option>\r\n                  {opdGroups.map((group) => (\r\n                    <option key={group.groupcode} value={group.groupcode}>\r\n                      {group.groupname}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n                {groupsLoading && (\r\n                  <span className=\"text-sm text-gray-500\">กำลังโหลดกลุ่มบริการ...</span>\r\n                )}\r\n                {selectedServices.length > 0 && (\r\n                  <span className=\"rounded-full bg-emerald-100 px-3 py-1 text-sm font-semibold text-emerald-700\">\r\n                    เลือกแล้ว {selectedServices.length} รายการ\r\n                  </span>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <div className=\"border-b bg-white/80 px-8 py-3 text-sm text-gray-600\">\r\n              {saleItemsHistoryLoading ? (\r\n                <span>กำลังโหลดประวัติ b_saleitem...</span>\r\n              ) : saleItemsHistoryError ? (\r\n                <span className=\"text-red-600\">{saleItemsHistoryError}</span>\r\n              ) : saleHistorySummary.count === 0 ? (\r\n                <span>ยังไม่มีรายการบันทึกใน b_saleitem</span>\r\n              ) : (\r\n                <div className=\"flex flex-wrap items-center gap-2\">\r\n                  <span>\r\n                    บันทึกแล้ว {saleHistorySummary.count} รายการ · ยอดรวม {formatCurrencyDisplay(\r\n                      saleHistorySummary.total\r\n                    )}\r\n                  </span>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={handleShowHistory}\r\n                    className=\"rounded-full border border-slate-200 bg-white px-3 py-1 text-[11px] font-semibold text-slate-600 transition hover:border-slate-300\"\r\n                  >\r\n                    ดูประวัติทั้งหมด\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Two-column content */}\r\n            <div className=\"grid max-h-[65vh] grid-cols-1 gap-0 md:grid-cols-2\">\r\n              {/* Left: Selected services */}\r\n              <div className=\"flex flex-col border-r border-gray-200 bg-gradient-to-br from-blue-50 to-indigo-50 max-h-[65vh]\">\r\n                <div className=\"border-b bg-white/80 px-6 py-4\">\r\n                  <h3 className=\"text-lg font-bold text-gray-800\">📝 บริการที่เลือก</h3>\r\n                  <p className=\"text-xs text-gray-500\">\r\n                    {selectedServices.length} รายการ\r\n                    {selectedOpdGroup && ` · ${selectedOpdGroup.groupname}`}\r\n                  </p>\r\n                </div>\r\n                <div className=\"flex-1 overflow-y-auto p-4\">\r\n                  {selectedServices.length === 0 ? (\r\n                    <div className=\"flex h-full flex-col items-center justify-center text-center\">\r\n                      <div className=\"mb-3 text-5xl\">📂</div>\r\n                      <p className=\"text-sm text-gray-500\">ยังไม่มีบริการที่เลือก</p>\r\n                      <p className=\"text-xs text-gray-400\">เลือกจากรายการทางขวามือ</p>\r\n                    </div>\r\n                  ) : (\r\n                    <>\r\n                      <div className=\"space-y-3\">\r\n                        {selectedServices.map((entry) => (\r\n                          <div\r\n                            key={entry.id}\r\n                            className=\"rounded-2xl border border-white bg-white p-4 shadow-md transition hover:shadow-lg\"\r\n                          >\r\n                            <div className=\"flex items-start justify-between\">\r\n                              <div className=\"flex-1\">\r\n                                <p className=\"font-semibold text-gray-800\">{entry.itemname}</p>\r\n                                <p className=\"text-xs text-gray-500\">\r\n                                  รหัส {entry.itemcode} · ราคา {formatCurrencyDisplay(entry.salesprice)}\r\n                                </p>\r\n                              </div>\r\n                              <button\r\n                                type=\"button\"\r\n                                onClick={() => handleRemoveServiceEntry(entry.id)}\r\n                                className=\"ml-2 rounded-full bg-red-100 p-1.5 text-red-600 transition hover:bg-red-200\"\r\n                              >\r\n                                <X className=\"w-4 h-4\" />\r\n                              </button>\r\n                            </div>\r\n\r\n                            <div className=\"mt-3 grid grid-cols-2 gap-3\">\r\n                              <div className=\"rounded-xl bg-emerald-50 p-3\">\r\n                                <p className=\"mb-1 text-xs font-semibold uppercase tracking-wide text-emerald-700\">\r\n                                  Charge\r\n                                </p>\r\n                                <div className=\"flex gap-2\">\r\n                                  <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"บาท\"\r\n                                    value={entry.chargePrice}\r\n                                    onChange={(e) => handleChargePriceChange(entry.id, e.target.value)}\r\n                                    className=\"w-full rounded-lg border border-emerald-200 bg-white px-2 py-1.5 text-sm focus:border-emerald-400 focus:outline-none\"\r\n                                  />\r\n                                  <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"%\"\r\n                                    value={entry.chargePercent}\r\n                                    onChange={(e) => handleChargePercentChange(entry.id, e.target.value)}\r\n                                    className=\"w-16 rounded-lg border border-emerald-200 bg-white px-2 py-1.5 text-center text-sm focus:border-emerald-400 focus:outline-none\"\r\n                                  />\r\n                                </div>\r\n                              </div>\r\n                              <div className=\"rounded-xl bg-rose-50 p-3\">\r\n                                <p className=\"mb-1 text-xs font-semibold uppercase tracking-wide text-rose-700\">\r\n                                  Discount\r\n                                </p>\r\n                                <div className=\"flex gap-2\">\r\n                                  <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"บาท\"\r\n                                    value={entry.discountPrice}\r\n                                    onChange={(e) => handleDiscountPriceChange(entry.id, e.target.value)}\r\n                                    className=\"w-full rounded-lg border border-rose-200 bg-white px-2 py-1.5 text-sm focus:border-rose-400 focus:outline-none\"\r\n                                  />\r\n                                  <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"%\"\r\n                                    value={entry.discountPercent}\r\n                                    onChange={(e) => handleDiscountPercentChange(entry.id, e.target.value)}\r\n                                    className=\"w-16 rounded-lg border border-rose-200 bg-white px-2 py-1.5 text-center text-sm focus:border-rose-400 focus:outline-none\"\r\n                                  />\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                            <div className=\"mt-3 flex items-center justify-between rounded-2xl border border-indigo-100 bg-indigo-50/40 px-3 py-2 text-sm font-semibold text-indigo-600\">\r\n                              <span>ยอดสุทธิ</span>\r\n                              <span>{formatCurrencyDisplay(calculateServiceEntryTotal(entry))}</span>\r\n                            </div>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                      <div className=\"mt-4 rounded-2xl border border-dashed border-indigo-200 bg-white/80 px-4 py-3 text-sm text-gray-600 shadow-inner\">\r\n                        <div className=\"flex items-center justify-between text-xs font-semibold uppercase tracking-wide text-gray-500\">\r\n                          <span>สรุปยอด</span>\r\n                          <span>{selectedServices.length} รายการ</span>\r\n                        </div>\r\n                        <div className=\"mt-2 space-y-1\">\r\n                          <div className=\"flex justify-between\">\r\n                            <span>รวมราคาพื้นฐาน</span>\r\n                            <span className=\"font-semibold text-gray-700\">\r\n                              {formatCurrencyDisplay(selectedServicesTotals.baseTotal)}\r\n                            </span>\r\n                          </div>\r\n                          <div className=\"flex justify-between\">\r\n                            <span>รวมค่า Charge</span>\r\n                            <span className=\"font-semibold text-gray-700\">\r\n                              {formatCurrencyDisplay(selectedServicesTotals.chargeTotal)}\r\n                            </span>\r\n                          </div>\r\n                          <div className=\"flex justify-between\">\r\n                            <span>รวมส่วนลด</span>\r\n                            <span className=\"font-semibold text-gray-700\">\r\n                              {formatCurrencyDisplay(selectedServicesTotals.discountTotal)}\r\n                            </span>\r\n                          </div>\r\n                          <div className=\"flex justify-between text-base font-semibold text-indigo-600\">\r\n                            <span>ยอดสุทธิทั้งหมด</span>\r\n                            <span>{formatCurrencyDisplay(selectedServicesTotals.netTotal)}</span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Right: Available services */}\r\n              <div className=\"flex flex-col bg-white max-h-[65vh]\">\r\n                <div className=\"border-b px-6 py-4\">\r\n                  <h3 className=\"text-lg font-bold text-gray-800\">📜 รายการบริการ</h3>\r\n                  {selectedOpdGroup && (\r\n                    <p className=\"text-xs text-gray-500\">{selectedOpdGroup.groupname}</p>\r\n                  )}\r\n                </div>\r\n                <div className=\"px-6 py-3\">\r\n                  <div className=\"relative\">\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"🔍 ค้นหาบริการ...\"\r\n                      value={serviceSearchTerm}\r\n                      onChange={(e) => setServiceSearchTerm(e.target.value)}\r\n                      className=\"w-full rounded-xl border border-gray-200 bg-gray-50 px-4 py-2.5 text-sm focus:border-indigo-400 focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-100\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex-1 overflow-y-auto px-6 pb-4\">\r\n                  {servicesLoading && (\r\n                    <div className=\"flex items-center justify-center py-8\">\r\n                      <div className=\"h-8 w-8 animate-spin rounded-full border-4 border-indigo-200 border-t-indigo-600\"></div>\r\n                    </div>\r\n                  )}\r\n                  {serviceError && (\r\n                    <p className=\"py-4 text-center text-sm text-red-600\">{serviceError}</p>\r\n                  )}\r\n                  {!servicesLoading && !serviceError && filteredServiceItems.length === 0 && (\r\n                    <div className=\"flex flex-col items-center justify-center py-8 text-center\">\r\n                      <div className=\"mb-2 text-4xl\">💭</div>\r\n                      <p className=\"text-sm text-gray-500\">\r\n                        {selectedOpdGroupCode ? \"ไม่พบรายการบริการ\" : \"เลือกกลุ่มบริการก่อน\"}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                  <div className=\"space-y-2\">\r\n                    {filteredServiceItems.map((item) => {\r\n                      const alreadyAdded = selectedServices.some(\r\n                        (entry) => entry.itemcode === item.itemcode\r\n                      );\r\n                      return (\r\n                        <div\r\n                          key={item.itemcode}\r\n                          className={`flex items-center justify-between rounded-xl border px-4 py-3 transition ${alreadyAdded\r\n                            ? \"border-emerald-200 bg-emerald-50\"\r\n                            : \"border-gray-100 bg-gray-50 hover:border-indigo-200 hover:bg-indigo-50\"\r\n                            }`}\r\n                        >\r\n                          <div>\r\n                            <p className=\"font-medium text-gray-800\">{item.itemname}</p>\r\n                            <p className=\"text-xs text-gray-500\">\r\n                              ราคา {formatCurrencyDisplay(item.saleprice)}\r\n                            </p>\r\n                          </div>\r\n                          <button\r\n                            type=\"button\"\r\n                            onClick={() => handleAddService(item)}\r\n                            disabled={alreadyAdded}\r\n                            className={`rounded-full px-4 py-1.5 text-xs font-semibold transition ${alreadyAdded\r\n                              ? \"bg-emerald-200 text-emerald-700\"\r\n                              : \"bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow hover:shadow-md\"\r\n                              }`}\r\n                          >\r\n                            {alreadyAdded ? \"✓ เลือกแล้ว\" : \"เพิ่ม\"}\r\n                          </button>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n\r\n\r\n            {/* Footer */}\r\n            <div className=\"flex items-center justify-between border-t bg-gray-50 px-8 py-4\">\r\n              <p className=\"text-sm text-gray-600\">\r\n                เลือกแล้ว <span className=\"font-bold text-indigo-600\">{selectedServices.length}</span> รายการ\r\n                <span className=\"mx-2 hidden text-xs text-gray-400 md:inline\">·</span>\r\n                <span className=\"mr-1\">ยอดสุทธิ</span>\r\n                <span className=\"font-bold text-indigo-600\">\r\n                  {formatCurrencyDisplay(selectedServicesTotals.netTotal)}\r\n                </span>\r\n              </p>\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleCompleteServiceSelection}\r\n                disabled={savingServices || selectedServices.length === 0}\r\n                className=\"rounded-xl bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-2.5 font-semibold text-white shadow-lg transition hover:from-indigo-700 hover:to-purple-700 disabled:opacity-60 disabled:cursor-not-allowed\"\r\n              >\r\n                {savingServices ? \"กำลังบันทึกบริการ...\" : \"เสร็จสิ้น\"}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Sale History Modal */}\r\n      {showHistoryModal && (\r\n        <div className=\"fixed inset-0 z-[65] flex items-center justify-center p-4\">\r\n          <div\r\n            className=\"absolute inset-0 bg-slate-900/60\"\r\n            onClick={handleCloseHistory}\r\n          />\r\n          <div className=\"relative z-10 w-full max-w-2xl rounded-2xl bg-white p-6 shadow-2xl\">\r\n            <div className=\"flex items-center justify-between border-b pb-4\">\r\n              <div>\r\n                <p className=\"text-lg font-semibold text-slate-800\">ประวัติ b_saleitem</p>\r\n                <p className=\"text-xs text-slate-500\">แสดงรายการรวมที่เก็บไว้สำหรับลูกค้านี้</p>\r\n              </div>\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleCloseHistory}\r\n                className=\"rounded-full p-2 text-slate-600 transition hover:bg-slate-100\"\r\n              >\r\n                <X className=\"h-4 w-4\" />\r\n              </button>\r\n            </div>\r\n            <div className=\"mt-4 space-y-3 max-h-[55vh] overflow-y-auto\">\r\n              {saleItemsHistory.length === 0 ? (\r\n                <p className=\"text-sm text-slate-500\">ยังไม่มีประวัติการบันทึกในหน้าต่างนี้</p>\r\n              ) : (\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"grid grid-cols-[120px_120px_1fr_96px] items-center gap-2 text-[11px] font-semibold uppercase text-slate-500\">\r\n                    <span>วันที่</span>\r\n                    <span>เลขที่ใบเสร็จ</span>\r\n                    <span>รายการ</span>\r\n                    <span className=\"text-right\">ยอดสุทธิ</span>\r\n                  </div>\r\n                  <div className=\"space-y-1\">\r\n                    {saleItemsHistory.map((historyItem, index) => (\r\n                      <div\r\n                        key={`${historyItem.sale_date}-${historyItem.receipt_no}-${index}`}\r\n                        className=\"grid grid-cols-[120px_120px_1fr_96px] items-center gap-2 rounded-xl border border-slate-100 bg-slate-50 px-3 py-2 text-sm text-slate-700\"\r\n                      >\r\n                        <span className=\"text-[13px] font-medium text-slate-600\">\r\n                          {historyItem.sale_date || \"-\"}\r\n                        </span>\r\n                        <span className=\"text-[13px] font-medium text-slate-600\">\r\n                          {historyItem.receipt_no || \"-\"}\r\n                        </span>\r\n                        <span className=\"truncate\" title={historyItem.item_name}>\r\n                          {historyItem.item_name || \"-\"}\r\n                        </span>\r\n                        <span className=\"text-right font-semibold text-slate-800\">\r\n                          {formatCurrencyDisplay(toNumericValue(historyItem.amount))}\r\n                        </span>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div className=\"mt-5 flex justify-end\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleCloseHistory}\r\n                className=\"rounded-xl border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-600 transition hover:bg-slate-50\"\r\n              >\r\n                ปิด\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Appointment Popup Modal */}\r\n      {showAppointmentPopup && (\r\n        <div className=\"fixed inset-0 z-[60] flex items-center justify-center p-4\">\r\n          <div\r\n            className=\"absolute inset-0 bg-black/50\"\r\n            onClick={() => setShowAppointmentPopup(false)}\r\n          />\r\n          <div className=\"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[80vh] overflow-hidden animate-slideUp\">\r\n            <div className=\"bg-gradient-to-r from-teal-500 to-teal-600 px-6 py-4 flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <Calendar className=\"w-6 h-6 text-white\" />\r\n                <h2 className=\"text-lg font-semibold text-white\">นัดหมาย</h2>\r\n              </div>\r\n              <button\r\n                onClick={() => setShowAppointmentPopup(false)}\r\n                className=\"p-2 hover:bg-white/20 rounded-full transition-colors\"\r\n              >\r\n                <X className=\"w-5 h-5 text-white\" />\r\n              </button>\r\n            </div>\r\n            <div className=\"p-6 overflow-y-auto max-h-[calc(80vh-80px)] space-y-6\">\r\n              <div className=\"space-y-2 text-sm text-slate-600\">\r\n                <p className=\"text-base font-semibold text-slate-800\">ตารางนัดหมาย</p>\r\n                <p className=\"text-slate-500\">\r\n                  กรอกข้อมูลเพื่อสร้างเรกคอร์ดในตาราง `bjh_appointment` พร้อมผูกกับลูกค้ารายนี้\r\n                </p>\r\n              </div>\r\n\r\n              <div className=\"space-y-3 rounded-2xl border border-slate-200 bg-slate-50 p-4\">\r\n                <div className=\"flex items-start justify-between gap-3\">\r\n                  <div>\r\n                    <p className=\"text-sm font-semibold text-slate-800\">\r\n                      ประวัตินัดหมาย ({appointmentHistory.length})\r\n                    </p>\r\n                    <p className=\"text-[11px] text-slate-500\">\r\n                      แสดงรายการล่าสุดจาก `id_all` เดียวกัน\r\n                    </p>\r\n                  </div>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={handleOpenNewAppointment}\r\n                    className=\"rounded-full border border-slate-300 px-3 py-1 text-xs font-semibold text-slate-600 hover:border-slate-400\"\r\n                  >\r\n                    เพิ่มนัดหมายใหม่\r\n                  </button>\r\n                </div>\r\n                {appointmentHistoryLoading ? (\r\n                  <p className=\"text-xs text-slate-500\">กำลังโหลดประวัตินัดหมาย...</p>\r\n                ) : appointmentHistoryError ? (\r\n                  <p className=\"text-xs text-rose-600\">{appointmentHistoryError}</p>\r\n                ) : appointmentHistory.length === 0 ? (\r\n                  <p className=\"text-xs text-slate-500\">ยังไม่มีบันทึกนัดหมายในระบบ</p>\r\n                ) : (\r\n                  <div className=\"space-y-2\">\r\n                    {appointmentHistory.map((entry, index) => {\r\n                      const cardKey = resolveAppointmentHistoryKey(entry, index);\r\n                      const start = formatAppointmentDateTimeLabel(entry.start_date);\r\n                      const end = formatAppointmentDateTimeLabel(entry.end_date);\r\n                      const recordLabel = entry.record_no\r\n                        ? `Record No. ${entry.record_no}`\r\n                        : entry.appoint_code || \"ไม่ระบุรหัส\";\r\n                      const activity = entry.activity ? String(entry.activity) : null;\r\n                      const note = entry.note ? String(entry.note) : null;\r\n                      return (\r\n                        <div\r\n                          key={cardKey}\r\n                          className={`rounded-2xl border bg-white px-3 py-3 shadow-sm transition ${selectedAppointmentHistoryKey === cardKey\r\n                            ? \"border-teal-300 ring-1 ring-teal-200\"\r\n                            : \"border-slate-200\"\r\n                            }`}\r\n                        >\r\n                          <div className=\"flex items-start justify-between gap-3\">\r\n                            <div className=\"space-y-1\">\r\n                              <p className=\"text-sm font-semibold text-slate-800\">{recordLabel}</p>\r\n                              <p className=\"text-[11px] text-slate-500\">\r\n                                วันนัด {start} · ครบกำหนด {end}\r\n                              </p>\r\n                              {activity && (\r\n                                <p className=\"text-[11px] text-slate-500\">\r\n                                  กิจกรรม: {activity}\r\n                                </p>\r\n                              )}\r\n                              {note && (\r\n                                <p className=\"text-[11px] text-slate-500\">\r\n                                  หมายเหตุ: {note}\r\n                                </p>\r\n                              )}\r\n                            </div>\r\n                            <div className=\"flex flex-col gap-2\">\r\n                              <button\r\n                                type=\"button\"\r\n                                disabled={!entry.appoint_code}\r\n                                title={!entry.appoint_code ? \"รหัสนัดหมายไม่พร้อม\" : \"แก้ไขนัดหมายนี้\"}\r\n                                onClick={() => handleSelectAppointmentHistory(entry, cardKey)}\r\n                                className={`rounded-full px-3 py-1 text-xs font-semibold transition ${entry.appoint_code\r\n                                  ? \"border border-slate-300 text-slate-600 hover:border-slate-400\"\r\n                                  : \"border border-slate-200 text-slate-400 cursor-not-allowed\"\r\n                                  }`}\r\n                              >\r\n                                แก้ไขนัดหมาย\r\n                              </button>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {appointmentSections.map((section) => (\r\n                <div key={section.title} className=\"space-y-3\">\r\n                  <p className=\"text-sm font-semibold text-slate-700\">{section.title}</p>\r\n                  <div\r\n                    className={`grid ${section.columns || \"grid-cols-1 md:grid-cols-2\"} gap-4`}\r\n                  >\r\n                    {section.fields.map((fieldKey) => {\r\n                      const meta = appointmentFieldMetaMap[fieldKey];\r\n                      if (!meta) return null;\r\n                      const value = appointmentForm[fieldKey] || \"\";\r\n                      const isTextarea = meta.type === \"textarea\";\r\n                      const inputType =\r\n                        meta.type === \"date\"\r\n                          ? \"date\"\r\n                          : meta.type === \"datetime-local\"\r\n                            ? \"datetime-local\"\r\n                            : meta.type === \"tel\"\r\n                              ? \"tel\"\r\n                              : \"text\";\r\n                      return (\r\n                        <div\r\n                          key={fieldKey}\r\n                          className={`group ${meta.fullWidth ? \"md:col-span-2\" : \"\"}`}\r\n                        >\r\n                          <label className=\"block text-xs font-semibold uppercase tracking-wider text-slate-500 mb-1\">\r\n                            {meta.label}\r\n                          </label>\r\n                          {isTextarea ? (\r\n                            <textarea\r\n                              rows={4}\r\n                              value={value}\r\n                              onChange={(event) =>\r\n                                handleAppointmentFieldChange(fieldKey, event.target.value)\r\n                              }\r\n                              placeholder={meta.placeholder}\r\n                              className=\"w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 focus:border-slate-400 focus:outline-none focus:ring-2 focus:ring-cyan-100\"\r\n                            />\r\n                          ) : (\r\n                            <input\r\n                              type={inputType}\r\n                              value={value}\r\n                              onChange={(event) =>\r\n                                handleAppointmentFieldChange(fieldKey, event.target.value)\r\n                              }\r\n                              placeholder={meta.placeholder}\r\n                              readOnly={meta.readOnly}\r\n                              disabled={meta.readOnly}\r\n                              className={`w-full px-4 py-3 border-2 rounded-2xl transition focus:border-cyan-400 focus:ring-2 focus:ring-cyan-100 outline-none text-gray-900 ${meta.readOnly\r\n                                ? \"bg-slate-100 border-slate-200\"\r\n                                : \"border-slate-200 bg-white\"\r\n                                } disabled:cursor-not-allowed`}\r\n                            />\r\n                          )}\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n\r\n              {appointmentError && (\r\n                <p className=\"text-sm text-red-600\">{appointmentError}</p>\r\n              )}\r\n\r\n              <div className=\"flex justify-end gap-3\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowAppointmentPopup(false)}\r\n                  className=\"px-5 py-2 border border-slate-300 rounded-xl text-slate-700 font-semibold hover:border-slate-400 transition\"\r\n                >\r\n                  ปิด\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleSaveAppointment}\r\n                  disabled={appointmentLoading}\r\n                  className=\"px-5 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl font-semibold shadow-lg transition hover:from-blue-700 hover:to-indigo-700 disabled:opacity-70 disabled:cursor-not-allowed\"\r\n                >\r\n                  {appointmentLoading ? \"กำลังบันทึก...\" : \"บันทึกนัดหมาย\"}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;AAHA;;;;AAoCA,MAAM,qBACJ;AAEF,IAAI,0BAAyD;AAC7D,IAAI,4BAAoE;AAExE,MAAM,8BAA8B;IAClC,IAAI,yBAAyB;QAC3B,OAAO;IACT;IAEA,IAAI,CAAC,2BAA2B;QAC9B,4BAA4B,QAAQ,GAAG,CAAC;YACtC,MAAM,GAAG,mBAAmB,cAAc,CAAC,EAAE,IAAI,CAAC,CAAC;gBACjD,IAAI,CAAC,SAAS,EAAE,EAAE;oBAChB,MAAM,IAAI,MAAM;gBAClB;gBACA,OAAO,SAAS,IAAI;YACtB;YACA,MAAM,GAAG,mBAAmB,cAAc,CAAC,EAAE,IAAI,CAAC,CAAC;gBACjD,IAAI,CAAC,SAAS,EAAE,EAAE;oBAChB,MAAM,IAAI,MAAM;gBAClB;gBACA,OAAO,SAAS,IAAI;YACtB;YACA,MAAM,GAAG,mBAAmB,kBAAkB,CAAC,EAAE,IAAI,CAAC,CAAC;gBACrD,IAAI,CAAC,SAAS,EAAE,EAAE;oBAChB,MAAM,IAAI,MAAM;gBAClB;gBACA,OAAO,SAAS,IAAI;YACtB;SACD,EAAE,IAAI,CAAC,CAAC,CAAC,WAAW,WAAW,aAAa;YAC3C,MAAM,UAAkC;gBACtC;gBACA;gBACA;YACF;YACA,0BAA0B;YAC1B,OAAO;QACT;IACF;IAEA,OAAO;AACT;AAEA,MAAM,8BAA8B,CAAC,QACnC,QAAQ,MAAM,IAAI,GAAG,WAAW,KAAK;AAEvC,MAAM,4BAA4B,CAChC,WACA;IAEA,MAAM,mBAAmB,4BAA4B;IACrD,IAAI,CAAC,kBAAkB;QACrB,OAAO;IACT;IACA,OACE,4BAA4B,UAAU,OAAO,MAAM,oBACnD,4BAA4B,UAAU,OAAO,MAAM;AAEvD;AAuCA,MAAM,kBAAkB;IACtB;QAAE,KAAK;QAAW,OAAO;IAAe;IACxC;QAAE,KAAK;QAAY,OAAO;IAAe;CAC1C;AAID,MAAM,4BAA4B,IAChC,gBAAgB,MAAM,CAAC,CAAC,KAAK;QAC3B,GAAG,CAAC,KAAK,GAAG,CAAC,GAAG;YACd,QAAQ;YACR,QAAQ;YACR,YAAY;YACZ,sBAAsB;YACtB,gBAAgB;YAChB,mBAAmB;YACnB,cAAc;YACd,gBAAgB;YAChB,YAAY;YACZ,aAAa;QACf;QACA,OAAO;IACT,GAAG,CAAC;AAEN,MAAM,wBAAwB;IAAC;IAAU;CAAY;AACrD,MAAM,oCAAoC;IACxC;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAED,MAAM,gBAAgB;IACpB;IACA;CACD;AACD,MAAM,iBAAiB;IACrB;IACA;CACD;AACD,MAAM,gBAAgB;IAAC;IAAU;CAAY;AAE7C,8BAA8B;AAC9B,MAAM,oBAAoB,IAAI,KAAK,YAAY,CAAC,SAAS;IACvD,uBAAuB;IACvB,uBAAuB;AACzB;AAEA,MAAM,wBAAwB,CAAC,QAC7B,OAAO,QAAQ,CAAC,SAAS,kBAAkB,MAAM,CAAC,SAAS;AAE7D,MAAM,0BAA0B,CAAC,QAC/B,OAAO,QAAQ,CAAC,SAAS,MAAM,OAAO,CAAC,KAAK;AAE9C,MAAM,0BAA0B,CAAC;IAC/B,MAAM,UAAU,MAAM,IAAI;IAC1B,IAAI,CAAC,SAAS,OAAO;IACrB,MAAM,UAAU,OAAO;IACvB,OAAO,OAAO,QAAQ,CAAC,WAAW,UAAU;AAC9C;AAEA,MAAM,iBAAiB,CAAC;IACtB,IAAI,UAAU,QAAQ,UAAU,WAAW,OAAO;IAClD,IAAI,OAAO,UAAU,YAAY,OAAO,QAAQ,CAAC,QAAQ;QACvD,OAAO;IACT;IACA,MAAM,UAAU,OAAO;IACvB,OAAO,OAAO,QAAQ,CAAC,WAAW,UAAU;AAC9C;AAEA,MAAM,0BAA0B,CAAC;IAC/B,IAAI,UAAU,QAAQ,UAAU,WAAW,OAAO;IAClD,MAAM,UAAU,OAAO,UAAU,WAAW,QAAQ,OAAO;IAC3D,OAAO,OAAO,QAAQ,CAAC,WAAW,UAAU;AAC9C;AAEA,MAAM,6BAA6B,CAAC;IAClC,MAAM,aAAa,OAAO,QAAQ,CAAC,MAAM,UAAU,IAAI,MAAM,UAAU,GAAG;IAC1E,MAAM,eAAe,wBAAwB,MAAM,WAAW;IAC9D,MAAM,iBAAiB,wBAAwB,MAAM,aAAa;IAClE,OAAO,aAAa,eAAe;AACrC;AAEA,MAAM,wBAAwB;IAC5B,MAAM,YAAY,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,KAAK;IAClD,MAAM,aAAa,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,OAAO;IACrD,OAAO,CAAC,EAAE,EAAE,UAAU,CAAC,EAAE,YAAY;AACvC;AAEA,MAAM,6BAA6B;IACjC;QAAE,KAAK;QAAU,OAAO;QAAU,UAAU;IAAK;IACjD;QAAE,KAAK;QAAM,OAAO;IAAK;IACzB;QAAE,KAAK;QAAQ,OAAO;IAAO;IAC7B;QAAE,KAAK;QAAU,OAAO;IAAS;IACjC;QAAE,KAAK;QAAU,OAAO;IAAS;IACjC;QAAE,KAAK;QAAsB,OAAO;IAAqB;IACzD;QAAE,KAAK;QAAU,OAAO;IAAS;IACjC;QAAE,KAAK;QAAiB,OAAO;IAAgB;IAC/C;QAAE,KAAK;QAAU,OAAO;IAAS;IACjC;QAAE,KAAK;QAAQ,OAAO;IAAO;IAC7B;QAAE,KAAK;QAAW,OAAO;IAAU;IACnC;QAAE,KAAK;QAAY,OAAO;IAAW;IACrC;QAAE,KAAK;QAAU,OAAO;IAAS;IACjC;QAAE,KAAK;QAAa,OAAO;IAAY;IACvC;QAAE,KAAK;QAAc,OAAO;IAAa;IACzC;QAAE,KAAK;QAAU,OAAO;IAAS;IACjC;QAAE,KAAK;QAAY,OAAO;IAAW;IACrC;QAAE,KAAK;QAAiB,OAAO;IAAgB;IAC/C;QAAE,KAAK;QAAS,OAAO;IAAQ;IAC/B;QAAE,KAAK;QAAe,OAAO;IAAc;IAC3C;QAAE,KAAK;QAAS,OAAO;IAAQ;IAC/B;QAAE,KAAK;QAAU,OAAO;IAAS;IACjC;QAAE,KAAK;QAAY,OAAO;IAAW;IACrC;QAAE,KAAK;QAAW,OAAO;IAAU;IACnC;QAAE,KAAK;QAAiB,OAAO;IAAgB;IAC/C;QAAE,KAAK;QAAa,OAAO;IAAY;IACvC;QAAE,KAAK;QAAW,OAAO;IAAU;IACnC;QAAE,KAAK;QAAY,OAAO;IAAW;IACrC;QAAE,KAAK;QAAQ,OAAO;QAAQ,WAAW;IAAK;IAC9C;QAAE,KAAK;QAAoB,OAAO;IAAmB;IACrD;QAAE,KAAK;QAAiB,OAAO;IAAgB;IAC/C;QAAE,KAAK;QAAiB,OAAO;IAAgB;IAC/C;QAAE,KAAK;QAAgB,OAAO;IAAe;IAC7C;QAAE,KAAK;QAAgB,OAAO;IAAe;IAC7C;QAAE,KAAK;QAAoB,OAAO;IAAmB;IACrD;QAAE,KAAK;QAAuB,OAAO;IAAsB;IAC3D;QAAE,KAAK;QAAuB,OAAO;IAAsB;IAC3D;QAAE,KAAK;QAAmB,OAAO;IAAkB;IACnD;QAAE,KAAK;QAAa,OAAO;IAAY;IACvC;QAAE,KAAK;QAAW,OAAO;QAAW,WAAW;IAAK;IACpD;QAAE,KAAK;QAAY,OAAO;IAAW;IACrC;QAAE,KAAK;QAAW,OAAO;IAAU;IACnC;QAAE,KAAK;QAAgB,OAAO;IAAe;IAC7C;QAAE,KAAK;QAAa,OAAO;IAAY;IACvC;QAAE,KAAK;QAAY,OAAO;IAAW;IACrC;QAAE,KAAK;QAAU,OAAO;IAAS;IACjC;QAAE,KAAK;QAAS,OAAO;IAAQ;IAC/B;QAAE,KAAK;QAAQ,OAAO;IAAO;IAC7B;QAAE,KAAK;QAAO,OAAO;IAAM;IAC3B;QAAE,KAAK;QAAU,OAAO;IAAS;IACjC;QAAE,KAAK;QAAU,OAAO;IAAS;IACjC;QAAE,KAAK;QAAW,OAAO;IAAU;CACpC;AAED,MAAM,iBAAiB,CAAC;IACtB,MAAM,aAAa,IAAI,WAAW;IAClC,IAAI,WAAW,QAAQ,CAAC,SAAS,OAAO;IACxC,IAAI,WAAW,QAAQ,CAAC,SAAS,OAAO;IACxC,IAAI,eAAe,mBAAmB,OAAO;IAC7C,OAAO;AACT;AAaA,MAAM,uBAA+C;IACnD;QAAE,KAAK;QAAa,OAAO;QAAa,UAAU;IAAK;IACvD;QAAE,KAAK;QAAQ,OAAO;QAAQ,UAAU;IAAK;IAC7C;QAAE,KAAK;QAAgB,OAAO;QAAgB,UAAU;IAAK;IAC7D;QAAE,KAAK;QAAiB,OAAO;QAAmB,MAAM;IAAO;IAC/D;QAAE,KAAK;QAAc,OAAO;QAAU,MAAM;IAAiB;IAC7D;QAAE,KAAK;QAAY,OAAO;QAAY,MAAM;IAAiB;IAC7D;QAAE,KAAK;QAAU,OAAO;IAAW;IACnC;QAAE,KAAK;QAAQ,OAAO;IAAO;IAC7B;QAAE,KAAK;QAAW,OAAO;IAAU;IACnC;QAAE,KAAK;QAAY,OAAO;IAAW;IACrC;QACE,KAAK;QACL,OAAO;QACP,aAAa;IACf;IACA;QAAE,KAAK;QAAe,OAAO;QAAe,MAAM;IAAM;IACxD;QAAE,KAAK;QAAS,OAAO;IAAQ;IAC/B;QAAE,KAAK;QAAY,OAAO;IAAU;IACpC;QAAE,KAAK;QAAQ,OAAO;QAAY,MAAM;QAAY,WAAW;IAAK;IACpE;QAAE,KAAK;QAAe,OAAO;IAAU;IACvC;QAAE,KAAK;QAAe,OAAO;IAAU;IACvC;QAAE,KAAK;QAAa,OAAO;IAAc;IACzC;QAAE,KAAK;QAAa,OAAO;IAAc;IACzC;QAAE,KAAK;QAAY,OAAO;IAAW;IACrC;QAAE,KAAK;QAAa,OAAO;IAAY;IACvC;QAAE,KAAK;QAAa,OAAO;QAAe,MAAM;IAAO;IACvD;QAAE,KAAK;QAAU,OAAO;QAAa,UAAU;IAAK;CACrD;AAED,MAAM,0BAA0B,qBAAqB,MAAM,CAAC,CAAC,KAAK;IAChE,GAAG,CAAC,MAAM,GAAG,CAAC,GAAG;IACjB,OAAO;AACT,GAAG,CAAC;AAYJ,MAAM,iCAAiC,CACrC;IAEA,IAAI,UAAU,aAAa,UAAU,QAAQ,UAAU,IAAI,OAAO;IAElE,MAAM,aAAa,OAAO,UAAU,WAAW,QAAQ,OAAO;IAC9D,MAAM,SAAS,IAAI,KAAK;IACxB,IAAI,OAAO,KAAK,CAAC,OAAO,OAAO,KAAK;QAClC,MAAM,WAAW,OAAO,eAAe,WAAW,aAAa,OAAO;QACtE,OAAO,SAAS,OAAO,CAAC,KAAK,KAAK,KAAK,CAAC,IAAI,CAAC,EAAE;IACjD;IAEA,OAAO,IAAI,KAAK,cAAc,CAAC,SAAS;QACtC,WAAW;QACX,WAAW;IACb,GAAG,MAAM,CAAC;AACZ;AAEA,MAAM,+BAA+B,CACnC,OACA;IAEA,IAAI,MAAM,YAAY,EAAE;QACtB,OAAO,CAAC,KAAK,EAAE,MAAM,YAAY,EAAE;IACrC;IACA,IAAI,MAAM,SAAS,KAAK,aAAa,MAAM,SAAS,KAAK,MAAM;QAC7D,OAAO,CAAC,OAAO,EAAE,MAAM,SAAS,EAAE;IACpC;IACA,OAAO,CAAC,QAAQ,EAAE,OAAO;AAC3B;AAQA,MAAM,sBAA4C;IAChD;QACE,OAAO;QACP,QAAQ;YACN;YACA;YACA;YACA;SACD;QACD,SAAS;IACX;IACA;QACE,OAAO;QACP,QAAQ;YACN;YACA;YACA;YACA;YACA;YACA;YACA;YACA;SACD;QACD,SAAS;IACX;IACA;QACE,OAAO;QACP,QAAQ;YACN;YACA;YACA;YACA;YACA;YACA;YACA;YACA;SACD;QACD,SAAS;IACX;CACD;AAED,MAAM,4BAA4B,IAChC,qBAAqB,MAAM,CAAC,CAAC,KAAK;QAChC,GAAG,CAAC,MAAM,GAAG,CAAC,GAAG;QACjB,OAAO;IACT,GAAG,CAAC;AAEN,MAAM,wBAAwB,CAAC;IAC7B,IAAI,CAAC,OAAO,OAAO;IACnB,MAAM,aAAa,MAAM,QAAQ,GAAG,IAAI,GAAG,WAAW;IACtD,IAAI,CAAC,YAAY,OAAO;IACxB,IAAI,eAAe,aAAa,WAAW,QAAQ,CAAC,WAAW,OAAO;IACtE,IAAI,eAAe,cAAc,WAAW,QAAQ,CAAC,WAAW,OAAO;IACvE,MAAM,cAAc,gBAAgB,IAAI,CAAC,CAAC,OAAS,KAAK,GAAG,KAAK;IAChE,OAAO,cAAc,YAAY,GAAG,GAAG;AACzC;AAOA,MAAM,eAAe,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAqB;;IAC1D,MAAM,YAAY,IAAA,uKAAM,EAAoB;IAC5C,MAAM,SAAS,IAAA,uKAAM,EAAkC;IACvD,MAAM,aAAa,IAAA,uKAAM,EAAC;IAC1B,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,MAAM,kBAAkB,IAAA,4KAAW;qDAAC;YAClC,MAAM,SAAS,UAAU,OAAO;YAChC,IAAI,CAAC,QAAQ;YACb,SAAS,OAAO,SAAS,CAAC;QAC5B;oDAAG;QAAC;KAAS;IAEb,MAAM,cAAc,IAAA,4KAAW;iDAAC;YAC9B,MAAM,SAAS,UAAU,OAAO;YAChC,MAAM,MAAM,OAAO,OAAO;YAC1B,IAAI,CAAC,UAAU,CAAC,KAAK;YACrB,IAAI,SAAS,CAAC,GAAG,GAAG,OAAO,KAAK,EAAE,OAAO,MAAM;YAC/C,SAAS;QACX;gDAAG;QAAC;KAAS;IAEb,MAAM,gBAAgB,IAAA,4KAAW;mDAAC;YAChC,MAAM,MAAM,OAAO,OAAO;YAC1B,MAAM,SAAS,UAAU,OAAO;YAChC,IAAI,CAAC,OAAO,CAAC,QAAQ;YACrB,IAAI,SAAS,CAAC,GAAG,GAAG,OAAO,KAAK,EAAE,OAAO,MAAM;YAC/C,IAAI,CAAC,OAAO;YACZ,MAAM,QAAQ,IAAI;YAClB,MAAM,WAAW,GAAG;YACpB,MAAM,MAAM;2DAAG;oBACb,IAAI,SAAS,CAAC,OAAO,GAAG,GAAG,OAAO,KAAK,EAAE,OAAO,MAAM;gBACxD;;YACA,MAAM,GAAG,GAAG;QACd;kDAAG;QAAC;KAAM;IAEV,IAAA,0KAAS;kCAAC;YACR,MAAM,SAAS,UAAU,OAAO;YAChC,IAAI,CAAC,QAAQ;YACb,MAAM,MAAM,OAAO,UAAU,CAAC;YAC9B,IAAI,CAAC,KAAK;YACV,MAAM,QAAQ,KAAK,GAAG,CAAC,GAAG,OAAO,gBAAgB,IAAI;YACrD,MAAM,cAAc,OAAO,WAAW,IAAI;YAC1C,MAAM,cAAc;YACpB,OAAO,KAAK,GAAG,cAAc;YAC7B,OAAO,MAAM,GAAG,cAAc;YAC9B,OAAO,KAAK,CAAC,KAAK,GAAG;YACrB,OAAO,KAAK,CAAC,MAAM,GAAG,GAAG,YAAY,EAAE,CAAC;YACxC,IAAI,KAAK,CAAC,OAAO;YACjB,IAAI,OAAO,GAAG;YACd,IAAI,QAAQ,GAAG;YACf,IAAI,SAAS,GAAG;YAChB,IAAI,WAAW,GAAG;YAClB,OAAO,OAAO,GAAG;YACjB,WAAW;QACb;iCAAG,EAAE;IAEL,IAAA,0KAAS;kCAAC;YACR,IAAI,CAAC,SAAS;YACd;QACF;iCAAG;QAAC;QAAe;KAAQ;IAE3B,MAAM,mBAAmB,CAAC;QACxB,MAAM,SAAS,UAAU,OAAO;QAChC,IAAI,CAAC,QAAQ,OAAO;YAAE,GAAG;YAAG,GAAG;QAAE;QACjC,MAAM,OAAO,OAAO,qBAAqB;QACzC,OAAO;YACL,GAAG,MAAM,OAAO,GAAG,KAAK,IAAI;YAC5B,GAAG,MAAM,OAAO,GAAG,KAAK,GAAG;QAC7B;IACF;IAEA,MAAM,oBAAoB,CAAC;QACzB,MAAM,cAAc;QACpB,MAAM,MAAM,OAAO,OAAO;QAC1B,IAAI,CAAC,KAAK;QACV,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,iBAAiB;QAClC,WAAW,OAAO,GAAG;QACrB,IAAI,SAAS;QACb,IAAI,MAAM,CAAC,GAAG;IAChB;IAEA,MAAM,oBAAoB,CAAC;QACzB,IAAI,CAAC,WAAW,OAAO,EAAE;QACzB,MAAM,MAAM,OAAO,OAAO;QAC1B,IAAI,CAAC,KAAK;QACV,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,iBAAiB;QAClC,IAAI,MAAM,CAAC,GAAG;QACd,IAAI,MAAM;IACZ;IAEA,MAAM,cAAc;QAClB,IAAI,CAAC,WAAW,OAAO,EAAE;QACzB,WAAW,OAAO,GAAG;QACrB;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBACC,KAAK;gBACL,WAAU;gBACV,eAAe;gBACf,eAAe;gBACf,aAAa;gBACb,gBAAgB;;;;;;0BAElB,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBACC,MAAK;wBACL,SAAS;wBACT,WAAU;kCACX;;;;;;kCAGD,6LAAC;wBAAK,WAAU;kCAA6B;;;;;;;;;;;;;;;;;;AAIrD;GArHM;KAAA;AA6HC,MAAM,oBAAoB,CAAC,EAChC,MAAM,EACN,OAAO,EACP,cAAc,WAAW,EACzB,MAAM,EACiB;;IACvB,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAe,CAAC;IAChE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAA4D;IACtG,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAEhD,EAAE;IACJ,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAEhD,EAAE;IACJ,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAElD,EAAE;IACJ,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAElD,EAAE;IACJ,MAAM,CAAC,sBAAsB,wBAAwB,GAAG,IAAA,yKAAQ,EAE9D,EAAE;IACJ,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IACjD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAC;IACzD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAC;IACzD,MAAM,CAAC,sBAAsB,wBAAwB,GAAG,IAAA,yKAAQ,EAAC;IACjE,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EACpD;IAEF,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,yKAAQ,EAAC;IAC7D,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAgB;IACxE,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,yKAAQ,EAC1D,EAAE;IAEJ,MAAM,CAAC,2BAA2B,6BAA6B,GAAG,IAAA,yKAAQ,EAAC;IAC3E,MAAM,CAAC,yBAAyB,2BAA2B,GAAG,IAAA,yKAAQ,EAAgB;IACtF,MAAM,CAAC,+BAA+B,iCAAiC,GAAG,IAAA,yKAAQ,EAChF;IAEF,MAAM,CAAC,wBAAwB,0BAA0B,GAAG,IAAA,yKAAQ,EAAgB;IACpF,MAAM,wBAAwB,IAAA,uKAAM,EAAyB,CAAC;IAC9D,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAiB,EAAE;IACrE,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAiB,EAAE;IACrE,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAoB,EAAE;IAC9E,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,yKAAQ,EAAgB;IAC5E,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,yKAAQ,EAAgB;IAC5E,MAAM,CAAC,uBAAuB,yBAAyB,GAAG,IAAA,yKAAQ,EAAgB;IAClF,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,yKAAQ,EAAC;IAC7D,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAgB;IACxE,MAAM,yBAAyB,CAAC;QAC9B,IAAI,UAAU,aAAa,UAAU,MAAM,OAAO;QAClD,MAAM,OAAO,OAAO,UAAU,WAAW,QAAQ,OAAO;QACxD,OAAO,KAAK,IAAI;IAClB;IACA,MAAM,qBAAqB,IAAA,wKAAO;yDAAC;YACjC,MAAM,eAAe;gBAAC;gBAAU;gBAAM;gBAAc;aAAgB;YACpE,KAAK,MAAM,OAAO,aAAc;gBAC9B,IAAI,OAAO,cAAc;oBACvB,MAAM,aAAa,uBAAuB,YAAY,CAAC,IAAI;oBAC3D,IAAI,YAAY,OAAO;gBACzB;YACF;YACA,OAAO;QACT;wDAAG;QAAC;KAAa;IACjB,MAAM,gBAAgB,IAAA,wKAAO;oDAAC;YAC5B,MAAM,WAAW;gBAAC;gBAAU;gBAAS;aAAK;YAC1C,KAAK,MAAM,OAAO,SAAU;gBAC1B,IAAI,OAAO,cAAc;oBACvB,MAAM,aAAa,uBAAuB,YAAY,CAAC,IAAI;oBAC3D,IAAI,YAAY,OAAO;gBACzB;YACF;YACA,OAAO;QACT;mDAAG;QAAC;KAAa;IACjB,MAAM,sBAAsB,IAAA,wKAAO;0DAAC;YAClC,MAAM,YAAY;gBAAC;gBAAQ;gBAAiB;aAAc;YAC1D,KAAK,MAAM,OAAO,UAAW;gBAC3B,IAAI,OAAO,cAAc;oBACvB,MAAM,aAAa,uBAAuB,YAAY,CAAC,IAAI;oBAC3D,IAAI,YAAY,OAAO;gBACzB;YACF;YACA,OAAO;QACT;yDAAG;QAAC;KAAa;IACjB,MAAM,mBAAmB,IAAA,wKAAO;uDAAC;YAC/B,MAAM,YAAY;gBAAC;gBAAc;aAAgB;YACjD,KAAK,MAAM,OAAO,UAAW;gBAC3B,IAAI,OAAO,cAAc;oBACvB,MAAM,aAAa,uBAAuB,YAAY,CAAC,IAAI;oBAC3D,IAAI,YAAY,OAAO;gBACzB;YACF;YACA,OAAO;QACT;sDAAG;QAAC;KAAa;IACjB,qBAAqB;IACrB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAoB,EAAE;IAChE,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IACnD,MAAM,CAAC,sBAAsB,wBAAwB,GAAG,IAAA,yKAAQ,EAAS;IACzE,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,yKAAQ,EAAmB,EAAE;IAC/E,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAC;IACvD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAgB;IAChE,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,yKAAQ,EAAC;IAC3D,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAyB,EAAE;IACnF,MAAM,6BAA6B,IAAA,uKAAM,EAAgB;IACzD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAQ,EAAE;IAClE,MAAM,CAAC,yBAAyB,2BAA2B,GAAG,IAAA,yKAAQ,EAAC;IACvE,MAAM,CAAC,uBAAuB,yBAAyB,GAAG,IAAA,yKAAQ,EAAgB;IAClF,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAC;IACrD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAC;IACzD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAgB;IAClE,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EACpD;IAEF,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,yKAAQ,EAC5D,eAAe,CAAC,EAAE,CAAC,GAAG;IAExB,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAC;IACrD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAgB;IACxE,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IACnD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IAEjD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAK7C;QACD,QAAQ;QACR,MAAM;QACN,OAAO;QACP,SAAS;IACX;IAEA,MAAM,qBAAqB;QACzB,IAAI;YACF,MAAM,WAAW,MAAM,MAAM;YAC7B,MAAM,SAAS,MAAM,SAAS,IAAI;YAClC,IAAI,OAAO,OAAO,IAAI,OAAO,IAAI,EAAE;gBACjC,iBAAiB,OAAO,IAAI;YAC9B,OAAO;gBACL,oDAAoD;gBACpD,iBAAiB;oBACf;wBACE,OAAO;wBACP,OAAO;wBACP,OAAO;oBACT;oBACA;wBAAE,OAAO;wBAAa,OAAO;wBAAa,OAAO;oBAAU;oBAC3D;wBAAE,OAAO;wBAAU,OAAO;wBAAU,OAAO;oBAAU;oBACrD;wBAAE,OAAO;wBAAa,OAAO;wBAAa,OAAO;oBAAU;oBAC3D;wBACE,OAAO;wBACP,OAAO;wBACP,OAAO;oBACT;oBACA;wBAAE,OAAO;wBAAgB,OAAO;wBAAgB,OAAO;oBAAU;oBACjE;wBAAE,OAAO;wBAAc,OAAO;wBAAc,OAAO;oBAAU;iBAC9D;YACH;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,kCAAkC;YAChD,qCAAqC;YACrC,iBAAiB;gBACf;oBACE,OAAO;oBACP,OAAO;oBACP,OAAO;gBACT;gBACA;oBAAE,OAAO;oBAAa,OAAO;oBAAa,OAAO;gBAAU;gBAC3D;oBAAE,OAAO;oBAAU,OAAO;oBAAU,OAAO;gBAAU;gBACrD;oBAAE,OAAO;oBAAa,OAAO;oBAAa,OAAO;gBAAU;gBAC3D;oBAAE,OAAO;oBAAkB,OAAO;oBAAkB,OAAO;gBAAU;gBACrE;oBAAE,OAAO;oBAAgB,OAAO;oBAAgB,OAAO;gBAAU;gBACjE;oBAAE,OAAO;oBAAc,OAAO;oBAAc,OAAO;gBAAU;aAC9D;QACH;IACF;IAEA,MAAM,qBAAqB;QACzB,IAAI;YACF,MAAM,WAAW,MAAM,MAAM;YAC7B,MAAM,SAAS,MAAM,SAAS,IAAI;YAClC,IAAI,OAAO,OAAO,IAAI,OAAO,IAAI,EAAE;gBACjC,iBAAiB,OAAO,IAAI;YAC9B,OAAO;gBACL,oBAAoB;gBACpB,iBAAiB;oBACf;wBAAE,OAAO;wBAAY,OAAO;oBAAW;oBACvC;wBAAE,OAAO;wBAAa,OAAO;oBAAY;oBACzC;wBAAE,OAAO;wBAAc,OAAO;oBAAa;oBAC3C;wBAAE,OAAO;wBAAQ,OAAO;oBAAO;oBAC/B;wBAAE,OAAO;wBAAW,OAAO;oBAAU;oBACrC;wBAAE,OAAO;wBAAY,OAAO;oBAAW;iBACxC;YACH;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,kCAAkC;YAChD,oBAAoB;YACpB,iBAAiB;gBACf;oBAAE,OAAO;oBAAY,OAAO;gBAAW;gBACvC;oBAAE,OAAO;oBAAa,OAAO;gBAAY;gBACzC;oBAAE,OAAO;oBAAc,OAAO;gBAAa;gBAC3C;oBAAE,OAAO;oBAAQ,OAAO;gBAAO;gBAC/B;oBAAE,OAAO;oBAAW,OAAO;gBAAU;gBACrC;oBAAE,OAAO;oBAAY,OAAO;gBAAW;aACxC;QACH;IACF;IAEA,MAAM,sBAAsB;QAC1B,IAAI;YACF,MAAM,WAAW,MAAM,MAAM;YAC7B,MAAM,SAAS,MAAM,SAAS,IAAI;YAClC,IAAI,OAAO,OAAO,IAAI,OAAO,IAAI,EAAE;gBACjC,kBAAkB,OAAO,IAAI;YAC/B,OAAO;gBACL,oBAAoB;gBACpB,kBAAkB;oBAChB;wBAAE,OAAO;wBAAe,OAAO;oBAAc;oBAC7C;wBAAE,OAAO;wBAAiB,OAAO;oBAAgB;oBACjD;wBAAE,OAAO;wBAAwB,OAAO;oBAAuB;oBAC/D;wBAAE,OAAO;wBAAa,OAAO;oBAAY;oBACzC;wBAAE,OAAO;wBAAa,OAAO;oBAAY;oBACzC;wBAAE,OAAO;wBAAW,OAAO;oBAAU;oBACrC;wBAAE,OAAO;wBAAc,OAAO;oBAAa;oBAC3C;wBAAE,OAAO;wBAAW,OAAO;oBAAU;oBACrC;wBAAE,OAAO;wBAAQ,OAAO;oBAAO;iBAChC;YACH;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,mCAAmC;YACjD,oBAAoB;YACpB,kBAAkB;gBAChB;oBAAE,OAAO;oBAAe,OAAO;gBAAc;gBAC7C;oBAAE,OAAO;oBAAiB,OAAO;gBAAgB;gBACjD;oBAAE,OAAO;oBAAwB,OAAO;gBAAuB;gBAC/D;oBAAE,OAAO;oBAAa,OAAO;gBAAY;gBACzC;oBAAE,OAAO;oBAAa,OAAO;gBAAY;gBACzC;oBAAE,OAAO;oBAAW,OAAO;gBAAU;gBACrC;oBAAE,OAAO;oBAAc,OAAO;gBAAa;gBAC3C;oBAAE,OAAO;oBAAW,OAAO;gBAAU;gBACrC;oBAAE,OAAO;oBAAQ,OAAO;gBAAO;aAChC;QACH;IACF;IAEA,MAAM,sBAAsB;QAC1B,IAAI;YACF,MAAM,WAAW,MAAM,MAAM;YAC7B,MAAM,SAAS,MAAM,SAAS,IAAI;YAClC,IAAI,OAAO,OAAO,IAAI,OAAO,IAAI,EAAE;gBACjC,kBAAkB,OAAO,IAAI;YAC/B,OAAO;gBACL,oBAAoB;gBACpB,kBAAkB;oBAChB;wBAAE,OAAO;wBAAO,OAAO;oBAAM;oBAC7B;wBAAE,OAAO;wBAAO,OAAO;oBAAM;oBAC7B;wBAAE,OAAO;wBAAW,OAAO;oBAAU;oBACrC;wBAAE,OAAO;wBAAU,OAAO;oBAAS;oBACnC;wBAAE,OAAO;wBAAY,OAAO;oBAAW;oBACvC;wBAAE,OAAO;wBAAY,OAAO;oBAAW;oBACvC;wBAAE,OAAO;wBAAS,OAAO;oBAAQ;iBAClC;YACH;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,mCAAmC;YACjD,oBAAoB;YACpB,kBAAkB;gBAChB;oBAAE,OAAO;oBAAO,OAAO;gBAAM;gBAC7B;oBAAE,OAAO;oBAAO,OAAO;gBAAM;gBAC7B;oBAAE,OAAO;oBAAW,OAAO;gBAAU;gBACrC;oBAAE,OAAO;oBAAU,OAAO;gBAAS;gBACnC;oBAAE,OAAO;oBAAY,OAAO;gBAAW;gBACvC;oBAAE,OAAO;oBAAY,OAAO;gBAAW;gBACvC;oBAAE,OAAO;oBAAS,OAAO;gBAAQ;aAClC;QACH;IACF;IAEA,MAAM,4BAA4B;QAChC,IAAI;YACF,MAAM,WAAW,MAAM,MAAM;YAC7B,MAAM,SAAS,MAAM,SAAS,IAAI;YAClC,IAAI,OAAO,OAAO,IAAI,OAAO,IAAI,EAAE;gBACjC,wBAAwB,OAAO,IAAI;YACrC,OAAO;gBACL,oBAAoB;gBACpB,wBAAwB;oBACtB;wBAAE,OAAO;wBAAQ,OAAO;oBAAO;oBAC/B;wBAAE,OAAO;wBAAO,OAAO;oBAAM;oBAC7B;wBAAE,OAAO;wBAAM,OAAO;oBAAK;oBAC3B;wBAAE,OAAO;wBAAM,OAAO;oBAAK;oBAC3B;wBAAE,OAAO;wBAAS,OAAO;oBAAQ;oBACjC;wBAAE,OAAO;wBAAO,OAAO;oBAAM;iBAC9B;YACH;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,0CAA0C;YACxD,oBAAoB;YACpB,wBAAwB;gBACtB;oBAAE,OAAO;oBAAQ,OAAO;gBAAO;gBAC/B;oBAAE,OAAO;oBAAO,OAAO;gBAAM;gBAC7B;oBAAE,OAAO;oBAAM,OAAO;gBAAK;gBAC3B;oBAAE,OAAO;oBAAM,OAAO;gBAAK;gBAC3B;oBAAE,OAAO;oBAAS,OAAO;gBAAQ;gBACjC;oBAAE,OAAO;oBAAO,OAAO;gBAAM;aAC9B;QACH;IACF;IAEA,mBAAmB;IACnB,MAAM,iBAAiB;QACrB,iBAAiB;QACjB,IAAI;YACF,MAAM,WAAW,MAAM,MAAM;YAC7B,MAAM,SAAS,MAAM,SAAS,IAAI;YAClC,IAAI,CAAC,SAAS,EAAE,IAAI,OAAO,OAAO,KAAK,OAAO;gBAC5C,MAAM,IAAI,MAAM,OAAO,KAAK,IAAI;YAClC;YACA,aAAa,MAAM,OAAO,CAAC,OAAO,IAAI,IAAI,OAAO,IAAI,GAAG,EAAE;QAC5D,EAAE,OAAO,OAAY;YACnB,QAAQ,KAAK,CAAC,8BAA8B;QAC9C,SAAU;YACR,iBAAiB;QACnB;IACF;IAEA,mCAAmC;IACnC,MAAM,uBAAuB,OAAO;QAClC,IAAI,CAAC,WAAW;YACd,qBAAqB,EAAE;YACvB;QACF;QACA,2BAA2B,OAAO,GAAG;QACrC,mBAAmB;QACnB,gBAAgB;QAChB,qBAAqB,EAAE;QACvB,IAAI;YACF,MAAM,WAAW,MAAM,MACrB,CAAC,+BAA+B,EAAE,mBAAmB,YAAY;YAEnE,MAAM,SAAS,MAAM,SAAS,IAAI;YAClC,IAAI,CAAC,SAAS,EAAE,IAAI,OAAO,OAAO,KAAK,OAAO;gBAC5C,MAAM,IAAI,MAAM,OAAO,KAAK,IAAI;YAClC;YACA,IAAI,2BAA2B,OAAO,KAAK,WAAW;YACtD,MAAM,kBAAkB,MAAM,OAAO,CAAC,OAAO,IAAI,IAC7C,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC,OAAyB,CAAC;oBAC3C,GAAG,IAAI;oBACP,WAAW,wBAAwB,KAAK,SAAS;gBACnD,CAAC,KACC,EAAE;YACN,qBAAqB;QACvB,EAAE,OAAO,OAAY;YACnB,IAAI,2BAA2B,OAAO,KAAK,WAAW;YACtD,gBAAgB,OAAO,WAAW;QACpC,SAAU;YACR,IAAI,2BAA2B,OAAO,KAAK,WAAW;gBACpD,mBAAmB;YACrB;QACF;IACF;IAEA,MAAM,wBAAwB,IAAA,4KAAW;gEAAC,OAAO;YAC/C,2BAA2B;YAC3B,yBAAyB;YACzB,IAAI;gBACF,MAAM,WAAW,MAAM,MAAM,CAAC,qBAAqB,EAAE,mBAAmB,OAAO;gBAC/E,MAAM,SAAS,MAAM,SAAS,IAAI;gBAClC,IAAI,CAAC,SAAS,EAAE,IAAI,OAAO,OAAO,KAAK,OAAO;oBAC5C,MAAM,IAAI,MAAM,OAAO,KAAK,IAAI;gBAClC;gBACA,oBAAoB,MAAM,OAAO,CAAC,OAAO,IAAI,IAAI,OAAO,IAAI,GAAG,EAAE;YACnE,EAAE,OAAO,OAAY;gBACnB,oBAAoB,EAAE;gBACtB,yBAAyB,OAAO,WAAW;YAC7C,SAAU;gBACR,2BAA2B;YAC7B;QACF;+DAAG,EAAE;IAEL,MAAM,oBAAoB,CAAC;QACzB,wBAAwB;QACxB,qBAAqB;QACrB,gBAAgB;QAChB,IAAI,CAAC,WAAW;YACd,qBAAqB,EAAE;YACvB;QACF;QACA,qBAAqB;IACvB;IAEA,MAAM,yBAAyB;QAC7B,oBAAoB;QACpB,gBAAgB;QAChB,IAAI,UAAU,MAAM,KAAK,GAAG;YAC1B;QACF;QACA,IAAI,sBAAsB;YACxB,qBAAqB;QACvB;IACF;IAEA,MAAM,0BAA0B;QAC9B,oBAAoB;QACpB,qBAAqB;QACrB,gBAAgB;IAClB;IAEA,MAAM,oBAAoB;QACxB,IAAI,CAAC,oBAAoB;QACzB,sBAAsB;QACtB,oBAAoB;IACtB;IAEA,MAAM,qBAAqB;QACzB,oBAAoB;IACtB;IAEA,MAAM,oBAAoB,IAAA,4KAAW;4DAAC;YACpC,IAAI,CAAC,eAAe;YACpB,kBAAkB;YAClB,oBAAoB;YACpB,mBAAmB;YACnB,IAAI;gBACF,MAAM,WAAW,MAAM,MACrB,CAAC,0BAA0B,EAAE,mBAAmB,gBAAgB;gBAElE,MAAM,SAAS,MAAM,SAAS,IAAI;gBAClC,IAAI,CAAC,SAAS,EAAE,IAAI,OAAO,OAAO,KAAK,OAAO;oBAC5C,MAAM,IAAI,MAAM,OAAO,KAAK,IAAI;gBAClC;gBACA,MAAM,eAAe;gBACrB,IAAI,MAAM,OAAO,CAAC,OAAO,IAAI,GAAG;oBAC9B,OAAO,IAAI,CAAC,OAAO;4EAAC,CAAC;4BACnB,MAAM,UAAU,sBAAsB,KAAK,IAAI;4BAC/C,IAAI,CAAC,SAAS;4BACd,MAAM;iGAAe,CAAC,QACpB,UAAU,aAAa,UAAU,OAAO,KAAK,OAAO;;4BACtD,YAAY,CAAC,QAAQ,GAAG;gCACtB,QAAQ,aAAa,KAAK,SAAS,IAAI,KAAK,MAAM;gCAClD,QAAQ,aAAa,KAAK,SAAS,IAAI,KAAK,MAAM;gCAClD,YAAY,QACV,KAAK,mBAAmB,IAAI,KAAK,WAAW,IAAI,KAAK,UAAU;gCAEjE,sBACE,KAAK,sBAAsB,IAAI,KAAK,oBAAoB,IAAI;gCAC9D,gBAAgB,QACd,KAAK,gBAAgB,IAAI,KAAK,cAAc;gCAE9C,mBACE,KAAK,mBAAmB,IAAI,KAAK,iBAAiB,IAAI;gCACxD,cAAc,KAAK,aAAa,IAAI,KAAK,YAAY,IAAI;gCACzD,gBAAgB,KAAK,eAAe,IAAI,KAAK,cAAc,IAAI;gCAC/D,YAAY,KAAK,WAAW,IAAI,KAAK,UAAU,IAAI;gCACnD,aAAa,KAAK,YAAY,IAAI,KAAK,WAAW,IAAI;4BACxD;wBACF;;gBACF;gBACA,mBAAmB;YACrB,EAAE,OAAO,OAAY;gBACnB,QAAQ,KAAK,CAAC,gCAAgC;gBAC9C,oBAAoB,OAAO,WAAW;YACxC,SAAU;gBACR,kBAAkB;YACpB;QACF;2DAAG;QAAC;KAAmB;IAEvB,IAAA,0KAAS;uCAAC;YACR,IAAI,oBAAoB,oBAAoB;gBAC1C,sBAAsB;YACxB;QACF;sCAAG;QAAC;QAAkB;QAAoB;KAAsB;IAEhE,IAAA,0KAAS;uCAAC;YACR,IAAI,CAAC,kBAAkB;YACvB,uBAAuB,eAAe,CAAC,EAAE,CAAC,GAAG;YAC7C;QACF;sCAAG;QAAC;QAAkB;KAAkB;IAExC,MAAM,6BAA6B,CACjC,MACA;QAEA,mBAAmB,CAAC,UAAY,CAAC;gBAC/B,GAAG,OAAO;gBACV,CAAC,KAAK,EAAE;oBACN,GAAG,OAAO,CAAC,KAAK;oBAChB,GAAG,OAAO;gBACZ;YACF,CAAC;IACH;IAEA,MAAM,sBAAsB,CAC1B,MACA,OACA;QAEA,MAAM,UAAmC;YAAE,CAAC,MAAM,EAAE;QAAM;QAC1D,IAAI,UAAU,gBAAgB,CAAC,OAAO;YACpC,QAAQ,oBAAoB,GAAG;QACjC;QACA,IAAI,UAAU,oBAAoB,CAAC,OAAO;YACxC,QAAQ,iBAAiB,GAAG;QAC9B;QACA,2BAA2B,MAAM;IACnC;IAEA,MAAM,+BAA+B,CAAC,MAAsB;QAC1D,2BAA2B,MAAM;YAAE;QAAa;IAClD;IAEA,MAAM,yBAAyB;QAC7B,IAAI,CAAC,eAAe;YAClB,gBAAgB;gBACd,QAAQ;gBACR,MAAM;gBACN,OAAO;gBACP,SAAS;YACX;YACA;QACF;QACA,iBAAiB;QACjB,IAAI;YACF,MAAM,UAAU;gBACd,MAAM;gBACN,OAAO;gBACP,WAAW,gBAAgB;gBAC3B,UAAU,gBAAgB,GAAG,CAAC,CAAC;oBAC7B,MAAM,QAAQ,eAAe,CAAC,KAAK,GAAG,CAAC;oBACvC,OAAO;wBACL,MAAM,KAAK,GAAG;wBACd,QAAQ,MAAM,MAAM;wBACpB,QAAQ,MAAM,MAAM;wBACpB,YAAY,MAAM,UAAU;wBAC5B,sBAAsB,MAAM,oBAAoB;wBAChD,gBAAgB,MAAM,cAAc;wBACpC,mBAAmB,MAAM,iBAAiB;wBAC1C,cAAc,MAAM,YAAY;wBAChC,gBAAgB,MAAM,cAAc,IAAI;wBACxC,YAAY,MAAM,UAAU,IAAI;wBAChC,aAAa,MAAM,WAAW,IAAI;oBACpC;gBACF;YACF;YAEA,MAAM,WAAW,MAAM,MAAM,sBAAsB;gBACjD,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC;YACvB;YAEA,IAAI;YACJ,IAAI;gBACF,SAAS,MAAM,SAAS,IAAI;YAC9B,EAAE,OAAO,YAAY;gBACnB,MAAM,eAAe,MAAM,SAAS,IAAI;gBACxC,MAAM,IAAI,MACR,gBACA,AAAC,WAAqB,OAAO,IAC7B;YAEJ;YACA,IAAI,CAAC,SAAS,EAAE,IAAI,OAAO,OAAO,KAAK,OAAO;gBAC5C,MAAM,IAAI,MAAM,OAAO,KAAK,IAAI;YAClC;YACA,gBAAgB;gBACd,QAAQ;gBACR,MAAM;gBACN,OAAO;gBACP,SAAS,OAAO,OAAO,IAAI;YAC7B;YACA,MAAM;QACR,EAAE,OAAO,OAAY;YACnB,gBAAgB;gBACd,QAAQ;gBACR,MAAM;gBACN,OAAO;gBACP,SAAS,OAAO,WAAW;YAC7B;QACF,SAAU;YACR,iBAAiB;QACnB;IACF;IAEA,MAAM,6BAA6B;QACjC,IAAI,CAAC,oBAAoB;YACvB,gBAAgB;gBACd,QAAQ;gBACR,MAAM;gBACN,OAAO;gBACP,SAAS;YACX;YACA,OAAO;QACT;QACA,IAAI,iBAAiB,MAAM,KAAK,GAAG;YACjC,gBAAgB;gBACd,QAAQ;gBACR,MAAM;gBACN,OAAO;gBACP,SAAS;YACX;YACA,OAAO;QACT;QACA,kBAAkB;QAClB,IAAI;YACF,MAAM,iBAAiB,iBAAiB;YACxC,MAAM,UAAU;gBACd,MAAM;gBACN,UAAU,oBAAoB;gBAC9B,aAAa,uBAAuB;gBACpC,WAAW;gBACX,UAAU,iBAAiB,GAAG,CAAC,CAAC,QAAU,CAAC;wBACzC,UAAU,MAAM,QAAQ;wBACxB,UAAU,MAAM,QAAQ;wBACxB,UAAU,MAAM,UAAU;wBAC1B,WAAW,2BAA2B;wBACtC,UAAU,MAAM,QAAQ,IAAI;oBAC9B,CAAC;YACH;YAEA,MAAM,WAAW,MAAM,MAAM,mBAAmB;gBAC9C,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC;YACvB;YAEA,MAAM,SAAS,MAAM,SAAS,IAAI;YAClC,IAAI,CAAC,SAAS,EAAE,IAAI,OAAO,OAAO,KAAK,OAAO;gBAC5C,MAAM,IAAI,MAAM,OAAO,KAAK,IAAI;YAClC;YACA,gBAAgB;gBACd,QAAQ;gBACR,MAAM;gBACN,OAAO;gBACP,SACE,OAAO,OAAO,IACd,CAAC,OAAO,EAAE,OAAO,aAAa,IAAI,iBAAiB,MAAM,CAAC,yBAAyB,CAAC;YACxF;YACA,iBAAiB;YACjB,IAAI,oBAAoB;gBACtB,sBAAsB;YACxB;YACA,OAAO;QACT,EAAE,OAAO,OAAY;YACnB,gBAAgB;gBACd,QAAQ;gBACR,MAAM;gBACN,OAAO;gBACP,SACE,OAAO,WAAW;YACtB;YACA,OAAO;QACT,SAAU;YACR,kBAAkB;QACpB;IACF;IAEA,MAAM,iCAAiC;QACrC,MAAM,QAAQ,MAAM;QACpB,IAAI,OAAO;YACT;QACF;IACF;IAEA,gCAAgC;IAChC,MAAM,6BAA6B,CACjC,IACA;QAEA,oBAAoB,CAAC,UACnB,QAAQ,GAAG,CAAC,CAAC,QAAW,MAAM,EAAE,KAAK,KAAK,QAAQ,SAAS;IAE/D;IAEA,MAAM,0BAA0B,CAAC,IAAY;QAC3C,2BAA2B,IAAI,CAAC;YAC9B,MAAM,UAAU,MAAM,IAAI;YAC1B,MAAM,UAAU,OAAO;YACvB,MAAM,WAAW,QAAQ,MAAM,GAAG,KAAK,OAAO,QAAQ,CAAC;YACvD,MAAM,cACJ,YAAY,MAAM,UAAU,GAAG,IAC3B,wBAAwB,AAAC,UAAU,MAAM,UAAU,GAAI,OACvD;YACN,OAAO;gBAAE,GAAG,KAAK;gBAAE,aAAa;gBAAO,eAAe;YAAY;QACpE;IACF;IAEA,MAAM,4BAA4B,CAAC,IAAY;QAC7C,2BAA2B,IAAI,CAAC;YAC9B,MAAM,UAAU,MAAM,IAAI;YAC1B,MAAM,UAAU,OAAO;YACvB,MAAM,WAAW,QAAQ,MAAM,GAAG,KAAK,OAAO,QAAQ,CAAC;YACvD,MAAM,YACJ,YAAY,MAAM,UAAU,GAAG,IAC3B,wBAAwB,AAAC,MAAM,UAAU,GAAG,UAAW,OACvD;YACN,OAAO;gBAAE,GAAG,KAAK;gBAAE,aAAa;gBAAW,eAAe;YAAM;QAClE;IACF;IAEA,MAAM,4BAA4B,CAAC,IAAY;QAC7C,2BAA2B,IAAI,CAAC;YAC9B,MAAM,UAAU,MAAM,IAAI;YAC1B,MAAM,UAAU,OAAO;YACvB,MAAM,WAAW,QAAQ,MAAM,GAAG,KAAK,OAAO,QAAQ,CAAC;YACvD,MAAM,cACJ,YAAY,MAAM,UAAU,GAAG,IAC3B,wBAAwB,AAAC,UAAU,MAAM,UAAU,GAAI,OACvD;YACN,OAAO;gBAAE,GAAG,KAAK;gBAAE,eAAe;gBAAO,iBAAiB;YAAY;QACxE;IACF;IAEA,MAAM,8BAA8B,CAAC,IAAY;QAC/C,2BAA2B,IAAI,CAAC;YAC9B,MAAM,UAAU,MAAM,IAAI;YAC1B,MAAM,UAAU,OAAO;YACvB,MAAM,WAAW,QAAQ,MAAM,GAAG,KAAK,OAAO,QAAQ,CAAC;YACvD,MAAM,YACJ,YAAY,MAAM,UAAU,GAAG,IAC3B,wBAAwB,AAAC,MAAM,UAAU,GAAG,UAAW,OACvD;YACN,OAAO;gBAAE,GAAG,KAAK;gBAAE,eAAe;gBAAW,iBAAiB;YAAM;QACtE;IACF;IAEA,MAAM,mBAAmB,CAAC;QACxB,oBAAoB,CAAC;YACnB,IAAI,QAAQ,IAAI,CAAC,CAAC,QAAU,MAAM,QAAQ,KAAK,KAAK,QAAQ,GAAG;gBAC7D,OAAO;YACT;YACA,OAAO;mBACF;gBACH;oBACE,IAAI,GAAG,KAAK,QAAQ,CAAC,CAAC,EAAE,KAAK,GAAG,IAAI;oBACpC,UAAU,KAAK,QAAQ;oBACvB,UAAU,KAAK,QAAQ;oBACvB,YAAY,wBAAwB,KAAK,SAAS;oBAClD,aAAa;oBACb,eAAe;oBACf,eAAe;oBACf,iBAAiB;oBACjB,UAAU;gBACZ;aACD;QACH;IACF;IAEA,MAAM,2BAA2B,CAAC;QAChC,oBAAoB,CAAC,UAAY,QAAQ,MAAM,CAAC,CAAC,QAAU,MAAM,EAAE,KAAK;IAC1E;IAEA,kCAAkC;IAClC,MAAM,mBAAmB,IAAA,wKAAO;uDAC9B,IAAM,UAAU,IAAI;+DAAC,CAAC,QAAU,MAAM,SAAS,KAAK;iEAAyB;sDAC7E;QAAC;QAAW;KAAqB;IAGnC,MAAM,yBAAyB,IAAA,wKAAO;6DACpC,IACE,iBAAiB,MAAM;qEACrB,CAAC,KAAK;oBACJ,MAAM,aAAa,OAAO,QAAQ,CAAC,MAAM,UAAU,IAAI,MAAM,UAAU,GAAG;oBAC1E,MAAM,eAAe,wBAAwB,MAAM,WAAW;oBAC9D,MAAM,iBAAiB,wBAAwB,MAAM,aAAa;oBAClE,MAAM,YAAY,aAAa,eAAe;oBAC9C,IAAI,SAAS,IAAI;oBACjB,IAAI,WAAW,IAAI;oBACnB,IAAI,aAAa,IAAI;oBACrB,IAAI,QAAQ,IAAI;oBAChB,OAAO;gBACT;oEACA;gBAAE,WAAW;gBAAG,aAAa;gBAAG,eAAe;gBAAG,UAAU;YAAE;4DAElE;QAAC;KAAiB;IAGpB,MAAM,qBAAqB,IAAA,wKAAO;yDAChC,IACE,iBAAiB,MAAM;iEACrB,CAAC,KAAK;oBACJ,MAAM,SAAS,eAAe,OAAO;oBACrC,IAAI,KAAK,IAAI,OAAO,QAAQ,CAAC,UAAU,SAAS;oBAChD,IAAI,KAAK,IAAI;oBACb,OAAO;gBACT;gEACA;gBAAE,OAAO;gBAAG,OAAO;YAAE;wDAEzB;QAAC;KAAiB;IAGpB,MAAM,wBAAwB,eAAe,CAAC,oBAAoB;IAElE,MAAM,uBAAuB,IAAA,wKAAO;2DAAC;YACnC,IAAI,CAAC,kBAAkB,IAAI,IAAI,OAAO;YACtC,MAAM,YAAY,kBAAkB,IAAI,GAAG,WAAW;YACtD,OAAO,kBAAkB,MAAM;mEAC7B,CAAC,OACC,KAAK,QAAQ,CAAC,WAAW,GAAG,QAAQ,CAAC,cACrC,KAAK,QAAQ,CAAC,WAAW,GAAG,QAAQ,CAAC;;QAE3C;0DAAG;QAAC;QAAmB;KAAkB;IAEzC,IAAA,0KAAS;uCAAC;YACR,QAAQ,GAAG,CACT,kCACA,QACA,gBACA;YAEF,IAAI,aAAa;gBACf,gBAAgB;oBAAE,GAAG,WAAW;gBAAC;YACnC;YACA,IAAI,QAAQ;gBACV;gBACA;gBACA;gBACA;gBACA;YACF;QACF;sCAAG;QAAC;QAAa;KAAO;IAExB,IAAA,0KAAS;uCAAC;YACR,IAAI;gBACF,MAAM,aAAa,aAAa,OAAO,CAAC;gBACxC,IAAI,YAAY;oBACd,MAAM,SAAS,KAAK,KAAK,CAAC;oBAC1B,MAAM,OAAO,QAAQ,QAAQ,QAAQ,YAAY,QAAQ,SAAS;oBAClE,gBAAgB;gBAClB;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,sCAAsC;YACtD;QACF;sCAAG,EAAE;IACL,MAAM,oBAAoB,IAAA,4KAAW;4DAAC,CAAC,WAAmB;YACxD;oEAAgB,CAAC,UAAY,CAAC;wBAC5B,GAAG,OAAO;wBACV,CAAC,UAAU,EAAE;oBACf,CAAC;;QACH;2DAAG,EAAE;IAEL,MAAM,+BAA+B,IAAA,4KAAW;uEAAC,CAAC,WAAmB;YACnE;+EAAmB,CAAC,UAAY,CAAC;wBAC/B,GAAG,OAAO;wBACV,CAAC,UAAU,EAAE;oBACf,CAAC;;QACH;sEAAG,EAAE;IAEL,MAAM,uBAAuB,IAAA,4KAAW;+DAAC;YACvC,MAAM,QAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;YACpD,mBAAmB;gBACjB,GAAG,2BAA2B;gBAC9B,GAAG,sBAAsB,OAAO;gBAChC,eACE,sBAAsB,OAAO,CAAC,aAAa,IAAI;gBACjD,WAAW,sBAAsB,OAAO,CAAC,SAAS,IAAI;YACxD;YACA,0BAA0B;YAC1B,iCAAiC;YACjC,oBAAoB;QACtB;8DAAG,EAAE;IAEL,MAAM,2BAA2B,IAAA,4KAAW;mEAAC;YAC3C;QACF;kEAAG;QAAC;KAAqB;IAEzB,MAAM,0BAA0B,IAAA,4KAAW;kEAAC;YAC1C,IAAI,CAAC,eAAe;gBAClB,sBAAsB,EAAE;gBACxB,2BAA2B;gBAC3B;YACF;YACA,6BAA6B;YAC7B,2BAA2B;YAC3B,IAAI;gBACF,MAAM,WAAW,MAAM,MACrB,CAAC,yBAAyB,EAAE,mBAAmB,gBAAgB;gBAEjE,MAAM,SAAS,MAAM,SAAS,IAAI;gBAClC,IAAI,CAAC,SAAS,EAAE,IAAI,OAAO,OAAO,KAAK,OAAO;oBAC5C,MAAM,IAAI,MAAM,OAAO,KAAK,IAAI;gBAClC;gBACA,sBAAsB,MAAM,OAAO,CAAC,OAAO,IAAI,IAAI,OAAO,IAAI,GAAG,EAAE;YACrE,EAAE,OAAO,OAAY;gBACnB,sBAAsB,EAAE;gBACxB,2BACE,OAAO,WAAW;YAEtB,SAAU;gBACR,6BAA6B;YAC/B;QACF;iEAAG;QAAC;KAAc;IAElB,MAAM,iCAAiC,IAAA,4KAAW;yEAChD,CAAC,OAA+B;YAC9B,MAAM,aAAqC,CAAC;YAC5C,qBAAqB,OAAO;iFAAC,CAAC;oBAC5B,MAAM,WAAW,KAAK,CAAC,KAAK,GAAG,CAAC;oBAChC,UAAU,CAAC,KAAK,GAAG,CAAC,GAClB,aAAa,aAAa,aAAa,OAAO,KAAK,OAAO;gBAC9D;;YACA,IAAI,CAAC,WAAW,MAAM,EAAE;gBACtB,WAAW,MAAM,GAAG;YACtB;YACA,mBAAmB;gBACjB,GAAG,2BAA2B;gBAC9B,GAAG,UAAU;YACf;YACA,0BAA0B,MAAM,YAAY,GAAG,OAAO,MAAM,YAAY,IAAI;YAC5E,iCAAiC;YACjC,oBAAoB;QACtB;wEACA;QAAC;KAAc;IAGjB,IAAA,0KAAS;uCAAC;YACR,IAAI,CAAC,cAAc;YACnB,oBAAoB;YACpB,IACE,cAAc,MAAM,IACpB,cAAc,MAAM,IACpB,iBAAiB,MAAM,EACvB;gBACA;YACF;YACA,IAAI,YAAY;YAChB,sBAAsB;YACtB,8BACG,IAAI;+CAAC,CAAC;oBACL,IAAI,WAAW;oBACf,iBAAiB,KAAK,SAAS;oBAC/B,iBAAiB,KAAK,SAAS;oBAC/B,oBAAoB,KAAK,YAAY;gBACvC;8CACC,KAAK;+CAAC,CAAC;oBACN,IAAI,WAAW;oBACf,oBAAoB,OAAO,WAAW;gBACxC;8CACC,OAAO;+CAAC;oBACP,IAAI,WAAW;oBACf,sBAAsB;gBACxB;;YACF;+CAAO;oBACL,YAAY;gBACd;;QACF;sCAAG;QACD;QACA,cAAc,MAAM;QACpB,cAAc,MAAM;QACpB,iBAAiB,MAAM;KACxB;IAED,IAAA,0KAAS;uCAAC;YACR,MAAM,QAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;YACpD,sBAAsB,OAAO,GAAG;gBAC9B,QAAQ;gBACR,cAAc;gBACd,QAAQ,YAAY,CAAC,SAAS,IAAI;gBAClC,MAAM,YAAY,CAAC,OAAO,IAAI,YAAY,CAAC,OAAO,IAAI;gBACtD,SAAS,YAAY,CAAC,UAAU,IAAI;gBACpC,UAAU,YAAY,CAAC,WAAW,IAAI;gBACtC,aAAa,YAAY,CAAC,cAAc,IAAI,YAAY,CAAC,QAAQ,IAAI;gBACrE,OAAO,YAAY,CAAC,QAAQ,IAAI;gBAChC,UAAU,YAAY,CAAC,WAAW,IAAI;gBACtC,MAAM,YAAY,CAAC,OAAO,IAAI;gBAC9B,eACE,sBAAsB,OAAO,CAAC,aAAa,IAAI;gBACjD,WAAW,sBAAsB,OAAO,CAAC,SAAS,IAAI;YACxD;QACF;sCAAG;QAAC;QAAe;QAAqB;KAAa;IAErD,IAAA,0KAAS;uCAAC;YACR,IAAI,CAAC,sBAAsB;YAC3B;YACA;QACF;sCAAG;QAAC;QAAsB;QAAyB;KAAqB;IAExE,MAAM,gBAAgB,YAAY,CAAC,WAAW,IAAI;IAClD,MAAM,cAAc,YAAY,CAAC,SAAS,IAAI;IAC9C,MAAM,cAAc,YAAY,CAAC,SAAS,IAAI;IAE9C,IAAA,0KAAS;uCAAC;YACR,IAAI,CAAC,cAAc,MAAM,EAAE;gBACzB,sBAAsB;gBACtB;YACF;YACA,IAAI,CAAC,eAAe;gBAClB,sBAAsB;gBACtB;YACF;YACA,MAAM,QAAQ,cAAc,IAAI;qDAAC,CAAC,OAChC,0BAA0B,MAAM;;YAElC,sBAAsB,QAAQ,MAAM,EAAE,GAAG;QAC3C;sCAAG;QAAC;QAAe;KAAc;IAEjC,IAAA,0KAAS;uCAAC;YACR,IAAI,CAAC,cAAc,MAAM,EAAE;gBACzB,sBAAsB;gBACtB;YACF;YACA,IAAI,CAAC,oBAAoB;gBACvB,sBAAsB;gBACtB;YACF;YACA,IAAI,CAAC,aAAa;gBAChB,sBAAsB;gBACtB;YACF;YACA,MAAM,QAAQ,cAAc,IAAI;qDAC9B,CAAC,OACC,KAAK,WAAW,KAAK,sBACrB,0BAA0B,MAAM;;YAEpC,sBAAsB,QAAQ,MAAM,EAAE,GAAG;QAC3C;sCAAG;QAAC;QAAe;QAAoB;KAAY;IAEnD,IAAA,0KAAS;uCAAC;YACR,IAAI,CAAC,iBAAiB,MAAM,EAAE;gBAC5B,yBAAyB;gBACzB;YACF;YACA,IAAI,CAAC,oBAAoB;gBACvB,yBAAyB;gBACzB;YACF;YACA,IAAI,CAAC,aAAa;gBAChB,yBAAyB;gBACzB;YACF;YACA,MAAM,QAAQ,iBAAiB,IAAI;qDACjC,CAAC,OACC,KAAK,WAAW,KAAK,sBACrB,0BAA0B,MAAM;;YAEpC,yBAAyB,QAAQ,MAAM,EAAE,GAAG;QAC9C;sCAAG;QAAC;QAAkB;QAAoB;KAAY;IAEtD,IAAA,0KAAS;uCAAC;YACR,IAAI,gBAAgB,CAAC,YAAY,CAAC,UAAU,EAAE;gBAC5C,kBAAkB,WAAW;YAC/B;QACF;sCAAG;QAAC;QAAc,YAAY,CAAC,UAAU;QAAE;KAAkB;IAC7D,MAAM,kBAAkB,IAAA,wKAAO;sDAC7B,IACE,cAAc,GAAG;8DAAC,CAAC,WAAa,CAAC;wBAC/B,IAAI,SAAS,EAAE;wBACf,OAAO,GAAG,SAAS,OAAO,CAAC,EAAE,EAAE,SAAS,OAAO,CAAC,CAAC,CAAC;oBACpD,CAAC;;qDACH;QAAC;KAAc;IAEjB,MAAM,kBAAkB,IAAA,wKAAO;sDAAC;YAC9B,IAAI,CAAC,oBAAoB,OAAO,EAAE;YAClC,OAAO,cACJ,MAAM;8DAAC,CAAC,WAAa,SAAS,WAAW,KAAK;6DAC9C,GAAG;8DAAC,CAAC,WAAa,CAAC;wBAClB,IAAI,SAAS,EAAE;wBACf,OAAO,GAAG,SAAS,OAAO,CAAC,EAAE,EAAE,SAAS,OAAO,CAAC,CAAC,CAAC;oBACpD,CAAC;;QACL;qDAAG;QAAC;QAAe;KAAmB;IACtC,MAAM,qBAAqB,IAAA,wKAAO;yDAAC;YACjC,IAAI,CAAC,oBAAoB,OAAO,EAAE;YAClC,OAAO,iBACJ,MAAM;iEAAC,CAAC,cAAgB,YAAY,WAAW,KAAK;gEACpD,GAAG;iEAAC,CAAC,cAAgB,CAAC;wBACrB,IAAI,YAAY,EAAE;wBAClB,OAAO,GAAG,YAAY,OAAO,CAAC,EAAE,EAAE,YAAY,OAAO,CAAC,CAAC,CAAC;oBAC1D,CAAC;;QACL;wDAAG;QAAC;QAAkB;KAAmB;IAEzC,MAAM,uBAAuB,CAAC;QAC5B,IAAI,CAAC,iBAAiB;YACpB,sBAAsB;YACtB,sBAAsB;YACtB,yBAAyB;YACzB,kBAAkB,YAAY;YAC9B,kBAAkB,UAAU;YAC5B,kBAAkB,UAAU;YAC5B,kBAAkB,WAAW;YAC7B;QACF;QACA,MAAM,YAAY,OAAO;QACzB,IAAI,CAAC,OAAO,QAAQ,CAAC,YAAY;QACjC,MAAM,WAAW,cAAc,IAAI,CAAC,CAAC,OAAS,KAAK,EAAE,KAAK;QAC1D,sBAAsB;QACtB,sBAAsB;QACtB,yBAAyB;QACzB,kBAAkB,YAAY,UAAU,WAAW,UAAU,WAAW;QACxE,kBAAkB,UAAU;QAC5B,kBAAkB,UAAU;QAC5B,kBAAkB,WAAW;IAC/B;IAEA,MAAM,uBAAuB,CAAC;QAC5B,IAAI,CAAC,iBAAiB;YACpB,sBAAsB;YACtB,yBAAyB;YACzB,kBAAkB,UAAU;YAC5B,kBAAkB,UAAU;YAC5B,kBAAkB,WAAW;YAC7B;QACF;QACA,MAAM,YAAY,OAAO;QACzB,IAAI,CAAC,OAAO,QAAQ,CAAC,YAAY;QACjC,MAAM,WAAW,cAAc,IAAI,CAAC,CAAC,OAAS,KAAK,EAAE,KAAK;QAC1D,sBAAsB;QACtB,yBAAyB;QACzB,kBAAkB,UAAU,UAAU,WAAW,UAAU,WAAW;QACtE,kBAAkB,UAAU;QAC5B,kBAAkB,WAAW;IAC/B;IAEA,MAAM,0BAA0B,CAAC;QAC/B,IAAI,CAAC,oBAAoB;YACvB,yBAAyB;YACzB,kBAAkB,UAAU;YAC5B,kBAAkB,WAAW;YAC7B;QACF;QACA,MAAM,YAAY,OAAO;QACzB,IAAI,CAAC,OAAO,QAAQ,CAAC,YAAY;QACjC,MAAM,cAAc,iBAAiB,IAAI,CAAC,CAAC,OAAS,KAAK,EAAE,KAAK;QAChE,yBAAyB;QACzB,kBAAkB,UAAU,aAAa,WAAW,aAAa,WAAW;QAC5E,kBACE,WACA,aAAa,aAAa,QAAQ,aAAa,aAAa,YACxD,OAAO,YAAY,QAAQ,IAC3B;IAER;IACA,MAAM,aAAa,OAAO;QACxB,gCAAgC;QAChC,IAAI,WAAW;QAEf,aAAa;QACb,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,sBAAsB;gBACjD,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC;oBACnB,QAAQ;oBACR,MAAM;gBACR;YACF;YAEA,MAAM,SAAS,MAAM,SAAS,IAAI;YAElC,MAAM,cAAc,SAAS,cAAc;YAC3C,IAAI,OAAO,OAAO,EAAE;gBAClB,SAAS;gBACT,gBAAgB;oBACd,QAAQ;oBACR,MAAM;oBACN,OAAO;oBACP,SAAS;gBACX;gBAEA,8CAA8C;gBAC9C,WAAW;oBACT,gBAAgB,CAAC,OAAS,CAAC;4BAAE,GAAG,IAAI;4BAAE,QAAQ;wBAAM,CAAC;oBACrD,IAAI,aAAa;wBACf,WAAW;4BACT,OAAO;4BACP;wBACF,GAAG,MAAM,8BAA8B;oBACzC;gBACF,GAAG,OAAO,kCAAkC;YAC9C,OAAO;gBACL,gBAAgB;oBACd,QAAQ;oBACR,MAAM;oBACN,OAAO;oBACP,SACE,OAAO,KAAK,IACZ;gBACJ;gBACA,WAAW;oBACT,gBAAgB,CAAC,OAAS,CAAC;4BAAE,GAAG,IAAI;4BAAE,QAAQ;wBAAM,CAAC;gBACvD,GAAG;YACL;QACF,EAAE,OAAO,OAAO;YACd,gBAAgB;gBACd,QAAQ;gBACR,MAAM;gBACN,OAAO;gBACP,SACE;YACJ;YACA,WAAW;gBACT,gBAAgB,CAAC,OAAS,CAAC;wBAAE,GAAG,IAAI;wBAAE,QAAQ;oBAAM,CAAC;YACvD,GAAG;QACL,SAAU;YACR,aAAa;QACf;IACF;IAEA,MAAM,oBAAoB;QACxB,kBAAkB,UAAU;QAC5B,WAAW;YACT,WAAW;YACX,WAAW;gBACT,gBAAgB;YAClB;QACF;IACF;IAEA,MAAM,wBAAwB;QAC5B,IAAI,oBAAoB;QACxB,MAAM,gBAAgB,OAAO,OAAO,CAAC,iBAAiB,MAAM,CAC1D,CAAC,KAAK,CAAC,KAAK,MAAM;YAChB,MAAM,aAAa,OAAO,UAAU,WAAW,MAAM,IAAI,KAAK;YAC9D,IACE,eAAe,MACf,eAAe,QACf,eAAe,WACf;gBACA,GAAG,CAAC,IAAI,GAAG;YACb;YACA,OAAO;QACT,GACA,CAAC;QAGH,OAAO,cAAc,SAAS;QAC9B,MAAM,kBACJ,cAAc,MAAM,IAAI,iBAAiB,sBAAsB,OAAO,CAAC,MAAM;QAC/E,IAAI,iBAAiB;YACnB,cAAc,MAAM,GAAG;QACzB;QAEA,IAAI,CAAC,cAAc,MAAM,EAAE;YACzB,oBAAoB;YACpB;QACF;QAEA,sBAAsB;QACtB,oBAAoB;QACpB,IAAI;YACF,MAAM,YAAY,QAAQ;YAC1B,MAAM,WAAW,YACb,CAAC,kBAAkB,EAAE,mBAAmB,yBAA0B,GAClE;YACJ,MAAM,WAAW,MAAM,MAAM,UAAU;gBACrC,QAAQ,YAAY,QAAQ;gBAC5B,SAAS;oBACP,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC;oBAAE,MAAM;gBAAc;YAC7C;YACA,MAAM,SAAS,MAAM,SAAS,IAAI;YAClC,IAAI,CAAC,SAAS,EAAE,IAAI,OAAO,OAAO,KAAK,OAAO;gBAC5C,MAAM,IAAI,MAAM,OAAO,KAAK,IAAI;YAClC;YAEA,gBAAgB;gBACd,QAAQ;gBACR,MAAM;gBACN,OAAO,YAAY,mBAAmB;gBACtC,SAAS,YACL,sDACA;YACN;YACA;YACA;QACF,EAAE,OAAO,OAAY;YACnB,oBAAoB,OAAO,WAAW;QACxC,SAAU;YACR,sBAAsB;QACxB;IACF;IAEA,QAAQ,GAAG,CAAC,yCAAyC;IAErD,IAAI,CAAC,QAAQ,OAAO;IAEpB,2CAA2C;IAC3C,MAAM,qBAAqB,CAAC;QAC1B,IAAI,CAAC,WAAW,OAAO;QACvB,MAAM,OAAO,IAAI,KAAK;QACtB,IAAI,MAAM,KAAK,OAAO,KAAK,OAAO;QAClC,OAAO,KAAK,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;IACzC;IAEA,sCAAsC;IACtC,MAAM,qBAAqB,CAAC;QAC1B,IAAI,CAAC,WAAW,OAAO;QACvB,IAAI,OAAO,cAAc,YAAY,UAAU,KAAK,CAAC,iBAAiB;YACpE,OAAO,UAAU,SAAS,CAAC,GAAG;QAChC;QACA,OAAO;IACT;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCAEb,6LAAC;wBAAI,WAAU;;0CAEb,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC;oCACC,SAAS;oCACT,WAAU;8CAEV,cAAA,6LAAC,oMAAC;wCAAC,WAAU;;;;;;;;;;;;;;;;0CAKjB,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCACC,SAAS,IAAM,aAAa;wCAC5B,WAAW,CAAC,wFAAwF,EAAE,cAAc,YAAY,6BAA6B,gCAC1J,+EAA+E,CAAC;wCACnF,OAAM;;0DAEN,6LAAC,6MAAI;gDAAC,WAAU;;;;;;0DAChB,6LAAC;gDAAK,WAAU;0DAAiD;;;;;;;;;;;;kDAEnE,6LAAC;wCACC,SAAS,IAAM,aAAa;wCAC5B,WAAW,CAAC,wFAAwF,EAAE,cAAc,QAAQ,6BAA6B,gCACtJ,+EAA+E,CAAC;wCACnF,OAAM;;0DAEN,6LAAC,6NAAQ;gDAAC,WAAU;;;;;;0DACpB,6LAAC;gDAAK,WAAU;0DAAiD;;;;;;;;;;;;kDAEnE,6LAAC;wCACC,SAAS,IAAM,aAAa;wCAC5B,WAAW,CAAC,wFAAwF,EAAE,cAAc,YAAY,6BAA6B,gCAC1J,+EAA+E,CAAC;wCACnF,OAAM;;0DAEN,6LAAC,+OAAc;gDAAC,WAAU;;;;;;0DAC1B,6LAAC;gDAAK,WAAU;0DAAiD;;;;;;;;;;;;kDAEnE,6LAAC;wCACC,SAAS;4CACP,aAAa;4CACb;wCACF;wCACA,WAAW,CAAC,wFAAwF,EAAE,cAAc,YAAY,6BAA6B,gCAC1J,wFAAwF,CAAC;wCAC5F,OAAM;;0DAEN,6LAAC,4NAAS;gDAAC,WAAU;;;;;;0DACrB,6LAAC;gDAAK,WAAU;0DAAiD;;;;;;4CAChE,iBAAiB,MAAM,GAAG,mBACzB,6LAAC;gDAAK,WAAU;0DACb,iBAAiB,MAAM;;;;;;;;;;;;kDAI9B,6LAAC;wCACC,SAAS,IAAM,aAAa;wCAC5B,WAAW,CAAC,wFAAwF,EAAE,cAAc,gBAAgB,6BAA6B,gCAC9J,+EAA+E,CAAC;wCACnF,OAAM;;0DAEN,6LAAC,yNAAQ;gDAAC,WAAU;;;;;;0DACpB,6LAAC;gDAAK,WAAU;0DAAiD;;;;;;;;;;;;;;;;;;;;;;;;kCAMvE,6LAAC;wBACC,WAAU;wBACV,OAAO;4BAAE,WAAW;wBAAqB;;4BAGxC,cAAc,2BACb,6LAAC;gCAAI,WAAU;;kDAEb,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;;;;;;kEACf,6LAAC;wDAAG,WAAU;kEAA6F;;;;;;;;;;;;0DAI7G,6LAAC;gDAAI,WAAU;;kEAEb,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,OAAO,YAAY,CAAC,SAAS,IAAI,YAAY,CAAC,QAAQ,IAAI;gEAC1D,UAAU,CAAC,IAAM,kBAAkB,UAAU,EAAE,MAAM,CAAC,KAAK;gEAC3D,WAAU;;kFAEV,6LAAC;wEAAO,OAAM;kFAAG;;;;;;oEAChB,cAAc,GAAG,CAAC,CAAC,uBAClB,6LAAC;4EAA0B,OAAO,OAAO,KAAK;sFAAG,OAAO,KAAK;2EAAhD,OAAO,KAAK;;;;;;;;;;;;;;;;;kEAK/B,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,OAAO,YAAY,CAAC,SAAS,IAAI;gEACjC,UAAU,CAAC,IAAM,kBAAkB,UAAU,EAAE,MAAM,CAAC,KAAK;gEAC3D,WAAU;;kFAEV,6LAAC;wEAAO,OAAM;kFAAG;;;;;;kFACjB,6LAAC;wEAAO,OAAM;kFAAM;;;;;;kFACpB,6LAAC;wEAAO,OAAM;kFAAM;;;;;;kFACpB,6LAAC;wEAAO,OAAM;kFAAS;;;;;;kFACvB,6LAAC;wEAAO,OAAM;kFAAM;;;;;;kFACpB,6LAAC;wEAAO,OAAM;kFAAO;;;;;;kFACrB,6LAAC;wEAAO,OAAM;kFAAM;;;;;;;;;;;;;;;;;;kEAIxB,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,MAAK;gEACL,OAAO,YAAY,CAAC,OAAO,IAAI,YAAY,CAAC,OAAO,IAAI;gEACvD,UAAU,CAAC,IAAM,kBAAkB,QAAQ,EAAE,MAAM,CAAC,KAAK;gEACzD,WAAU;gEACV,aAAY;;;;;;;;;;;;kEAIhB,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,MAAK;gEACL,OAAO,YAAY,CAAC,UAAU,IAAI;gEAClC,UAAU,CAAC,IAAM,kBAAkB,WAAW,EAAE,MAAM,CAAC,KAAK;gEAC5D,WAAU;gEACV,aAAY;;;;;;;;;;;;kEAIhB,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,MAAK;gEACL,OAAO,YAAY,CAAC,WAAW,IAAI;gEACnC,UAAU,CAAC,IAAM,kBAAkB,YAAY,EAAE,MAAM,CAAC,KAAK;gEAC7D,WAAU;gEACV,aAAY;;;;;;;;;;;;kEAIhB,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,OAAO,YAAY,CAAC,SAAS,IAAI;gEACjC,UAAU,CAAC,IAAM,kBAAkB,UAAU,EAAE,MAAM,CAAC,KAAK;gEAC3D,WAAU;;kFAEV,6LAAC;wEAAO,OAAM;kFAAG;;;;;;kFACjB,6LAAC;wEAAO,OAAM;kFAAM;;;;;;kFACpB,6LAAC;wEAAO,OAAM;kFAAO;;;;;;kFACrB,6LAAC;wEAAO,OAAM;kFAAQ;;;;;;;;;;;;;;;;;;kEAI1B,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,MAAK;gEACL,SAAS,IAAM,kBAAkB,aAAa,YAAY,CAAC,YAAY,KAAK,WAAW,KAAK;gEAC5F,WAAU;;kFAEV,6LAAC,6MAAI;wEAAC,WAAW,CAAC,QAAQ,EAAE,YAAY,CAAC,YAAY,KAAK,WAAW,oCAAoC,iBAAiB;;;;;;kFAC1H,6LAAC;wEAAK,WAAU;kFACb,YAAY,CAAC,YAAY,KAAK,WAAW,eAAe;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kDAQnE,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;;;;;;kEACf,6LAAC;wDAAG,WAAU;kEAAiG;;;;;;;;;;;;0DAIjH,6LAAC;gDAAI,WAAU;;kEAEb,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,MAAK;gEACL,OAAO,YAAY,CAAC,QAAQ,IAAI,YAAY,CAAC,WAAW,IAAI;gEAC5D,UAAU,CAAC,IAAM,kBAAkB,SAAS,EAAE,MAAM,CAAC,KAAK;gEAC1D,WAAU;gEACV,aAAY;;;;;;;;;;;;kEAIhB,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,MAAK;gEACL,OAAO,YAAY,CAAC,QAAQ,IAAI;gEAChC,UAAU,CAAC,IAAM,kBAAkB,SAAS,EAAE,MAAM,CAAC,KAAK;gEAC1D,WAAU;gEACV,aAAY;;;;;;;;;;;;kEAIhB,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,MAAK;gEACL,OAAO,YAAY,CAAC,SAAS,IAAI;gEACjC,UAAU,CAAC,IAAM,kBAAkB,UAAU,EAAE,MAAM,CAAC,KAAK;gEAC3D,WAAU;gEACV,aAAY;;;;;;;;;;;;kEAIhB,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,MAAK;gEACL,OAAO,YAAY,CAAC,WAAW,IAAI;gEACnC,UAAU,CAAC,IAAM,kBAAkB,YAAY,EAAE,MAAM,CAAC,KAAK;gEAC7D,WAAU;gEACV,aAAY;;;;;;;;;;;;kEAIhB,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,OAAO,YAAY,CAAC,UAAU,IAAI,YAAY,CAAC,SAAS,IAAI;gEAC5D,UAAU,CAAC,IAAM,kBAAkB,WAAW,EAAE,MAAM,CAAC,KAAK;gEAC5D,WAAU;;kFAEV,6LAAC;wEAAO,OAAM;kFAAG;;;;;;oEAChB,eAAe,GAAG,CAAC,CAAC,uBACnB,6LAAC;4EAA0B,OAAO,OAAO,KAAK;sFAAG,OAAO,KAAK;2EAAhD,OAAO,KAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kDAQnC,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;;;;;;kEACf,6LAAC;wDAAG,WAAU;kEAAgG;;;;;;;;;;;;0DAIhH,6LAAC;gDAAI,WAAU;;kEAEb,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,OAAO,YAAY,CAAC,SAAS,IAAI,YAAY,CAAC,eAAe,IAAI;gEACjE,UAAU,CAAC,IAAM,kBAAkB,UAAU,EAAE,MAAM,CAAC,KAAK;gEAC3D,WAAU;;kFAEV,6LAAC;wEAAO,OAAM;kFAAG;;;;;;oEAChB,cAAc,GAAG,CAAC,CAAC,uBAClB,6LAAC;4EAA0B,OAAO,OAAO,KAAK;sFAAG,OAAO,KAAK;2EAAhD,OAAO,KAAK;;;;;;;;;;;;;;;;;kEAK/B,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,OAAO,YAAY,CAAC,qBAAqB,IAAI,YAAY,CAAC,oBAAoB,IAAI;gEAClF,UAAU,CAAC,IAAM,kBAAkB,sBAAsB,EAAE,MAAM,CAAC,KAAK;gEACvE,WAAU;;kFAEV,6LAAC;wEAAO,OAAM;kFAAG;;;;;;oEAChB,eAAe,GAAG,CAAC,CAAC,uBACnB,6LAAC;4EAA0B,OAAO,OAAO,KAAK;sFAAG,OAAO,KAAK;2EAAhD,OAAO,KAAK;;;;;;;;;;;;;;;;;kEAK/B,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,OAAO,YAAY,CAAC,gBAAgB,IAAI,YAAY,CAAC,YAAY,IAAI;gEACrE,UAAU,CAAC,IAAM,kBAAkB,iBAAiB,EAAE,MAAM,CAAC,KAAK;gEAClE,WAAU;;kFAEV,6LAAC;wEAAO,OAAM;kFAAG;;;;;;oEAChB,qBAAqB,GAAG,CAAC,CAAC,uBACzB,6LAAC;4EAA0B,OAAO,OAAO,KAAK;sFAAG,OAAO,KAAK;2EAAhD,OAAO,KAAK;;;;;;;;;;;;;;;;;kEAK/B,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,MAAK;gEACL,OAAO,YAAY,CAAC,kBAAkB,IAAI,YAAY,CAAC,YAAY,IAAI;gEACvE,UAAU,CAAC,IAAM,kBAAkB,mBAAmB,EAAE,MAAM,CAAC,KAAK;gEACpE,WAAU;gEACV,aAAY;;;;;;;;;;;;;;;;;;;;;;;;kDAOpB,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;;;;;;kEACf,6LAAC;wDAAG,WAAU;kEAA6F;;;;;;;;;;;;0DAI7G,6LAAC;gDAAI,WAAU;;kEAEb,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;;kFACf,6LAAC;kFAAK;;;;;;oEAAS;;;;;;;0EAEjB,6LAAC;gEACC,MAAK;gEACL,OAAO,mBAAmB,YAAY,CAAC,mBAAmB,IAAI,YAAY,CAAC,uBAAuB;gEAClG,UAAU,CAAC,IAAM,kBAAkB,oBAAoB,EAAE,MAAM,CAAC,KAAK;gEACrE,WAAU;;;;;;;;;;;;kEAId,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;;kFACf,6LAAC;kFAAK;;;;;;oEAAS;;;;;;;0EAEjB,6LAAC;gEACC,MAAK;gEACL,OAAO,mBAAmB,YAAY,CAAC,gBAAgB,IAAI,YAAY,CAAC,0BAA0B;gEAClG,UAAU,CAAC,IAAM,kBAAkB,iBAAiB,EAAE,MAAM,CAAC,KAAK;gEAClE,WAAU;;;;;;;;;;;;kEAId,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;;kFACf,6LAAC;kFAAK;;;;;;oEAAS;;;;;;;0EAEjB,6LAAC;gEACC,MAAK;gEACL,OAAO,mBAAmB,YAAY,CAAC,gBAAgB,IAAI,YAAY,CAAC,yBAAyB;gEACjG,UAAU,CAAC,IAAM,kBAAkB,iBAAiB,EAAE,MAAM,CAAC,KAAK;gEAClE,WAAU;;;;;;;;;;;;;;;;;;;;;;;;kDAOlB,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;;;;;;kEACf,6LAAC;wDAAG,WAAU;kEAAiG;;;;;;;;;;;;0DAIjH,6LAAC;gDAAI,WAAU;;kEAEb,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;;kFACf,6LAAC;kFAAK;;;;;;oEAAS;;;;;;;0EAEjB,6LAAC;gEACC,MAAK;gEACL,OAAO,mBAAmB,YAAY,CAAC,sBAAsB,IAAI,YAAY,CAAC,uBAAuB;gEACrG,UAAU,CAAC,IAAM,kBAAkB,uBAAuB,EAAE,MAAM,CAAC,KAAK;gEACxE,WAAU;;;;;;;;;;;;kEAId,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;;kFACf,6LAAC;kFAAK;;;;;;oEAAS;;;;;;;0EAEjB,6LAAC;gEACC,MAAK;gEACL,OAAO,mBAAmB,YAAY,CAAC,eAAe,IAAI,YAAY,CAAC,mBAAmB;gEAC1F,UAAU,CAAC,IAAM,kBAAkB,gBAAgB,EAAE,MAAM,CAAC,KAAK;gEACjE,WAAU;;;;;;;;;;;;;;;;;;;;;;;;kDAOlB,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;;;;;;kEACf,6LAAC;wDAAG,WAAU;kEAA6F;;;;;;;;;;;;0DAI7G,6LAAC;gDAAI,WAAU;;kEAEb,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;;kFACf,6LAAC;kFAAK;;;;;;oEAAS;;;;;;;0EAEjB,6LAAC;gEACC,MAAK;gEACL,OAAO,mBAAmB,YAAY,CAAC,sBAAsB,IAAI,YAAY,CAAC,qBAAqB;gEACnG,UAAU,CAAC,IAAM,kBAAkB,uBAAuB,EAAE,MAAM,CAAC,KAAK;gEACxE,WAAU;;;;;;;;;;;;kEAId,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;;kFACf,6LAAC;kFAAK;;;;;;oEAAS;;;;;;;0EAEjB,6LAAC;gEACC,MAAK;gEACL,OAAO,mBAAmB,YAAY,CAAC,eAAe,IAAI,YAAY,CAAC,eAAe;gEACtF,UAAU,CAAC,IAAM,kBAAkB,gBAAgB,EAAE,MAAM,CAAC,KAAK;gEACjE,WAAU;;;;;;;;;;;;kEAId,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;;kFACf,6LAAC;kFAAK;;;;;;oEAAQ;;;;;;;0EAEhB,6LAAC;gEACC,MAAK;gEACL,OAAO,mBAAmB,YAAY,CAAC,mBAAmB,IAAI,YAAY,CAAC,aAAa;gEACxF,UAAU,CAAC,IAAM,kBAAkB,oBAAoB,EAAE,MAAM,CAAC,KAAK;gEACrE,WAAU;;;;;;;;;;;;;;;;;;;;;;;;kDAOlB,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;;;;;;kEACf,6LAAC;wDAAG,WAAU;kEAAgG;;;;;;;;;;;;0DAIhH,6LAAC;gDACC,OAAO,YAAY,CAAC,OAAO,IAAI,YAAY,CAAC,WAAW,IAAI;gDAC3D,UAAU,CAAC,IAAM,kBAAkB,QAAQ,EAAE,MAAM,CAAC,KAAK;gDACzD,WAAU;gDACV,aAAY;;;;;;;;;;;;;;;;;;4BAOnB,cAAc,uBACb,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDAAI,WAAU;;;;;;8DACf,6LAAC;oDAAG,WAAU;8DAA+F;;;;;;;;;;;;wCAI9G,oCACC,6LAAC;4CAAE,WAAU;sDAAgC;;;;;;wCAE9C,kCACC,6LAAC;4CAAE,WAAU;sDAA6B;;;;;;sDAE5C,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAM,WAAU;sEAAiD;;;;;;sEAClE,6LAAC;4DACC,MAAK;4DACL,OAAO,YAAY,CAAC,QAAQ,IAAI;4DAChC,UAAU,CAAC,IAAM,kBAAkB,SAAS,EAAE,MAAM,CAAC,KAAK;4DAC1D,WAAU;4DACV,aAAY;;;;;;;;;;;;8DAGhB,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAI,WAAU;;8EACb,6LAAC;oEAAM,WAAU;8EAAiD;;;;;;8EAClE,6LAAC;oEACC,OAAO,qBAAqB,OAAO,sBAAsB;oEACzD,UAAU,CAAC,IAAM,qBAAqB,EAAE,MAAM,CAAC,KAAK;oEACpD,WAAU;;sFAEV,6LAAC;4EAAO,OAAM;sFAAG;;;;;;wEAChB,gBAAgB,GAAG,CAAC,CAAC,uBACpB,6LAAC;gFAAuB,OAAO,OAAO,EAAE;0FAAG,OAAO,KAAK;+EAA1C,OAAO,EAAE;;;;;;;;;;;;;;;;;sEAI5B,6LAAC;4DAAI,WAAU;;8EACb,6LAAC;oEAAM,WAAU;8EAAiD;;;;;;8EAClE,6LAAC;oEACC,OAAO,qBAAqB,OAAO,sBAAsB;oEACzD,UAAU,CAAC,IAAM,qBAAqB,EAAE,MAAM,CAAC,KAAK;oEACpD,UAAU,CAAC,gBAAgB,MAAM;oEACjC,WAAU;;sFAEV,6LAAC;4EAAO,OAAM;sFAAG;;;;;;wEAChB,gBAAgB,GAAG,CAAC,CAAC,uBACpB,6LAAC;gFAAuB,OAAO,OAAO,EAAE;0FAAG,OAAO,KAAK;+EAA1C,OAAO,EAAE;;;;;;;;;;;;;;;;;sEAI5B,6LAAC;4DAAI,WAAU;;8EACb,6LAAC;oEAAM,WAAU;8EAAiD;;;;;;8EAClE,6LAAC;oEACC,OAAO,wBAAwB,OAAO,yBAAyB;oEAC/D,UAAU,CAAC,IAAM,wBAAwB,EAAE,MAAM,CAAC,KAAK;oEACvD,UAAU,CAAC,mBAAmB,MAAM;oEACpC,WAAU;;sFAEV,6LAAC;4EAAO,OAAM;sFAAG;;;;;;wEAChB,mBAAmB,GAAG,CAAC,CAAC,uBACvB,6LAAC;gFAAuB,OAAO,OAAO,EAAE;0FAAG,OAAO,KAAK;+EAA1C,OAAO,EAAE;;;;;;;;;;;;;;;;;sEAI5B,6LAAC;4DAAI,WAAU;;8EACb,6LAAC;oEAAM,WAAU;8EAAiD;;;;;;8EAClE,6LAAC;oEACC,MAAK;oEACL,OAAO,YAAY,CAAC,UAAU,IAAI;oEAClC,QAAQ;oEACR,WAAU;oEACV,aAAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;4BAUzB,cAAc,2BACb,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDAAI,WAAU;;;;;;8DACf,6LAAC;oDAAG,WAAU;8DAAgG;;;;;;;;;;;;sDAKhH,6LAAC;4CAAI,WAAU;sDACZ,gBAAgB,GAAG,CAAC,CAAC,qBACpB,6LAAC;oDAEC,SAAS,IAAM,uBAAuB,KAAK,GAAG;oDAC9C,WAAW,CAAC,gDAAgD,EAAE,wBAAwB,KAAK,GAAG,GAC1F,wCACA,2EACA;8DAEH,KAAK,KAAK;mDAPN,KAAK,GAAG;;;;;;;;;;wCAWlB,+BACC,6LAAC;4CAAI,WAAU;sDACb,cAAA,6LAAC,+NAAO;gDAAC,WAAU;;;;;;;;;;qGAGrB,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAI,WAAU;;8EACb,6LAAC;oEAAM,WAAU;8EAAiD;;;;;;8EAClE,6LAAC;oEACC,MAAK;oEACL,OAAO,eAAe,CAAC,oBAAoB,EAAE,UAAU;oEACvD,UAAU,CAAC,IAAM,mBAAmB,CAAC,OAAS,CAAC;gFAC7C,GAAG,IAAI;gFACP,CAAC,oBAAoB,EAAE;oFAAE,GAAG,IAAI,CAAC,oBAAoB;oFAAE,QAAQ,EAAE,MAAM,CAAC,KAAK;gFAAC;4EAChF,CAAC;oEACD,WAAU;oEACV,aAAY;;;;;;;;;;;;sEAGhB,6LAAC;4DAAI,WAAU;;8EACb,6LAAC;oEAAM,WAAU;8EAAiD;;;;;;8EAClE,6LAAC;oEACC,MAAK;oEACL,OAAO,eAAe,CAAC,oBAAoB,EAAE,UAAU;oEACvD,UAAU,CAAC,IAAM,mBAAmB,CAAC,OAAS,CAAC;gFAC7C,GAAG,IAAI;gFACP,CAAC,oBAAoB,EAAE;oFAAE,GAAG,IAAI,CAAC,oBAAoB;oFAAE,QAAQ,EAAE,MAAM,CAAC,KAAK;gFAAC;4EAChF,CAAC;oEACD,WAAU;oEACV,aAAY;;;;;;;;;;;;;;;;;;8DAIlB,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAM,WAAU;;8EACf,6LAAC;oEACC,MAAK;oEACL,SAAS,eAAe,CAAC,oBAAoB,EAAE,cAAc;oEAC7D,UAAU,CAAC,IAAM,mBAAmB,CAAC,OAAS,CAAC;gFAC7C,GAAG,IAAI;gFACP,CAAC,oBAAoB,EAAE;oFAAE,GAAG,IAAI,CAAC,oBAAoB;oFAAE,YAAY,EAAE,MAAM,CAAC,OAAO;gFAAC;4EACtF,CAAC;oEACD,WAAU;;;;;;gEACV;;;;;;;wDAGH,eAAe,CAAC,oBAAoB,EAAE,4BACrC,6LAAC;4DACC,MAAK;4DACL,OAAO,eAAe,CAAC,oBAAoB,EAAE,wBAAwB;4DACrE,UAAU,CAAC,IAAM,mBAAmB,CAAC,OAAS,CAAC;wEAC7C,GAAG,IAAI;wEACP,CAAC,oBAAoB,EAAE;4EAAE,GAAG,IAAI,CAAC,oBAAoB;4EAAE,sBAAsB,EAAE,MAAM,CAAC,KAAK;wEAAC;oEAC9F,CAAC;4DACD,WAAU;4DACV,aAAY;;;;;;;;;;;;8DAIlB,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAM,WAAU;;8EACf,6LAAC;oEACC,MAAK;oEACL,SAAS,eAAe,CAAC,oBAAoB,EAAE,kBAAkB;oEACjE,UAAU,CAAC,IAAM,mBAAmB,CAAC,OAAS,CAAC;gFAC7C,GAAG,IAAI;gFACP,CAAC,oBAAoB,EAAE;oFAAE,GAAG,IAAI,CAAC,oBAAoB;oFAAE,gBAAgB,EAAE,MAAM,CAAC,OAAO;gFAAC;4EAC1F,CAAC;oEACD,WAAU;;;;;;gEACV;;;;;;;wDAGH,eAAe,CAAC,oBAAoB,EAAE,gCACrC,6LAAC;4DACC,MAAK;4DACL,OAAO,eAAe,CAAC,oBAAoB,EAAE,qBAAqB;4DAClE,UAAU,CAAC,IAAM,mBAAmB,CAAC,OAAS,CAAC;wEAC7C,GAAG,IAAI;wEACP,CAAC,oBAAoB,EAAE;4EAAE,GAAG,IAAI,CAAC,oBAAoB;4EAAE,mBAAmB,EAAE,MAAM,CAAC,KAAK;wEAAC;oEAC3F,CAAC;4DACD,WAAU;4DACV,aAAY;;;;;;;;;;;;8DAIlB,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAM,WAAU;sEAAiD;;;;;;sEAClE,6LAAC;4DACC,OAAO,eAAe,CAAC,oBAAoB,EAAE,kBAAkB;4DAC/D,UAAU,CAAC,IAAM,mBAAmB,CAAC,OAAS,CAAC;wEAC7C,GAAG,IAAI;wEACP,CAAC,oBAAoB,EAAE;4EAAE,GAAG,IAAI,CAAC,oBAAoB;4EAAE,gBAAgB,EAAE,MAAM,CAAC,KAAK;wEAAC;oEACxF,CAAC;4DACD,WAAU;;8EAEV,6LAAC;oEAAO,OAAM;8EAAG;;;;;;gEAChB,sBAAsB,GAAG,CAAC,CAAC,oBAC1B,6LAAC;wEAAiB,OAAO;kFAAM;uEAAlB;;;;;;;;;;;;;;;;;8DAInB,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAM,WAAU;sEAAiD;;;;;;sEAClE,6LAAC;4DACC,OAAO,eAAe,CAAC,oBAAoB,EAAE,cAAc;4DAC3D,UAAU,CAAC,IAAM,mBAAmB,CAAC,OAAS,CAAC;wEAC7C,GAAG,IAAI;wEACP,CAAC,oBAAoB,EAAE;4EAAE,GAAG,IAAI,CAAC,oBAAoB;4EAAE,YAAY,EAAE,MAAM,CAAC,KAAK;wEAAC;oEACpF,CAAC;4DACD,WAAU;;8EAEV,6LAAC;oEAAO,OAAM;8EAAG;;;;;;gEAChB,cAAc,GAAG,CAAC,CAAC,oBAClB,6LAAC;wEAAiB,OAAO;kFAAM;uEAAlB;;;;;;;;;;;;;;;;;8DAInB,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAM,WAAU;sEAAiD;;;;;;sEAClE,6LAAC;4DACC,OAAO,eAAe,CAAC,oBAAoB,EAAE,eAAe;4DAC5D,UAAU,CAAC,IAAM,mBAAmB,CAAC,OAAS,CAAC;wEAC7C,GAAG,IAAI;wEACP,CAAC,oBAAoB,EAAE;4EAAE,GAAG,IAAI,CAAC,oBAAoB;4EAAE,aAAa,EAAE,MAAM,CAAC,KAAK;wEAAC;oEACrF,CAAC;4DACD,WAAU;;8EAEV,6LAAC;oEAAO,OAAM;8EAAG;;;;;;gEAChB,cAAc,GAAG,CAAC,CAAC,oBAClB,6LAAC;wEAAiB,OAAO;kFAAM;uEAAlB;;;;;;;;;;;;;;;;;8DAKnB,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAM,WAAU;sEAAiD;;;;;;sEAClE,6LAAC;4DACC,OAAO,eAAe,CAAC,oBAAoB,EAAE,gBAAgB;4DAC7D,UAAU,CAAC,MAAQ,mBAAmB,CAAC,OAAS,CAAC;wEAC/C,GAAG,IAAI;wEACP,CAAC,oBAAoB,EAAE;4EAAE,GAAG,IAAI,CAAC,oBAAoB;4EAAE,cAAc;wEAAI;oEAC3E,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;4BAUd,cAAc,2BACb,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDAAI,WAAU;;;;;;8DACf,6LAAC;oDAAG,WAAU;8DAA+F;;;;;;;;;;;;sDAK/G,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAM,WAAU;sEAAiD;;;;;;sEAClE,6LAAC;4DACC,OAAO;4DACP,UAAU,CAAC,IAAM,wBAAwB,EAAE,MAAM,CAAC,KAAK;4DACvD,UAAU;4DACV,WAAU;;8EAEV,6LAAC;oEAAO,OAAM;8EAAG;;;;;;gEAChB,UAAU,GAAG,CAAC,CAAC,sBACd,6LAAC;wEAA6B,OAAO,MAAM,SAAS;kFAAG,MAAM,SAAS;uEAAzD,MAAM,SAAS;;;;;;;;;;;;;;;;;gDAKjC,sCACC,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAM,WAAU;sEAAiD;;;;;;sEAClE,6LAAC;4DACC,MAAK;4DACL,OAAO;4DACP,UAAU,CAAC,IAAM,qBAAqB,EAAE,MAAM,CAAC,KAAK;4DACpD,WAAU;4DACV,aAAY;;;;;;;;;;;;gDAKjB,iBAAiB,MAAM,GAAG,mBACzB,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAG,WAAU;;gEAAqC;gEAAiB,iBAAiB,MAAM;gEAAC;;;;;;;sEAC5F,6LAAC;4DAAI,WAAU;sEACZ,iBAAiB,GAAG,CAAC,CAAC,oBACrB,6LAAC;oEAAiB,WAAU;;sFAC1B,6LAAC;4EAAK,WAAU;sFAAyB,IAAI,QAAQ;;;;;;sFACrD,6LAAC;4EAAK,WAAU;;gFACb,sBAAsB,2BAA2B;gFAAM;;;;;;;;mEAHlD,IAAI,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;4BAgB/B,cAAc,+BACb,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDAAI,WAAU;;;;;;8DACf,6LAAC;oDAAG,WAAU;8DAAgG;;;;;;;;;;;;wCAI/G,mCACC,6LAAC;4CAAI,WAAU;sDACb,cAAA,6LAAC,+NAAO;gDAAC,WAAU;;;;;;;;;;qGAGrB,6LAAC;4CAAI,WAAU;;gDACZ,oBAAoB,GAAG,CAAC,CAAC,SAAS,oBACjC,6LAAC;wDAAc,WAAU;;0EACvB,6LAAC;gEAAG,WAAU;0EAA+B,QAAQ,KAAK;;;;;;0EAC1D,6LAAC;gEAAI,WAAW,CAAC,KAAK,EAAE,QAAQ,OAAO,IAAI,6BAA6B,MAAM,CAAC;0EAC5E,QAAQ,MAAM,CAAC,GAAG,CAAC,CAAC;oEACnB,MAAM,YAAY,uBAAuB,CAAC,SAAS;oEACnD,IAAI,CAAC,WAAW,OAAO;oEACvB,qBACE,6LAAC;wEAAmB,WAAW,UAAU,SAAS,GAAG,kBAAkB;;0FACrE,6LAAC;gFAAM,WAAU;0FAAkD,UAAU,KAAK;;;;;;4EACjF,UAAU,IAAI,KAAK,2BAClB,6LAAC;gFACC,OAAO,eAAe,CAAC,SAAS,IAAI;gFACpC,UAAU,CAAC,IAAM,mBAAmB,CAAC,OAAS,CAAC;4FAAE,GAAG,IAAI;4FAAE,CAAC,SAAS,EAAE,EAAE,MAAM,CAAC,KAAK;wFAAC,CAAC;gFACtF,UAAU,UAAU,QAAQ;gFAC5B,WAAU;gFACV,aAAa,UAAU,WAAW;;;;;yIAGpC,6LAAC;gFACC,MAAM,UAAU,IAAI,IAAI;gFACxB,OAAO,eAAe,CAAC,SAAS,IAAI;gFACpC,UAAU,CAAC,IAAM,mBAAmB,CAAC,OAAS,CAAC;4FAAE,GAAG,IAAI;4FAAE,CAAC,SAAS,EAAE,EAAE,MAAM,CAAC,KAAK;wFAAC,CAAC;gFACtF,UAAU,UAAU,QAAQ;gFAC5B,WAAW,CAAC,4CAA4C,EAAE,UAAU,QAAQ,GAAG,gBAAgB,WAAW,oFAAoF,CAAC;gFAC/L,aAAa,UAAU,WAAW;;;;;;;uEAjB9B;;;;;gEAsBd;;;;;;;uDA7BM;;;;;gDAkCX,mBAAmB,MAAM,GAAG,mBAC3B,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAG,WAAU;sEAAmC;;;;;;sEACjD,6LAAC;4DAAI,WAAU;sEACZ,mBAAmB,GAAG,CAAC,CAAC,MAAM,oBAC7B,6LAAC;oEAEC,WAAU;oEACV,SAAS;wEACP,MAAM,MAAM,6BAA6B,MAAM;wEAC/C,iCAAiC,kCAAkC,MAAM,OAAO;oEAClF;8EAEA,cAAA,6LAAC;wEAAI,WAAU;;0FACb,6LAAC;gFAAK,WAAU;0FAAqC,KAAK,QAAQ,IAAI;;;;;;0FACtE,6LAAC;gFAAK,WAAU;0FAAyB,+BAA+B,KAAK,UAAU;;;;;;;;;;;;mEATpF,6BAA6B,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kCAwB9D,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCACC,SAAS;gCACT,UAAU;gCACV,WAAU;0CACX;;;;;;0CAGD,6LAAC;gCACC,SAAS,IAAM;gCACf,UAAU;gCACV,WAAU;0CAET,0BACC;;sDACE,6LAAC,+NAAO;4CAAC,WAAU;;;;;;wCAAyB;;iEAI9C;;sDACE,6LAAC,6MAAI;4CAAC,WAAU;;;;;;wCAAY;;;;;;;;;;;;;;;;;;;;0BAStC,6LAAC,+JAAiB;gBAChB,QAAQ,aAAa,MAAM;gBAC3B,SAAS,IAAM,gBAAgB;wBAAE,GAAG,YAAY;wBAAE,QAAQ;oBAAM;gBAChE,MAAM,aAAa,IAAI;gBACvB,OAAO,aAAa,KAAK;gBACzB,SAAS,aAAa,OAAO;;;;;;YAI9B,8BACC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBACC,WAAU;wBACV,SAAS,IAAM,gBAAgB;;;;;;kCAEjC,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;;0DACb,6LAAC,6NAAQ;gDAAC,WAAU;;;;;;0DACpB,6LAAC;gDAAG,WAAU;0DAAmC;;;;;;;;;;;;kDAEnD,6LAAC;wCACC,SAAS,IAAM,gBAAgB;wCAC/B,WAAU;kDAEV,cAAA,6LAAC,oMAAC;4CAAC,WAAU;;;;;;;;;;;;;;;;;0CAGjB,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAE,WAAU;0DAAyC;;;;;;0DACtD,6LAAC;gDAAE,WAAU;0DAAiB;;;;;;4CAC7B,oCACC,6LAAC;gDAAE,WAAU;0DAA2B;;;;;;4CAEzC,kCACC,6LAAC;gDAAE,WAAU;0DAAwB;;;;;;;;;;;;kDAIzC,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAM,WAAU;kEAAiD;;;;;;kEAClE,6LAAC;wDACC,MAAK;wDACL,OAAO,YAAY,CAAC,QAAQ,IAAI;wDAChC,UAAU,CAAC,QAAU,kBAAkB,SAAS,MAAM,MAAM,CAAC,KAAK;wDAClE,WAAU;wDACV,aAAY;;;;;;;;;;;;0DAIhB,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,OAAO,qBAAqB,OAAO,sBAAsB;gEACzD,UAAU,CAAC,QAAU,qBAAqB,MAAM,MAAM,CAAC,KAAK;gEAC5D,WAAU;;kFAEV,6LAAC;wEAAO,OAAM;kFAAG;;;;;;oEAChB,gBAAgB,GAAG,CAAC,CAAC,uBACpB,6LAAC;4EAAuB,OAAO,OAAO,EAAE;sFACrC,OAAO,KAAK;2EADF,OAAO,EAAE;;;;;;;;;;;;;;;;;kEAM5B,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,OAAO,qBAAqB,OAAO,sBAAsB;gEACzD,UAAU,CAAC,QAAU,qBAAqB,MAAM,MAAM,CAAC,KAAK;gEAC5D,UAAU,CAAC,gBAAgB,MAAM;gEACjC,WAAU;;kFAEV,6LAAC;wEAAO,OAAM;kFAAG;;;;;;oEAChB,gBAAgB,GAAG,CAAC,CAAC,uBACpB,6LAAC;4EAAuB,OAAO,OAAO,EAAE;sFACrC,OAAO,KAAK;2EADF,OAAO,EAAE;;;;;;;;;;;;;;;;;;;;;;;0DAQ9B,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAM,WAAU;kEAAiD;;;;;;kEAClE,6LAAC;wDACC,OAAO,wBAAwB,OAAO,yBAAyB;wDAC/D,UAAU,CAAC,QAAU,wBAAwB,MAAM,MAAM,CAAC,KAAK;wDAC/D,UAAU,CAAC,mBAAmB,MAAM;wDACpC,WAAU;;0EAEV,6LAAC;gEAAO,OAAM;0EAAG;;;;;;4DAChB,mBAAmB,GAAG,CAAC,CAAC,uBACvB,6LAAC;oEAAuB,OAAO,OAAO,EAAE;8EACrC,OAAO,KAAK;mEADF,OAAO,EAAE;;;;;;;;;;;;;;;;;0DAO5B,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,MAAK;gEACL,OAAO,YAAY,CAAC,UAAU,IAAI;gEAClC,QAAQ;gEACR,WAAU;gEACV,aAAY;;;;;;;;;;;;kEAGhB,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAM,WAAU;0EAAiD;;;;;;0EAClE,6LAAC;gEACC,MAAK;gEACL,OAAO,YAAY,CAAC,UAAU,IAAI;gEAClC,QAAQ;gEACR,WAAU;;;;;;;;;;;;;;;;;;;;;;;;kDAMlB,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDACC,MAAK;gDACL,SAAS,IAAM,gBAAgB;gDAC/B,WAAU;0DACX;;;;;;0DAGD,6LAAC;gDACC,MAAK;gDACL,SAAS;gDACT,UAAU;gDACV,WAAU;0DAET,YAAY,mBAAmB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAS3C,kCACC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBACC,WAAU;wBACV,SAAS,IAAM,oBAAoB;;;;;;kCAErC,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;;0DACb,6LAAC,+OAAc;gDAAC,WAAU;;;;;;0DAC1B,6LAAC;gDAAG,WAAU;0DAAmC;;;;;;;;;;;;kDAEnD,6LAAC;wCACC,SAAS,IAAM,oBAAoB;wCACnC,WAAU;kDAEV,cAAA,6LAAC,oMAAC;4CAAC,WAAU;;;;;;;;;;;;;;;;;0CAGjB,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAE,WAAU;kEAAuC;;;;;;kEACpD,6LAAC;wDAAE,WAAU;kEAAyB;;;;;;;;;;;;0DAIxC,6LAAC;gDACC,MAAK;gDACL,SAAS;gDACT,UAAU,iBAAiB;gDAC3B,WAAU;0DAET,gBAAgB,gBAAgB;;;;;;;;;;;;kDAGrC,6LAAC;wCAAI,WAAU;;4CACZ,kCACC,6LAAC;gDAAE,WAAU;0DAAwB;;;;;;4CAEtC,gCACC,6LAAC;gDAAE,WAAU;0DAAyB;;;;;;;;;;;;kDAG1C,6LAAC;wCAAI,WAAU;kDACZ,gBAAgB,GAAG,CAAC,CAAC,qBACpB,6LAAC;gDAEC,MAAK;gDACL,SAAS,IAAM,uBAAuB,KAAK,GAAG;gDAC9C,WAAW,CAAC,wEAAwE,EAAE,wBAAwB,KAAK,GAAG,GAClH,gDACA,mEACA;0DAEH,KAAK,KAAK;+CARN,KAAK,GAAG;;;;;;;;;;kDAYnB,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAM,WAAU;;oDAA8E;kEAE7F,6LAAC;wDACC,MAAK;wDACL,OAAO,sBAAsB,MAAM;wDACnC,UAAU,CAAC,IACT,2BAA2B,qBAAqB;gEAAE,QAAQ,EAAE,MAAM,CAAC,KAAK;4DAAC;wDAE3E,WAAU;wDACV,aAAY;;;;;;;;;;;;0DAGhB,6LAAC;gDAAM,WAAU;;oDAA8E;kEAE7F,6LAAC;wDACC,MAAK;wDACL,OAAO,sBAAsB,MAAM;wDACnC,UAAU,CAAC,IACT,2BAA2B,qBAAqB;gEAAE,QAAQ,EAAE,MAAM,CAAC,KAAK;4DAAC;wDAE3E,WAAU;wDACV,aAAY;;;;;;;;;;;;;;;;;;kDAIlB,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAE,WAAU;0DAAoE;;;;;;0DAGjF,6LAAC;gDAAI,WAAU;0DACZ;oDAAC;wDAAE,OAAO;wDAAS,OAAO;oDAAM;oDAAG;wDAAE,OAAO;wDAAM,OAAO;oDAAK;iDAAE,CAAC,GAAG,CAAC,CAAC,uBACrE,6LAAC;wDAEC,MAAK;wDACL,SAAS,IACP,oBAAoB,qBAAqB,cAAc,OAAO,KAAK;wDAErE,WAAW,CAAC,gEAAgE,EAAE,sBAAsB,UAAU,KAAK,OAAO,KAAK,GAC3H,gDACA,mEACA;kEAEH,OAAO,KAAK;uDAVR,CAAC,QAAQ,EAAE,OAAO,KAAK,EAAE;;;;;;;;;;4CAcnC,sBAAsB,UAAU,kBAC/B,6LAAC;gDACC,OAAO,sBAAsB,oBAAoB;gDACjD,UAAU,CAAC,IACT,2BAA2B,qBAAqB;wDAC9C,sBAAsB,EAAE,MAAM,CAAC,KAAK;oDACtC;gDAEF,WAAU;gDACV,aAAY;gDACZ,MAAM;;;;;;;;;;;;kDAIZ,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAE,WAAU;0DAAoE;;;;;;0DAGjF,6LAAC;gDAAI,WAAU;0DACZ;oDAAC;wDAAE,OAAO;wDAAS,OAAO;oDAAM;oDAAG;wDAAE,OAAO;wDAAM,OAAO;oDAAK;iDAAE,CAAC,GAAG,CAAC,CAAC,uBACrE,6LAAC;wDAEC,MAAK;wDACL,SAAS,IACP,oBAAoB,qBAAqB,kBAAkB,OAAO,KAAK;wDAEzE,WAAW,CAAC,gEAAgE,EAAE,sBAAsB,cAAc,KAAK,OAAO,KAAK,GAC/H,gDACA,mEACA;kEAEH,OAAO,KAAK;uDAVR,CAAC,KAAK,EAAE,OAAO,KAAK,EAAE;;;;;;;;;;4CAchC,sBAAsB,cAAc,kBACnC,6LAAC;gDACC,OAAO,sBAAsB,iBAAiB;gDAC9C,UAAU,CAAC,IACT,2BAA2B,qBAAqB;wDAC9C,mBAAmB,EAAE,MAAM,CAAC,KAAK;oDACnC;gDAEF,WAAU;gDACV,aAAY;gDACZ,MAAM;;;;;;;;;;;;kDAKZ,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAI,WAAU;0DACb,cAAA,6LAAC;oDAAE,WAAU;;wDAAoE;wDAE7E,gBAAgB,IAAI,CAAC,CAAC,OAAS,KAAK,GAAG,KAAK,sBAAsB;wDACnE;;;;;;;;;;;;0DAGL,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;;kFACC,6LAAC;wEAAE,WAAU;kFAAgE;;;;;;kFAG7E,6LAAC;wEAAE,WAAU;kFAAqC;;;;;;;;;;;;0EAIpD,6LAAC;gEAAK,WAAU;;oEAA6B;oEACnC,sBAAsB,cAAc,IAAI;;;;;;;;;;;;;kEAGpD,6LAAC;wDAAI,WAAU;kEACZ,sBAAsB,GAAG,CAAC,CAAC,uBAC1B,6LAAC;gEAEC,MAAK;gEACL,SAAS,IAAM,2BAA2B,qBAAqB;wEAAE,gBAAgB;oEAAO;gEACxF,WAAW,CAAC,iFAAiF,EAAE,sBAAsB,cAAc,KAAK,SACpI,gDACA,sEACA;0EAEH;+DARI;;;;;;;;;;kEAYX,6LAAC;wDAAI,WAAU;;4DACZ,kCAAkC,GAAG,CAAC,CAAC,MAAM,sBAC5C,6LAAC;oEAA2B,WAAW,UAAU,IAAI,iCAAiC;8EACnF;mEADK,GAAG,KAAK,CAAC,EAAE,OAAO;;;;;0EAI5B,6LAAC;gEAAE,WAAU;0EAA6B;;;;;;;;;;;;;;;;;;0DAK9C,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;;kFACC,6LAAC;wEAAE,WAAU;kFAAgE;;;;;;kFAG7E,6LAAC;wEAAE,WAAU;kFAAqC;;;;;;;;;;;;0EAIpD,6LAAC;gEAAK,WAAU;;oEAA6B;oEACnC,sBAAsB,UAAU,IAAI;;;;;;;;;;;;;kEAGhD,6LAAC;wDAAI,WAAU;kEACZ,cAAc,GAAG,CAAC,CAAC,uBAClB,6LAAC;gEAEC,MAAK;gEACL,SAAS,IAAM,2BAA2B,qBAAqB;wEAAE,YAAY;oEAAO;gEACpF,WAAW,CAAC,iFAAiF,EAAE,sBAAsB,UAAU,KAAK,SAChI,gDACA,sEACA;0EAEH;+DARI,CAAC,KAAK,EAAE,QAAQ;;;;;;;;;;kEAY3B,6LAAC;wDAAI,WAAU;;4DACZ,cAAc,GAAG,CAAC,CAAC,MAAM,sBACxB,6LAAC;oEAA2B,WAAW,UAAU,IAAI,iCAAiC;8EACnF;mEADK,GAAG,KAAK,CAAC,EAAE,OAAO;;;;;0EAI5B,6LAAC;gEAAE,WAAU;0EAA6B;;;;;;;;;;;;;;;;;;0DAG9C,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;;kFACC,6LAAC;wEAAE,WAAU;kFAAgE;;;;;;kFAG7E,6LAAC;wEAAE,WAAU;kFAAqC;;;;;;;;;;;;0EAIpD,6LAAC;gEAAK,WAAU;;oEAA6B;oEACnC,sBAAsB,WAAW,IAAI;;;;;;;;;;;;;kEAGjD,6LAAC;wDAAI,WAAU;kEACZ,cAAc,GAAG,CAAC,CAAC,uBAClB,6LAAC;gEAEC,MAAK;gEACL,SAAS,IAAM,2BAA2B,qBAAqB;wEAAE,aAAa;oEAAO;gEACrF,WAAW,CAAC,iFAAiF,EAAE,sBAAsB,WAAW,KAAK,SACjI,gDACA,sEACA;0EAEH;+DARI,CAAC,MAAM,EAAE,QAAQ;;;;;;;;;;kEAY5B,6LAAC;wDAAI,WAAU;;4DACZ,eAAe,GAAG,CAAC,CAAC,MAAM,sBACzB,6LAAC;oEAA2B,WAAW,UAAU,IAAI,iCAAiC;8EACnF;mEADK,GAAG,KAAK,CAAC,EAAE,OAAO;;;;;0EAI5B,6LAAC;gEAAE,WAAU;0EAA6B;;;;;;;;;;;;;;;;;;0DAG9C,6LAAC;gDAAE,WAAU;0DAAyB;;;;;;0DAGtC,6LAAC;gDACC,OAAO,sBAAsB,YAAY;gDACzC,UAAU,CAAC,QAAU,6BAA6B,qBAAqB;;;;;;4CAExE,sBAAsB,YAAY,kBACjC,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAE,WAAU;kEAAsD;;;;;;kEAGnE,6LAAC;wDACC,KAAK,sBAAsB,YAAY;wDACvC,KAAI;wDACJ,WAAU;;;;;;;;;;;;;;;;;;;;;;;;0CAMpB,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;kDACC,cAAA,6LAAC;4CAAE,WAAU;sDAAyB;;;;;;;;;;;kDAIxC,6LAAC;wCACC,MAAK;wCACL,SAAS;wCACT,UAAU,iBAAiB;wCAC3B,WAAU;kDAET,gBAAgB,2BAA2B;;;;;;;;;;;;;;;;;;;;;;;;YAQrD,kCACC,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBACC,WAAU;oBACV,SAAS,CAAC,IAAM,EAAE,eAAe;;sCAGjC,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;;sDACC,6LAAC;4CAAG,WAAU;sDAAqB;;;;;;sDACnC,6LAAC;4CAAE,WAAU;sDAA6B;;;;;;;;;;;;8CAI5C,6LAAC;oCACC,MAAK;oCACL,SAAS;oCACT,WAAU;8CAEV,cAAA,6LAAC,oMAAC;wCAAC,WAAU;;;;;;;;;;;;;;;;;sCAKjB,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAM,WAAU;kDAAsC;;;;;;kDACvD,6LAAC;wCACC,WAAU;wCACV,OAAO;wCACP,UAAU,CAAC,IAAM,kBAAkB,EAAE,MAAM,CAAC,KAAK;;0DAEjD,6LAAC;gDAAO,OAAM;0DAAG;;;;;;4CAChB,UAAU,GAAG,CAAC,CAAC,sBACd,6LAAC;oDAA6B,OAAO,MAAM,SAAS;8DACjD,MAAM,SAAS;mDADL,MAAM,SAAS;;;;;;;;;;;oCAK/B,+BACC,6LAAC;wCAAK,WAAU;kDAAwB;;;;;;oCAEzC,iBAAiB,MAAM,GAAG,mBACzB,6LAAC;wCAAK,WAAU;;4CAA+E;4CAClF,iBAAiB,MAAM;4CAAC;;;;;;;;;;;;;;;;;;sCAK3C,6LAAC;4BAAI,WAAU;sCACZ,wCACC,6LAAC;0CAAK;;;;;2EACJ,sCACF,6LAAC;gCAAK,WAAU;0CAAgB;;;;;2EAC9B,mBAAmB,KAAK,KAAK,kBAC/B,6LAAC;0CAAK;;;;;yFAEN,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;;4CAAK;4CACQ,mBAAmB,KAAK;4CAAC;4CAAkB,sBACrD,mBAAmB,KAAK;;;;;;;kDAG5B,6LAAC;wCACC,MAAK;wCACL,SAAS;wCACT,WAAU;kDACX;;;;;;;;;;;;;;;;;sCAQP,6LAAC;4BAAI,WAAU;;8CAEb,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDAAG,WAAU;8DAAkC;;;;;;8DAChD,6LAAC;oDAAE,WAAU;;wDACV,iBAAiB,MAAM;wDAAC;wDACxB,oBAAoB,CAAC,GAAG,EAAE,iBAAiB,SAAS,EAAE;;;;;;;;;;;;;sDAG3D,6LAAC;4CAAI,WAAU;sDACZ,iBAAiB,MAAM,KAAK,kBAC3B,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;kEAAgB;;;;;;kEAC/B,6LAAC;wDAAE,WAAU;kEAAwB;;;;;;kEACrC,6LAAC;wDAAE,WAAU;kEAAwB;;;;;;;;;;;yGAGvC;;kEACE,6LAAC;wDAAI,WAAU;kEACZ,iBAAiB,GAAG,CAAC,CAAC,sBACrB,6LAAC;gEAEC,WAAU;;kFAEV,6LAAC;wEAAI,WAAU;;0FACb,6LAAC;gFAAI,WAAU;;kGACb,6LAAC;wFAAE,WAAU;kGAA+B,MAAM,QAAQ;;;;;;kGAC1D,6LAAC;wFAAE,WAAU;;4FAAwB;4FAC7B,MAAM,QAAQ;4FAAC;4FAAS,sBAAsB,MAAM,UAAU;;;;;;;;;;;;;0FAGxE,6LAAC;gFACC,MAAK;gFACL,SAAS,IAAM,yBAAyB,MAAM,EAAE;gFAChD,WAAU;0FAEV,cAAA,6LAAC,oMAAC;oFAAC,WAAU;;;;;;;;;;;;;;;;;kFAIjB,6LAAC;wEAAI,WAAU;;0FACb,6LAAC;gFAAI,WAAU;;kGACb,6LAAC;wFAAE,WAAU;kGAAsE;;;;;;kGAGnF,6LAAC;wFAAI,WAAU;;0GACb,6LAAC;gGACC,MAAK;gGACL,aAAY;gGACZ,OAAO,MAAM,WAAW;gGACxB,UAAU,CAAC,IAAM,wBAAwB,MAAM,EAAE,EAAE,EAAE,MAAM,CAAC,KAAK;gGACjE,WAAU;;;;;;0GAEZ,6LAAC;gGACC,MAAK;gGACL,aAAY;gGACZ,OAAO,MAAM,aAAa;gGAC1B,UAAU,CAAC,IAAM,0BAA0B,MAAM,EAAE,EAAE,EAAE,MAAM,CAAC,KAAK;gGACnE,WAAU;;;;;;;;;;;;;;;;;;0FAIhB,6LAAC;gFAAI,WAAU;;kGACb,6LAAC;wFAAE,WAAU;kGAAmE;;;;;;kGAGhF,6LAAC;wFAAI,WAAU;;0GACb,6LAAC;gGACC,MAAK;gGACL,aAAY;gGACZ,OAAO,MAAM,aAAa;gGAC1B,UAAU,CAAC,IAAM,0BAA0B,MAAM,EAAE,EAAE,EAAE,MAAM,CAAC,KAAK;gGACnE,WAAU;;;;;;0GAEZ,6LAAC;gGACC,MAAK;gGACL,aAAY;gGACZ,OAAO,MAAM,eAAe;gGAC5B,UAAU,CAAC,IAAM,4BAA4B,MAAM,EAAE,EAAE,EAAE,MAAM,CAAC,KAAK;gGACrE,WAAU;;;;;;;;;;;;;;;;;;;;;;;;kFAKlB,6LAAC;wEAAI,WAAU;;0FACb,6LAAC;0FAAK;;;;;;0FACN,6LAAC;0FAAM,sBAAsB,2BAA2B;;;;;;;;;;;;;+DAjErD,MAAM,EAAE;;;;;;;;;;kEAsEnB,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAI,WAAU;;kFACb,6LAAC;kFAAK;;;;;;kFACN,6LAAC;;4EAAM,iBAAiB,MAAM;4EAAC;;;;;;;;;;;;;0EAEjC,6LAAC;gEAAI,WAAU;;kFACb,6LAAC;wEAAI,WAAU;;0FACb,6LAAC;0FAAK;;;;;;0FACN,6LAAC;gFAAK,WAAU;0FACb,sBAAsB,uBAAuB,SAAS;;;;;;;;;;;;kFAG3D,6LAAC;wEAAI,WAAU;;0FACb,6LAAC;0FAAK;;;;;;0FACN,6LAAC;gFAAK,WAAU;0FACb,sBAAsB,uBAAuB,WAAW;;;;;;;;;;;;kFAG7D,6LAAC;wEAAI,WAAU;;0FACb,6LAAC;0FAAK;;;;;;0FACN,6LAAC;gFAAK,WAAU;0FACb,sBAAsB,uBAAuB,aAAa;;;;;;;;;;;;kFAG/D,6LAAC;wEAAI,WAAU;;0FACb,6LAAC;0FAAK;;;;;;0FACN,6LAAC;0FAAM,sBAAsB,uBAAuB,QAAQ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8CAU1E,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDAAG,WAAU;8DAAkC;;;;;;gDAC/C,kCACC,6LAAC;oDAAE,WAAU;8DAAyB,iBAAiB,SAAS;;;;;;;;;;;;sDAGpE,6LAAC;4CAAI,WAAU;sDACb,cAAA,6LAAC;gDAAI,WAAU;0DACb,cAAA,6LAAC;oDACC,MAAK;oDACL,aAAY;oDACZ,OAAO;oDACP,UAAU,CAAC,IAAM,qBAAqB,EAAE,MAAM,CAAC,KAAK;oDACpD,WAAU;;;;;;;;;;;;;;;;sDAIhB,6LAAC;4CAAI,WAAU;;gDACZ,iCACC,6LAAC;oDAAI,WAAU;8DACb,cAAA,6LAAC;wDAAI,WAAU;;;;;;;;;;;gDAGlB,8BACC,6LAAC;oDAAE,WAAU;8DAAyC;;;;;;gDAEvD,CAAC,mBAAmB,CAAC,gBAAgB,qBAAqB,MAAM,KAAK,mBACpE,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAI,WAAU;sEAAgB;;;;;;sEAC/B,6LAAC;4DAAE,WAAU;sEACV,uBAAuB,sBAAsB;;;;;;;;;;;;8DAIpD,6LAAC;oDAAI,WAAU;8DACZ,qBAAqB,GAAG,CAAC,CAAC;wDACzB,MAAM,eAAe,iBAAiB,IAAI,CACxC,CAAC,QAAU,MAAM,QAAQ,KAAK,KAAK,QAAQ;wDAE7C,qBACE,6LAAC;4DAEC,WAAW,CAAC,yEAAyE,EAAE,eACnF,qCACA,yEACA;;8EAEJ,6LAAC;;sFACC,6LAAC;4EAAE,WAAU;sFAA6B,KAAK,QAAQ;;;;;;sFACvD,6LAAC;4EAAE,WAAU;;gFAAwB;gFAC7B,sBAAsB,KAAK,SAAS;;;;;;;;;;;;;8EAG9C,6LAAC;oEACC,MAAK;oEACL,SAAS,IAAM,iBAAiB;oEAChC,UAAU;oEACV,WAAW,CAAC,0DAA0D,EAAE,eACpE,oCACA,kFACA;8EAEH,eAAe,gBAAgB;;;;;;;2DArB7B,KAAK,QAAQ;;;;;oDAyBxB;;;;;;;;;;;;;;;;;;;;;;;;sCASR,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAE,WAAU;;wCAAwB;sDACzB,6LAAC;4CAAK,WAAU;sDAA6B,iBAAiB,MAAM;;;;;;wCAAQ;sDACtF,6LAAC;4CAAK,WAAU;sDAA8C;;;;;;sDAC9D,6LAAC;4CAAK,WAAU;sDAAO;;;;;;sDACvB,6LAAC;4CAAK,WAAU;sDACb,sBAAsB,uBAAuB,QAAQ;;;;;;;;;;;;8CAG1D,6LAAC;oCACC,MAAK;oCACL,SAAS;oCACT,UAAU,kBAAkB,iBAAiB,MAAM,KAAK;oCACxD,WAAU;8CAET,iBAAiB,yBAAyB;;;;;;;;;;;;;;;;;;;;;;;YAQpD,kCACC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBACC,WAAU;wBACV,SAAS;;;;;;kCAEX,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;;0DACC,6LAAC;gDAAE,WAAU;0DAAuC;;;;;;0DACpD,6LAAC;gDAAE,WAAU;0DAAyB;;;;;;;;;;;;kDAExC,6LAAC;wCACC,MAAK;wCACL,SAAS;wCACT,WAAU;kDAEV,cAAA,6LAAC,oMAAC;4CAAC,WAAU;;;;;;;;;;;;;;;;;0CAGjB,6LAAC;gCAAI,WAAU;0CACZ,iBAAiB,MAAM,KAAK,kBAC3B,6LAAC;oCAAE,WAAU;8CAAyB;;;;;6FAEtC,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;8DAAK;;;;;;8DACN,6LAAC;8DAAK;;;;;;8DACN,6LAAC;8DAAK;;;;;;8DACN,6LAAC;oDAAK,WAAU;8DAAa;;;;;;;;;;;;sDAE/B,6LAAC;4CAAI,WAAU;sDACZ,iBAAiB,GAAG,CAAC,CAAC,aAAa,sBAClC,6LAAC;oDAEC,WAAU;;sEAEV,6LAAC;4DAAK,WAAU;sEACb,YAAY,SAAS,IAAI;;;;;;sEAE5B,6LAAC;4DAAK,WAAU;sEACb,YAAY,UAAU,IAAI;;;;;;sEAE7B,6LAAC;4DAAK,WAAU;4DAAW,OAAO,YAAY,SAAS;sEACpD,YAAY,SAAS,IAAI;;;;;;sEAE5B,6LAAC;4DAAK,WAAU;sEACb,sBAAsB,eAAe,YAAY,MAAM;;;;;;;mDAbrD,GAAG,YAAY,SAAS,CAAC,CAAC,EAAE,YAAY,UAAU,CAAC,CAAC,EAAE,OAAO;;;;;;;;;;;;;;;;;;;;;0CAqB9E,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC;oCACC,MAAK;oCACL,SAAS;oCACT,WAAU;8CACX;;;;;;;;;;;;;;;;;;;;;;;YASR,sCACC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBACC,WAAU;wBACV,SAAS,IAAM,wBAAwB;;;;;;kCAEzC,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;;0DACb,6LAAC,yNAAQ;gDAAC,WAAU;;;;;;0DACpB,6LAAC;gDAAG,WAAU;0DAAmC;;;;;;;;;;;;kDAEnD,6LAAC;wCACC,SAAS,IAAM,wBAAwB;wCACvC,WAAU;kDAEV,cAAA,6LAAC,oMAAC;4CAAC,WAAU;;;;;;;;;;;;;;;;;0CAGjB,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAE,WAAU;0DAAyC;;;;;;0DACtD,6LAAC;gDAAE,WAAU;0DAAiB;;;;;;;;;;;;kDAKhC,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;;0EACC,6LAAC;gEAAE,WAAU;;oEAAuC;oEACjC,mBAAmB,MAAM;oEAAC;;;;;;;0EAE7C,6LAAC;gEAAE,WAAU;0EAA6B;;;;;;;;;;;;kEAI5C,6LAAC;wDACC,MAAK;wDACL,SAAS;wDACT,WAAU;kEACX;;;;;;;;;;;;4CAIF,0CACC,6LAAC;gDAAE,WAAU;0DAAyB;;;;;2FACpC,wCACF,6LAAC;gDAAE,WAAU;0DAAyB;;;;;2FACpC,mBAAmB,MAAM,KAAK,kBAChC,6LAAC;gDAAE,WAAU;0DAAyB;;;;;yGAEtC,6LAAC;gDAAI,WAAU;0DACZ,mBAAmB,GAAG,CAAC,CAAC,OAAO;oDAC9B,MAAM,UAAU,6BAA6B,OAAO;oDACpD,MAAM,QAAQ,+BAA+B,MAAM,UAAU;oDAC7D,MAAM,MAAM,+BAA+B,MAAM,QAAQ;oDACzD,MAAM,cAAc,MAAM,SAAS,GAC/B,CAAC,WAAW,EAAE,MAAM,SAAS,EAAE,GAC/B,MAAM,YAAY,IAAI;oDAC1B,MAAM,WAAW,MAAM,QAAQ,GAAG,OAAO,MAAM,QAAQ,IAAI;oDAC3D,MAAM,OAAO,MAAM,IAAI,GAAG,OAAO,MAAM,IAAI,IAAI;oDAC/C,qBACE,6LAAC;wDAEC,WAAW,CAAC,2DAA2D,EAAE,kCAAkC,UACvG,yCACA,oBACA;kEAEJ,cAAA,6LAAC;4DAAI,WAAU;;8EACb,6LAAC;oEAAI,WAAU;;sFACb,6LAAC;4EAAE,WAAU;sFAAwC;;;;;;sFACrD,6LAAC;4EAAE,WAAU;;gFAA6B;gFAChC;gFAAM;gFAAa;;;;;;;wEAE5B,0BACC,6LAAC;4EAAE,WAAU;;gFAA6B;gFAC9B;;;;;;;wEAGb,sBACC,6LAAC;4EAAE,WAAU;;gFAA6B;gFAC7B;;;;;;;;;;;;;8EAIjB,6LAAC;oEAAI,WAAU;8EACb,cAAA,6LAAC;wEACC,MAAK;wEACL,UAAU,CAAC,MAAM,YAAY;wEAC7B,OAAO,CAAC,MAAM,YAAY,GAAG,wBAAwB;wEACrD,SAAS,IAAM,+BAA+B,OAAO;wEACrD,WAAW,CAAC,wDAAwD,EAAE,MAAM,YAAY,GACpF,kEACA,6DACA;kFACL;;;;;;;;;;;;;;;;;uDAjCA;;;;;gDAwCX;;;;;;;;;;;;oCAKL,oBAAoB,GAAG,CAAC,CAAC,wBACxB,6LAAC;4CAAwB,WAAU;;8DACjC,6LAAC;oDAAE,WAAU;8DAAwC,QAAQ,KAAK;;;;;;8DAClE,6LAAC;oDACC,WAAW,CAAC,KAAK,EAAE,QAAQ,OAAO,IAAI,6BAA6B,MAAM,CAAC;8DAEzE,QAAQ,MAAM,CAAC,GAAG,CAAC,CAAC;wDACnB,MAAM,OAAO,uBAAuB,CAAC,SAAS;wDAC9C,IAAI,CAAC,MAAM,OAAO;wDAClB,MAAM,QAAQ,eAAe,CAAC,SAAS,IAAI;wDAC3C,MAAM,aAAa,KAAK,IAAI,KAAK;wDACjC,MAAM,YACJ,KAAK,IAAI,KAAK,SACV,SACA,KAAK,IAAI,KAAK,mBACZ,mBACA,KAAK,IAAI,KAAK,QACZ,QACA;wDACV,qBACE,6LAAC;4DAEC,WAAW,CAAC,MAAM,EAAE,KAAK,SAAS,GAAG,kBAAkB,IAAI;;8EAE3D,6LAAC;oEAAM,WAAU;8EACd,KAAK,KAAK;;;;;;gEAEZ,2BACC,6LAAC;oEACC,MAAM;oEACN,OAAO;oEACP,UAAU,CAAC,QACT,6BAA6B,UAAU,MAAM,MAAM,CAAC,KAAK;oEAE3D,aAAa,KAAK,WAAW;oEAC7B,WAAU;;;;;6HAGZ,6LAAC;oEACC,MAAM;oEACN,OAAO;oEACP,UAAU,CAAC,QACT,6BAA6B,UAAU,MAAM,MAAM,CAAC,KAAK;oEAE3D,aAAa,KAAK,WAAW;oEAC7B,UAAU,KAAK,QAAQ;oEACvB,UAAU,KAAK,QAAQ;oEACvB,WAAW,CAAC,mIAAmI,EAAE,KAAK,QAAQ,GAC1J,kCACA,4BACD,4BAA4B,CAAC;;;;;;;2DA7B/B;;;;;oDAkCX;;;;;;;2CAtDM,QAAQ,KAAK;;;;;oCA2DxB,kCACC,6LAAC;wCAAE,WAAU;kDAAwB;;;;;;kDAGvC,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDACC,MAAK;gDACL,SAAS,IAAM,wBAAwB;gDACvC,WAAU;0DACX;;;;;;0DAGD,6LAAC;gDACC,MAAK;gDACL,SAAS;gDACT,UAAU;gDACV,WAAU;0DAET,qBAAqB,mBAAmB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAS3D;IAxqGa;MAAA"}},
    {"offset": {"line": 7759, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/nut_z/OneDrive/%E0%B9%80%E0%B8%94%E0%B8%AA%E0%B8%81%E0%B9%8C%E0%B8%97%E0%B9%87%E0%B8%AD%E0%B8%9B/new-bjh/bjh-bangkok/src/components/AddCustomerModal.tsx"],"sourcesContent":["\"use client\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { X, Save, Loader2, User, FileText, ClipboardCheck, Briefcase, Calendar, Star } from \"lucide-react\";\r\nimport { NotificationPopup } from \"./NotificationPopup\";\r\n\r\ninterface AddCustomerModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onSuccess: () => void;\r\n}\r\n\r\ntype TabType = \"contact\" | \"opd\" | \"consent\" | \"service\" | \"appointment\";\r\n\r\ninterface ThaiProvince {\r\n    id: number;\r\n    name_th: string;\r\n    name_en: string;\r\n}\r\n\r\ninterface ThaiDistrict {\r\n    id: number;\r\n    province_id: number;\r\n    name_th: string;\r\n    name_en: string;\r\n}\r\n\r\ninterface ThaiSubDistrict {\r\n    id: number;\r\n    district_id: number;\r\n    name_th: string;\r\n    name_en: string;\r\n    zip_code: number | string | null;\r\n}\r\n\r\nconst THAI_DATA_BASE_URL =\r\n    \"https://raw.githubusercontent.com/kongvut/thai-province-data/refs/heads/master/api/latest\";\r\n\r\nexport const AddCustomerModal = ({\r\n    isOpen,\r\n    onClose,\r\n    onSuccess,\r\n}: AddCustomerModalProps) => {\r\n    const [activeTab, setActiveTab] = useState<TabType>(\"contact\");\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [notification, setNotification] = useState({\r\n        isOpen: false,\r\n        type: \"success\" as \"success\" | \"error\",\r\n        title: \"\",\r\n        message: \"\",\r\n    });\r\n\r\n    // Form state - Contact Information (matching EditCustomerModal fields)\r\n    const [formData, setFormData] = useState({\r\n        // Personal Info\r\n        status: \"\",\r\n        prefix: \"\",\r\n        name: \"\",\r\n        surname: \"\",\r\n        nickname: \"\",\r\n        gender: \"\",\r\n        star_flag: \"\",\r\n        // Contact Info\r\n        phone: \"\",\r\n        email: \"\",\r\n        lineid: \"\",\r\n        facebook: \"\",\r\n        country: \"\",\r\n        // Business Info\r\n        source: \"\",\r\n        interested_product: \"\",\r\n        contact_staff: \"\",\r\n        proposed_amount: \"\",\r\n        // Follow-up Dates\r\n        got_contact_date: \"\",\r\n        last_followup: \"\",\r\n        next_followup: \"\",\r\n        // Consult/Surgery Dates\r\n        consult_date: \"\",\r\n        booked_consult_date: \"\",\r\n        surgery_date: \"\",\r\n        booked_surgery_date: \"\",\r\n        appointment_time: \"\",\r\n        // Notes\r\n        note: \"\",\r\n    });\r\n\r\n    // OPD form state\r\n    const [opdData, setOpdData] = useState({\r\n        locno: \"\",\r\n        province: \"\",\r\n        amphur: \"\",\r\n        tumbon: \"\",\r\n        zipcode: \"\",\r\n    });\r\n\r\n    // Consent form state\r\n    const [consentData, setConsentData] = useState({\r\n        weight: \"\",\r\n        height: \"\",\r\n        hasChronic: false,\r\n        chronicDiseaseDetail: \"\",\r\n        hasDrugAllergy: false,\r\n        drugAllergyDetail: \"\",\r\n        medicalConsent: \"\",\r\n        acceptPdpa: \"\",\r\n        acceptMedia: \"\",\r\n    });\r\n\r\n    // Options from API\r\n    const [statusOptions, setStatusOptions] = useState<Array<{ value: string; label: string; color: string }>>([]);\r\n    const [sourceOptions, setSourceOptions] = useState<Array<{ value: string; label: string }>>([]);\r\n    const [productOptions, setProductOptions] = useState<Array<{ value: string; label: string }>>([]);\r\n    const [countryOptions, setCountryOptions] = useState<Array<{ value: string; label: string }>>([]);\r\n    const [contactPersonOptions, setContactPersonOptions] = useState<Array<{ value: string; label: string }>>([]);\r\n\r\n    // Thai address data\r\n    const [thaiProvinces, setThaiProvinces] = useState<ThaiProvince[]>([]);\r\n    const [thaiDistricts, setThaiDistricts] = useState<ThaiDistrict[]>([]);\r\n    const [thaiSubdistricts, setThaiSubdistricts] = useState<ThaiSubDistrict[]>([]);\r\n    const [selectedProvinceId, setSelectedProvinceId] = useState<number | null>(null);\r\n    const [selectedDistrictId, setSelectedDistrictId] = useState<number | null>(null);\r\n    const [selectedSubdistrictId, setSelectedSubdistrictId] = useState<number | null>(null);\r\n    const [thaiAddressLoading, setThaiAddressLoading] = useState(false);\r\n\r\n    // Fallback data for when API is unavailable\r\n    const fallbackStatusOptions = [\r\n        { value: \"ติดตามต่อเนื่อง\", label: \"ติดตามต่อเนื่อง\", color: \"#FFD700\" },\r\n        { value: \"ปิดการขาย\", label: \"ปิดการขาย\", color: \"#90EE90\" },\r\n        { value: \"ยกเลิก\", label: \"ยกเลิก\", color: \"#FFB6C1\" },\r\n        { value: \"รอตอบกลับ\", label: \"รอตอบกลับ\", color: \"#87CEEB\" },\r\n        { value: \"ได้นัด Consult\", label: \"ได้นัด Consult\", color: \"#FFA500\" },\r\n        { value: \"ได้นัดผ่าตัด\", label: \"ได้นัดผ่าตัด\", color: \"#FF6347\" },\r\n        { value: \"ผ่าตัดแล้ว\", label: \"ผ่าตัดแล้ว\", color: \"#32CD32\" },\r\n    ];\r\n\r\n    const fallbackSourceOptions = [\r\n        { value: \"Facebook\", label: \"Facebook\" },\r\n        { value: \"Instagram\", label: \"Instagram\" },\r\n        { value: \"Google Ads\", label: \"Google Ads\" },\r\n        { value: \"Line\", label: \"Line\" },\r\n        { value: \"Walk-in\", label: \"Walk-in\" },\r\n        { value: \"Referral\", label: \"Referral\" },\r\n    ];\r\n\r\n    const fallbackProductOptions = [\r\n        { value: \"ตีตัวไล่ตัว\", label: \"ตีตัวไล่ตัว\" },\r\n        { value: \"Sub brow lift\", label: \"Sub brow lift\" },\r\n        { value: \"แก้ตาหมื่อตอนและแก้ว\", label: \"แก้ตาหมื่อตอนและแก้ว\" },\r\n        { value: \"ตาสองชั้น\", label: \"ตาสองชั้น\" },\r\n        { value: \"เสริมจมูก\", label: \"เสริมจมูก\" },\r\n        { value: \"แก้จมูก\", label: \"แก้จมูก\" },\r\n        { value: \"เสริมตาขาว\", label: \"เสริมตาขาว\" },\r\n        { value: \"ลิฟหน้า\", label: \"ลิฟหน้า\" },\r\n        { value: \"Skin\", label: \"Skin\" },\r\n    ];\r\n\r\n    const fallbackCountryOptions = [\r\n        { value: \"ไทย\", label: \"ไทย\" },\r\n        { value: \"จีน\", label: \"จีน\" },\r\n        { value: \"ญี่ปุ่น\", label: \"ญี่ปุ่น\" },\r\n        { value: \"เกาหลี\", label: \"เกาหลี\" },\r\n        { value: \"สิงคโปร์\", label: \"สิงคโปร์\" },\r\n        { value: \"มาเลเซีย\", label: \"มาเลเซีย\" },\r\n        { value: \"อินโดนีเซีย\", label: \"อินโดนีเซีย\" },\r\n        { value: \"เวียดนาม\", label: \"เวียดนาม\" },\r\n        { value: \"ฟิลิปปินส์\", label: \"ฟิลิปปินส์\" },\r\n        { value: \"พม่า\", label: \"พม่า\" },\r\n        { value: \"อื่นๆ\", label: \"อื่นๆ\" },\r\n    ];\r\n\r\n    const fallbackContactPersonOptions = [\r\n        { value: \"ไม่ระบุ\", label: \"ไม่ระบุ\" },\r\n    ];\r\n\r\n    // Fetch options on mount\r\n    useEffect(() => {\r\n        if (!isOpen) return;\r\n\r\n        const fetchStatusOptions = async () => {\r\n            try {\r\n                const response = await fetch(\"/api/status-options\");\r\n                const result = await response.json();\r\n                if (result.success && result.data) {\r\n                    setStatusOptions(result.data);\r\n                } else {\r\n                    setStatusOptions(fallbackStatusOptions);\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Failed to fetch status options:\", error);\r\n                setStatusOptions(fallbackStatusOptions);\r\n            }\r\n        };\r\n\r\n        const fetchSourceOptions = async () => {\r\n            try {\r\n                const response = await fetch(\"/api/source-options\");\r\n                const result = await response.json();\r\n                if (result.success && result.data) {\r\n                    setSourceOptions(result.data);\r\n                } else {\r\n                    setSourceOptions(fallbackSourceOptions);\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Failed to fetch source options:\", error);\r\n                setSourceOptions(fallbackSourceOptions);\r\n            }\r\n        };\r\n\r\n        const fetchProductOptions = async () => {\r\n            try {\r\n                const response = await fetch(\"/api/product-options\");\r\n                const result = await response.json();\r\n                if (result.success && result.data) {\r\n                    setProductOptions(result.data);\r\n                } else {\r\n                    setProductOptions(fallbackProductOptions);\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Failed to fetch product options:\", error);\r\n                setProductOptions(fallbackProductOptions);\r\n            }\r\n        };\r\n\r\n        const fetchCountryOptions = async () => {\r\n            try {\r\n                const response = await fetch(\"/api/country-options\");\r\n                const result = await response.json();\r\n                if (result.success && result.data) {\r\n                    setCountryOptions(result.data);\r\n                } else {\r\n                    setCountryOptions(fallbackCountryOptions);\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Failed to fetch country options:\", error);\r\n                setCountryOptions(fallbackCountryOptions);\r\n            }\r\n        };\r\n\r\n        const fetchContactPersonOptions = async () => {\r\n            try {\r\n                const response = await fetch(\"/api/n-staff\");\r\n                const result = await response.json();\r\n                if (result.success && result.data) {\r\n                    // Transform n_staff data to option format\r\n                    setContactPersonOptions(result.data.map((staff: { nickname: string; code: string }) => ({\r\n                        value: staff.nickname,\r\n                        label: staff.nickname,\r\n                    })));\r\n                } else {\r\n                    setContactPersonOptions(fallbackContactPersonOptions);\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Failed to fetch contact person options:\", error);\r\n                setContactPersonOptions(fallbackContactPersonOptions);\r\n            }\r\n        };\r\n\r\n        // Fetch all options\r\n        fetchStatusOptions();\r\n        fetchSourceOptions();\r\n        fetchProductOptions();\r\n        fetchCountryOptions();\r\n        fetchContactPersonOptions();\r\n    }, [isOpen]);\r\n\r\n    // Fetch Thai address data\r\n    useEffect(() => {\r\n        if (!isOpen) return;\r\n\r\n        const fetchThaiData = async () => {\r\n            setThaiAddressLoading(true);\r\n            try {\r\n                const [provincesRes, districtsRes, subdistrictsRes] = await Promise.all([\r\n                    fetch(`${THAI_DATA_BASE_URL}/province.json`),\r\n                    fetch(`${THAI_DATA_BASE_URL}/district.json`),\r\n                    fetch(`${THAI_DATA_BASE_URL}/sub_district.json`),\r\n                ]);\r\n\r\n                if (provincesRes.ok) {\r\n                    const provinces = await provincesRes.json();\r\n                    setThaiProvinces(provinces);\r\n                }\r\n                if (districtsRes.ok) {\r\n                    const districts = await districtsRes.json();\r\n                    setThaiDistricts(districts);\r\n                }\r\n                if (subdistrictsRes.ok) {\r\n                    const subdistricts = await subdistrictsRes.json();\r\n                    setThaiSubdistricts(subdistricts);\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Failed to fetch Thai address data:\", error);\r\n            } finally {\r\n                setThaiAddressLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchThaiData();\r\n    }, [isOpen]);\r\n\r\n    // Filter districts by province\r\n    const filteredDistricts = selectedProvinceId\r\n        ? thaiDistricts.filter((d) => d.province_id === selectedProvinceId)\r\n        : [];\r\n\r\n    // Filter subdistricts by district\r\n    const filteredSubdistricts = selectedDistrictId\r\n        ? thaiSubdistricts.filter((s) => s.district_id === selectedDistrictId)\r\n        : [];\r\n\r\n    const handleProvinceSelect = (provinceId: string) => {\r\n        const id = provinceId ? parseInt(provinceId) : null;\r\n        setSelectedProvinceId(id);\r\n        setSelectedDistrictId(null);\r\n        setSelectedSubdistrictId(null);\r\n\r\n        const province = thaiProvinces.find((p) => p.id === id);\r\n        setOpdData((prev) => ({\r\n            ...prev,\r\n            province: province?.name_th || \"\",\r\n            amphur: \"\",\r\n            tumbon: \"\",\r\n            zipcode: \"\",\r\n        }));\r\n    };\r\n\r\n    const handleDistrictSelect = (districtId: string) => {\r\n        const id = districtId ? parseInt(districtId) : null;\r\n        setSelectedDistrictId(id);\r\n        setSelectedSubdistrictId(null);\r\n\r\n        const district = thaiDistricts.find((d) => d.id === id);\r\n        setOpdData((prev) => ({\r\n            ...prev,\r\n            amphur: district?.name_th || \"\",\r\n            tumbon: \"\",\r\n            zipcode: \"\",\r\n        }));\r\n    };\r\n\r\n    const handleSubdistrictSelect = (subdistrictId: string) => {\r\n        const id = subdistrictId ? parseInt(subdistrictId) : null;\r\n        setSelectedSubdistrictId(id);\r\n\r\n        const subdistrict = thaiSubdistricts.find((s) => s.id === id);\r\n        setOpdData((prev) => ({\r\n            ...prev,\r\n            tumbon: subdistrict?.name_th || \"\",\r\n            zipcode: subdistrict?.zip_code?.toString() || \"\",\r\n        }));\r\n    };\r\n\r\n    const handleSave = async () => {\r\n        // Validate mandatory fields: ชื่อ, สถานะ, เบอร์โทร, เพศ, แหล่งที่มา, ผลิตภัณฑ์ที่สนใจ\r\n        const missingFields: string[] = [];\r\n        if (!formData.name.trim()) missingFields.push(\"ชื่อ\");\r\n        if (!formData.status) missingFields.push(\"สถานะ\");\r\n        if (!formData.phone.trim()) missingFields.push(\"เบอร์โทร\");\r\n        if (!formData.gender) missingFields.push(\"เพศ\");\r\n        if (!formData.source) missingFields.push(\"แหล่งที่มา\");\r\n        if (!formData.interested_product) missingFields.push(\"ผลิตภัณฑ์ที่สนใจ\");\r\n\r\n        if (missingFields.length > 0) {\r\n            setNotification({\r\n                isOpen: true,\r\n                type: \"error\",\r\n                title: \"ข้อมูลไม่ครบ\",\r\n                message: `กรุณากรอกข้อมูลที่จำเป็น: ${missingFields.join(\", \")}`,\r\n            });\r\n            return;\r\n        }\r\n\r\n        setIsLoading(true);\r\n        try {\r\n            const customerPayload = {\r\n                // Personal Info\r\n                prefix: formData.prefix,\r\n                name: formData.name,\r\n                surname: formData.surname,\r\n                nickname: formData.nickname,\r\n                gender: formData.gender,\r\n                star_flag: formData.star_flag === \"ติดดาว\" ? 1 : 0,\r\n                status: formData.status,\r\n                // Contact Info\r\n                phone: formData.phone,\r\n                email: formData.email,\r\n                lineid: formData.lineid,\r\n                facebook: formData.facebook,\r\n                country: formData.country,\r\n                // Business Info\r\n                source: formData.source,\r\n                interested_product: formData.interested_product,\r\n                contact_staff: formData.contact_staff,\r\n                proposed_amount: formData.proposed_amount || null,\r\n                // Follow-up Dates\r\n                got_contact_date: formData.got_contact_date || null,\r\n                last_followup: formData.last_followup || null,\r\n                next_followup: formData.next_followup || null,\r\n                // Consult/Surgery Dates\r\n                consult_date: formData.consult_date || null,\r\n                booked_consult_date: formData.booked_consult_date || null,\r\n                surgery_date: formData.surgery_date || null,\r\n                booked_surgery_date: formData.booked_surgery_date || null,\r\n                appointment_time: formData.appointment_time || null,\r\n                // Notes\r\n                note: formData.note,\r\n                // OPD data\r\n                locno: opdData.locno,\r\n                province: opdData.province,\r\n                amphur: opdData.amphur,\r\n                tumbon: opdData.tumbon,\r\n                zipcode: opdData.zipcode,\r\n            };\r\n\r\n            const response = await fetch(\"/api/customer-add\", {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n                body: JSON.stringify(customerPayload),\r\n            });\r\n\r\n            if (!response.ok) {\r\n                const errorData = await response.json();\r\n                throw new Error(errorData.error || \"Failed to save customer\");\r\n            }\r\n\r\n            setNotification({\r\n                isOpen: true,\r\n                type: \"success\",\r\n                title: \"สำเร็จ\",\r\n                message: \"บันทึกข้อมูลลูกค้าเรียบร้อยแล้ว\",\r\n            });\r\n\r\n            // Reset form\r\n            setFormData({\r\n                status: \"\",\r\n                prefix: \"\",\r\n                name: \"\",\r\n                surname: \"\",\r\n                nickname: \"\",\r\n                gender: \"\",\r\n                star_flag: \"\",\r\n                phone: \"\",\r\n                email: \"\",\r\n                lineid: \"\",\r\n                facebook: \"\",\r\n                country: \"\",\r\n                source: \"\",\r\n                interested_product: \"\",\r\n                contact_staff: \"\",\r\n                proposed_amount: \"\",\r\n                got_contact_date: \"\",\r\n                last_followup: \"\",\r\n                next_followup: \"\",\r\n                consult_date: \"\",\r\n                booked_consult_date: \"\",\r\n                surgery_date: \"\",\r\n                booked_surgery_date: \"\",\r\n                appointment_time: \"\",\r\n                note: \"\",\r\n            });\r\n            setOpdData({\r\n                locno: \"\",\r\n                province: \"\",\r\n                amphur: \"\",\r\n                tumbon: \"\",\r\n                zipcode: \"\",\r\n            });\r\n            setActiveTab(\"contact\");\r\n\r\n            setTimeout(() => {\r\n                onSuccess();\r\n            }, 1500);\r\n        } catch (error: any) {\r\n            setNotification({\r\n                isOpen: true,\r\n                type: \"error\",\r\n                title: \"เกิดข้อผิดพลาด\",\r\n                message: error.message || \"ไม่สามารถบันทึกข้อมูลได้\",\r\n            });\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    const tabs = [\r\n        { id: \"contact\" as TabType, label: \"Contact Information\", icon: User },\r\n        { id: \"opd\" as TabType, label: \"OPD\", icon: FileText },\r\n        { id: \"consent\" as TabType, label: \"Consent\", icon: ClipboardCheck },\r\n        { id: \"service\" as TabType, label: \"บริการ\", icon: Briefcase },\r\n        { id: \"appointment\" as TabType, label: \"นัดหมาย\", icon: Calendar },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fadeIn\">\r\n            <div className=\"bg-white rounded-2xl shadow-2xl max-h-[90vh] overflow-hidden w-full max-w-4xl animate-slideUp transform transition-all\">\r\n                {/* Header with Gradient */}\r\n                <div className=\"sticky top-0 bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 z-10 shadow-lg\">\r\n                    {/* Close button - top right */}\r\n                    <div className=\"absolute top-3 right-3\">\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"p-2 hover:bg-white hover:bg-opacity-20 rounded-xl transition-all duration-200 group\"\r\n                        >\r\n                            <X className=\"w-5 h-5 text-white group-hover:rotate-90 transition-transform duration-200\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Centered Tabs */}\r\n                    <div className=\"flex justify-center items-center gap-1 sm:gap-2 px-4 py-4\">\r\n                        {tabs.map((tab) => (\r\n                            <button\r\n                                key={tab.id}\r\n                                onClick={() => setActiveTab(tab.id)}\r\n                                className={`flex flex-col sm:flex-row items-center justify-center gap-1 px-3 sm:px-4 py-2 sm:py-2.5 ${activeTab === tab.id\r\n                                    ? \"bg-white/30 shadow-inner\"\r\n                                    : \"bg-white/10 hover:bg-white/20\"\r\n                                    } text-white rounded-xl transition-all duration-200 min-w-[60px] sm:min-w-[80px]`}\r\n                                title={tab.label}\r\n                            >\r\n                                <tab.icon className=\"w-5 h-5\" />\r\n                                <span className=\"text-xs sm:text-sm font-medium hidden sm:block\">{tab.label}</span>\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Scrollable Content */}\r\n                <div className=\"overflow-y-auto\" style={{ maxHeight: \"calc(90vh - 180px)\" }}>\r\n                    <div className=\"p-6 space-y-6\">\r\n                        {/* Contact Information Tab */}\r\n                        {activeTab === \"contact\" && (\r\n                            <>\r\n                                {/* Section 1: Personal Info */}\r\n                                <div className=\"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl p-6 border border-cyan-100 shadow-sm\">\r\n                                    <div className=\"flex items-center gap-2 mb-4\">\r\n                                        <div className=\"w-1 h-6 bg-gradient-to-b from-cyan-500 to-blue-500 rounded-full\"></div>\r\n                                        <h2 className=\"text-lg font-bold bg-gradient-to-r from-cyan-600 to-blue-600 bg-clip-text text-transparent\">\r\n                                            ข้อมูลส่วนตัว\r\n                                        </h2>\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n                                        {/* Status */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">สถานะ <span className=\"text-red-500\">*</span></label>\r\n                                            <select\r\n                                                value={formData.status}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, status: e.target.value }))}\r\n                                                className={`w-full pl-4 pr-8 py-3 border-2 ${!formData.status ? 'border-red-300' : 'border-cyan-200'} bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer`}\r\n                                            >\r\n                                                <option value=\"\">เลือกสถานะ</option>\r\n                                                {statusOptions.map((option) => (\r\n                                                    <option key={option.value} value={option.value}>{option.label}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                        {/* Prefix */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">คำนำหน้า</label>\r\n                                            <select\r\n                                                value={formData.prefix}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, prefix: e.target.value }))}\r\n                                                className=\"w-full pl-4 pr-8 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            >\r\n                                                <option value=\"\">เลือกคำนำหน้า</option>\r\n                                                <option value=\"นาย\">นาย</option>\r\n                                                <option value=\"นาง\">นาง</option>\r\n                                                <option value=\"นางสาว\">นางสาว</option>\r\n                                                <option value=\"Mr.\">Mr.</option>\r\n                                                <option value=\"Mrs.\">Mrs.</option>\r\n                                                <option value=\"Ms.\">Ms.</option>\r\n                                            </select>\r\n                                        </div>\r\n                                        {/* Name */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ชื่อ <span className=\"text-red-500\">*</span></label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={formData.name}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, name: e.target.value }))}\r\n                                                className={`w-full px-4 py-3 border-2 ${!formData.name.trim() ? 'border-red-300' : 'border-cyan-200'} bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none`}\r\n                                                placeholder=\"กรอกชื่อ\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Surname */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">นามสกุล</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={formData.surname}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, surname: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none\"\r\n                                                placeholder=\"กรอกนามสกุล\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Nickname */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ชื่อเล่น</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={formData.nickname}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, nickname: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none\"\r\n                                                placeholder=\"กรอกชื่อเล่น\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Gender */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">เพศ <span className=\"text-red-500\">*</span></label>\r\n                                            <select\r\n                                                value={formData.gender}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, gender: e.target.value }))}\r\n                                                className={`w-full pl-4 pr-8 py-3 border-2 ${!formData.gender ? 'border-red-300' : 'border-cyan-200'} bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer`}\r\n                                            >\r\n                                                <option value=\"\">เลือกเพศ</option>\r\n                                                <option value=\"ชาย\">ชาย</option>\r\n                                                <option value=\"หญิง\">หญิง</option>\r\n                                                <option value=\"อื่นๆ\">อื่นๆ</option>\r\n                                            </select>\r\n                                        </div>\r\n                                        {/* Star Flag */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ติดดาว</label>\r\n                                            <button\r\n                                                type=\"button\"\r\n                                                onClick={() => setFormData((prev) => ({ ...prev, star_flag: prev.star_flag === \"ติดดาว\" ? \"\" : \"ติดดาว\" }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl hover:border-cyan-300 transition-all duration-200 flex items-center justify-center gap-2\"\r\n                                            >\r\n                                                <Star className={`w-6 h-6 ${formData.star_flag === \"ติดดาว\" ? \"fill-yellow-400 text-yellow-400\" : \"text-gray-400\"}`} />\r\n                                                <span className=\"text-sm font-medium text-gray-700\">\r\n                                                    {formData.star_flag === \"ติดดาว\" ? \"ติดดาวแล้ว\" : \"คลิกเพื่อติดดาว\"}\r\n                                                </span>\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Section 2: Contact Info */}\r\n                                <div className=\"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-xl p-6 border border-indigo-100 shadow-sm\">\r\n                                    <div className=\"flex items-center gap-2 mb-4\">\r\n                                        <div className=\"w-1 h-6 bg-gradient-to-b from-indigo-500 to-purple-500 rounded-full\"></div>\r\n                                        <h2 className=\"text-lg font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent\">\r\n                                            ข้อมูลติดต่อ\r\n                                        </h2>\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                        {/* Phone */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">เบอร์โทร <span className=\"text-red-500\">*</span></label>\r\n                                            <input\r\n                                                type=\"tel\"\r\n                                                value={formData.phone}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, phone: e.target.value }))}\r\n                                                className={`w-full px-4 py-3 border-2 ${!formData.phone.trim() ? 'border-red-300' : 'border-indigo-200'} bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none`}\r\n                                                placeholder=\"กรอกเบอร์โทร\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Email */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">อีเมล</label>\r\n                                            <input\r\n                                                type=\"email\"\r\n                                                value={formData.email}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, email: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none\"\r\n                                                placeholder=\"กรอกอีเมล\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Line ID */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ไลน์ไอดี</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={formData.lineid}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, lineid: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none\"\r\n                                                placeholder=\"กรอกไลน์ไอดี\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Facebook */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">เฟสบุ๊ค</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={formData.facebook}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, facebook: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none\"\r\n                                                placeholder=\"กรอกเฟสบุ๊ค\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Country */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ประเทศ</label>\r\n                                            <select\r\n                                                value={formData.country}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, country: e.target.value }))}\r\n                                                className=\"w-full pl-4 pr-8 py-3 border-2 border-indigo-200 bg-white rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            >\r\n                                                <option value=\"\">เลือกประเทศ</option>\r\n                                                {countryOptions.map((option) => (\r\n                                                    <option key={option.value} value={option.value}>{option.label}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Section 3: Business Info */}\r\n                                <div className=\"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl p-6 border border-emerald-100 shadow-sm\">\r\n                                    <div className=\"flex items-center gap-2 mb-4\">\r\n                                        <div className=\"w-1 h-6 bg-gradient-to-b from-emerald-500 to-teal-500 rounded-full\"></div>\r\n                                        <h2 className=\"text-lg font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent\">\r\n                                            ข้อมูลธุรกิจ\r\n                                        </h2>\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n                                        {/* Source */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">แหล่งที่มา <span className=\"text-red-500\">*</span></label>\r\n                                            <select\r\n                                                value={formData.source}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, source: e.target.value }))}\r\n                                                className={`w-full pl-4 pr-8 py-3 border-2 ${!formData.source ? 'border-red-300' : 'border-emerald-200'} bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer`}\r\n                                            >\r\n                                                <option value=\"\">เลือกแหล่งที่มา</option>\r\n                                                {sourceOptions.map((option) => (\r\n                                                    <option key={option.value} value={option.value}>{option.label}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                        {/* Interested Product */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ผลิตภัณฑ์ที่สนใจ <span className=\"text-red-500\">*</span></label>\r\n                                            <select\r\n                                                value={formData.interested_product}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, interested_product: e.target.value }))}\r\n                                                className={`w-full pl-4 pr-8 py-3 border-2 ${!formData.interested_product ? 'border-red-300' : 'border-emerald-200'} bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer`}\r\n                                            >\r\n                                                <option value=\"\">เลือกผลิตภัณฑ์</option>\r\n                                                {productOptions.map((option) => (\r\n                                                    <option key={option.value} value={option.value}>{option.label}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                        {/* Contact Staff */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ผู้ติดต่อ</label>\r\n                                            <select\r\n                                                value={formData.contact_staff}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, contact_staff: e.target.value }))}\r\n                                                className=\"w-full pl-4 pr-8 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            >\r\n                                                <option value=\"\">เลือกผู้ติดต่อ</option>\r\n                                                {contactPersonOptions.map((option) => (\r\n                                                    <option key={option.value} value={option.value}>{option.label}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                        {/* Proposed Amount */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ยอดนำเสนอ</label>\r\n                                            <input\r\n                                                type=\"number\"\r\n                                                value={formData.proposed_amount}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, proposed_amount: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none\"\r\n                                                placeholder=\"กรอกยอดนำเสนอ\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Section 4: วันที่ติดตาม */}\r\n                                <div className=\"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl p-6 border border-cyan-100 shadow-sm\">\r\n                                    <div className=\"flex items-center gap-2 mb-4\">\r\n                                        <div className=\"w-1 h-6 bg-gradient-to-b from-cyan-500 to-blue-500 rounded-full\"></div>\r\n                                        <h2 className=\"text-lg font-bold bg-gradient-to-r from-cyan-600 to-blue-600 bg-clip-text text-transparent\">\r\n                                            วันที่ติดตาม\r\n                                        </h2>\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                        {/* Got Contact Date */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                                                <span>📅</span> วันที่ได้ชื่อ เบอร์\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"date\"\r\n                                                value={formData.got_contact_date}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, got_contact_date: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Last Follow-up */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                                                <span>📅</span> วันที่ติดตามครั้งล่าสุด\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"date\"\r\n                                                value={formData.last_followup}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, last_followup: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Next Follow-up */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                                                <span>📅</span> วันที่ติดตามครั้งถัดไป\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"date\"\r\n                                                value={formData.next_followup}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, next_followup: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-cyan-200 bg-white rounded-xl focus:ring-2 focus:ring-cyan-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Section 5: วันที่ Consult */}\r\n                                <div className=\"bg-gradient-to-br from-purple-50 to-violet-50 rounded-xl p-6 border border-purple-100 shadow-sm\">\r\n                                    <div className=\"flex items-center gap-2 mb-4\">\r\n                                        <div className=\"w-1 h-6 bg-gradient-to-b from-purple-500 to-violet-500 rounded-full\"></div>\r\n                                        <h2 className=\"text-lg font-bold bg-gradient-to-r from-purple-600 to-violet-600 bg-clip-text text-transparent\">\r\n                                            วันที่ Consult\r\n                                        </h2>\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                        {/* Booked Consult Date */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                                                <span>📅</span> วันที่ได้นัด consult\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"date\"\r\n                                                value={formData.booked_consult_date}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, booked_consult_date: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-purple-200 bg-white rounded-xl focus:ring-2 focus:ring-purple-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Consult Date */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                                                <span>📅</span> วันที่ Consult\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"date\"\r\n                                                value={formData.consult_date}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, consult_date: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-purple-200 bg-white rounded-xl focus:ring-2 focus:ring-purple-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Section 6: วันที่ผ่าตัด */}\r\n                                <div className=\"bg-gradient-to-br from-rose-50 to-pink-50 rounded-xl p-6 border border-rose-100 shadow-sm\">\r\n                                    <div className=\"flex items-center gap-2 mb-4\">\r\n                                        <div className=\"w-1 h-6 bg-gradient-to-b from-rose-500 to-pink-500 rounded-full\"></div>\r\n                                        <h2 className=\"text-lg font-bold bg-gradient-to-r from-rose-600 to-pink-600 bg-clip-text text-transparent\">\r\n                                            วันที่ผ่าตัด\r\n                                        </h2>\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                        {/* Booked Surgery Date */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                                                <span>📅</span> วันที่ได้นัดผ่าตัด\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"date\"\r\n                                                value={formData.booked_surgery_date}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, booked_surgery_date: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-rose-200 bg-white rounded-xl focus:ring-2 focus:ring-rose-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Surgery Date */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                                                <span>📅</span> วันที่ผ่าตัด\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"date\"\r\n                                                value={formData.surgery_date}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, surgery_date: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-rose-200 bg-white rounded-xl focus:ring-2 focus:ring-rose-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            />\r\n                                        </div>\r\n                                        {/* Appointment Time */}\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2\">\r\n                                                <span>⏰</span> เวลาที่นัด\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"time\"\r\n                                                value={formData.appointment_time}\r\n                                                onChange={(e) => setFormData((prev) => ({ ...prev, appointment_time: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-rose-200 bg-white rounded-xl focus:ring-2 focus:ring-rose-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Section 6: Notes */}\r\n                                <div className=\"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl p-6 border border-amber-100 shadow-sm\">\r\n                                    <div className=\"flex items-center gap-2 mb-4\">\r\n                                        <div className=\"w-1 h-6 bg-gradient-to-b from-amber-500 to-yellow-500 rounded-full\"></div>\r\n                                        <h2 className=\"text-lg font-bold bg-gradient-to-r from-amber-600 to-yellow-600 bg-clip-text text-transparent\">\r\n                                            หมายเหตุ\r\n                                        </h2>\r\n                                    </div>\r\n                                    <textarea\r\n                                        value={formData.note}\r\n                                        onChange={(e) => setFormData((prev) => ({ ...prev, note: e.target.value }))}\r\n                                        className=\"w-full px-4 py-3 border-2 border-amber-200 bg-white rounded-xl focus:ring-2 focus:ring-amber-400 focus:border-transparent outline-none min-h-[120px] resize-none\"\r\n                                        placeholder=\"📝 พิมพ์หมายเหตุ...\"\r\n                                    />\r\n                                </div>\r\n                            </>\r\n                        )}\r\n\r\n                        {/* OPD Tab */}\r\n                        {activeTab === \"opd\" && (\r\n                            <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100 shadow-sm\">\r\n                                <div className=\"flex items-center gap-2 mb-4\">\r\n                                    <div className=\"w-1 h-6 bg-gradient-to-b from-blue-500 to-indigo-500 rounded-full\"></div>\r\n                                    <h2 className=\"text-lg font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent\">\r\n                                        ข้อมูล OPD - ที่อยู่\r\n                                    </h2>\r\n                                </div>\r\n                                {thaiAddressLoading && (\r\n                                    <p className=\"text-xs text-emerald-600 mb-4\">กำลังโหลดข้อมูลจังหวัด/อำเภอ/ตำบล...</p>\r\n                                )}\r\n                                <div className=\"space-y-4\">\r\n                                    <div className=\"group\">\r\n                                        <label className=\"block text-sm font-semibold text-gray-700 mb-2\">บ้านเลขที่</label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={opdData.locno}\r\n                                            onChange={(e) => setOpdData((prev) => ({ ...prev, locno: e.target.value }))}\r\n                                            className=\"w-full px-4 py-3 border-2 border-blue-200 bg-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-transparent outline-none\"\r\n                                            placeholder=\"ระบุบ้านเลขที่\"\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">จังหวัด</label>\r\n                                            <select\r\n                                                value={selectedProvinceId ? String(selectedProvinceId) : \"\"}\r\n                                                onChange={(e) => handleProvinceSelect(e.target.value)}\r\n                                                className=\"w-full pl-4 pr-8 py-3 border-2 border-blue-200 bg-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                            >\r\n                                                <option value=\"\">เลือกจังหวัด</option>\r\n                                                {thaiProvinces.map((province) => (\r\n                                                    <option key={province.id} value={province.id}>{province.name_th}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">อำเภอ / เขต</label>\r\n                                            <select\r\n                                                value={selectedDistrictId ? String(selectedDistrictId) : \"\"}\r\n                                                onChange={(e) => handleDistrictSelect(e.target.value)}\r\n                                                disabled={!filteredDistricts.length}\r\n                                                className=\"w-full pl-4 pr-8 py-3 border-2 border-blue-200 bg-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-transparent outline-none cursor-pointer disabled:bg-gray-100\"\r\n                                            >\r\n                                                <option value=\"\">เลือกอำเภอ / เขต</option>\r\n                                                {filteredDistricts.map((district) => (\r\n                                                    <option key={district.id} value={district.id}>{district.name_th}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ตำบล / แขวง</label>\r\n                                            <select\r\n                                                value={selectedSubdistrictId ? String(selectedSubdistrictId) : \"\"}\r\n                                                onChange={(e) => handleSubdistrictSelect(e.target.value)}\r\n                                                disabled={!filteredSubdistricts.length}\r\n                                                className=\"w-full pl-4 pr-8 py-3 border-2 border-blue-200 bg-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-transparent outline-none cursor-pointer disabled:bg-gray-100\"\r\n                                            >\r\n                                                <option value=\"\">เลือกตำบล / แขวง</option>\r\n                                                {filteredSubdistricts.map((subdistrict) => (\r\n                                                    <option key={subdistrict.id} value={subdistrict.id}>{subdistrict.name_th}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">รหัสไปรษณีย์</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={opdData.zipcode}\r\n                                                readOnly\r\n                                                className=\"w-full px-4 py-3 border-2 border-blue-200 bg-gray-100 rounded-xl outline-none text-gray-700\"\r\n                                                placeholder=\"รหัสไปรษณีย์ (อัตโนมัติ)\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Consent Tab */}\r\n                        {activeTab === \"consent\" && (\r\n                            <div className=\"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl p-6 border border-emerald-100 shadow-sm\">\r\n                                <div className=\"flex items-center gap-2 mb-4\">\r\n                                    <div className=\"w-1 h-6 bg-gradient-to-b from-emerald-500 to-teal-500 rounded-full\"></div>\r\n                                    <h2 className=\"text-lg font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent\">\r\n                                        Consent Form\r\n                                    </h2>\r\n                                </div>\r\n                                <div className=\"space-y-4\">\r\n                                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">น้ำหนัก (kg)</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={consentData.weight}\r\n                                                onChange={(e) => setConsentData((prev) => ({ ...prev, weight: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none\"\r\n                                                placeholder=\"ระบุน้ำหนัก\"\r\n                                            />\r\n                                        </div>\r\n                                        <div className=\"group\">\r\n                                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ส่วนสูง (cm)</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={consentData.height}\r\n                                                onChange={(e) => setConsentData((prev) => ({ ...prev, height: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none\"\r\n                                                placeholder=\"ระบุส่วนสูง\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"group\">\r\n                                        <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2\">\r\n                                            <input\r\n                                                type=\"checkbox\"\r\n                                                checked={consentData.hasChronic}\r\n                                                onChange={(e) => setConsentData((prev) => ({ ...prev, hasChronic: e.target.checked }))}\r\n                                                className=\"w-4 h-4 rounded border-gray-300 text-emerald-500 focus:ring-emerald-400\"\r\n                                            />\r\n                                            มีโรคประจำตัว\r\n                                        </label>\r\n                                        {consentData.hasChronic && (\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={consentData.chronicDiseaseDetail}\r\n                                                onChange={(e) => setConsentData((prev) => ({ ...prev, chronicDiseaseDetail: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none mt-2\"\r\n                                                placeholder=\"ระบุโรคประจำตัว\"\r\n                                            />\r\n                                        )}\r\n                                    </div>\r\n                                    <div className=\"group\">\r\n                                        <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2\">\r\n                                            <input\r\n                                                type=\"checkbox\"\r\n                                                checked={consentData.hasDrugAllergy}\r\n                                                onChange={(e) => setConsentData((prev) => ({ ...prev, hasDrugAllergy: e.target.checked }))}\r\n                                                className=\"w-4 h-4 rounded border-gray-300 text-emerald-500 focus:ring-emerald-400\"\r\n                                            />\r\n                                            มีประวัติแพ้ยา\r\n                                        </label>\r\n                                        {consentData.hasDrugAllergy && (\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={consentData.drugAllergyDetail}\r\n                                                onChange={(e) => setConsentData((prev) => ({ ...prev, drugAllergyDetail: e.target.value }))}\r\n                                                className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none mt-2\"\r\n                                                placeholder=\"ระบุยาที่แพ้\"\r\n                                            />\r\n                                        )}\r\n                                    </div>\r\n                                    <div className=\"group\">\r\n                                        <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ยินยอมรับการรักษา</label>\r\n                                        <select\r\n                                            value={consentData.medicalConsent}\r\n                                            onChange={(e) => setConsentData((prev) => ({ ...prev, medicalConsent: e.target.value }))}\r\n                                            className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                        >\r\n                                            <option value=\"\">เลือก</option>\r\n                                            <option value=\"ยินยอม\">ยินยอม</option>\r\n                                            <option value=\"ไม่ยินยอม\">ไม่ยินยอม</option>\r\n                                        </select>\r\n                                    </div>\r\n                                    <div className=\"group\">\r\n                                        <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ยอมรับ PDPA</label>\r\n                                        <select\r\n                                            value={consentData.acceptPdpa}\r\n                                            onChange={(e) => setConsentData((prev) => ({ ...prev, acceptPdpa: e.target.value }))}\r\n                                            className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                        >\r\n                                            <option value=\"\">เลือก</option>\r\n                                            <option value=\"ยอมรับ\">ยอมรับ</option>\r\n                                            <option value=\"ไม่ยอมรับ\">ไม่ยอมรับ</option>\r\n                                        </select>\r\n                                    </div>\r\n                                    <div className=\"group\">\r\n                                        <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ยินยอมเผยแพร่สื่อ</label>\r\n                                        <select\r\n                                            value={consentData.acceptMedia}\r\n                                            onChange={(e) => setConsentData((prev) => ({ ...prev, acceptMedia: e.target.value }))}\r\n                                            className=\"w-full px-4 py-3 border-2 border-emerald-200 bg-white rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-transparent outline-none cursor-pointer\"\r\n                                        >\r\n                                            <option value=\"\">เลือก</option>\r\n                                            <option value=\"ยอมรับ\">ยอมรับ</option>\r\n                                            <option value=\"ไม่ยอมรับ\">ไม่ยอมรับ</option>\r\n                                        </select>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Service Tab */}\r\n                        {activeTab === \"service\" && (\r\n                            <div className=\"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-100 shadow-sm\">\r\n                                <div className=\"flex items-center gap-2 mb-4\">\r\n                                    <div className=\"w-1 h-6 bg-gradient-to-b from-purple-500 to-pink-500 rounded-full\"></div>\r\n                                    <h2 className=\"text-lg font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent\">\r\n                                        บริการ\r\n                                    </h2>\r\n                                </div>\r\n                                <div className=\"text-center py-12 text-gray-500\">\r\n                                    <Briefcase className=\"w-16 h-16 mx-auto mb-4 text-gray-300\" />\r\n                                    <p className=\"text-lg font-medium\">กรุณาบันทึกข้อมูลลูกค้าก่อน</p>\r\n                                    <p className=\"text-sm mt-2\">หลังจากบันทึกแล้ว สามารถเพิ่มบริการได้ในหน้าแก้ไขข้อมูล</p>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Appointment Tab */}\r\n                        {activeTab === \"appointment\" && (\r\n                            <div className=\"bg-gradient-to-br from-orange-50 to-amber-50 rounded-xl p-6 border border-orange-100 shadow-sm\">\r\n                                <div className=\"flex items-center gap-2 mb-4\">\r\n                                    <div className=\"w-1 h-6 bg-gradient-to-b from-orange-500 to-amber-500 rounded-full\"></div>\r\n                                    <h2 className=\"text-lg font-bold bg-gradient-to-r from-orange-600 to-amber-600 bg-clip-text text-transparent\">\r\n                                        นัดหมาย\r\n                                    </h2>\r\n                                </div>\r\n                                <div className=\"text-center py-12 text-gray-500\">\r\n                                    <Calendar className=\"w-16 h-16 mx-auto mb-4 text-gray-300\" />\r\n                                    <p className=\"text-lg font-medium\">กรุณาบันทึกข้อมูลลูกค้าก่อน</p>\r\n                                    <p className=\"text-sm mt-2\">หลังจากบันทึกแล้ว สามารถเพิ่มนัดหมายได้ในหน้าแก้ไขข้อมูล</p>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Footer */}\r\n                <div className=\"sticky bottom-0 bg-gradient-to-t from-gray-50 to-white border-t border-gray-200 p-4 sm:p-5 flex justify-center gap-4 shadow-lg\">\r\n                    <button\r\n                        onClick={onClose}\r\n                        disabled={isLoading}\r\n                        className=\"px-6 sm:px-8 py-2.5 sm:py-3 border-2 border-gray-300 rounded-xl text-gray-700 text-sm sm:text-base font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 disabled:opacity-50\"\r\n                    >\r\n                        ยกเลิก\r\n                    </button>\r\n                    <button\r\n                        onClick={handleSave}\r\n                        disabled={isLoading}\r\n                        className=\"flex items-center gap-2 px-6 sm:px-8 py-2.5 sm:py-3 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white text-sm sm:text-base font-semibold rounded-xl transition-all duration-200 disabled:opacity-70 shadow-lg hover:shadow-xl\"\r\n                    >\r\n                        {isLoading ? (\r\n                            <>\r\n                                <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                                กำลังบันทึก...\r\n                            </>\r\n                        ) : (\r\n                            <>\r\n                                <Save className=\"w-4 h-4\" />\r\n                                บันทึก\r\n                            </>\r\n                        )}\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Notification Popup */}\r\n            <NotificationPopup\r\n                isOpen={notification.isOpen}\r\n                onClose={() => setNotification((prev) => ({ ...prev, isOpen: false }))}\r\n                type={notification.type}\r\n                title={notification.title}\r\n                message={notification.message}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n"],"names":[],"mappings":"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"}}]
}