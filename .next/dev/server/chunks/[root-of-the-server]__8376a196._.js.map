{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/nut_z/OneDrive/%E0%B9%80%E0%B8%94%E0%B8%AA%E0%B8%81%E0%B9%8C%E0%B8%97%E0%B9%87%E0%B8%AD%E0%B8%9B/new-bjh/bjh-bangkok/src/app/api/marketing-folders/route.ts"],"sourcesContent":["import { NextResponse, type NextRequest } from \"next/server\";\r\nimport { promises as fs } from \"fs\";\r\nimport path from \"path\";\r\n\r\ntype FileType = \"image\" | \"video\" | \"clip\";\r\n\r\ninterface ApiFileItem {\r\n  id: number;\r\n  name: string;\r\n  type: FileType;\r\n  url: string;\r\n  thumbnail: string;\r\n  size: string;\r\n  date: string;\r\n  tags: string[];\r\n  favorite: boolean;\r\n  views: number;\r\n  category: string;\r\n  needsThumbnailGeneration?: boolean;\r\n}\r\n\r\nconst thumbnailsRoot = path.join(process.cwd(), \"public\", \"images\", \"video\");\r\n\r\ninterface ApiFolderNode {\r\n  id: string;\r\n  name: string;\r\n  path: string;\r\n  fileIds: number[];\r\n  children: ApiFolderNode[];\r\n}\r\n\r\nconst marketingRoot = path.join(process.cwd(), \"public\", \"images\", \"video\");\r\n\r\nconst folderDefinitions = [\r\n  { id: \"ad-content\", name: \"Ad Content\" },\r\n  { id: \"before-and-after\", name: \"Before and After\" },\r\n  { id: \"branding\", name: \"Branding\" },\r\n  { id: \"presentations\", name: \"Presentations\" },\r\n  { id: \"all-footages\", name: \"All Footages\" },\r\n  { id: \"other-files\", name: \"Other Files\" },\r\n];\r\n\r\nconst imageExtensions = new Set([\r\n  \".png\",\r\n  \".jpg\",\r\n  \".jpeg\",\r\n  \".webp\",\r\n  \".gif\",\r\n  \".bmp\",\r\n  \".tif\",\r\n  \".tiff\",\r\n]);\r\nconst videoExtensions = new Set([\r\n  \".mp4\",\r\n  \".mov\",\r\n  \".avi\",\r\n  \".mkv\",\r\n  \".webm\",\r\n  \".flv\",\r\n  \".mpeg\",\r\n]);\r\n\r\nconst slugify = (value: string) =>\r\n  value\r\n    .toLowerCase()\r\n    .replace(/[^a-z0-9]+/g, \"-\")\r\n    .replace(/(^-|-$)+/g, \"\");\r\n\r\nconst formatBytes = (bytes: number) => {\r\n  if (bytes === 0) return \"0 B\";\r\n  const units = [\"B\", \"KB\", \"MB\", \"GB\", \"TB\"];\r\n  const exponent = Math.floor(Math.log(bytes) / Math.log(1024));\r\n  const value = bytes / Math.pow(1024, exponent);\r\n  return `${value.toFixed(2)} ${units[exponent]}`;\r\n};\r\n\r\nconst getFileType = (fileName: string): FileType => {\r\n  const ext = path.extname(fileName).toLowerCase();\r\n  if (imageExtensions.has(ext)) return \"image\";\r\n  if (videoExtensions.has(ext)) return \"video\";\r\n  return \"clip\";\r\n};\r\n\r\nconst pathExists = async (target: string) => {\r\n  try {\r\n    const stats = await fs.stat(target);\r\n    return stats.isDirectory();\r\n  } catch {\r\n    return false;\r\n  }\r\n};\r\n\r\nconst sanitizeFolderName = (value: string) =>\r\n  value.replace(/[\\\\/]/g, \"\").trim();\r\n\r\nconst normalizeSegments = (pathString: string) =>\r\n  pathString\r\n    .split(\"/\")\r\n    .map((segment) => segment.trim())\r\n    .filter(Boolean);\r\n\r\nconst isInsideMarketingRoot = (target: string) => {\r\n  const relative = path.relative(marketingRoot, target);\r\n  if (relative === \"\") return true;\r\n  return !relative.startsWith(\"..\") && !path.isAbsolute(relative);\r\n};\r\n\r\nconst fileExists = async (target: string): Promise<boolean> => {\r\n  try {\r\n    const stats = await fs.stat(target);\r\n    return stats.isFile();\r\n  } catch {\r\n    return false;\r\n  }\r\n};\r\n\r\n// Generate thumbnail path for a video file\r\nconst getVideoThumbnailPath = (\r\n  segments: string[],\r\n  fileName: string\r\n): string => {\r\n  const baseName = path.basename(fileName, path.extname(fileName));\r\n  const thumbnailName = `${baseName}_thumb.jpg`;\r\n  return path.join(thumbnailsRoot, thumbnailName);\r\n};\r\n\r\n// Get thumbnail URL for a video file\r\nconst getVideoThumbnailUrl = (segments: string[], fileName: string): string => {\r\n  const baseName = path.basename(fileName, path.extname(fileName));\r\n  const thumbnailName = `${baseName}_thumb.jpg`;\r\n  return `/images/video/${thumbnailName}`;\r\n};\r\n\r\n// Default video placeholder\r\nconst VIDEO_PLACEHOLDER = \"/images/video-placeholder.svg\";\r\n\r\nconst buildFolderNode = async (\r\n  dirPath: string,\r\n  segments: string[],\r\n  category: string,\r\n  files: ApiFileItem[],\r\n  counter: { value: number }\r\n): Promise<ApiFolderNode> => {\r\n  const entries = await fs.readdir(dirPath, { withFileTypes: true });\r\n  entries.sort((a, b) =>\r\n    a.name.localeCompare(b.name, undefined, { sensitivity: \"base\" })\r\n  );\r\n\r\n  const fileIds: number[] = [];\r\n  const children: ApiFolderNode[] = [];\r\n\r\n  for (const entry of entries) {\r\n    if (entry.name.startsWith(\".\")) continue;\r\n\r\n    const entryPath = path.join(dirPath, entry.name);\r\n\r\n    if (entry.isDirectory()) {\r\n      const childNode = await buildFolderNode(\r\n        entryPath,\r\n        [...segments, entry.name],\r\n        category,\r\n        files,\r\n        counter\r\n      );\r\n      children.push(childNode);\r\n      continue;\r\n    }\r\n\r\n    if (entry.isFile()) {\r\n      const stats = await fs.stat(entryPath);\r\n      const fileId = counter.value++;\r\n      const fileSegments = [...segments, entry.name];\r\n      const urlSegments = fileSegments.map((segment) =>\r\n        encodeURIComponent(segment)\r\n      );\r\n      const url = `/api/serve-video/${urlSegments.join(\"/\")}`;\r\n      const fileType = getFileType(entry.name);\r\n\r\n      // Determine thumbnail for the file\r\n      let thumbnail = url;\r\n      let needsThumbnailGeneration = false;\r\n\r\n      if (fileType === \"video\" || fileType === \"clip\") {\r\n        // Check if thumbnail exists\r\n        const thumbnailPath = getVideoThumbnailPath(fileSegments, entry.name);\r\n        const thumbnailExists = await fileExists(thumbnailPath);\r\n\r\n        if (thumbnailExists) {\r\n          thumbnail = getVideoThumbnailUrl(fileSegments, entry.name);\r\n        } else {\r\n          // Use placeholder and mark for generation\r\n          thumbnail = VIDEO_PLACEHOLDER;\r\n          needsThumbnailGeneration = true;\r\n        }\r\n      }\r\n\r\n      const fileItem: ApiFileItem = {\r\n        id: fileId,\r\n        name: entry.name,\r\n        type: fileType,\r\n        url,\r\n        thumbnail,\r\n        size: formatBytes(stats.size),\r\n        date: stats.mtime.toISOString(),\r\n        tags: segments,\r\n        favorite: false,\r\n        views: 0,\r\n        category,\r\n        needsThumbnailGeneration,\r\n      };\r\n      files.push(fileItem);\r\n      fileIds.push(fileId);\r\n    }\r\n  }\r\n\r\n  const nodeId = segments.map(slugify).join(\"-\");\r\n  return {\r\n    id: nodeId,\r\n    name: segments[segments.length - 1] ?? \"\",\r\n    path: segments.join(\"/\"),\r\n    fileIds,\r\n    children,\r\n  };\r\n};\r\n\r\nexport async function GET() {\r\n  try {\r\n    const files: ApiFileItem[] = [];\r\n    const counter = { value: 1 };\r\n\r\n    const folders: ApiFolderNode[] = [];\r\n\r\n    for (const definition of folderDefinitions) {\r\n      const dirPath = path.join(marketingRoot, definition.name);\r\n      if (await pathExists(dirPath)) {\r\n        const node = await buildFolderNode(\r\n          dirPath,\r\n          [definition.name],\r\n          definition.name,\r\n          files,\r\n          counter\r\n        );\r\n        folders.push(node);\r\n      } else {\r\n        folders.push({\r\n          id: definition.id,\r\n          name: definition.name,\r\n          path: definition.name,\r\n          fileIds: [],\r\n          children: [],\r\n        });\r\n      }\r\n    }\r\n\r\n    return NextResponse.json({ folders, files }, { status: 200 });\r\n  } catch (error) {\r\n    console.error(\"Error reading marketing folders\", error);\r\n    return NextResponse.json(\r\n      { folders: [], files: [], error: \"Unable to read marketing assets.\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\nconst isDirectoryEmpty = async (dirPath: string) => {\r\n  try {\r\n    const entries = await fs.readdir(dirPath);\r\n    return entries.length === 0;\r\n  } catch {\r\n    return false;\r\n  }\r\n};\r\n\r\nexport async function PATCH(req: NextRequest) {\r\n  try {\r\n    const body = await req.json();\r\n    const rawCurrentPath =\r\n      typeof body.currentPath === \"string\" ? body.currentPath : \"\";\r\n    const rawNewName = typeof body.newName === \"string\" ? body.newName : \"\";\r\n    const sanitizedNewName = sanitizeFolderName(rawNewName);\r\n\r\n    if (!rawCurrentPath || !sanitizedNewName) {\r\n      return NextResponse.json(\r\n        { error: \"Current path and new folder name are required.\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    if (sanitizedNewName.includes(\"..\")) {\r\n      return NextResponse.json(\r\n        { error: \"Invalid folder name.\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const currentSegments = normalizeSegments(rawCurrentPath);\r\n    if (\r\n      currentSegments.length === 0 ||\r\n      currentSegments.some((segment) => segment.includes(\"..\"))\r\n    ) {\r\n      return NextResponse.json(\r\n        { error: \"Invalid current path.\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const currentDir = path.join(marketingRoot, ...currentSegments);\r\n    if (!isInsideMarketingRoot(currentDir)) {\r\n      return NextResponse.json(\r\n        { error: \"Current path is outside of marketing assets.\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    if (!(await pathExists(currentDir))) {\r\n      return NextResponse.json(\r\n        { error: \"Folder does not exist.\" },\r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    const parentSegments = currentSegments.slice(0, -1);\r\n    const parentDir = path.join(marketingRoot, ...parentSegments);\r\n    if (!isInsideMarketingRoot(parentDir)) {\r\n      return NextResponse.json(\r\n        { error: \"Invalid parent folder.\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const newDir = path.join(parentDir, sanitizedNewName);\r\n    if (!isInsideMarketingRoot(newDir)) {\r\n      return NextResponse.json(\r\n        { error: \"Invalid target path.\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    if (await pathExists(newDir)) {\r\n      return NextResponse.json(\r\n        { error: \"Target folder already exists.\" },\r\n        { status: 409 }\r\n      );\r\n    }\r\n\r\n    await fs.rename(currentDir, newDir);\r\n    const parentPath = parentSegments.join(\"/\");\r\n    const newPath = parentPath\r\n      ? `${parentPath}/${sanitizedNewName}`\r\n      : sanitizedNewName;\r\n    return NextResponse.json({ success: true, path: newPath }, { status: 200 });\r\n  } catch (error) {\r\n    console.error(\"Error renaming marketing folder\", error);\r\n    return NextResponse.json(\r\n      { error: \"Unable to rename folder.\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\nexport async function POST(req: NextRequest) {\r\n  try {\r\n    const body = await req.json();\r\n    const rawParentPath =\r\n      typeof body.parentPath === \"string\" ? body.parentPath : \"\";\r\n    const rawFolderName =\r\n      typeof body.folderName === \"string\" ? body.folderName : \"\";\r\n    const sanitizedFolderName = sanitizeFolderName(rawFolderName);\r\n\r\n    if (!rawParentPath || !sanitizedFolderName) {\r\n      return NextResponse.json(\r\n        { error: \"Parent path and folder name are required.\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    if (sanitizedFolderName.includes(\"..\")) {\r\n      return NextResponse.json(\r\n        { error: \"Invalid folder name.\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const parentSegments = normalizeSegments(rawParentPath);\r\n    if (\r\n      parentSegments.length === 0 ||\r\n      parentSegments.some((segment) => segment.includes(\"..\"))\r\n    ) {\r\n      return NextResponse.json(\r\n        { error: \"Invalid parent path.\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const parentDir = path.join(marketingRoot, ...parentSegments);\r\n    if (!isInsideMarketingRoot(parentDir)) {\r\n      return NextResponse.json(\r\n        { error: \"Parent path is outside of the marketing tree.\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    if (!(await pathExists(parentDir))) {\r\n      return NextResponse.json(\r\n        { error: \"Parent folder does not exist.\" },\r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    const newFolderPath = path.join(parentDir, sanitizedFolderName);\r\n    if (!isInsideMarketingRoot(newFolderPath)) {\r\n      return NextResponse.json(\r\n        { error: \"Invalid folder path.\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    if (await pathExists(newFolderPath)) {\r\n      return NextResponse.json(\r\n        { error: \"Folder already exists.\" },\r\n        { status: 409 }\r\n      );\r\n    }\r\n\r\n    await fs.mkdir(newFolderPath);\r\n    return NextResponse.json(\r\n      { success: true, path: `${rawParentPath}/${sanitizedFolderName}` },\r\n      { status: 201 }\r\n    );\r\n  } catch (error) {\r\n    console.error(\"Error creating marketing folder\", error);\r\n    return NextResponse.json(\r\n      { error: \"Unable to create folder.\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\nexport async function DELETE(req: NextRequest) {\r\n  try {\r\n    const body = await req.json();\r\n    const rawPath = typeof body.path === \"string\" ? body.path : \"\";\r\n    const normalized = normalizeSegments(rawPath);\r\n\r\n    if (normalized.length === 0) {\r\n      return NextResponse.json(\r\n        { error: \"Folder path is required.\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    if (normalized.some((segment) => segment.includes(\"..\"))) {\r\n      return NextResponse.json(\r\n        { error: \"Invalid folder path.\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const targetDir = path.join(marketingRoot, ...normalized);\r\n    if (!isInsideMarketingRoot(targetDir)) {\r\n      return NextResponse.json(\r\n        { error: \"Path is outside marketing assets.\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    if (!(await pathExists(targetDir))) {\r\n      return NextResponse.json({ error: \"Folder not found.\" }, { status: 404 });\r\n    }\r\n\r\n    if (!(await isDirectoryEmpty(targetDir))) {\r\n      return NextResponse.json(\r\n        { error: \"Folder must be empty before deleting.\" },\r\n        { status: 409 }\r\n      );\r\n    }\r\n\r\n    await fs.rmdir(targetDir);\r\n    return NextResponse.json(\r\n      { success: true, path: normalized.join(\"/\") },\r\n      { status: 200 }\r\n    );\r\n  } catch (error) {\r\n    console.error(\"Error deleting marketing folder\", error);\r\n    return NextResponse.json(\r\n      { error: \"Unable to delete folder.\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}}]
}